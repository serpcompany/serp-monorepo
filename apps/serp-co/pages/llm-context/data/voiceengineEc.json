[
  {
    "owner": "voice-engine",
    "repo": "ec",
    "content": "TITLE: Building the Echo Canceller\nDESCRIPTION: Commands to install dependencies and build the echo canceller project from source. This creates both 'ec' and 'ec_hw' executables for different hardware configurations.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nsudo apt-get -y install libasound2-dev libspeexdsp-dev\ngit clone https://github.com/voice-engine/ec.git\ncd ec\nmake\n```\n\n----------------------------------------\n\nTITLE: Using 'ec' for Echo Cancellation\nDESCRIPTION: Commands demonstrating how to use the 'ec' utility for echo cancellation. This includes running the echo canceller, playing audio through the FIFO pipe, and recording processed audio.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n# terminal #1, run ec\n./ec -h\n./ec -i plughw:1 -o plughw:1 -s\n\n# terminal #2, play 16k fs, 16 bits, 1 channel raw audio\ncat 16k_s16le_mono_audio.raw > /tmp/ec.input\n\n# terminal #3, record\ncat /tmp/ec.output > 16k_s16le_stereo_audio.raw\n```\n\n----------------------------------------\n\nTITLE: Using 'ec_hw' for Echo Cancellation with Hardware Loopback\nDESCRIPTION: Commands showing how to use the 'ec_hw' utility for devices with hardware audio loopback. This demonstrates selecting input device, channels, loopback channel, and microphone channels.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\n# terminal #1, run ec\n./ec_hw -h\n./ec -i plughw:1 -c 8 -l 7 -m 0,1,2,3\n\n# terminal #3, record\ncat /tmp/ec.output > 16k_s16le_4_channels.raw\n```\n\n----------------------------------------\n\nTITLE: Configuring PulseAudio for Echo Cancellation\nDESCRIPTION: Commands to configure PulseAudio to work with the echo canceller by loading appropriate modules and setting default sink and source. This enables integration with the system audio stack.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\npacmd load-module module-pipe-sink sink_name=ec.sink format=s16 rate=16000 channels=1 file=/tmp/ec.input\npacmd load-module module-pipe-source source_name=ec.source format=s16 rate=16000 channels=2 file=/tmp/ec.output\npacmd set-default-sink ec.sink\npacmd set-default-source ec.source\n\n./ec -i plughw:0 -o plughw:0\n```\n\n----------------------------------------\n\nTITLE: Installing the FIFO ALSA Plugin\nDESCRIPTION: Commands to install the FIFO ALSA plugin, which allows the FIFO /tmp/ec.output to be used as a capture device in ALSA configurations.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ngit clone https://github.com/voice-engine/alsa_plugin_fifo.git\ncd alsa_plugin_fifo\nmake && sudo make install\n```\n\n----------------------------------------\n\nTITLE: Audio Stream Flow Diagram for Echo Cancellation without Hardware Loopback\nDESCRIPTION: ASCII diagram showing the audio stream flow for devices without hardware audio loopback. The diagram illustrates how 'ec' acts as an audio output broker using named pipes for input and output.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_1\n\nLANGUAGE: text\nCODE:\n```\n                   +-------------------+  +-------------------+\n                   |  PulseAudio       +  |  PulseAudio       |\n                   |  module+pipe+source  |  module+pipe+sink |\n                   +----------+--------+  +-------+-----------+\n+--------------+              ^                   |             +------------+\n|ALSA          |              |                   |             |ALSA        |\n|FIFO plugin   |              |                   v             |file plugin |\n+------+-------+       +------+-------+    +------+-------+     +----+-------+\n       ^               |    FIFO      |    |    FIFO      |          |\n       +---------------+/tmp/ec.output|    | /tmp/ec.input| <--------+\n                       +------+-------+    +------+-------+\n                              ^                   |\n                              |                   |\n                              |                   |\n                              |                   |\n                           +--+--+                | playback\n                           | AEC | <--------------+\n                           +--+--+                |\n                              ^                   |\n                              |                   v\n                       +------+-------+    +------+-------+\n                       |  hw:x,y      |    |  hw:x,y      |\n                       |  plughw:x,y  |    |  plughw:x,y  |\n                       +--------------+    +--------------+\n```\n\n----------------------------------------\n\nTITLE: Audio Stream Flow Diagram for Echo Cancellation with Hardware Loopback\nDESCRIPTION: ASCII diagram illustrating the audio stream flow for devices with hardware audio loopback. This shows how 'ec_hw' works with devices that have a hardware audio loopback channel.\nSOURCE: https://github.com/voice-engine/ec/blob/master/README.md#2025-04-22_snippet_5\n\nLANGUAGE: text\nCODE:\n```\n                       +---------+          +-------+         +------+\n                       |         |          |       |         |      |\n                       |         |          |       |         | FILE |\nMicrophones ---------->|         |--------> |  AEC  |-------> | FIFO |----> Audio Input\n                       |   ADC   |          |       |         |      |\n                       |         |          +-------+         +------+\n                       |         |             /\n             __________|         |____________/\n            |          +---------+   Loopback Channel\n            |\n            |          +---------+\n            |          |         |\nSpeakers <-------------|   DAC   |<------- Audio Output\n                       |         |\n                       +---------+\n```"
  }
]