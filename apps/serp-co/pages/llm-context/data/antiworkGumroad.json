[
  {
    "owner": "antiwork",
    "repo": "gumroad",
    "content": "TITLE: Tax Collection Implementation Fields\nDESCRIPTION: Core database fields and models used for tax calculation and storage. The Purchase model contains gumroad_tax_cents field which stores the tax amount, calculated by the SalesTaxCalculator class.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/taxes.md#2025-04-23_snippet_0\n\nLANGUAGE: ruby\nCODE:\n```\nPurchase.gumroad_tax_cents # Field storing tax amount\nSalesTaxCalculator # Class handling tax calculation logic\n```\n\n----------------------------------------\n\nTITLE: Configuring Environment Variables for Gumroad Production\nDESCRIPTION: Set up all environment variables listed in the .env.production.example file. These variables contain configuration for database connections, caching, application servers, storage, payment processing, authentication, email services, and third-party integrations.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/production_environment.md#2025-04-23_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n## Environment Variables\n\nSet up all environment variables listed in the `.env.production.example` file in your environment. These variables contain all the necessary configuration for database connections, caching, application servers, storage, payment processing, authentication, email services, and third-party integrations.\n```\n\n----------------------------------------\n\nTITLE: Database Schema for UTM Link Tracking\nDESCRIPTION: Database schema defining three main tables: utm_links for storing link metadata, utm_link_visits for tracking visits, and utm_link_driven_sales for attribution data. Includes field definitions and index specifications.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/shipping.md#2025-04-23_snippet_0\n\nLANGUAGE: sql\nCODE:\n```\nCREATE TABLE utm_links (\n  seller_id bigint NOT NULL,\n  title varchar NOT NULL,\n  target_resource_type varchar NOT NULL,\n  target_resource_id bigint,\n  permalink varchar NOT NULL UNIQUE,\n  utm_source varchar NOT NULL,\n  utm_medium varchar NOT NULL,\n  utm_campaign varchar NOT NULL,\n  utm_term varchar,\n  utm_content varchar,\n  first_click_at timestamp,\n  last_click_at timestamp,\n  total_clicks integer DEFAULT 0,\n  unique_clicks integer DEFAULT 0,\n  ip_address varchar,\n  browser_guid varchar\n);\n\nCREATE TABLE utm_link_visits (\n  utm_link_id bigint NOT NULL,\n  user_id bigint,\n  referrer varchar,\n  ip_address varchar NOT NULL,\n  user_agent varchar,\n  browser_guid varchar NOT NULL,\n  country_code varchar NOT NULL,\n  created_at timestamp\n);\n\nCREATE TABLE utm_link_driven_sales (\n  utm_link_id bigint NOT NULL,\n  utm_link_visit_id bigint NOT NULL,\n  purchase_id bigint NOT NULL\n);\n```\n\n----------------------------------------\n\nTITLE: Constants Definition\nDESCRIPTION: Constants used to define taxable regions and jurisdictions in the codebase.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/taxes.md#2025-04-23_snippet_2\n\nLANGUAGE: ruby\nCODE:\n```\nTAXABLE_US_STATE_CODES\nEU_VAT_APPLICABLE_COUNTRY_CODES\n```\n\n----------------------------------------\n\nTITLE: Setting Up the Database\nDESCRIPTION: Commands for preparing the database schema and running migrations.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_8\n\nLANGUAGE: shell\nCODE:\n```\nbin/rails db:prepare\n```\n\n----------------------------------------\n\nTITLE: Configuring Sidekiq Workers for Gumroad\nDESCRIPTION: Configuration settings for Sidekiq workers, which process background jobs for the Gumroad application. It includes settings for threads, memory recommendations, and database replica usage.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/production_environment.md#2025-04-23_snippet_2\n\nLANGUAGE: markdown\nCODE:\n```\n#### Configuration\n\n- **Threads**: Set via `RAILS_MAX_THREADS` (default: 2)\n- **Memory**: Recommended 2GB per instance\n- **Database Replicas**: Set `USE_DB_WORKER_REPLICAS=true` to use read replicas for database operations\n```\n\n----------------------------------------\n\nTITLE: Starting the Development Application\nDESCRIPTION: Command for starting the Rails server, JavaScript build system, and Sidekiq worker for local development.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_9\n\nLANGUAGE: shell\nCODE:\n```\nbin/dev\n```\n\n----------------------------------------\n\nTITLE: Feature Flag Implementation\nDESCRIPTION: Feature flag pattern used for controlling tax collection in different countries. Format follows collect_tax_<country_code> pattern.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/taxes.md#2025-04-23_snippet_1\n\nLANGUAGE: ruby\nCODE:\n```\ncollect_tax_cl # Example feature flag for Chile\n```\n\n----------------------------------------\n\nTITLE: Configuring Puma Application Server for Gumroad\nDESCRIPTION: Configuration settings for Puma, the application server used by Gumroad. It includes settings for worker processes, threads, and memory recommendations. It also suggests using Nginx as a reverse proxy.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/production_environment.md#2025-04-23_snippet_1\n\nLANGUAGE: markdown\nCODE:\n```\n#### Puma (Application Server)\n\nPuma runs the Rails application and handles HTTP requests. Configuration:\n\n- **Worker Processes**: Set via `PUMA_WORKER_PROCESSES` (default: 1)\n- **Threads**: Set via `RAILS_MAX_THREADS` (default: 2)\n- **Memory**: Recommended 2GB per instance\n\nWe recommend running Nginx in front of Puma as a reverse proxy.\n```\n\n----------------------------------------\n\nTITLE: Configuring PayPal SDK in Ruby\nDESCRIPTION: This Ruby initialization code sets up the PayPal SDK with sandbox credentials for a Gumroad partner account. It defines endpoints, credentials, and configures the PayPal SDK for use in a Rails application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/paypal.md#2025-04-23_snippet_5\n\nLANGUAGE: ruby\nCODE:\n```\nPAYPAL_ENDPOINT = \"https://api-3t.sandbox.paypal.com/nvp\"\nPAYPAL_REST_ENDPOINT = \"https://api.sandbox.paypal.com\"\nPAYPAL_ENV = \"sandbox\"\nPAYPAL_CLIENT_ID = \"AQiKjZAqXGcN_oU8wh-RKelv6Nf3IrWVY9J9rrhz1pF7aqiyZjutSdG75I6ahd3zJe1ThpklFp5jNman\"\nPAYPAL_CLIENT_SECRET = \"EPnNdtAW6jsUleHWQmjsFNef37f1GGWLwtJx3uO2PRdbENAFxTgW1WA1V83MVYvSrRrkH0tXNevE0CJ_\"\nPAYPAL_LIB_MODE = \"sandbox\"\nPAYPAL_URL = \"https://www.sandbox.paypal.com\"\nPAYPAL_MERCHANT_ID = \"5SCHBGJUCTP2U\"\nPAYPAL_USER_EMAIL = \"paypal-facilitator@gumroad.com\"\nPAYPAL_USER = \"paypal-facilitator_api1.gumroad.com\"\nPAYPAL_PASS = \"1383112423\"\nPAYPAL_SIGNATURE = \"AFcWxV21C7fd0v3bYYYRCpSSRl31A9TRhGDrqj7x7lF9P6NGOruW.7ak\"\n\nPayPal::SDK.configure(\n  :mode => PAYPAL_ENV,\n  :client_id => PAYPAL_CLIENT_ID,\n  :client_secret => PAYPAL_CLIENT_SECRET,\n  :username => PAYPAL_USER,\n  :password => PAYPAL_PASS,\n  :signature => PAYPAL_SIGNATURE\n)\n```\n\n----------------------------------------\n\nTITLE: Starting Docker Services for Development\nDESCRIPTION: Commands for starting Docker services for local development with options for running in foreground or background.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_7\n\nLANGUAGE: shell\nCODE:\n```\nmake local\n```\n\nLANGUAGE: shell\nCODE:\n```\nLOCAL_DETACHED=true make local\n```\n\n----------------------------------------\n\nTITLE: Installing and Configuring MySQL for Gumroad Development\nDESCRIPTION: Commands to install MySQL and Percona Toolkit via Homebrew, configure OpenSSL, and set a root password for the database. This setup is required for running the Gumroad application without Docker.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nbrew install mysql percona-toolkit\nbrew link --force mysql\n\n# to use Homebrew's `openssl`:\nbrew install openssl\nbundle config --global build.mysql2 --with-opt-dir=\"$(brew --prefix openssl)\"\n\n# to set root password (use password=\"password\"):\n$(brew â€”-prefix mysql)/bin/mysqladmin -u root password <NEWPASSWORD>\n```\n\n----------------------------------------\n\nTITLE: Installing Docker on Linux\nDESCRIPTION: Commands for installing Docker on Linux systems and adding the current user to the docker group for permissions.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nsudo wget -qO- https://get.docker.com/ | sh\nsudo usermod -aG docker $(whoami)\n```\n\n----------------------------------------\n\nTITLE: Creating Apple Pay Domain in Stripe via Rails Console\nDESCRIPTION: This Ruby code snippet demonstrates how to add a new domain for Apple Pay support using the Stripe API through the Rails console. It creates an Apple Pay domain entry with the specified domain name.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/apple_pay.md#2025-04-23_snippet_0\n\nLANGUAGE: ruby\nCODE:\n```\nStripe::ApplePayDomain.create(domain_name: domain)\n```\n\n----------------------------------------\n\nTITLE: Starting the Development Environment in Bash\nDESCRIPTION: Command to start the local development environment using the provided bin/dev script.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nbin/dev\n```\n\n----------------------------------------\n\nTITLE: Generating PayPal Access Token with cURL\nDESCRIPTION: This command generates an access token for PayPal API authentication using client credentials flow. The token is required for all subsequent API calls to PayPal's webhook endpoints.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/paypal.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncurl https://api.paypal.com/v1/oauth2/token \\\n  -H \"Accept: application/json\" \\\n  -H \"Accept-Language: en_US\" \\\n  -u \"<client_id>:<client_secret>\" \\\n  -d \"grant_type=client_credentials\"\n```\n\n----------------------------------------\n\nTITLE: Installing Bundler and Setting Up Gems\nDESCRIPTION: Commands for installing Bundler and configuring Sidekiq Pro credentials for the Ruby application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_2\n\nLANGUAGE: shell\nCODE:\n```\ngem install bundler\n```\n\n----------------------------------------\n\nTITLE: Configuring Elasticsearch Environment Variables\nDESCRIPTION: Bash environment variable configuration for Elasticsearch to limit memory usage and set up as a single node. These settings should be added to the shell configuration file.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nexport ES_JAVA_OPTS=-Xms512m -Xmx512m\nexport discovery.type=single-node\n```\n\n----------------------------------------\n\nTITLE: Running Common Development Tasks\nDESCRIPTION: Commands for running common development tasks like accessing the Rails console and executing Rake tasks.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_12\n\nLANGUAGE: shell\nCODE:\n```\nbin/rails c\n```\n\nLANGUAGE: shell\nCODE:\n```\nbin/rake task_name\n```\n\n----------------------------------------\n\nTITLE: Starting Redis Service with Homebrew\nDESCRIPTION: Command to start the Redis service using Homebrew services and configure it to restart at login. This ensures Redis is running whenever the development environment is needed.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nbrew services start redis\n```\n\n----------------------------------------\n\nTITLE: Installing MySQL and Percona Toolkit on macOS\nDESCRIPTION: Commands for installing MySQL 8.0, Percona Toolkit, and configuring the MySQL gem with OpenSSL on macOS using Homebrew.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nbrew install mysql@8.0 percona-toolkit\nbrew link --force mysql@8.0\n\n# to use Homebrew's `openssl`:\nbrew install openssl\nbundle config --global build.mysql2 --with-opt-dir=\"$(brew --prefix openssl)\"\n\n# ensure MySQL is not running as a service\nbrew services stop mysql@8.0\n```\n\n----------------------------------------\n\nTITLE: Installing MongoDB for Gumroad Development\nDESCRIPTION: Command to install MongoDB 3.6 using Homebrew for the Gumroad development environment. This specifies the MongoDB version used by the application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nbrew install mongodb/brew/mongodb-community@3.6\n```\n\n----------------------------------------\n\nTITLE: Setting Up npm for Node.js Dependencies\nDESCRIPTION: Commands for enabling the correct version of npm with corepack and installing Node.js dependencies.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_5\n\nLANGUAGE: shell\nCODE:\n```\ncorepack enable\n```\n\nLANGUAGE: shell\nCODE:\n```\nnpm install\n```\n\n----------------------------------------\n\nTITLE: Installing Redis for Gumroad Development\nDESCRIPTION: Command to install Redis using Homebrew for the Gumroad development environment. Redis is used for caching and other background processes.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nbrew install redis\n```\n\n----------------------------------------\n\nTITLE: Setting Up Git Hooks for Linting\nDESCRIPTION: Command for configuring local Git hooks to check for linting issues when committing code.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_13\n\nLANGUAGE: shell\nCODE:\n```\ngit config --local core.hooksPath .githooks\n```\n\n----------------------------------------\n\nTITLE: Deploying Web Server Generic for Long-Running Tasks in Bash\nDESCRIPTION: This snippet demonstrates how to deploy a web_server_generic instance for running long-running tasks in production. It includes setting the deployment tag and starting the generic web server.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/migrations.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nexport DEPLOY_TAG=production-<revision>\ncd nomad/production && ./start_generic_web.sh\n```\n\n----------------------------------------\n\nTITLE: Creating Hotfix Branch from Production Release Tag using Git\nDESCRIPTION: Git commands to create a hotfix branch from the latest production release tag. This is used when the latest deployed code is in the production-release tag.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ngit tag -d production-release\ngit fetch origin tag production-release\ngit checkout -b comp-assets-hotfix-branch-name production-release\n```\n\n----------------------------------------\n\nTITLE: Connecting to Web Server Generic Instance via SSH in Bash\nDESCRIPTION: This code snippet shows how to SSH into the server and open a Rails console on the web_server_generic instance. It uses the INSTANCE_IP environment variable to specify the target server.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/migrations.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nINSTANCE_IP=10.1.x.x COMMAND=\"screen -adrAR\" ./console.sh\nbundle exec rails c\n```\n\n----------------------------------------\n\nTITLE: Starting Local Development Services for Gumroad Debugging\nDESCRIPTION: Command to start supporting services for local development environment using Make.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/debugging.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nmake local\n```\n\n----------------------------------------\n\nTITLE: Deploying to Production Manually using Bash\nDESCRIPTION: Commands to manually deploy the production branch after rebasing staging into production. This process uses a deployment script in the nomad/production directory.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncd nomad/production && dotenv -f ../.env ./deploy_unattended.sh\n```\n\n----------------------------------------\n\nTITLE: Seeding Users Database in Ruby on Rails for Gumroad Project\nDESCRIPTION: This Ruby on Rails command prepares the database and seeds it with predefined users having various roles and permissions. It's typically used for setting up a development or testing environment.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/users.md#2025-04-23_snippet_0\n\nLANGUAGE: ruby\nCODE:\n```\nbin/rails db:prepare\n```\n\n----------------------------------------\n\nTITLE: Creating Hotfix Branch from Specific Production Tag using Git\nDESCRIPTION: Git command to create a hotfix branch from a specific production tag. This is used when the latest deployed code is not in the production-release tag.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\ngit fetch --tags && git checkout -b comp-assets-hotfix-branch-name production-d6b4605/2018-05-02-13-16-03\n```\n\n----------------------------------------\n\nTITLE: Running Ruby Tests with RSpec\nDESCRIPTION: Commands for running the entire test suite, specific test files, or individual tests using RSpec.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$ bin/rspec\n$ bin/rspec spec/requests/dashboard_spec.rb\n$ bin/rspec spec/requests/dashboard_spec.rb:75\n```\n\n----------------------------------------\n\nTITLE: Deploying Hotfix to Production using Bash\nDESCRIPTION: Commands to deploy a hotfix to production. This process involves setting an environment variable with the deployment tag and running the deployment script.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nexport DEPLOY_TAG=\"production-xxxxxxx\"\ncd nomad/production && dotenv -f ../.env ./deploy_unattended.sh\n```\n\n----------------------------------------\n\nTITLE: Configuring RPush for Push Notifications in Gumroad\nDESCRIPTION: Configuration settings for RPush, which handles push notifications to mobile devices. It includes Redis configuration, certificate requirements for Apple Push Notification Service, Firebase configuration for Android, memory recommendations, and required environment variables.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/production_environment.md#2025-04-23_snippet_3\n\nLANGUAGE: markdown\nCODE:\n```\n### Push Notification Service (RPush)\n\nRPush handles push notifications to mobile devices.\n\n- Requires specific Redis instance configured via `RPUSH_REDIS_HOST`\n- Requires certificates for Apple Push Notification Service (APN)\n- Requires Firebase configuration for Android notifications\n- **Memory**: Recommended 2GB per instance\n- **Environment Variables**:\n  - `INITIALIZE_RPUSH_APPS`: \"true\"\n```\n\n----------------------------------------\n\nTITLE: Fetching PayPal Webhooks with cURL\nDESCRIPTION: This command retrieves all existing webhooks configured for the PayPal account. It requires an access token obtained from the authentication step.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/paypal.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncurl -v -X GET https://api.paypal.com/v1/notifications/webhooks \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization: Bearer <access_token>\"\n```\n\n----------------------------------------\n\nTITLE: Setting Up Test Database for Ruby Tests\nDESCRIPTION: Commands to set up the required services and test database for running Ruby tests.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n$ make local\n$ RAILS_ENV=test bin/rails db:setup\n```\n\n----------------------------------------\n\nTITLE: Registering a PayPal Webhook with cURL\nDESCRIPTION: This command creates a new webhook in the PayPal system with a specified URL and event type. The webhook will be triggered when the specified event (CHECKOUT.ORDER.PROCESSED) occurs.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/paypal.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ncurl -v -X POST https://api.paypal.com/v1/notifications/webhooks \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization: Bearer <access_token>\" \\\n-d '{\n  \"url\": \"https://<URL>/paypal-webhook\",\n  \"event_types\": [\n  {\n    \"name\": \"CHECKOUT.ORDER.PROCESSED\"\n  }\n  ]\n}'\n```\n\n----------------------------------------\n\nTITLE: Resetting Elasticsearch Indices\nDESCRIPTION: Ruby code for resetting Elasticsearch indices to avoid index_not_found_exception errors in development.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_10\n\nLANGUAGE: ruby\nCODE:\n```\n# Run this in a rails console:\nDevTools.delete_all_indices_and_reindex_all\n```\n\n----------------------------------------\n\nTITLE: Viewing Dead Job Backtrace in Sidekiq\nDESCRIPTION: Script to retrieve and display the backtrace of a specific dead job from Sidekiq's DeadSet. Filters jobs by worker class and argument value.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/sidekiq.md#2025-04-23_snippet_0\n\nLANGUAGE: ruby\nCODE:\n```\nds = Sidekiq::DeadSet.new\ndead_jobs = ds.select { |job| job.klass == 'ExportUserSalesDataWorker' && job.args[0] == 123 }\npp dead_jobs.first.error_backtrace; nil\n```\n\n----------------------------------------\n\nTITLE: Bulk Deletion of Sidekiq Jobs\nDESCRIPTION: Script for safely removing large batches of Sidekiq jobs from a specific queue. Includes progress tracking and handles jobs in batches to prevent memory issues. Specifically targets jobs by worker class and index name.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/sidekiq.md#2025-04-23_snippet_1\n\nLANGUAGE: ruby\nCODE:\n```\ndef delete_batch_of_jobs\n  i = 0\n  queue = Sidekiq::Queue.new('default')\n  jobs = []\n  queue.each do |job|\n    if job.klass == \"ElasticsearchIndexerWorker\" && job.args[1]['class_name'] == 'Purchase::Indices::V999'\n      i += 1\n      jobs << job\n      break if i == 500\n    end\n  end\n  jobs.each(&:delete)\n  i\nend\n\ndef delete_jobs_with_running_total\n  total = 0\n  loop do\n    deleted = delete_batch_of_jobs\n    total += deleted\n    puts \"[#{Time.now}] Total deleted: #{total}\"\n    break if deleted == 0\n  end\n  total\nend\n\ndelete_jobs_with_running_total\n```\n\n----------------------------------------\n\nTITLE: Testing Redis Server Connection\nDESCRIPTION: Command to test if the Redis server is running properly using the ping command. A 'PONG' response indicates the server is operational.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nredis-cli ping\n```\n\n----------------------------------------\n\nTITLE: Running Non-Rails Services for Debugging\nDESCRIPTION: Command to start the non-Rails services using Foreman with a specific Procfile for debugging.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/debugging.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nforeman start -f Procfile.debug\n```\n\n----------------------------------------\n\nTITLE: Testing Nginx Configuration\nDESCRIPTION: Command to test if the Nginx configuration is valid before applying changes. This helps prevent configuration errors that could cause the web server to fail.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_11\n\nLANGUAGE: bash\nCODE:\n```\nsudo nginx -t\n```\n\n----------------------------------------\n\nTITLE: Configuring Sidekiq Pro Credentials\nDESCRIPTION: Instructions for configuring Bundler with Sidekiq Pro credentials or disabling it for development.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_3\n\nLANGUAGE: shell\nCODE:\n```\nbundle config gems.contribsys.com <key>\n```\n\nLANGUAGE: shell\nCODE:\n```\nexport GUMROAD_SIDEKIQ_PRO_DISABLED=true\necho \"export GUMROAD_SIDEKIQ_PRO_DISABLED=true\" >> ~/.bashrc\n```\n\n----------------------------------------\n\nTITLE: Restarting Nginx Service\nDESCRIPTION: Command to restart the Nginx service using Homebrew services. This applies the configuration changes and makes the web server available for the Gumroad application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_12\n\nLANGUAGE: bash\nCODE:\n```\nbrew services restart nginx\n```\n\n----------------------------------------\n\nTITLE: Deploying Sidekiq Worker Only using Bash and Nomad\nDESCRIPTION: Bash commands to deploy only the Sidekiq worker using Nomad. This process involves setting environment variables, generating a Nomad job file, and running it.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\n$ export DEPLOY_TAG=<>\n$ cd nomad\n$ source nomad_proxy_functions.sh\n$ cd production\n$ alias  nomad=nomad_insecure_wrapper\n$ dotenv -f ../.env erb sidekiq_worker.nomad.erb > sidekiq_worker.nomad\n$ nomad run sidekiq_worker.nomad\n```\n\n----------------------------------------\n\nTITLE: Accessing Production Logs via Shell Command\nDESCRIPTION: Command to access production logs by changing to the production directory and executing the logs script.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/logs.md#2025-04-23_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\ncd nomad/production && ./logs.sh\n```\n\n----------------------------------------\n\nTITLE: Accessing Hashi-UI Container Monitoring\nDESCRIPTION: Commands to enable proxy access to Hashi-UI for container monitoring in the production environment.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/alerts.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$ cd nomad\n$ source nomad_proxy_functions.sh\n$ proxy_on production\n```\n\n----------------------------------------\n\nTITLE: Accessing Staging Logs via Shell Command\nDESCRIPTION: Command to access staging logs by changing to the staging directory and executing the logs script.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/logs.md#2025-04-23_snippet_1\n\nLANGUAGE: shell\nCODE:\n```\ncd nomad/staging && ./logs.sh\n```\n\n----------------------------------------\n\nTITLE: Accessing Screen Sessions for Memory Usage\nDESCRIPTION: Commands to connect to screen sessions and view memory usage statistics for both Puma and Sidekiq processes.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/memory_profiling.md#2025-04-23_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nscreen -x puma\nPress Ctrl+c and note the peak memory usage.\n```\n\n----------------------------------------\n\nTITLE: Configuring Push Notifications\nDESCRIPTION: Command for setting up push notifications in the development environment using rpush.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_11\n\nLANGUAGE: shell\nCODE:\n```\nINITIALIZE_RPUSH_APPS=true bundle exec rpush start -e development -f\n```\n\n----------------------------------------\n\nTITLE: Manually Unlocking Deployment using Bash\nDESCRIPTION: Command to manually unlock the deployment process, allowing new deployments to proceed.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ncd nomad/production && ./unlock_deployment.sh\n```\n\n----------------------------------------\n\nTITLE: Conventional Commit Message Structure in Bash\nDESCRIPTION: Example structure for commit messages following the Conventional Commits specification. This helps maintain a standardized commit history.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md#2025-04-23_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\ntype(scope): title\n\ndescription\n```\n\n----------------------------------------\n\nTITLE: Deploying Directory Navigation\nDESCRIPTION: Commands for navigating and managing deployment directories.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/alerts.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ngrd\ncd ..\nls -l\n```\n\n----------------------------------------\n\nTITLE: Updating PayPal Webhook Event Types with cURL\nDESCRIPTION: This command updates an existing webhook with a comprehensive list of event types. It uses the PATCH method to modify only the event_types field, adding multiple event notifications related to checkouts, disputes, payments, and partner consent.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/paypal.md#2025-04-23_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ncurl -v -X PATCH https://api.paypal.com/v1/notifications/webhooks/><webhook-id> \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization: Bearer <access_token>\" \\\n-d '[\n  {\n  \"op\": \"replace\",\n  \"path\": \"/event_types\",\n  \"value\": [\n    {\n      \"name\": \"CHECKOUT.ORDER.PROCESSED\"\n    },\n    {\n      \"name\":\"CUSTOMER.DISPUTE.CREATED\"\n    },\n    {\n      \"name\":\"CUSTOMER.DISPUTE.RESOLVED\"\n    },\n    {\n      \"name\":\"CUSTOMER.DISPUTE.UPDATED\"\n    },\n    {\n      \"name\": \"MERCHANT.PARTNER-CONSENT.REVOKED\"\n    },\n    {\n      \"name\": \"PAYMENT.CAPTURE.COMPLETED\"\n    },\n    {\n      \"name\": \"PAYMENT.CAPTURE.DENIED\"\n    },\n    {\n      \"name\":\"PAYMENT.CAPTURE.PENDING\"\n    },\n    {\n      \"name\": \"PAYMENT.CAPTURE.REFUNDED\"\n    },\n    {\n      \"name\":\"PAYMENT.CAPTURE.REVERSED\"\n    },\n    {\n      \"name\":\"PAYMENT.ORDER.CREATED\"\n    },\n    {\n      \"name\": \"PAYMENT.REFERENCED-PAYOUT-ITEM.COMPLETED\"\n    }\n  ]\n  }\n]'\n```\n\n----------------------------------------\n\nTITLE: SSL Certificate Verification\nDESCRIPTION: Command for checking and displaying SSL certificates for a given hostname and port.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/alerts.md#2025-04-23_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nopenssl s_client -showcerts -connect [host]:[port]\n```\n\n----------------------------------------\n\nTITLE: Running Docker Container for Gumroad Web Application\nDESCRIPTION: Commands to pull and run the Gumroad web application Docker container with specific environment configuration and memory settings.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/memory_profiling.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndocker pull gumroad/web:<env>-<revision>\nmake local # In a seperate window\ndocker run -it -e BUILD_JS=1 -e RAILS_LOG_LEVEL=error --shm-size=256m -p 3000:3000 --network web_default gumroad/web:<env>-<revision> /bin/bash\n```\n\n----------------------------------------\n\nTITLE: Running Capybara Specs Multiple Times\nDESCRIPTION: Bash script to run a specific Capybara spec multiple times to check for flakiness.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nfor i in {1..10}; do\n  echo \"Run number $i\\n-\"\n  bin/rspec spec/requests/product_creation_spec.rb:28\ndone\n```\n\n----------------------------------------\n\nTITLE: Running Puma Server with Memory Monitoring\nDESCRIPTION: Commands to start a Puma server instance with memory usage monitoring using screen and memusg.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/memory_profiling.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nscreen -S puma bash\ncd /app\nRAILS_ENV=<env> CUSTOM_DOMAIN=<ngrok domain> PUMA_WORKER_PROCESSES=<workers count> ./bin/memusg.sh ./docker/web/server.sh\n```\n\n----------------------------------------\n\nTITLE: Resolving Browser GUID Ban in Ruby on Rails\nDESCRIPTION: This code snippet shows how to resolve a browser GUID ban that occurs after 3 failed purchase attempts. It destroys the blocked object associated with the purchase's browser GUID and the purchase itself, allowing for new purchase attempts.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_7\n\nLANGUAGE: ruby\nCODE:\n```\n# Run this in a rails console\npurchase = Purchase.last\nBlockedObject.browser_guid.active.find_by(purchase.browser_guid).destroy\npurchase.destroy\n```\n\n----------------------------------------\n\nTITLE: Running Sidekiq Worker with Memory Monitoring\nDESCRIPTION: Commands to start a Sidekiq worker instance with memory usage monitoring using screen and memusg.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/memory_profiling.md#2025-04-23_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nscreen -S puma bash\ncd /app\nRAILS_ENV=<env> ./bin/memusg.sh ./docker/web/sidekiq_worker.sh\n```\n\n----------------------------------------\n\nTITLE: Cloning the Gumroad Repository in Bash\nDESCRIPTION: Command to clone the Gumroad repository to your local machine. This is the first step in setting up the development environment.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md#2025-04-23_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ngit clone https://github.com/antiwork/gumroad.git\n```\n\n----------------------------------------\n\nTITLE: Example Conventional Commit Message in Bash\nDESCRIPTION: A concrete example of a feature commit message following the Conventional Commits format, specifically for adding mobile testing support to the CLI.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md#2025-04-23_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nfeat(cli): Add mobile testing support\n```\n\n----------------------------------------\n\nTITLE: Creating a Feature Branch in Bash\nDESCRIPTION: Command to create a new feature branch for development. This follows git flow practices where features are developed in separate branches.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ngit checkout -b feature/your-feature\n```\n\n----------------------------------------\n\nTITLE: Cleaning Temporary Files and Listing Large Files\nDESCRIPTION: Commands for managing disk space by cleaning temporary files and identifying large files on the server.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/alerts.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nsudo rm -rf /tmp/*\nsudo find / -type f -size +20M -exec ls -lh {} \\;\n```\n\n----------------------------------------\n\nTITLE: Running the Test Suite in Bash\nDESCRIPTION: Command to execute the RSpec test suite for the project. This ensures that all tests pass before submitting a pull request.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/CONTRIBUTING.md#2025-04-23_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nbundle exec rspec spec\n```\n\n----------------------------------------\n\nTITLE: Checking Sidekiq Memory Usage\nDESCRIPTION: Commands to access Sidekiq screen session and view its memory usage statistics.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/memory_profiling.md#2025-04-23_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nscreen -x sidekiq\nPress Ctrl+c and note the peak memory usage.\n```\n\n----------------------------------------\n\nTITLE: Generating SSL Certificates for Local Development\nDESCRIPTION: Command for generating SSL certificates for local development using mkcert.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_6\n\nLANGUAGE: shell\nCODE:\n```\nbrew install mkcert\n```\n\nLANGUAGE: shell\nCODE:\n```\nbin/generate_ssl_certificates\n```\n\n----------------------------------------\n\nTITLE: Navigating to Gumroad Repository Directory\nDESCRIPTION: Command to change to the main Gumroad repository directory. This is a prerequisite step for the Nginx configuration that follows.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\ncd /path/to/gumroad/web\n```\n\n----------------------------------------\n\nTITLE: Base64 Encoded PNG Image Data\nDESCRIPTION: A base64 encoded string containing binary PNG image data starting with the standard data:image/png header.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/spec/support/fixtures/gumroad_base64.txt#2025-04-23_snippet_0\n\nLANGUAGE: text\nCODE:\n```\ndata:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABmEAAAIACAIAAAD15l9hAAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob...\n```\n\n----------------------------------------\n\nTITLE: Stopping Web Server Generic Instance in Bash\nDESCRIPTION: This snippet demonstrates how to stop the web_server_generic instance after completing a long-running task. It includes sourcing necessary functions, toggling proxies, and using nomad to stop the instance.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/migrations.md#2025-04-23_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ncd nomad\nsource nomad_proxy_functions.sh\nproxy_off production; proxy_on production\nnomad_insecure_wrapper stop -purge web_server_generic\nproxy_off production\n```\n\n----------------------------------------\n\nTITLE: Creating a New Subscription Payment in Local Environment\nDESCRIPTION: Ruby code snippet for creating a new subscription payment in the local development environment.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_5\n\nLANGUAGE: ruby\nCODE:\n```\n\n```\n\n----------------------------------------\n\nTITLE: Charging Subscriptions in Ruby on Rails\nDESCRIPTION: This snippet demonstrates how to charge a subscription using the Rails console. It retrieves the last subscription and calls the charge! method twice. Note that creating multiple subscription purchases quickly may conflict with purchase model validations.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_6\n\nLANGUAGE: ruby\nCODE:\n```\n# Run this in a rails console\nsub = Subscription.last.charge!\nsub.charge!\n```\n\n----------------------------------------\n\nTITLE: Disabling Rack Timeout for Integration Tests\nDESCRIPTION: Environment variable setting to disable Rack timeout for integration tests.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_3\n\nLANGUAGE: text\nCODE:\n```\nDISABLE_RACK_TIMEOUT=\"1\"\n```\n\n----------------------------------------\n\nTITLE: Network Connectivity Testing\nDESCRIPTION: Command for checking network connectivity to a specific host and port with a 5-second timeout.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/alerts.md#2025-04-23_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nnc -z -w 5 [host] [port]\n```\n\n----------------------------------------\n\nTITLE: Starting Ngrok HTTP Tunnel\nDESCRIPTION: Command to establish an Ngrok HTTP tunnel for port 3000, enabling external access to the local development server.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/memory_profiling.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nngrok http 3000\n```\n\n----------------------------------------\n\nTITLE: Setting Up Custom Domain in Hosts File\nDESCRIPTION: Example of adding a custom domain entry to the hosts file for local testing.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/testing.md#2025-04-23_snippet_4\n\nLANGUAGE: text\nCODE:\n```\n127.0.0.1 sample-custom-domain.example.com\n```\n\n----------------------------------------\n\nTITLE: Manually Locking Deployment using Bash\nDESCRIPTION: Command to manually lock the deployment process, preventing concurrent deployments.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncd nomad/production && ./lock_deployment.sh\n```\n\n----------------------------------------\n\nTITLE: Hotfixing Workers Only by Modifying Deployment Script\nDESCRIPTION: Diff showing modifications to the common.sh script to deploy only worker-related components, skipping database migrations and web server deployments.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/deploying.md#2025-04-23_snippet_6\n\nLANGUAGE: diff\nCODE:\n```\ndiff --git a/nomad/common.sh b/nomad/common.sh\nindex bb60a7a598..d128504bca 100644\n--- a/nomad/common.sh\n+++ b/nomad/common.sh\n@@ -138,26 +138,26 @@ function create_release_tag() {\n }\n \n function gr_deploy() {\n-  check_for_deployment_lock\n+  # check_for_deployment_lock\n \n-  run_job database_migration\n+  # run_job database_migration\n \n-  logger \"Waiting for db:migrate to complete\"\n+  # logger \"Waiting for db:migrate to complete\"\n \n-  wait_for_db_migrate\n+  # wait_for_db_migrate\n \n-  run_job rpush\n+  # run_job rpush\n   run_job sidekiq_worker\n \n-  if (production_deployment); then\n-    scale_up_web_server_clusters\n-    deploy_to_web_servers\n-  else\n-    deploy_to_web_servers\n-  fi\n+  # if (production_deployment); then\n+  #   scale_up_web_server_clusters\n+  #   deploy_to_web_servers\n+  # else\n+  #   deploy_to_web_servers\n+  # fi\n \n-  run_job post_deployment\n+  # run_job post_deployment\n \n   create_release_tag\n }\n```\n\n----------------------------------------\n\nTITLE: Installing dotenv Gem for Console Commands\nDESCRIPTION: Command for installing the dotenv gem which is required for certain console commands in the application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/README.md#2025-04-23_snippet_4\n\nLANGUAGE: shell\nCODE:\n```\ngem install dotenv\n```\n\n----------------------------------------\n\nTITLE: Rails Route Definition for UTM Link Tracking\nDESCRIPTION: Route definition in Rails for handling UTM link clicks and redirects through the UtmLinkTrackingController\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/shipping.md#2025-04-23_snippet_1\n\nLANGUAGE: ruby\nCODE:\n```\nget \"/u/:permalink\", to: \"utm_link_tracking#show\"\n```\n\n----------------------------------------\n\nTITLE: Deleting a PayPal Webhook with cURL\nDESCRIPTION: This command removes an existing webhook from the PayPal system. It requires the webhook ID and an access token for authentication.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/paypal.md#2025-04-23_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\ncurl -v -X DELETE https://api.paypal.com/v1/notifications/webhooks/><webhook-id> \\\n-H \"Content-Type:application/json\" \\\n-H \"Authorization: Bearer <access_token>\"\n```\n\n----------------------------------------\n\nTITLE: Required Notice Example in Markdown\nDESCRIPTION: Demonstrates the format for including the required copyright notice when distributing copies of the software under this license.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/LICENSE.md#2025-04-23_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n> Required Notice: Copyright 2024-present Gumroad, Inc.\n```\n\n----------------------------------------\n\nTITLE: Setting Up SSL Certificates for Nginx\nDESCRIPTION: Commands to create the SSL certificates directory and symlink the Gumroad development SSL certificate and key. This enables HTTPS for the local development environment.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_10\n\nLANGUAGE: bash\nCODE:\n```\nsudo mkdir -p /etc/ssl/certs\nsudo ln -s ${PWD}/docker/local-nginx/certs/gumroad_dev.crt /etc/ssl/certs/gumroad_dev.crt\nsudo ln -s ${PWD}/docker/local-nginx/certs/gumroad_dev.key /etc/ssl/certs/gumroad_dev.key\n```\n\n----------------------------------------\n\nTITLE: Copying Nginx Configuration for Gumroad Development\nDESCRIPTION: Command to copy the Nginx configuration file for Gumroad development from the repository to the Nginx servers directory. This sets up the web server for the application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\nsudo cp ${PWD}/docs/setup_without_docker/gumroad_dev.conf /usr/local/etc/nginx/servers/\n```\n\n----------------------------------------\n\nTITLE: Installing Elasticsearch for Gumroad Development\nDESCRIPTION: Commands to install Elasticsearch using Homebrew via the elastic tap. This adds search functionality to the Gumroad application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_5\n\nLANGUAGE: sh\nCODE:\n```\nbrew tap elastic/tap\nbrew install elastic/tap/elasticsearch-full\n```\n\n----------------------------------------\n\nTITLE: Installing Nginx for Gumroad Development\nDESCRIPTION: Command to install Nginx using Homebrew for the Gumroad development environment. Nginx serves as the web server for the application.\nSOURCE: https://github.com/antiwork/gumroad/blob/main/docs/setup_without_docker/mac.md#2025-04-23_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\nbrew install nginx\n```"
  }
]