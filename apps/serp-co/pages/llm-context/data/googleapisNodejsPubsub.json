[
  {
    "owner": "googleapis",
    "repo": "nodejs-pubsub",
    "content": "TITLE: Basic Pub/Sub Operations in Node.js\nDESCRIPTION: Demonstrates how to create a client, create a topic, create a subscription, listen for messages, handle errors, and publish a message using the Google Cloud Pub/Sub Node.js client library.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/README.md#2025-04-22_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\n// Imports the Google Cloud client library\nconst {PubSub} = require('@google-cloud/pubsub');\n\nasync function quickstart(\n  projectId = 'your-project-id', // Your Google Cloud Platform project ID\n  topicNameOrId = 'my-topic', // Name for the new topic to create\n  subscriptionName = 'my-sub' // Name for the new subscription to create\n) {\n  // Instantiates a client\n  const pubsub = new PubSub({projectId});\n\n  // Creates a new topic\n  const [topic] = await pubsub.createTopic(topicNameOrId);\n  console.log(`Topic ${topic.name} created.`);\n\n  // Creates a subscription on that new topic\n  const [subscription] = await topic.createSubscription(subscriptionName);\n\n  // Receive callbacks for new messages on the subscription\n  subscription.on('message', message => {\n    console.log('Received message:', message.data.toString());\n    process.exit(0);\n  });\n\n  // Receive callbacks for errors on the subscription\n  subscription.on('error', error => {\n    console.error('Received error:', error);\n    process.exit(1);\n  });\n\n  // Send a message to the topic\n  topic.publishMessage({data: Buffer.from('Test message!')});\n}\n```\n\n----------------------------------------\n\nTITLE: Installing the Google Cloud Pub/Sub Node.js Client Library\nDESCRIPTION: Command to install the Google Cloud Pub/Sub client library for Node.js using npm.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nnpm install @google-cloud/pubsub\n```\n\n----------------------------------------\n\nTITLE: Creating a Push Subscription in Node.js\nDESCRIPTION: Creates a new push subscription. Takes endpoint URL, topic name/ID, and subscription name/ID as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_5\n\nLANGUAGE: Shell\nCODE:\n```\nnode createPushSubscription.js <endpoint-url> <topic-name-or-id> <subscription-name-or-id>\n```\n\n----------------------------------------\n\nTITLE: Creating a BigQuery Subscription in Node.js\nDESCRIPTION: Creates a new BigQuery subscription. Takes topic name/ID, subscription name/ID, and BigQuery table ID as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_3\n\nLANGUAGE: Shell\nCODE:\n```\nnode createBigQuerySubscription.js <topic-name-or-id> <subscription-name-or-id> <bigquery-table-id>\n```\n\n----------------------------------------\n\nTITLE: Creating a Push Subscription Without Wrapper in Node.js\nDESCRIPTION: Creates a new push subscription with payload wrapping disabled. Takes endpoint URL, topic name/ID, and subscription name/ID as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_6\n\nLANGUAGE: Shell\nCODE:\n```\nnode createPushSubscriptionNoWrapper.js <endpoint-url> <topic-name-or-id> <subscription-name-or-id>\n```\n\n----------------------------------------\n\nTITLE: Creating a Proto-Based Schema in Node.js\nDESCRIPTION: Creates a new schema definition on a project using Protocol Buffers. Takes schema name and proto filename as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_4\n\nLANGUAGE: Shell\nCODE:\n```\nnode createProtoSchema.js <schema-name> <proto-filename>\n```\n\n----------------------------------------\n\nTITLE: Committing an Avro-Based Schema in Node.js\nDESCRIPTION: Commits a new schema definition revision on a project using Avro. Takes schema name and AVSC filename as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Shell\nCODE:\n```\nnode commitAvroSchema.js <schema-name> <avsc-filename>\n```\n\n----------------------------------------\n\nTITLE: Committing a Proto-Based Schema in Node.js\nDESCRIPTION: Commits a new schema definition revision on a project using Protocol Buffers. Takes schema name and proto filename as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_1\n\nLANGUAGE: Shell\nCODE:\n```\nnode commitProtoSchema.js <schema-name> <proto-filename>\n```\n\n----------------------------------------\n\nTITLE: Creating an Avro-Based Schema in Node.js\nDESCRIPTION: Creates a new schema definition on a project using Avro. Takes schema name and AVSC filename as arguments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/samples/README.md#2025-04-22_snippet_2\n\nLANGUAGE: Shell\nCODE:\n```\nnode createAvroSchema.js <schema-name> <avsc-filename>\n```\n\n----------------------------------------\n\nTITLE: Configuring Pub/Sub with gRPC C++ Bindings in Node.js\nDESCRIPTION: Example of how to configure the Google Cloud Pub/Sub client to use the C++ gRPC implementation instead of the default one. This approach may be beneficial for certain workflows and environments.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/README.md#2025-04-22_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\nconst {PubSub} = require('@google-cloud/pubsub');\nconst grpc = require('grpc');\nconst pubsub = new PubSub({grpc});\n```\n\n----------------------------------------\n\nTITLE: Importing PubSub in JavaScript (After)\nDESCRIPTION: Example of how to import and instantiate PubSub after the breaking change in v0.21.0 using ES6 import/export syntax.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_14\n\nLANGUAGE: JavaScript\nCODE:\n```\nconst {PubSub} = require('@google-cloud/pubsub');\nconst pubsub = new PubSub();\n```\n\n----------------------------------------\n\nTITLE: Adding Publisher Side Flow Control in JavaScript\nDESCRIPTION: Implements publisher-side flow control functionality.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_3\n\nLANGUAGE: JavaScript\nCODE:\n```\nadd publisher side flow control\n```\n\n----------------------------------------\n\nTITLE: Adding Schema Library Support in JavaScript\nDESCRIPTION: Implements support for the schema library.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_9\n\nLANGUAGE: JavaScript\nCODE:\n```\nschema library support\n```\n\n----------------------------------------\n\nTITLE: Removing data Attribute Requirement for Sending Messages in JavaScript\nDESCRIPTION: Removes the requirement for a 'data' attribute to be passed when sending a message.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_5\n\nLANGUAGE: JavaScript\nCODE:\n```\ndon't require a `data` attribute to be passed when sending a message\n```\n\n----------------------------------------\n\nTITLE: Exporting Publish and Subscribe Options in JavaScript\nDESCRIPTION: Exports publish and subscribe options for external use.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_6\n\nLANGUAGE: JavaScript\nCODE:\n```\nexport publish and subscribe options\n```\n\n----------------------------------------\n\nTITLE: Setting Publish Timeout to 5000ms in JavaScript\nDESCRIPTION: Sets only the Publish timeout to 5000 milliseconds.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_0\n\nLANGUAGE: JavaScript\nCODE:\n```\nset only Publish to 5000ms\n```\n\n----------------------------------------\n\nTITLE: Importing PubSub in JavaScript (Before)\nDESCRIPTION: Example of how to import and instantiate PubSub before the breaking change in v0.21.0.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_13\n\nLANGUAGE: JavaScript\nCODE:\n```\nconst pubsub = require('@google-cloud/pubsub')();\n// OR\nconst PubSub = require('@google-cloud/pubsub');\nconst pubsub = new PubSub();\n```\n\n----------------------------------------\n\nTITLE: Breaking Change - Topic Publisher Usage in JavaScript\nDESCRIPTION: Example showing the breaking change in how to use Topic publisher, moving from publisher() to publish() method.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_10\n\nLANGUAGE: JavaScript\nCODE:\n```\n// Before\nconst publisher = topic.publisher(publishOptions);\nawait publisher.publish(Buffer.from('Hello, world!'));\n\n// After\ntopic.setPublishOptions(publishOptions);\nawait topic.publish(Buffer.from('Hello, world!'));\n```\n\n----------------------------------------\n\nTITLE: Breaking Change - Subscription Options Configuration in JavaScript\nDESCRIPTION: Example demonstrating the breaking change in subscription options configuration with updated parameter structure.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_11\n\nLANGUAGE: JavaScript\nCODE:\n```\n// Before\nconst subscription = topic.subscription('my-sub', {\n  batching: {\n    maxMilliseconds: 100,\n  },\n  flowControl: {\n    maxBytes: os.freem() * 0.2,\n    maxMessages: 100,\n  },\n  maxConnections: 5,\n});\n\n// After\nconst subscription = topic.subscription('my-sub', {\n  ackDeadline: 10,\n  batching: {\n    callOptions: {},\n    maxMessages: 3000,\n    maxMilliseconds: 100,\n  },\n  flowControl: {\n    allowExcessMessages: true,\n    maxBytes: os.freem() * 0.2,\n    maxExtension: Infinity,\n    maxMessages: 100\n  },\n  streamingOptions: {\n    highWaterMark: 0,\n    maxStreams: 5,\n    timeout: 60000 * 5\n  }\n});\n```\n\n----------------------------------------\n\nTITLE: Breaking Change - Message Object Handling in JavaScript\nDESCRIPTION: Example showing how message objects can no longer be treated as plain objects after being refactored into a class.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_12\n\nLANGUAGE: JavaScript\nCODE:\n```\nconst m = Object.assign({}, message, customData);\nm.ack(); // TypeError: m.ack is not a function\n```\n\n----------------------------------------\n\nTITLE: Enabling Self-Signed JWT Feature Flag in JavaScript\nDESCRIPTION: Turns on the self-signed JWT feature flag.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_4\n\nLANGUAGE: JavaScript\nCODE:\n```\nturns on self-signed JWT feature flag\n```\n\n----------------------------------------\n\nTITLE: Adding Method Signature for Subscriber.Pull Without return_immediately in JavaScript\nDESCRIPTION: Adds a method signature for Subscriber.Pull without the deprecated return_immediately field.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_7\n\nLANGUAGE: JavaScript\nCODE:\n```\nAdd method signature for Subscriber.Pull without the deprecated return_immediately field.\n```\n\n----------------------------------------\n\nTITLE: Upgrading OpenTelemetry API to 1.0.0 in JavaScript\nDESCRIPTION: Upgrades the OpenTelemetry API to version 1.0.0.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_8\n\nLANGUAGE: JavaScript\nCODE:\n```\nupgrade the opentelemetry api to 1.0.0\n```\n\n----------------------------------------\n\nTITLE: Deprecating maxExtension in Favor of maxExtensionMinutes in JavaScript\nDESCRIPTION: Deprecates the maxExtension option in favor of maxExtensionMinutes.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_2\n\nLANGUAGE: JavaScript\nCODE:\n```\ndeprecate maxExtension in favour of maxExtensionMinutes\n```\n\n----------------------------------------\n\nTITLE: Holding Back google-gax Version in JavaScript\nDESCRIPTION: Temporarily holds back the google-gax version to avoid timeout issues caused by a specific pull request.\nSOURCE: https://github.com/googleapis/nodejs-pubsub/blob/main/CHANGELOG.md#2025-04-22_snippet_1\n\nLANGUAGE: JavaScript\nCODE:\n```\ntemporary hold-back on google-gax to avoid timeout issues caused by https://github.com/googleapis/gax-nodejs/pull/1100\n```"
  }
]