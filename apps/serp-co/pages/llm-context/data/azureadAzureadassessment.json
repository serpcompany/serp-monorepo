[
  {
    "owner": "azuread",
    "repo": "azureadassessment",
    "content": "TITLE: Installing Azure AD Assessment Module\nDESCRIPTION: Commands to install or update the Azure AD Assessment PowerShell module from the PowerShell Gallery.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_0\n\nLANGUAGE: powershell\nCODE:\n```\nInstall-Module AzureADAssessment -Force -Scope CurrentUser\n\n## If you have already installed the module, run the following instead to ensure you have the latest version.\nUpdate-Module AzureADAssessment -Force -Scope CurrentUser\n```\n\n----------------------------------------\n\nTITLE: Running Azure AD Data Collection\nDESCRIPTION: Commands to authenticate and collect Azure AD configuration data using the assessment module.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_1\n\nLANGUAGE: powershell\nCODE:\n```\n## Authenticate using a Global Admin or Global Reader account.\nConnect-AADAssessment -ClientId \"AppId of app created in the previous step\"\n\n## Export data to \"C:\\AzureADAssessment\" into a single output package.\nInvoke-AADAssessmentDataCollection\n```\n\n----------------------------------------\n\nTITLE: Using Service Principal Authentication\nDESCRIPTION: Command to connect using a service principal with certificate authentication instead of user credentials.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_6\n\nLANGUAGE: powershell\nCODE:\n```\n## Connect using Service Principal identity with app permissions.\nConnect-AADAssessment -ClientId <ClientId> -ClientCertificate (Get-Item 'Cert:\\CurrentUser\\My\\<Thumbprint>') -TenantId <TenantId>\n```\n\n----------------------------------------\n\nTITLE: Collecting Hybrid Component Data\nDESCRIPTION: Command to collect data from hybrid components like AD FS and AAD Connect servers.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_3\n\nLANGUAGE: powershell\nCODE:\n```\n## Export Data to \"C:\\AzureADAssessment\" into a single output package.\nInvoke-AADAssessmentHybridDataCollection\n```\n\n----------------------------------------\n\nTITLE: Setting PowerShell Execution Policy\nDESCRIPTION: Commands to enable script execution by setting the appropriate execution policy.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_9\n\nLANGUAGE: powershell\nCODE:\n```\n## Set globally on device\nSet-ExecutionPolicy RemoteSigned\n## Or set for just for current PowerShell session.\nSet-ExecutionPolicy RemoteSigned -Scope Process\n```\n\n----------------------------------------\n\nTITLE: Connecting to Sovereign Clouds\nDESCRIPTION: Commands to connect to sovereign cloud environments like US Government.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_7\n\nLANGUAGE: powershell\nCODE:\n```\n## Example connecting to USGov cloud environment using user delegated permissions.\nConnect-AADAssessment -ClientId <ClientId> -CloudEnvironment USGov -TenantId <TenantId>\n\n## Example connecting to USGov cloud environment using app permissions.\nConnect-AADAssessment -ClientId <ClientId> -ClientCertificate (Get-Item 'Cert:\\CurrentUser\\My\\<Thumbprint>') -CloudEnvironment USGov -TenantId <TenantId>\n```\n\n----------------------------------------\n\nTITLE: Specifying Custom Output Directory\nDESCRIPTION: Commands to specify a custom output directory for assessment data collection.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_5\n\nLANGUAGE: powershell\nCODE:\n```\n## If you would like to specify a different directory, use the OutputDirectory parameter.\nInvoke-AADAssessmentDataCollection \"C:\\Temp\"\nInvoke-AADAssessmentHybridDataCollection \"C:\\Temp\"\n```\n\n----------------------------------------\n\nTITLE: Exporting Portable Module\nDESCRIPTION: Commands to export and import a portable version of the module for servers without internet access.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_4\n\nLANGUAGE: powershell\nCODE:\n```\n## Export Portable Module to \"C:\\AzureADAssessment\".\nExport-AADAssessmentPortableModule \"C:\\AzureADAssessment\"\n\n## Import the module on each server running hybrid components.\nImport-Module \"C:\\AzureADAssessment\\AzureADAssessmentPortable.psm1\"\n\n## Export Data to \"C:\\AzureADAssessment\" into a single output package.\nInvoke-AADAssessmentHybridDataCollection\n```\n\n----------------------------------------\n\nTITLE: Skipping Report Output in Data Collection\nDESCRIPTION: Command to run data collection while skipping report output generation if the initial collection fails.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_2\n\nLANGUAGE: powershell\nCODE:\n```\nInvoke-AADAssessmentDataCollection -SkipReportOutput\n```\n\n----------------------------------------\n\nTITLE: Updating PowerShellGet Module\nDESCRIPTION: Commands to update PowerShellGet to resolve installation issues.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_8\n\nLANGUAGE: powershell\nCODE:\n```\n### Option 1: Run the following command to download and execute a script to update PowerShellGet. Note: Navigate to this URL in a web browser to see the contents of the script in GitHub.\niex $(irm 'https://aka.ms/Update-PowerShellGet')\n\n### Option 2: Run the following commands individually.\n## Update Nuget Package and PowerShellGet Module\nInstall-PackageProvider NuGet -Scope CurrentUser -Force\nInstall-Module PowerShellGet -Scope CurrentUser -Force -AllowClobber\n## Remove old modules from existing session\nRemove-Module PowerShellGet,PackageManagement -Force -ErrorAction Ignore\n## Import updated module\nImport-Module PowerShellGet -MinimumVersion 2.0 -Force\nImport-PackageProvider PowerShellGet -MinimumVersion 2.0 -Force\n```\n\n----------------------------------------\n\nTITLE: Installing MSAL.PS Module with Certificate Check Skip\nDESCRIPTION: Command to install MSAL.PS module while skipping publisher certificate verification.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_10\n\nLANGUAGE: powershell\nCODE:\n```\nInstall-Module MSAL.PS -SkipPublisherCheck -Force\n```\n\n----------------------------------------\n\nTITLE: PowerBI Query Error Message\nDESCRIPTION: Example error message that appears when PowerBI has issues with cross-referencing data sources during template loading. This occurs when trying to load extracted data (CSV and JSON) into PowerBI templates.\nSOURCE: https://github.com/azuread/azureadassessment/blob/master/README.md#2025-04-23_snippet_11\n\nLANGUAGE: text\nCODE:\n```\nQuery '*' (step '*') references other queries or steps, so it may not directly access a datasource. Please rebuild this data combination.\n```"
  }
]