[
  {
    "owner": "wazuh",
    "repo": "wazuh",
    "content": "TITLE: Checking for Non-root UID 0 Accounts\nDESCRIPTION: Verifies that no accounts other than root have UID 0. Checks /etc/passwd file for any non-root entries with UID 0, which would have superuser privileges.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer Elevated Privileges Configuration\nDESCRIPTION: Ensures that 'Always install with elevated privileges' is disabled by verifying the AlwaysInstallElevated registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_85\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> AlwaysInstallElevated -> !0;\n```\n\n----------------------------------------\n\nTITLE: Kernel Network Parameter Check\nDESCRIPTION: Validates kernel network security parameters including source routing, ICMP broadcasts and IP forwarding settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Wazuh Unit Tests\nDESCRIPTION: Sets up the CMake project for Wazuh unit tests by defining minimum CMake version, project name, include directories for test dependencies, and adding test subdirectories. Includes paths for GoogleTest framework and vulnerability scanner module components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/tests/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(unit_tests)\n\ninclude_directories(${CMAKE_SOURCE_DIR})\ninclude_directories(${CMAKE_SOURCE_DIR}/include/)\ninclude_directories(mocks/)\ninclude_directories(${SRC_FOLDER}/external/googletest/googletest/include/)\ninclude_directories(${SRC_FOLDER}/external/googletest/googlemock/include/)\ninclude_directories(${SRC_FOLDER}/wazuh_modules/vulnerability_scanner/src/)\ninclude_directories(${SRC_FOLDER}/wazuh_modules/vulnerability_scanner/include/)\ninclude_directories(${SRC_FOLDER}/wazuh_modules/vulnerability_scanner/src/databaseFeedManager/)\n\nlink_directories(${SRC_FOLDER}/external/googletest/lib/)\n\nadd_subdirectory(unit)\nadd_subdirectory(component)\nadd_subdirectory(benchmark)\n```\n\n----------------------------------------\n\nTITLE: YAML Definitions Example\nDESCRIPTION: Shows how to define reusable components like headers and network endpoints using YAML definitions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_19\n\nLANGUAGE: yaml\nCODE:\n```\ndefinitions:\n  header: <timestamp> <host.hostname> <daemon>:\n  source: <source.ip>:<source.port>\n  destination: <destination.ip>:<destination.port>\n  a-list:\n    - item1: value1\n    - item2: value2\n```\n\n----------------------------------------\n\nTITLE: IP CIDR Match Check\nDESCRIPTION: Validates if an IP address belongs to a specified CIDR range. Shows both matching and non-matching examples.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_18\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: ip_cidr_match('192.168.0.0', '192.168.0.11')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"192.168.1.5\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: ip_cidr_match('192.168.0.0', '192.168.0.11')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"111.111.1.11\"\n}\n```\n\n----------------------------------------\n\nTITLE: Wazuh Architecture Overview\nDESCRIPTION: Mermaid diagram showing the high-level architecture of Wazuh, from endpoint services through the server components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_4\n\nLANGUAGE: mermaid\nCODE:\n```\ngraph LR;\n    subgraph Endpoint\n        Service[\"Service\"]\n        WazuhAgent[\"Wazuh agent\"]\n        Service --- WazuhAgent\n    end\n\n    WazuhAgent -.-> Orchestrator[\"Orchestrator: Router\"]\n\n    subgraph WazuhServer[\"Wazuh server\"]\n\n        subgraph Engine\n            Orchestrator --> Route[\"Route\"]\n            Route --> Decoding[\"Decoding Stage\"]\n            subgraph SecurityPolicy[\"Security Policy\"]\n                Decoding --> Rule[\"Rule Stage\"]\n                Rule --> OutputStage[\"Output Stage\"]\n            end\n        end\n    end\n```\n\n----------------------------------------\n\nTITLE: Parsing JSON in Wazuh Normalization (YAML/JSON)\nDESCRIPTION: The parse_json function interprets and converts strings formatted in JSON notation into a JSON object. It validates the input as proper JSON format and assigns the resulting JSON object to the specified field if successful.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_114\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_json($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"{\\\"key\\\": {\\\"innerKey\\\": \\\"value\\\"}}\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"{\\\"key\\\": {\\\"innerKey\\\": \\\"value\\\"}}\",\n  \"target_field\": {\n    \"key\": {\n      \"innerKey\": \"value\"\n    }\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Normalizing Event IDs with Key-Value Database in YAML\nDESCRIPTION: Example of using a key-value database to map event IDs to predefined categorization fields. This simplifies event classification by retrieving categories, types, and actions based on the event ID.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_24\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - event: kvdb_get_merge(windows_security_eventid_to_category_type_action, $event.code)\n```\n\n----------------------------------------\n\nTITLE: Decoder Schema Visualization with Mermaid\nDESCRIPTION: A Mermaid diagram showing the structure of a decoder in the Wazuh security engine. It illustrates the components of a decoder including name, metadata, parents, checks, parser, and normalize stages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_26\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Decoder schema\n---\nkanban\n  Decoder[Decoder schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    assetParents[\"parents\"]\n    assetChecks[\"checks\"]\n    decoParsers[\"parser\"]\n    decoNormalize[\"normalize\"]\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode for Built-in Administrator in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is enabled. Checks if FilterAdministratorToken registry value is set to 1 to enforce UAC prompts for the Administrator account.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_27\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> FilterAdministratorToken -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !FilterAdministratorToken;\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Test Utils in Python\nDESCRIPTION: Installs the required engine-test-utils package using pip3 for integration testing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip3 install test/engine-test-utils\n```\n\n----------------------------------------\n\nTITLE: Setting Up CMake Test Environment for Wazuh\nDESCRIPTION: Configures CMake build settings for testing, including debug flags and dependency paths. Sets compiler flags for debugging with coverage and sanitizer options, includes necessary header directories for GoogleTest, RocksDB, and other modules, and adds test subdirectories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/tests/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nset(CMAKE_CXX_FLAGS_DEBUG \"-g --coverage -fsanitize=address,leak,undefined\")\n\ninclude_directories(${SRC_FOLDER}/external/googletest/googletest/include/)\ninclude_directories(${SRC_FOLDER}/external/googletest/googlemock/include/)\ninclude_directories(${SRC_FOLDER}/external/rocksdb/include)\ninclude_directories(${SRC_FOLDER}/shared_modules/content_manager/src/)\ninclude_directories(${SRC_FOLDER}/shared_modules/content_manager/include/)\ninclude_directories(${SRC_FOLDER}/shared_modules/utils)\n\nlink_directories(${SRC_FOLDER}/external/googletest/lib/)\n\nadd_subdirectory(component)\nadd_subdirectory(unit)\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Configuration for Security Issues\nDESCRIPTION: Examines the SSH configuration file for various security settings including protocol version, IgnoreRHosts, empty passwords, host-based authentication, and root login permissions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\n[CIS - Red Hat Linux - 1.3 - SSH Configuration - Protocol version 1 enabled {CIS: 1.3 Red Hat Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n\n[CIS - Red Hat Linux - 1.3 - SSH Configuration - IgnoreRHosts disabled {CIS: 1.3 Red Hat Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n\n[CIS - Red Hat Linux - 1.3 - SSH Configuration - Empty passwords permitted {CIS: 1.3 Red Hat Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\n\n[CIS - Red Hat Linux - 1.3 - SSH Configuration - Host based authentication enabled {CIS: 1.3 Red Hat Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n\n[CIS - Red Hat Linux - 1.3 - SSH Configuration - Root login allowed {CIS: 1.3 Red Hat Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Using array_contains_any Function in Wazuh Rules\nDESCRIPTION: The array_contains_any function checks if at least one of the provided elements exists in a target array. It supports various data types and is useful for filtering lists based on partial matches. The function returns true if any specified element is found.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\nfield: array_contains_any(element, [...])\n```\n\n----------------------------------------\n\nTITLE: Input Event JSON Structure Example\nDESCRIPTION: Example of an input event JSON structure showing the raw event data before processing by the Wazuh engine.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"@timestamp\": \"2025-01-23T17:40:37Z\",\n  \"agent\": {\n    \"groups\": [\n      \"group1\",\n      \"group2\"\n    ],\n    \"host\": {\n      \"architecture\": \"x86_64\",\n      \"hostname\": \"wazuh-endpoint-linux\",\n      \"ip\": [\n        \"192.168.1.2\"\n      ],\n      \"os\": {\n        \"name\": \"Amazon Linux 2\",\n        \"platform\": \"Linux\"\n      }\n    },\n    \"id\": \"2887e1cf-9bf2-431a-b066-a46860080f56\",\n    \"name\": \"wazuh-agent-name\",\n    \"type\": \"endpoint\",\n    \"version\": \"5.0.0\"\n  },\n  \"event\": {\n    \"collector\": \"file\",\n    \"module\": \"logcollector\",\n    \"original\": \"Dec 13 11:35:28 a-mac-with-esc-key GoogleSoftwareUpdateAgent[21412]: 2016-12-13 11:35:28.421 GoogleSoftwareUpdateAgent[21412/0x700007399000] [lvl=2] -[KSUpdateEngine updateAllExceptProduct:] KSUpdateEngine updating all installed products, except:'com.google.Keystone'.\"\n  },\n  \"log\": {\n    \"file\": {\n      \"path\": \"/var/log/syslog.log\"\n    }\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Registry and File System Security Audit Rules - Windows\nDESCRIPTION: Set of security audit rules checking various Windows security settings through registry keys and file system checks. Includes checks for disabled registry tools, DCOM settings, LM authentication, firewall configuration, error reporting, and automatic logon settings. Each rule is mapped to PCI DSS compliance requirements.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_audit_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n[Disabled Registry tools set {PCI_DSS: 10.6.1}] [any] []\nr:HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableRegistryTools -> 1;\nr:HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableRegistryTools -> 1;\n\n[DCOM disabled {PCI_DSS: 10.6.1}] [any] []\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\OLE -> EnableDCOM -> N;\n\n[LM authentication allowed (weak passwords) {PCI_DSS: 10.6.1, 11.4}] [any] []\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\LSA -> LMCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\LSA -> LMCompatibilityLevel -> 1;\n\n[Firewall/Anti Virus notification disabled {PCI_DSS: 10.6.1}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> FirewallDisableNotify -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> antivirusoverride -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> firewalldisablenotify -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> firewalldisableoverride -> !0;\n\n[Microsoft Firewall disabled {PCI_DSS: 10.6.1, 1.4}] [all] []\nr:HKEY_LOCAL_MACHINE\\software\\policies\\microsoft\\windowsfirewall\\domainprofile -> enablefirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\software\\policies\\microsoft\\windowsfirewall\\standardprofile -> enablefirewall -> 0;\n\n[Null sessions allowed {PCI_DSS: 11.4}] [any] []\nr:HKLM\\System\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymous -> 0;\n\n[Error reporting disabled {PCI_DSS: 10.6.1}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> DoReport -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeKernelFaults -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeMicrosoftApps -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeWindowsApps -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeShutdownErrs -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> ShowUI -> 0;\n\n[Automatic Logon enabled {PCI_DSS: 10.6.1}] [any] []\nr:HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> DefaultPassword;\nr:HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> 1;\n\n[Winpcap packet filter driver found {PCI_DSS: 10.6.1}] [any] []\nf:%WINDIR%\\System32\\drivers\\npf.sys;\nf:%WINDIR%\\Sysnative\\drivers\\npf.sys;\n```\n\n----------------------------------------\n\nTITLE: Partition Mount Options Security Checks\nDESCRIPTION: Verifies secure mount options for various partitions including /tmp, /var, /home, and /dev/shm with nodev, nosuid, and noexec flags.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:/tmp && !r:nodev;\nf:/etc/fstab -> !r:^# && r:/tmp && !r:nosuid;\nf:/etc/fstab -> !r:^# && r:/tmp && !r:noexec;\n```\n\n----------------------------------------\n\nTITLE: Configuring Field Mapping in Wazuh Engine (YAML)\nDESCRIPTION: Example of mapping configuration that sets various event-related fields using fixed values and array operations. Used to define how input data should be mapped to standardized event fields.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_34\n\nLANGUAGE: yaml\nCODE:\n```\n- map:\n    - event.kind: event\n    - event.dataset: apache.access\n    - event.category: +array_append/web\n    - event.module: apache\n    - service.type: apache\n    - event.outcome: success\n```\n\n----------------------------------------\n\nTITLE: Checking IoCs Against Known Malicious IPs in YAML\nDESCRIPTION: Example of using a key-value database to check IP addresses against known malicious IPs for threat detection. This allows for efficient matching of potential threats using predefined indicators of compromise.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_25\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - check:\n      - source.ip: kvdb_match(known_malicious_ips)\n```\n\n----------------------------------------\n\nTITLE: Visualizing Wazuh Engine Pipeline Flow with Mermaid\nDESCRIPTION: A comprehensive flowchart diagram illustrating the complete processing pipeline of the Wazuh Engine's default policy, including decoding, rule application, and output stages. The diagram shows how events flow through internal decoders, user decoders, Wazuh rules, user rules, and finally to outputs.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_10\n\nLANGUAGE: mermaid\nCODE:\n```\nflowchart TD\n\n classDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\n classDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n classDef ModuleArchClass fill:#673ab7,stroke-width:2px,fill-opacity:0.5, font-size: 20px\n classDef SubModuleArchClass fill:#673ab7,stroke-width:2px,fill-opacity:0.5, font-size: 15px\n\n%% --------------------------------------\n%%           Decoding Stage\n%% --------------------------------------\n\n subgraph decoTree[\"First layer - Internal decoders\"]\n    direction TB\n    decoInputRoot(\" \")\n    deco02(\" \")\n    deco03(\" \")\n    integrationDecoder(\"Integration Decoder\")\n    deco05(\" \")\n    deco06(\" \")\n    deco07(\" \")\n\n    decoInputRoot --> deco02 & deco03 & integrationDecoder\n    deco02 --> deco05\n    deco03 --> deco06 & deco07\n  end\n\n  integrationDecoder -..-> userDecoRoot:::TreeBoxClass\n\n\n subgraph userDecoTree[\"Integrations & User decoders\"]\n    direction TB\n    userDecoRoot(\" \")\n    userDeco02(\" \")\n    userDeco03(\" \")\n    userDeco04(\" \")\n    userDeco05(\" \")\n    userDeco06(\" \")\n    userDeco07(\" \")\n    userDeco08(\" \")\n\n    userDecoRoot --> userDeco02 & userDeco03 & userDeco04\n    userDeco02 --> userDeco05\n    userDeco03 --> userDeco06 & userDeco07\n    userDeco04 --> userDeco08\n  end\n\n%% Stage block\nsubgraph decoderStage[\"Decoding Stage\"]\n    decoTree:::TreeBoxClass\n    userDecoTree:::TreeBoxClass\nend\n\n\n\n%% Output decoder stage\neventNormalized@{shape: doc, label: \"Normalized</br>event\"}\neventNormalized:::EventBoxClass\n\n%% Pipieline\nrouteSelector ==> decoInputRoot\nuserDecoTree ====> eventNormalized\n\n%% --------------------------------------\n%%           Rules Stage\n%% --------------------------------------\n\n subgraph wazuhRulesTree[\"Wazuh Rules\"]\n  direction TB\n\n  wazuhRules01(\" \")\n  wazuhRules02(\" \")\n  wazuhRules03(\" \")\n  wazuhRules04(\" \")\n  wazuhRules05(\" \")\n  wazuhRules06(\" \")\n  wazuhRules07(\" \")\n  wazuhRules08(\" \")\n\n  wazuhRules01 --> wazuhRules02 & wazuhRules03 & wazuhRules04\n  wazuhRules02 --> wazuhRules05\n  wazuhRules03 --> wazuhRules06 & wazuhRules07\n  wazuhRules04 --> wazuhRules08\n end\n\n subgraph userRulesTree[\"User rules\"]\n  direction TB\n\n  userRules01(\" \")\n  userRules02(\" \")\n  userRules03(\" \")\n  userRules04(\" \")\n  userRules05(\" \")\n  userRules06(\" \")\n  userRules07(\" \")\n  userRules08(\" \")\n\n  userRules01 --> userRules02 & userRules03 & userRules04\n  userRules02 --> userRules05\n  userRules03 --> userRules06 & userRules07\n  userRules04 --> userRules08\n\n end\n\n\n\nsubgraph ruleStage[\"Rules Stage\"]\n wazuhRulesTree:::TreeBoxClass\n userRulesTree:::TreeBoxClass\nend\n\n%% Output stage rules\nsecurityEvent@{shape: doc, label: \"Security</br>event\"}\nsecurityEvent:::EventBoxClass\n\n%% Pipieline\neventNormalized==>wazuhRulesTree & userRulesTree-.->securityEvent\n\n%% --------------------------------------\n%%           Output Stage\n%% --------------------------------------\n subgraph outputTree[\"Outputs\"]\n  direction TB\n\n  output01(\" \")\n  output02(\" \")\n  output03(\" \")\n  output04(\" \")\n  output05(\" \")\n  output06(\" \")\n  output07(\" \")\n  output08(\" \")\n\n  output01 --> output02 & output03 & output04\n  output02 --> output05\n  output03 --> output06 & output07\n  output04 --> output08\n\n end\n outputTree:::TreeBoxClass\n\n%% Pipieline output\n securityEvent ==> outputTree\n\n\n%% --------------------------------------\n%%           Default Policy\n%% --------------------------------------\nsubgraph defaultPolicy[\"Default policy\"]\n  decoderStage\n  eventNormalized\n  ruleStage\n  securityEvent\n  outputTree\nend\ndefaultPolicy:::SubModuleArchClass\n\n\n%% --------------------------------------\n%%           Engine\n%% --------------------------------------\n%% Input Decodeing Stage\neventInput@{shape: doc, label: \"Incoming event</br>from endpoint\"}\neventInput:::EventBoxClass\n\nsubgraph engine[\"engine\"]\n  defaultPolicy\n  routeSelector([\"Orchestrator: Router (Route selector)\"])\nend\nengine:::ModuleArchClass\n\neventInput ===> routeSelector\n```\n\n----------------------------------------\n\nTITLE: Visualizing Event Flow in Wazuh Decoder Tree\nDESCRIPTION: This diagram shows the flow of events through the decoder tree in Wazuh's default policy. It illustrates the two main layers: internal decoders for normalization and integration/user decoders for specific source processing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_6\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Event flow on decoder tree\n---\nflowchart LR\n\n classDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\n classDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n\n subgraph decoTree[\"First layer - Internal decoders\"]\n    direction TB\n    deco01(\" \")\n    deco02(\" \")\n    deco03(\" \")\n    deco04(\"Integration Decoder\")\n    deco05(\" \")\n    deco06(\" \")\n    deco07(\" \")\n\n    deco01 --> deco02 & deco03 & deco04\n    deco02 --> deco05\n    deco03 --> deco06 & deco07\n  end\n\n  deco04 -..-> decoIntegration[\"Integration Decoder\"]:::TreeBoxClass\n  eventInput@{shape: doc, label: \"Event</br>Input\"} ==> decoTree\n  decoTree:::TreeBoxClass\n\n subgraph userDecoTree[\"Integrations & User decoders\"]\n    direction TB\n    userDeco01(\" \")\n    userDeco02(\" \")\n    userDeco03(\" \")\n    userDeco04(\" \")\n    userDeco05(\" \")\n    userDeco06(\" \")\n    userDeco07(\" \")\n    userDeco08(\" \")\n\n    userDeco01 --> userDeco02 & userDeco03 & userDeco04\n    userDeco02 --> userDeco05\n    userDeco03 --> userDeco06 & userDeco07\n    userDeco04 --> userDeco08\n  end\n\n\n\n%% decoIntegration --> userDecoTree\ndecoIntegration --> userDeco01\nuserDecoTree ----> eventOutput@{shape: doc, label: \"Normalized</br>event\"}\n\nuserDecoTree:::TreeBoxClass\neventInput:::EventBoxClass\neventOutput:::EventBoxClass\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Security Settings\nDESCRIPTION: Registry checks for Terminal Services security configurations including password policies, drive redirection, and encryption settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_79\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCdm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MinEncryptionLevel -> !3;\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Suite Package with pip\nDESCRIPTION: Command to install the engine-suite package, which includes the engine-router tool, using pip.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_router/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Configuring eMessages Library in CMake\nDESCRIPTION: This section configures the eMessages library by setting up its sources, include directories, and dependencies. It creates a static library and links it with Protobuf and a base library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/proto/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nfile(GLOB EMESSAGE_AUTO_SOURCES \"${ENGINE_EMESSAGES_INCLUDE_DIR}/eMessages/*.cc\")\n\nadd_library(eMessages STATIC)\n\ntarget_sources(eMessages\n    PRIVATE\n    ${EMESSAGE_AUTO_SOURCES}\n)\n\ntarget_include_directories(eMessages\n    PUBLIC\n    ${ENGINE_EMESSAGES_INCLUDE_DIR}\n)\n\ntarget_link_libraries(eMessages PUBLIC protobuf::libprotobuf base)\n```\n\n----------------------------------------\n\nTITLE: Configuring Normalization Rules in Wazuh Engine (YAML)\nDESCRIPTION: Example of normalization configuration showing different sub-stages including mapping, conditional checks, and parsing operations. Demonstrates how to transform and enrich event data based on conditions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_35\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - wazuh.decoders: array_append(windows-sysmon)\n      - event.dataset: sysmon\n      - event.kind: event\n\n  # Only maps network.protocol if event.code is 22\n  - check: $event.code == '22'\n    map:\n      - network.protocol: dns\n\n  # Only maps resources if the check and parse stages succeeded\n  - check: $event.outcome == failure\n    parse|message:\n      - \"[<error.code/int>]<details>\"\n    map:\n      - resources: split($details, \",\")\n```\n\n----------------------------------------\n\nTITLE: Example of Network Event Structured According to Schema\nDESCRIPTION: A JSON example demonstrating how a network event log is structured according to the Wazuh schema. This example shows categorization of event type and includes source, destination, and user information.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_11\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"event\": {\n    \"category\": \"network\",\n    \"type\": \"connection\",\n    \"action\": \"network_connection\"\n  },\n  \"source\": {\n    \"ip\": \"192.168.1.10\",\n    \"port\": 443\n  },\n  \"destination\": {\n    \"ip\": \"10.0.0.5\",\n    \"port\": 8080\n  },\n  \"user\": {\n    \"name\": \"admin\"\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Systemd Service Configurations in SLES12\nDESCRIPTION: These rules check for various systemd services that should be disabled or properly configured according to CIS benchmarks. It examines service files for specific configurations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nf:/usr/lib/systemd/system/rexec@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/rlogin@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/rsh@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/ntalk.service -> r:Exec;\nf:/usr/lib/systemd/system/telnet@.service -> r:ExecStart=-/usr/sbin/in.telnetd;\nf:/usr/lib/systemd/system/tftp.service -> r:Exec;\nf:/usr/lib/systemd/system/xinetd.service -> r:Exec;\nf:/usr/lib/systemd/system/dhcpd.service -> r:Exec;\nf:/usr/lib/systemd/system/default.target -> r:Graphical;\n```\n\n----------------------------------------\n\nTITLE: Configuring RocksDB Query Test Tool Build with CMake\nDESCRIPTION: Sets up a CMake build configuration for a RocksDB query testing tool. Includes sanitizer flags for debug builds, configures source files, and links required external libraries. The build process collects all CPP files in the directory and creates an executable with necessary dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/rocksDBQuery/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\nproject(rocks_db_query_testtool)\n\nif(FSANITIZE)\nset(CMAKE_CXX_FLAGS_DEBUG \"-g -fsanitize=address,leak,undefined\")\nendif()\n\nfile(GLOB ROCKS_DB_QUERY_TESTTOOL_SRC\n    \"*.cpp\"\n    )\n\nadd_executable(${PROJECT_NAME}\n    ${ROCKS_DB_QUERY_TESTTOOL_SRC}\n    )\n\ntarget_link_libraries(${PROJECT_NAME} pthread rocksdb flatbuffers rt)\n```\n\n----------------------------------------\n\nTITLE: Visualizing Event Flow in Wazuh Output Process\nDESCRIPTION: This diagram illustrates the output process in Wazuh, showing how events are distributed to multiple outputs through broadcasting. Each output can filter alerts to support customized distribution policies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_9\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Event flow on outputs\n---\nflowchart TD\n\n    outputR --> output1(\"Indexer alert output\") & output2(\"File alerts output\")\n    outputR(\"Broadcaster output\") --x output3(\"File archive output\")\n    outputR(\"Broadcaster output\") --x output4(\"Other output\")\n\n     outputR:::AssetSuccessClass\n     output1:::AssetSuccessClass\n     output2:::AssetSuccessClass\n     output3:::AssetFailClass\n     output4:::AssetSuccessClass\n    classDef AssetSuccessClass fill:#3f51b5,stroke-width:2px,fill-opacity:0.5\n    classDef AssetFailClass fill:#f44336,stroke-width:2px,fill-opacity:0.5\n    classDef AssetNotExecutedClass fill:#9e9e9e,stroke-width:2px,fill-opacity:0.5\n    linkStyle 2 stroke:#D50000,fill:none\n```\n\n----------------------------------------\n\nTITLE: Markdown Documentation Structure\nDESCRIPTION: Hierarchical documentation structure using markdown links to organize Wazuh's documentation into logical sections covering development, reference material, and diagnostics.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/SUMMARY.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Summary\n\n- [Introduction](README.md)\n\n# Development Guide\n\n- [Introduction](dev/README.md)\n- [Setup Environment](dev/setup.md)\n- [Build Packages](dev/build-packages.md)\n- [Build Image](dev/build-image.md)\n- [Build from Sources](dev/build-sources.md)\n- [Run from Sources](dev/run-server.md)\n- [Run Tests](dev/run-tests.md)\n\n# Reference Manual\n\n- [Introduction](ref/README.md)\n- [Getting Started](ref/getting-started/README.md)\n  - [Requirements](ref/getting-started/requirements.md)\n  - [Packages](ref/getting-started/packages.md)\n  - [Installation](ref/getting-started/installation.md)\n- [Configuration](ref/configuration/README.md)\n  - [Command Line Options](ref/configuration/cli-options.md)\n  - [Configuration files](ref/configuration/configuration-files.md)\n- [Modules](ref/modules/README.md)\n  - [Engine](ref/modules/engine/README.md)\n    - [Architecture](ref/modules/engine/architecture.md)\n    - [API Reference](ref/modules/engine/api-reference.md)\n    - [Outputs Reference](ref/modules/engine/ref-output.md)\n    - [Parsers Reference](ref/modules/engine/ref-parser.md)\n    - [Helper Functions Reference](ref/modules/engine/ref-helper-functions.md)\n    - [Dev internal tools](ref/modules/engine/internal-tools.md)\n  - [Management API](ref/modules/management/README.md)\n    - [Architecture](ref/modules/management/architecture.md)\n    - [API Reference](ref/modules/management/api-reference.html)\n  - [Communications API](ref/modules/communications/README.md)\n    - [Architecture](ref/modules/communications/architecture.md)\n    - [API Reference](ref/modules/communications/api-reference.html)\n- [Upgrade](ref/upgrade.md)\n- [Uninstall](ref/uninstall.md)\n- [Back Up and Restore](ref/backup-restore.md)\n- [Security](ref/security.md)\n- [Performance](ref/performance.md)\n- [Glossary](ref/glossary.md)\n\n# Diagnostic Guide\n\n- [Diagnostic Guide](diag/diagnostic.md)\n```\n\n----------------------------------------\n\nTITLE: Installing Dependencies on RPM-based Systems\nDESCRIPTION: Commands to install the required dependencies for building the Wazuh engine on RPM-based systems.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/build-sources.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n# Install dependencies\nsudo yum install curl zip unzip tar -y\nsudo yum groupinstall \"Development Tools\" -y\n```\n\n----------------------------------------\n\nTITLE: Checking Array Elements with array_not_contains_any in YAML\nDESCRIPTION: Checks if none of the provided elements are present in a given array. Supports multiple data types and accepts multiple search arguments. The test passes if none of the provided elements exist in the target array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_4\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: array_not_contains_any('dracut', 'vz-start', 'thin-provisioning-tools')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    \"mkinitramfs\",\n    \"cryptroot\",\n    \"framebuffer\",\n    \"dracut\",\n    \"thin-provisioning-tools\",\n    \"lvm2\",\n    \"vz-start\"\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Asset Naming Convention in Wazuh Engine\nDESCRIPTION: A simple code example showing the naming convention used for assets in the Wazuh Engine. Each asset is uniquely identified by its type, name, and version, organized in a hierarchical structure.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_13\n\nLANGUAGE: text\nCODE:\n```\n<type>/<name>/<version>\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Inbound Connections Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Inbound connections' is set to 'Block' by checking registry keys. This check ensures the Windows Firewall blocks inbound connections by default in the private profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_47\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring Environment Variables for Engine in .env File\nDESCRIPTION: Example of the format used in the .env configuration file for setting environment variables. These variables are used to configure the engine's behavior.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/engine-test-utils/README.md#2025-04-17_snippet_2\n\nLANGUAGE: env\nCODE:\n```\nENVIROMENT_VARIABLE=value\n```\n\n----------------------------------------\n\nTITLE: Installing Behave BDD Framework\nDESCRIPTION: Installs the Behave behavior-driven development framework using pip3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip3 install behave\n```\n\n----------------------------------------\n\nTITLE: Successful Text Extraction with parse_between Using Word Delimiters\nDESCRIPTION: Demonstrates parse_between using words as delimiters instead of symbols. The function extracts the text between the 'Start' and 'End' words, including spaces.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_100\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_between($input_field, 'Start', 'End')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"Start and End\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"Start and End\",\n  \"target_field\": \" and \"\n}\n```\n\n----------------------------------------\n\nTITLE: Implementing Condition Lists in Check Stage\nDESCRIPTION: Example YAML configuration showing how to define a condition list in the check stage of an asset. This demonstrates various condition types including exact match, field reference comparison, and helper function usage.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_30\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - event.format: text\n  - user.name: $root_user\n  - event.original: exists()\n  - event.id: 1234\n```\n\n----------------------------------------\n\nTITLE: Wazuh Module Router Documentation\nDESCRIPTION: Markdown documentation detailing the Publish-Subscribe architecture including key concepts like Publishers, Subscribers, Channels/Topics, Message Broker, Messages, and Filtering mechanisms. The document also references sequence diagrams for initialization, publisher, and subscriber flows.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/architecture/router-pubsub/Readme.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n<!---\nCopyright (C) 2015, Wazuh Inc.\nCreated by Wazuh, Inc. <info@wazuh.com>.\nThis program is free software; you can redistribute it and/or modify it under the terms of GPLv2\n-->\n\n# Wazuh module: Router PubSub architecture\n## Index\n- [Wazuh module: Router PubSub architecture](#wazuh-module-router-pubsub-architecture)\n  - [Index](#index)\n  - [Purpose](#purpose)\n    - [Definition](#definition)\n    - [Key Concepts](#key-concepts)\n      - [Publisher](#publisher)\n      - [Subscriber](#subscriber)\n      - [Channel/Topic](#channeltopic)\n      - [Message Broker/Event Bus](#message-brokerevent-bus)\n      - [Message](#message)\n      - [Filtering](#filtering)\n  - [Sequence diagrams](#sequence-diagrams)\n```\n\n----------------------------------------\n\nTITLE: Validating SSH Protocol Version Setting\nDESCRIPTION: Checks SSH configuration to ensure Protocol version 1 is not enabled, as required by CIS benchmark 6.2.1 and PCI-DSS 4.1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_26\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Installing Dependencies on DEB-based Systems\nDESCRIPTION: Commands to install the required dependencies for building the Wazuh engine on Debian-based systems.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/build-sources.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n# Install dependencies\nsudo apt install curl zip unzip tar -y\nsudo apt install build-essential -y\n```\n\n----------------------------------------\n\nTITLE: Checking for UID 0 Accounts\nDESCRIPTION: Detects non-root accounts with UID 0 for CIS compliance 9.2.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_33\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Extracting IP and Port Data with Wazuh Parser Expressions in YAML\nDESCRIPTION: This code snippet demonstrates a parser expression that captures an IP or hostname into client.ip or client.address fields, and optionally extracts a port into server.port field. It shows the structure of a basic Wazuh parser expression.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_21\n\nLANGUAGE: yaml\nCODE:\n```\nparse|event.original:\n  - \"<client.ip>?<client.address> connected to <server.ip>(?:<server.port>)\"\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Successful Connections Logging\nDESCRIPTION: Checks if the Windows Firewall Private Profile is configured to log successful connections according to CIS benchmark 9.2.10. Examines both policy and system registry locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_55\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Tester Unit Tests in CMake\nDESCRIPTION: Sets up unit tests for the API tester library when ENGINE_BUILD_TEST is enabled. It creates an executable 'api_tester_utest', links necessary libraries, and uses GTest for test discovery.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/tester/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_executable(api_tester_utest\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n    )\n    target_include_directories(api_tester_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_tester_utest\n        PRIVATE\n        api::tester\n        GTest::gtest_main\n        router::mocks\n        api::adapter::test\n    )\n    gtest_discover_tests(api_tester_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Manager ossec.conf Template Structure in XML\nDESCRIPTION: The main configuration template structure for the Wazuh manager component. It includes references to various template components like global settings, logging, alerts, remote connections, rootcheck, and other security modules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/config/README.md#2025-04-17_snippet_0\n\nLANGUAGE: xml\nCODE:\n```\n<ossec_config>\n    global.template\n\n    logging.template\n\n    alerts.template\n\n    remote-secure.template\n\n    [remote-syslog.template]\n\n    rootcheck.template\n\n    wodle-openscap.template\n\n    wodle-syscollector.template\n\n    syscheck.template\n\n    global-ar.template\n\n    ar-commands.template\n\n    ar-definitions.template\n\n    localfile-logs*\n\n    localfile-commands.template\n\n    localfile-extra.template\n\n    rules.template\n</ossec_config>\n```\n\n----------------------------------------\n\nTITLE: Configuring Wazuh Communications REST API in YAML\nDESCRIPTION: This YAML configuration snippet sets up the Wazuh Communications REST API. It specifies the host, port, number of workers, logging level and format, batching parameters, and SSL settings including key and certificate paths.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/communications/README.md#2025-04-17_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ncommunications_api:\n  host: 0.0.0.0\n  port: 27000\n  workers: 4\n  logging:\n    level: info\n    format: plain\n  batcher:\n    max_elements: 5\n    max_size: 3000\n    wait_time: 0.15\n  ssl:\n    key: /etc/wazuh-server/certs/server-1-key.pem\n    cert: /etc/wazuh-server/certs/server-1.pem\n    use_ca: false\n    ca: /etc/wazuh-server/certs/root-ca.pem\n```\n\n----------------------------------------\n\nTITLE: Comparison Operator Examples in YAML\nDESCRIPTION: Shows various ways to perform comparisons in check operations using operators and helper functions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_18\n\nLANGUAGE: yaml\nCODE:\n```\n# Example 1: Simple equality check\ncheck: http.method == \"GET\"\n\n# Example 2: Comparison with an integer value\ncheck: $event.severity > 3\n\n# Example 3: Using a helper function in check\ncheck: cidr_match($source.ip, \"192.168.0.0\", 24)\n```\n\n----------------------------------------\n\nTITLE: Add Integration Command Help\nDESCRIPTION: Help output for the add subcommand which adds integration assets to the Engine catalog\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_5\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration add -h\nusage: engine-integration add [-h] [-a API_SOCK] [--dry-run] [-n NAMESPACE]\n                              integration-path\n\npositional arguments:\n  integration-path      [default=current directory] Integration directory path\n\noptions:\n  -h, --help            show this help message and exit\n  -a API_SOCK, --api-sock API_SOCK\n                        [default=\"/run/wazuh-server/engine-api.socket\"] Engine\n                        instance API socket path\n  --dry-run             When set it will print all the steps to apply but wont\n                        affect the store\n  -n NAMESPACE, --namespace NAMESPACE\n                        [default=user] Namespace to add the integration to\n```\n\n----------------------------------------\n\nTITLE: Validating OneDrive Usage Restrictions\nDESCRIPTION: Registry checks to verify OneDrive file storage is properly restricted on Windows Server 2012 R2. Ensures compliance with file storage policies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_78\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> DisableFileSyncNGSC -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Skydrive -> DisableFileSync -> !1;\n```\n\n----------------------------------------\n\nTITLE: Setting Up Test Environment\nDESCRIPTION: Command to set up an isolated environment for running health tests\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n./test/setupEnvironment.py -e health_test/environment\n```\n\n----------------------------------------\n\nTITLE: Checking Key Existence in Object - exists_key_in()\nDESCRIPTION: Helper function that checks if a target field value exists as a key in a specified object. Takes an object parameter and returns boolean result indicating if the key exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_9\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: exists_key_in({'key': 'value'})\n```\n\n----------------------------------------\n\nTITLE: Using string_not_equal Function in Wazuh\nDESCRIPTION: Demonstrates how to use the string_not_equal function to check if strings are different. The function returns true if the strings don't match byte by byte.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_42\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_not_equal('hello world!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello\"\n}\n```\n\n----------------------------------------\n\nTITLE: Apache Error Log Parser Expression\nDESCRIPTION: A comprehensive parser expression for Apache error logs that handles multiple log formats. It extracts timestamp, log level, process ID, thread ID, source address, port, and message content from Apache error logs.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_33\n\nLANGUAGE: yaml\nCODE:\n```\nparse|event.original:\n    - \"[<@timestamp/Mon Dec 26 16:22:00 2016>] [<log.level>] [client <source.address>(?:<source.port>)] <message>\"\n\n    - \"[<@timestamp/%a %b %d %T %Y/en_US.UTF-8>] [<~apache.error.module>:<log.level>] [pid <process.pid>(?:tid <process.thread.id>)] [client <source.address>(?:<source.port>)] <message>\"\n\n    - \"[<@timestamp/%a %b %d %T %Y/en_US.UTF-8>] [<~apache.error.module>:<log.level>] [pid <process.pid>(?:tid <process.thread.id>)] <message>\"\n```\n\n----------------------------------------\n\nTITLE: Processed Event JSON Structure Example\nDESCRIPTION: Example of a processed event JSON structure after being enriched and normalized by the Wazuh engine.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_2\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"@timestamp\": \"2025-01-23T17:40:37Z\",\n  \"agent\": {\n    \"groups\": [\n      \"group1\",\n      \"group2\"\n    ],\n    \"host\": {\n      \"architecture\": \"x86_64\",\n      \"hostname\": \"wazuh-endpoint-linux\",\n      \"ip\": [\n        \"192.168.1.2\"\n      ],\n      \"os\": {\n        \"name\": \"Amazon Linux 2\",\n        \"platform\": \"Linux\"\n      }\n    },\n    \"id\": \"2887e1cf-9bf2-431a-b066-a46860080f56\",\n    \"name\": \"wazuh-agent-name\",\n    \"type\": \"endpoint\",\n    \"version\": \"5.0.0\"\n  },\n  \"event\": {\n    \"collector\": \"file\",\n    \"created\": \"2024-11-22T02:00:00Z\",\n    \"kind\": \"event\",\n    \"module\": \"logcollector\",\n    \"original\": \"Dec 13 11:35:28 a-mac-with-esc-key GoogleSoftwareUpdateAgent[21412]: 2016-12-13 11:35:28.421 GoogleSoftwareUpdateAgent[21412/0x700007399000] [lvl=2] -[KSUpdateEngine updateAllExceptProduct:] KSUpdateEngine updating all installed products, except:'com.google.Keystone'.\",\n    \"start\": \"2025-12-13T11:35:28.000Z\"\n  },\n  \"host\": {\n    \"hostname\": \"a-mac-with-esc-key\"\n  },\n  \"log\": {\n    \"file\": {\n      \"path\": \"/var/log/syslog.log\"\n    }\n  },\n  \"message\": \"2016-12-13 11:35:28.421 GoogleSoftwareUpdateAgent[21412/0x700007399000] [lvl=2] -[KSUpdateEngine updateAllExceptProduct:] KSUpdateEngine updating all installed products, except:'com.google.Keystone'.\",\n  \"process\": {\n    \"name\": \"GoogleSoftwareUpdateAgent\",\n    \"pid\": 21412\n  },\n  \"related\": {\n    \"hosts\": [\n      \"a-mac-with-esc-key\"\n    ]\n  },\n  \"tags\": [\n    \"production-server\"\n  ],\n  \"wazuh\": {\n    \"decoders\": [\n      \"syslog\"\n    ]\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Root Login Configuration\nDESCRIPTION: Checks if SSH root login is permitted, which should be disabled according to CIS benchmark 6.2.8\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Logging Path Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' by checking registry keys. This ensures firewall logs are stored in the specified standard location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_42\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Configuring Test Builds with CMake\nDESCRIPTION: Sets up test directory paths and configures unit and component test builds. Creates test executables with Google Test framework integration and discovers tests automatically.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/conf/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\nadd_executable(conf_utest\n    ${UNIT_SRC_DIR}/conf_test.cpp\n    ${UNIT_SRC_DIR}/unitconf_test.cpp\n)\ntarget_link_libraries(conf_utest GTest::gtest_main GTest::gmock conf)\ngtest_discover_tests(conf_utest)\n\nadd_executable(conf_ctest\n    ${COMPONENT_SRC_DIR}/apiLoader_test.cpp\n)\n\ntarget_link_libraries(conf_ctest PRIVATE conf GTest::gtest_main httpsrv)\ngtest_discover_tests(conf_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Configuring File Output in Wazuh\nDESCRIPTION: YAML configuration for the file output which sends alerts to a specified file. The path parameter is required and should be writable by the wazuh-server user.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-output.md#2025-04-17_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nfile:\n    path: ${PATH}\n```\n\n----------------------------------------\n\nTITLE: Parsing Key-Value Pairs in Wazuh Normalization (YAML/JSON)\nDESCRIPTION: The parse_key_value function extracts key-value pairs from a keys-values list. It uses specified separator, delimiter, quote, and escape characters to parse the input string and store each value in a field named after its corresponding key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_115\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_key_value($input_field, '=', ' ', '\\\\', \"'\")\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"key1=value1 key2=value2 key3=value3\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"key1=value1 key2=value2 key3=value3\",\n  \"target_field\": {\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Hotword Trojan Detection Rules\nDESCRIPTION: Rules to detect the Hotword Trojan by checking for specific files. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: text\nCODE:\n```\n[Hotword Trojan {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\_;\nf:%WINDIR%\\Sysnative\\_;\nf:%WINDIR%\\System32\\explore.exe;\nf:%WINDIR%\\Sysnative\\explore.exe;\nf:%WINDIR%\\System32\\ svchost.exe;\nf:%WINDIR%\\Sysnative\\ svchost.exe;\nf:%WINDIR%\\System32\\mmsystem.dlx;\nf:%WINDIR%\\Sysnative\\mmsystem.dlx;\nf:%WINDIR%\\System32\\WINDLL-ObjectsWin*.DLX;\nf:%WINDIR%\\Sysnative\\WINDLL-ObjectsWin*.DLX;\nf:%WINDIR%\\System32\\CFXP.DRV;\nf:%WINDIR%\\Sysnative\\CFXP.DRV;\nf:%WINDIR%\\System32\\CHJO.DRV;\nf:%WINDIR%\\Sysnative\\CHJO.DRV;\nf:%WINDIR%\\System32\\MMSYSTEM.DLX;\nf:%WINDIR%\\Sysnative\\MMSYSTEM.DLX;\nf:%WINDIR%\\System32\\OLECLI.DL;\nf:%WINDIR%\\Sysnative\\OLECLI.DL;\n```\n\n----------------------------------------\n\nTITLE: Using string_greater Function in Wazuh\nDESCRIPTION: Demonstrates how to use the string_greater function to perform lexicographical comparison. The function returns true if the target field is lexicographically greater than the provided string.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_33\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_greater('hello world!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"wazuh\"\n}\n```\n\n----------------------------------------\n\nTITLE: Indexer Output Asset Example in Wazuh\nDESCRIPTION: A complete asset example for wazuh-indexer output that sends integration events to the specified index. Uses the $(DATE) macro which is replaced by the current date in YYYY.MM.DD format.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-output.md#2025-04-17_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\nname: output/indexer/0\n\nmetadata:\n  module: wazuh\n  title: Indexer output event\n  description: Output integrations events to wazuh-indexer\n  compatibility: >\n    This decoder has been tested on Wazuh version 5.0\n  versions:\n    - \"\"\n  author:\n    name: Wazuh, Inc.\n    date: 2024/12/01\n  references:\n    - \"\"\n\noutputs:\n  - wazuh-indexer:\n      index: wazuh-alerts-$(DATE)\n```\n\n----------------------------------------\n\nTITLE: Directory Structure of Engine Catalog\nDESCRIPTION: Shows the hierarchical file structure of the engine-catalog package including the main commands and initialization files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_catalog/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n├── engine_catalog/\n|   └── cmds\n|       └── __init__.py\n|       └── add.py\n|       └── delete.py\n|       └── list.py\n|       └── update.py\n|   └── __init__.py\n|   └── __main__.py\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Policy Processing for Unchanged Group Policy Objects\nDESCRIPTION: Verifies that registry policies are processed even if Group Policy objects haven't changed by checking if 'NoGPOListChanges' is not set to 0 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_90\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoGPOListChanges;\n```\n\n----------------------------------------\n\nTITLE: Update Integration Command Help\nDESCRIPTION: Help output for the update subcommand which updates existing integration assets in the Engine catalog\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_7\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration update -h\nusage: engine-integration update [-h] [-a API_SOCK] [-p INTEGRATION-PATH]\n                                 [--dry-run] [-n NAMESPACE]\n\noptions:\n  -h, --help            show this help message and exit\n  -a API_SOCK, --api-sock API_SOCK\n                        [default=\"/run/wazuh-server/engine-api.socket\"] Engine\n                        instance API socket path\n  -p INTEGRATION-PATH, --integration-path INTEGRATION-PATH\n                        [default=current directory] Integration directory path\n  --dry-run             When set it will print all the steps to apply but wont\n                        affect the store\n  -n NAMESPACE, --namespace NAMESPACE\n                        Namespace to add the integration to\n```\n\n----------------------------------------\n\nTITLE: Adding support for nested queries in API q parameter\nDESCRIPTION: Added support for using nested queries in the q parameter of API requests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_4\n\nLANGUAGE: Python\nCODE:\n```\n# Support added for nested queries in API q parameter\n```\n\n----------------------------------------\n\nTITLE: File Output Asset Example in Wazuh\nDESCRIPTION: A complete asset example for file output that writes integration events to a specified file. Includes metadata such as compatibility, version information, and author details.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-output.md#2025-04-17_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\nname: output/file-output-integrations/0\n\nmetadata:\n  module: wazuh\n  title: file output event\n  description: Output integrations events to a file\n  compatibility: >\n    This decoder has been tested on Wazuh version 5.x\n  versions:\n    - 5.x\n  author:\n    name: Wazuh, Inc.\n    date: 2022/11/08\n  references:\n    - \"\"\n\noutputs:\n  - file:\n      path: /var/lib/wazuh-server/engine/alerts-ecs.json\n```\n\n----------------------------------------\n\nTITLE: SELinux Configuration Rules\nDESCRIPTION: Checks for proper SELinux enforcement and configuration settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/grub.conf -> !r:selinux=0;\nf:/etc/selinux/config -> r:SELINUX=enforcing;\nf:/etc/selinux/config -> r:SELINUXTYPE=targeted;\n```\n\n----------------------------------------\n\nTITLE: Checking Maximum Password Age in Windows Registry\nDESCRIPTION: This snippet checks if the 'Maximum password age' is set to 60 or fewer days, but not 0. It uses multiple registry checks to ensure compliance with CIS Benchmark 1.1.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3D;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3E;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3F;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:A\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:B\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:C\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:E\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:F\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Engine Integration Tests\nDESCRIPTION: Commands to set up the environment and run integration tests for the Wazuh Engine. Cleans existing test environment, sets up a new one, initializes the test framework, and runs the tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-tests.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n# Clean and set up the environment\ncd ${WAZUH_REPO_DIR} # Path of the cloned wa repository\nrm -rf /tmp/actions\npython3 src/engine/test/setupEnvironment.py -e /tmp/actions\nengine-it -e /tmp/actions -t src/engine/test/integration_tests/ init\nengine-it -e /tmp/actions -t src/engine/test/integration_tests/ run\n```\n\n----------------------------------------\n\nTITLE: Using array_contains Function in Wazuh Rules\nDESCRIPTION: The array_contains function checks if all specified elements exist in a target array. It supports multiple data types including objects, arrays, numbers, strings, and boolean values. The function returns true only if all provided elements are found in the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nfield: array_contains(element, [...])\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Login Grace Time Configuration\nDESCRIPTION: Verifies that the login grace time is set to the recommended 30 seconds to prevent open connections without authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 8: Wrong Grace Time {PCI_DSS: 2.2.4}] [any] [8]\nf:$sshd_file -> !r:^\\s*LoginGraceTime\\s+30\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Configuring KVDB Test Environment in CMake\nDESCRIPTION: Sets up the test environment for KVDB, including mock libraries and test executables for unit and component tests. This section is only included when ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/kvdb/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\n## Mocks\nadd_library(kvdb_mocks INTERFACE)\ntarget_include_directories(kvdb_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(kvdb_mocks INTERFACE GTest::gmock kvdb::ikvdb)\nadd_library(kvdb::mocks ALIAS kvdb_mocks)\n\n# Unit test\nadd_executable(kvdb_utest\n    ${UNIT_SRC_DIR}/kvdb_test.cpp\n)\ntarget_link_libraries(kvdb_utest GTest::gtest_main kvdb kvdb::mocks)\ngtest_discover_tests(kvdb_utest)\n\n# Component test\nadd_executable(kvdb_ctest\n    ${COMPONENT_SRC_DIR}/kvdbHandler_test.cpp\n    ${COMPONENT_SRC_DIR}/kvdbManager_test.cpp\n)\n\ntarget_link_libraries(kvdb_ctest GTest::gtest_main kvdb)\ngtest_discover_tests(kvdb_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Spyware Detection Rules\nDESCRIPTION: Rules for detecting various spyware applications including Twain Tec, SpyBuddy, and InternetOptimizer. Includes DLL paths, registry entries, and file locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_applications_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\n[Spyware - Twain Tec Spyware {PCI_DSS: 11.4}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\TwaintecDll.TwaintecDllObj.1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\twaintech;\nf:%WINDIR%\\twaintec.dll;\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine Catalog Installation\nDESCRIPTION: Command to verify the installation of the engine-catalog tool by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_policy/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-catalog --version\n```\n\n----------------------------------------\n\nTITLE: Using string_equal Function in Wazuh\nDESCRIPTION: Demonstrates how to use the string_equal function to perform exact string comparison. The function returns true only if strings match byte by byte.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_31\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_equal('hello world!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Protocol Version Configuration\nDESCRIPTION: Checks if SSH protocol version 1 is enabled, which is insecure according to CIS benchmark 6.2.1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Defining Rules for Detecting Various Malware Indicators\nDESCRIPTION: Rules to detect potential malware by checking for specific files and suspicious locations. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: text\nCODE:\n```\n[Possible Malware - Rbot/Sdbot detected {PCI_DSS: 11.4}] [any] []\nf:%Windir%\\System32\\rdriv.sys;\nf:%Windir%\\Sysnative\\rdriv.sys;\nf:%Windir%\\lsass.exe;\n\n[Possible Malware File {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\utorrent.exe;\nf:%WINDIR%\\System32\\utorrent.exe;\nf:%WINDIR%\\Sysnative\\utorrent.exe;\nf:%WINDIR%\\System32\\Files32.vxd;\nf:%WINDIR%\\Sysnative\\Files32.vxd;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Local Connection Security Rules\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Domain: Settings: Apply local connection security rules' is set to 'Yes'. This checks both policy and direct registry locations to ensure compliance with CIS benchmark 9.1.6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring Defs Test Suite in CMake\nDESCRIPTION: Sets up the test suite for the 'defs' library when ENGINE_BUILD_TEST is enabled. It creates a mock library, configures the test executable, and sets up GTest for discovering tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/defs/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n# Testing mocks\nadd_library(defs_mocks INTERFACE)\ntarget_include_directories(defs_mocks INTERFACE ${TEST_MOCK_DIR}\n)\ntarget_link_libraries(defs_mocks INTERFACE defs::idefinitions)\nadd_library(defs::mocks ALIAS defs_mocks)\n\nadd_executable(defs_utest\n  ${UNIT_SRC_DIR}/defs_test.cpp\n)\ntarget_include_directories(defs_utest\n  PRIVATE\n  ${TEST_SRC_DIR}\n  ${CMAKE_CURRENT_LIST_DIR}/src\n  ${CMAKE_CURRENT_LIST_DIR}/include/defs\n)\n\ntarget_link_libraries(defs_utest\n  PRIVATE\n  defs::mocks\n  defs\n  GTest::gtest_main\n)\n\ngtest_discover_tests(defs_utest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Engine Test Run Command Usage\nDESCRIPTION: Detailed command options for running integration tests with various configuration options for agent simulation and debugging.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-test run [-h] [--agent-id AGENT_ID] [--api-socket API-SOCKET] [--agent-name AGENT_NAME] [--agent-ip AGENT_IP] [-o ORIGIN] [--output OUTPUT_FILE]\n                       [-n NAMESPACES [NAMESPACES ...]] [-p POLICY | -s SESSION_NAME] [-d | -dd] [-t ASSETS [ASSETS ...]] [-j]\n                       integration-name\n\npositional arguments:\n  integration-name      Integration name\n\noptions:\n  -h, --help            show this help message and exit\n  --agent-id AGENT_ID   Agent ID for event filling\n  --api-socket API-SOCKET\n                        Socket to connect to the API\n  --agent-name AGENT_NAME\n                        Agent name for events filling\n  --agent-ip AGENT_IP   Register agent ip for events filling\n  -o ORIGIN, --origin ORIGIN\n                        Origin of the integration\n  --output OUTPUT_FILE  Output file where the events will be stored, if empty events wont be saved\n  -n NAMESPACES [NAMESPACES ...], --namespaces NAMESPACES [NAMESPACES ...]\n                        List of namespaces to include\n  -p POLICY, --policy POLICY\n                        Policy where to run the test. A temporary test session will be created and deleted when the command is completed.\n  -s SESSION_NAME, --session-name SESSION_NAME\n                        Session where to run the test\n  -d, --debug           Log asset history\n  -dd, --full-debug     Log asset history and full tracing\n  -t ASSETS [ASSETS ...], --trace ASSETS [ASSETS ...]\n                        List of assets to filter trace\n  -j, --json            Allows the output and trace generated by an event to be printed in Json format.\n```\n\n----------------------------------------\n\nTITLE: Installing Protocol Buffers Compiler on Ubuntu 22.04\nDESCRIPTION: Comprehensive setup script for installing the Protocol Buffers compiler and its dependencies on Ubuntu 22.04. Includes installation of protobuf compiler, bazel build system, and necessary development tools. Configures Bazel 5.4.0 specifically as required by protobuf.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/proto/readme.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\napt-get update\n# Instal protobuff compiler dependencies\napt-get install -y g++ git curl gnupg clang-format\n# Install bazel (https://bazel.build/install/ubuntu?hl=en)\n# Add Bazel distribution URI as a package source\ncurl -fsSL https://bazel.build/bazel-release.pub.gpg | gpg --dearmor > bazel.gpg\nmv bazel.gpg /etc/apt/trusted.gpg.d/\necho \"deb [arch=amd64] https://storage.googleapis.com/bazel-apt stable jdk1.8\" | tee /etc/apt/sources.list.d/bazel.list\n# Install and update Bazel 5.4.0 (Bazel 6 is not supported by protobuff yet)\napt update && apt install -y bazel-5.4.0 && apt full-upgrade\n# Remove the symbolic link to the old version\nrm /usr/bin/bazel\n# Create a symbolic link to the new version\nln -s /usr/bin/bazel-5.4.0 /usr/bin/bazel\n# Check the version\nbazel --version\n\n# Install protoc (https://github.com/protocolbuffers/protobuf/blob/main/src/README.md)\ncd ~\n# Get the source code\ngit clone https://github.com/protocolbuffers/protobuf.git\ncd protobuf\n# Checkout the version\ngit checkout v21.12\n# Update submodules\ngit submodule update --init --recursive\n# Build\nbazel build :protoc :protobuf\n# Install\ncp bazel-bin/protoc /usr/local/bin\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Decoder Tool\nDESCRIPTION: Commands for installing the engine-suite package and verifying the installation of the engine decoder tool.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_decoder/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\nLANGUAGE: bash\nCODE:\n```\nengine-decoder --version\n```\n\n----------------------------------------\n\nTITLE: Setting Up Test Environment\nDESCRIPTION: Creates an isolated test environment in the specified directory to prevent interference with existing installations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n./test/setupEnvironment.py -e /tmp/engine-integration-test\n```\n\n----------------------------------------\n\nTITLE: Checking Local User Enumeration on Domain-Joined Computers in Registry\nDESCRIPTION: Registry check to ensure the 'Enumerate local users on domain-joined computers' setting is disabled as required by CIS benchmark 18.8.25.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_59\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnumerateLocalUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Converting String to Boolean with parse_bool Function\nDESCRIPTION: Demonstrates the parse_bool function which checks if an input string is 'true' or 'false' (case-insensitive) and converts it to the corresponding boolean value. The function fails for any other input.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_103\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_bool($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"true\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"true\",\n  \"target_field\": true\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Router Implementation Dependencies\nDESCRIPTION: Sets up include directories and library dependencies for the router implementation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\ntarget_include_directories(router_router\n    PUBLIC\n    ${INC_DIR}\n    PRIVATE\n    ${SRC_DIR}\n)\ntarget_link_libraries(router_router\n    PUBLIC\n    router::irouter\n    builder::ibuilder\n    bk::ibk\n    queue::iqueue\n    PRIVATE\n    base\n    store::istore\n    builder::ibuilder\n)\nadd_library(router::router ALIAS router_router)\n```\n\n----------------------------------------\n\nTITLE: Verifying Secure Channel Data Encryption in Windows Registry\nDESCRIPTION: This snippet checks if 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'. It corresponds to CIS Benchmark 2.3.6.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireSignOrSeal -> 0;\n```\n\n----------------------------------------\n\nTITLE: Splitting Strings Using split() in Wazuh Normalization\nDESCRIPTION: The split() function divides a string by a separator character and returns the result as an array of strings. The operation is applied to the input field and the result is stored in the target field. If the target field already exists, it will be replaced.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_117\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: split($input_field, '|')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"val 1 | val 2 | val 3\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"val 1 | val 2 | val 3\",\n  \"target_field\": [\n    \"val 1 \",\n    \" val 2 \",\n    \" val 3\"\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking for MySQL Command History Disable\nDESCRIPTION: Verifies that the MySQL command history file (.mysql_history) does not exist in home directories, as per CIS recommendation 1.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_community_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nd:$home_dirs -> ^.mysql_history$;\n```\n\n----------------------------------------\n\nTITLE: Deleting KVDB Key in YAML\nDESCRIPTION: This snippet demonstrates how to use the kvdb_delete function to remove a key from the KVDB database. It returns true if the key was successfully removed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_86\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_delete('testing', 'key1')\n```\n\n----------------------------------------\n\nTITLE: Adding support for $ symbol in API query values\nDESCRIPTION: Added support for using the $ symbol in query values for the API.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_3\n\nLANGUAGE: Python\nCODE:\n```\n# Support added for $ symbol in API query values\n```\n\n----------------------------------------\n\nTITLE: Checking SSH IgnoreRhosts Configuration\nDESCRIPTION: Verifies that SSH IgnoreRhosts is enabled for improved security\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_29\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Extracting Regex Matches with regex_extract in Wazuh Normalization\nDESCRIPTION: The regex_extract function matches a regular expression against a specified field and captures the matched group. The function uses RE2 syntax and requires proper escaping of reserved YAML characters.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_59\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: regex_extract($fieldToMatch, '^(bye pcre\\\\d)$')\n```\n\n----------------------------------------\n\nTITLE: Sample Log Entry for Wazuh Parser\nDESCRIPTION: Example log entry to be parsed by the Wazuh parser expression. Shows a simple connection log with IP addresses and port information.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_22\n\nLANGUAGE: text\nCODE:\n```\n192.168.1.10 connected to 10.0.0.5:443\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Secure Desktop for UIAccess Applications in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop' is disabled. Checks if EnableUIADesktopToggle registry value is not set to 1 for enhanced security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_28\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\n```\n\n----------------------------------------\n\nTITLE: Configuring Unit Tests for Logpar Library in CMake\nDESCRIPTION: Sets up the unit test executable for the Logpar library when ENGINE_BUILD_TEST is enabled. It defines the test source directories, creates the test executable, links necessary libraries, and uses GTest for test discovery.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/logpar/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\n# Tests\nif(ENGINE_BUILD_TEST)\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\nadd_executable(logpar_utest\n    ${UNIT_SRC_DIR}/logpar_test.cpp\n)\ntarget_link_libraries(logpar_utest PRIVATE logpar GTest::gtest_main schemf::mocks)\n\ngtest_discover_tests(logpar_utest)\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Using regex_match Function in Wazuh\nDESCRIPTION: Demonstrates how to use the regex_match function to check if a string field matches a regular expression pattern. The function uses RE2 syntax and returns true if the pattern matches, false otherwise.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_26\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: regex_match('^(bye pcre\\\\d)$')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"bye pcre2\"\n}\n```\n\n----------------------------------------\n\nTITLE: Basic Field Type Validation in JSON\nDESCRIPTION: Demonstrates basic field validation with a numeric value\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_20\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": 234\n}\n```\n\n----------------------------------------\n\nTITLE: Verifying SSH Protocol Version in Wazuh Rootcheck\nDESCRIPTION: Ensures that SSH is not using the vulnerable protocol version 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 2: Protocol 1 {PCI_DSS: 2.2.4}] [any] [2]\nf:$sshd_file -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Security Policy Dataflow Visualization\nDESCRIPTION: Mermaid flowchart illustrating the security policy dataflow through decoders, rules, and outputs stages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_3\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Security policy dataflow\n---\nflowchart LR\n\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\nclassDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n\n subgraph decoTree[\"Decoders\"]\n  direction TB\n\n  deco01(\" \")\n  deco02(\" \")\n  deco03(\" \")\n  deco04(\" \")\n  deco05(\" \")\n  deco06(\" \")\n  deco07(\" \")\n  deco08(\" \")\n\n  deco01 --> deco02 & deco03 & deco04\n  deco02 --> deco05\n  deco03 --> deco06 & deco07\n  deco04 --> deco08\n end\n\n subgraph ruleTree[\"Rules\"]\n  direction TB\n\n  rule01(\" \")\n  rule02(\" \")\n  rule03(\" \")\n  rule04(\" \")\n  rule05(\" \")\n  rule06(\" \")\n  rule07(\" \")\n  rule08(\" \")\n\n  rule01 --> rule02 & rule03 & rule04\n  rule02 --> rule05\n  rule03 --> rule06 & rule07\n  rule04 --> rule08\n end\n\n subgraph outputTree[\"Outputs\"]\n  direction TB\n\n  output01(\" \")\n  output02(\" \")\n  output03(\" \")\n  output04(\" \")\n  output05(\" \")\n  output06(\" \")\n  output07(\" \")\n  output08(\" \")\n\n  output01 --> output02 & output03 & output04\n  output02 --> output05\n  output03 --> output06 & output07\n  output04 --> output08\n\n end\n\n decoTree:::TreeBoxClass\n ruleTree:::TreeBoxClass\n outputTree:::TreeBoxClass\n eventInput:::EventBoxClass\n eventOutput:::EventBoxClass\n\n eventInput@{shape: doc, label: \"Event</br>Input\"}==>decoTree==>ruleTree==>outputTree==>eventOutput@{shape: doc, label: \"Enriched</br>Event\"}\n```\n\n----------------------------------------\n\nTITLE: IP Address Validation in YAML\nDESCRIPTION: Configuration for validating public IP addresses\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_23\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: is_public_ip()\n```\n\n----------------------------------------\n\nTITLE: Arguments Configuration in YAML\nDESCRIPTION: Example YAML configuration showing the structure for defining helper function arguments with types, subsets, sources, and restrictions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\narguments:\n  argument_id:\n    type: any_type\n    generate: any_subtset\n    source: any_source\n    restrictions:\n      allowed:\n        - tany_value\n  argument_id:\n    type: any_type\n    generate: any_subtset\n    source: any_source\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Policy Processing Settings for Background Processing in Windows Registry\nDESCRIPTION: Verifies that registry policy processing is not disabled during periodic background processing in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_54\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoBackgroundPolicy;\n```\n\n----------------------------------------\n\nTITLE: Using string_equal Function with Reference in Wazuh\nDESCRIPTION: Shows how to use the string_equal function with a referenced value for string comparison. The example demonstrates a successful match when both strings are identical.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_32\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_equal($any_string)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_string\": \"hello world!\",\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Content Manager Test Tool Build\nDESCRIPTION: Sets up the main project configuration, enables testing, and configures the executable build using source files. Includes all CPP files in the directory and links required libraries including content_manager, pthread, and urlrequest.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/testtool/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nproject(content_manager_test_tool)\n\nenable_testing()\n\nfile(GLOB CONTENT_MANAGER_TEST_TOOL_SRC \"*.cpp\")\n\nadd_executable(content_manager_test_tool ${CONTENT_MANAGER_TEST_TOOL_SRC})\n\ntarget_link_libraries(content_manager_test_tool\n        content_manager\n        pthread\n        urlrequest)\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Unencrypted Traffic Configuration\nDESCRIPTION: Verifies that 'Allow unencrypted traffic' for WinRM client is disabled by checking if the AllowUnencryptedTraffic registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_90\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Microsoft Account Blocking in Windows Registry\nDESCRIPTION: This snippet checks if 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'. It corresponds to CIS Benchmark 2.3.1.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !NoConnectedUser;\n```\n\n----------------------------------------\n\nTITLE: Writing Conditional Expressions for Complex Logic\nDESCRIPTION: Three YAML examples showing how to use conditional expressions with logical operators for more complex filtering scenarios, including category and type checks, helper function usage, and origin path validation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_31\n\nLANGUAGE: yaml\nCODE:\n```\ncheck: $event.category==\"registry\" AND $event.type==\"change\" AND ($registry.path==\"/some/path\" OR $registry.path==\"/some/other/path\")\n```\n\nLANGUAGE: yaml\nCODE:\n```\ncheck: int_less($http.response.status_code, 400)\n```\n\nLANGUAGE: yaml\nCODE:\n```\ncheck: $wazuh.origin == /var/log/apache2/access.log OR $wazuh.origin == /var/log/httpd/access_log\n```\n\n----------------------------------------\n\nTITLE: KVDB Matching Configuration in YAML\nDESCRIPTION: Shows how to configure key-value database matching checks\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_24\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: kvdb_match('testing')\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Vulnerability Scanner Tests\nDESCRIPTION: Complete CMake configuration that sets up the vulnerability scanner unit tests project. Includes compiler flags, source file definitions, external dependencies like flatbuffers and rocksdb, and links required testing libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/tests/unit/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(vulnerability_scanner_unit_tests)\n\nset(CMAKE_CXX_FLAGS_DEBUG \"-g --coverage -fsanitize=address,leak,undefined\")\n\ninclude_directories(${SRC_FOLDER}/external/flatbuffers/include/)\n\nfile(GLOB PROJECT_SOURCES\n    *.cpp\n    ${SRC_FOLDER}/vulnerability_scanner/src/*[!main]*.cpp\n    ${SRC_FOLDER}/vulnerability_scanner/src/databaseFeedManager/*.cpp\n    ${SRC_FOLDER}/vulnerability_scanner/src/policyManager/*.cpp\n    ${SRC_FOLDER}/vulnerability_scanner/src/scanOrchestrator/*.cpp\n    ${SRC_FOLDER}/vulnerability_scanner/src/scanOrchestrator/versionMatcher/*.cpp\n)\n\nlink_directories(${SRC_FOLDER}/external/rocksdb/build)\nlink_directories(${SRC_FOLDER}/external/flatbuffers/build/)\nlink_directories(${SRC_FOLDER}/external/curl/lib/.libs/)\n\nadd_executable(${PROJECT_NAME} ${PROJECT_SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n    debug gtestd\n    debug gmockd\n    debug gtest_maind\n    debug gmock_maind\n    optimized gtest\n    optimized gmock\n    optimized gtest_main\n    optimized gmock_main\n    flatbuffers\n    rocksdb\n    router\n    urlrequest\n    curl\n    pthread\n)\n\ntarget_link_libraries(${PROJECT_NAME} vulnerability_scanner)\n\ntarget_compile_definitions(${PROJECT_NAME} PUBLIC FLATBUFFER_SCHEMAS_DIR=\"${SRC_FOLDER}/wazuh_modules/vulnerability_scanner/schemas/\")\n\nadd_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Elevation Prompt Behavior for Administrators in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode' is set correctly. Checks if ConsentPromptBehaviorAdmin registry value is configured for consent prompting on the secure desktop.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_29\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorAdmin;\n```\n\n----------------------------------------\n\nTITLE: Negative string_less Example with Reference in Wazuh\nDESCRIPTION: Shows a case where string_less returns false because the target field is lexicographically greater than the referenced value. This demonstrates how lexicographical comparison works.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_37\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_less($any_string)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_string\": \"hello world!\",\n  \"target_field\": \"wazuh\"\n}\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Allow unencrypted traffic' for WinRM Service Registry Setting\nDESCRIPTION: Checks if 'AllowUnencryptedTraffic' is set to 0 (Disabled) for WinRM service to prevent unencrypted communication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_134\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Displaying Directory Structure for Engine Clear Tool in Bash\nDESCRIPTION: Shows the directory structure of the Engine Clear Tool project, including the main Python files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_clear/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n├── engine_clear/\n|   └── __init__.py\n|   └── __main__.py\n```\n\n----------------------------------------\n\nTITLE: Merging Objects using merge() in Wazuh\nDESCRIPTION: The merge() function combines two objects or arrays of the same type. It merges the referenced object into the target field, with the reference object taking precedence in case of key collisions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_92\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: merge($any_object)\n```\n\n----------------------------------------\n\nTITLE: Checking Publish to Web Task Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure the \"Publish to Web\" task for files and folders is disabled according to CIS benchmark 18.8.20.1.11. The rules verify if the NoPublishingWizard registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_269\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Configuring Utils Benchmark Test Build in CMake\nDESCRIPTION: Configures a CMake build for utils benchmark tests. Sets minimum CMake version, defines project, configures include/link directories, builds executable from test source files, and links required libraries. Creates a test target that can be run with CTest.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/utils/benchmark/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(utils_benchmark_test)\n\ninclude_directories(${SRC_FOLDER}/external/benchmark/include)\nlink_directories(${SRC_FOLDER}/external/benchmark/build/src)\n\nfile(GLOB UTIL_CXX_BENCHMARKTEST_SRC\n    \"*_test.cpp\"\n    \"main.cpp\"\n)\n\nadd_executable(utils_benchmark_test ${UTIL_CXX_BENCHMARKTEST_SRC})\ntarget_link_libraries(utils_benchmark_test benchmark rocksdb)\n\nadd_test(NAME utils_benchmark_test\n         COMMAND utils_benchmark_test)\n```\n\n----------------------------------------\n\nTITLE: Debugging Commands for Wazuh Engine (Bash)\nDESCRIPTION: Collection of journalctl commands for filtering and monitoring Wazuh Engine logs with different severity levels.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_37\n\nLANGUAGE: bash\nCODE:\n```\njournalctl _COMM=wazuh-engine\n```\n\nLANGUAGE: bash\nCODE:\n```\njournalctl -f _COMM=wazuh-engine\n```\n\nLANGUAGE: bash\nCODE:\n```\njournalctl _COMM=wazuh-engine | grep info\n```\n\n----------------------------------------\n\nTITLE: Using string_less_or_equal Function in Wazuh\nDESCRIPTION: Demonstrates how to use the string_less_or_equal function for lexicographical comparison. The function returns true if the target field is lexicographically less than or equal to the provided string.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_39\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_less_or_equal('wazuh')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Using erase_custom_fields() on Object Fields in Wazuh\nDESCRIPTION: Shows how erase_custom_fields() functions on object fields, removing them if they don't belong to the schema.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_82\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: erase_custom_fields()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": {\n    \"key\": \"value\"\n  }\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Boot Services Configuration\nDESCRIPTION: Detects enabled boot services that should be disabled according to CIS benchmarks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_36\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dkudzu$;\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\nd:$rc_dirs -> ^S\\d\\dmysqld$;\nd:$rc_dirs -> ^S\\d\\dnamed$;\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Creating Wazuh Engine Docker Container (Bash)\nDESCRIPTION: Commands to create a Docker container for the Wazuh engine. It maps port 4022 on the host to port 22 in the container for SSH access.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/docker/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndocker create -p 4022:22 --name engine-container engine-container:latest\n```\n\nLANGUAGE: bash\nCODE:\n```\nexport VERSION=20250414-0\ndocker create -p 4022:22 --name engine-container engine-container:$VERSION\n```\n\n----------------------------------------\n\nTITLE: Setting Argument Restrictions in YAML\nDESCRIPTION: Configuration example for setting allowed values for arguments using restrictions property.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_4\n\nLANGUAGE: yaml\nCODE:\n```\nrestrictions:\n    allowed:\n    - testing\n```\n\n----------------------------------------\n\nTITLE: Verifying Audit Policy Override Settings in Windows Registry\nDESCRIPTION: This snippet checks if 'Audit: Force audit policy subcategory settings to override audit policy category settings' is set to 'Enabled'. It corresponds to CIS Benchmark 2.3.2.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> SCENoApplyLegacyAuditPolicy -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking AutoRun Default Behavior Settings in Registry\nDESCRIPTION: Registry checks to verify that 'Set the default behavior for AutoRun' is enabled and set to not execute autorun commands as required by CIS benchmark 18.9.8.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_66\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoAutorun -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoAutorun;\n```\n\n----------------------------------------\n\nTITLE: Integer Equality Check - int_equal()\nDESCRIPTION: Validates if an integer field equals a specified value. Accepts integers between -2^63 and 2^63-1 and returns boolean result.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_11\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_equal(22)\n```\n\n----------------------------------------\n\nTITLE: Initializing CMake Project Configuration\nDESCRIPTION: Sets up basic CMake project configuration including minimum version, project name, and C++ standard settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(keystore)\n\nenable_testing()\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_CXX_FLAGS \"-fPIC\")\n```\n\n----------------------------------------\n\nTITLE: Checking Secure Channel Data Encryption (When Possible) in Windows Registry\nDESCRIPTION: This snippet verifies if 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'. It aligns with CIS Benchmark 2.3.6.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SealSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring Wazuh Management REST API in YAML\nDESCRIPTION: A complete YAML configuration example for the Wazuh Management REST API that includes all available settings: basic configuration, intervals, SSL settings, logging options, CORS configuration, and access controls.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/management/README.md#2025-04-17_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nmanagement_api:\n  host: 0.0.0.0\n  port: 55000\n  intervals:\n    request_timeout: 10\n  ssl:\n    key: /etc/wazuh-server/certs/server-1-key.pem\n    cert: /etc/wazuh-server/certs/server-1.pem\n    use_ca: false\n    ca: /etc/wazuh-server/certs/root-ca.pem\n  logging:\n    level: info\n    format: plain\n  cors:\n    enabled: false\n    source_route: *\n    expose_headers: *\n    allow_headers: *\n    allow_credentials: false\n  access:\n    max_login_attempts: 50\n    block_time: 300\n    max_request_per_minute: 300\n```\n\n----------------------------------------\n\nTITLE: Configuring Indexer Output in Wazuh\nDESCRIPTION: YAML configuration for the wazuh-indexer output which sends alerts to wazuh-index for indexing. The index parameter must be a valid Elasticsearch index name starting with 'wazuh-'.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-output.md#2025-04-17_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nwazuh-indexer:\n    index: ${INDEX}\n```\n\n----------------------------------------\n\nTITLE: Usage Guide for Engine Policy Tool\nDESCRIPTION: Detailed usage instructions for the engine-policy tool, including available options and subcommands for managing policies, assets, and namespaces.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_policy/README.md#2025-04-17_snippet_3\n\nLANGUAGE: console\nCODE:\n```\nusage: engine-policy [-h] [--version] [--api-socket API_SOCKET] {create,delete,get,list,asset-add,asset-remove,asset-list,asset-clean-deleted,parent-set,parent-remove,namespace-list} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --api-socket API_SOCKET\n                        Path to the Wazuh API socket\n\nsubcommands:\n  {create,delete,get,list,asset-add,asset-remove,asset-list,asset-clean-deleted,parent-set,parent-remove,namespace-list}\n    create              Create a new, empty policy\n    delete              Remove a policy\n    get                 Get a policy\n    list                List all policies\n    asset-add           Add an asset to a policy\n    asset-remove        Remove an asset to a policy\n    asset-list          List all assets in a policy\n    asset-clean-deleted\n                        Remove all deleted assets from a policy\n    parent-set          Set the default parent for assets under a specific namespace\n    parent-remove       Remove the default parent for assets under a specific namespace\n    namespace-list      List all namespaces included in a policy\n```\n\n----------------------------------------\n\nTITLE: Recursively Merging KVDB Value with Existing Field in YAML\nDESCRIPTION: This snippet demonstrates how to use the kvdb_get_merge_recursive function to retrieve a value from KVDB and recursively merge it with the existing value in the target field for deep integration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_90\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_get_merge_recursive('testing', 'key')\n```\n\n----------------------------------------\n\nTITLE: Displaying Inline Code in Markdown\nDESCRIPTION: This snippet demonstrates how to display inline code within a Markdown document, specifically showing the 'vacuum' command.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/architecture/wazuh-db/Readme.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n<code>vacuum</code>\n```\n\n----------------------------------------\n\nTITLE: Integer Less Than Check - int_less()\nDESCRIPTION: Verifies if an integer field is less than a specified value. Accepts integers between -2^63 and 2^63-1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_14\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_less(22)\n```\n\n----------------------------------------\n\nTITLE: Defining KVDB Static Library in CMake\nDESCRIPTION: Creates a static library for KVDB, specifying source files, include directories, and dependencies including RocksDB.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/kvdb/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(kvdb STATIC\n    ${SRC_DIR}/kvdbManager.cpp\n    ${SRC_DIR}/kvdbHandler.cpp\n    ${SRC_DIR}/kvdbHandlerCollection.cpp\n    ${SRC_DIR}/refCounter.cpp\n)\n\ntarget_include_directories(kvdb\n    PUBLIC\n    ${INC_DIR}\n## TODO: private, after implement pimpl pattern\n    ${rocksdb_SOURCE_DIR}/include\n)\n\ntarget_link_libraries(kvdb\n    PRIVATE\n    RocksDB::rocksdb\n    base\n    PUBLIC\n    kvdb::ikvdb\n)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Inbound Connections Blocking\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to block inbound connections by default by checking registry keys. The check fails if DefaultInboundAction is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_29\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Microsoft Network Client Security Registry Check\nDESCRIPTION: Registry checks for network client security settings including digital signature requirements and password encryption policies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnableSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnablePlainTextPassword -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating Object Keys - has_keys()\nDESCRIPTION: Function that verifies if all specified keys in a target object exist in a provided list. Takes an array of strings as parameter and validates against object keys.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_10\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: has_keys(['ts', 'host'])\n```\n\n----------------------------------------\n\nTITLE: Installing Required Python Packages for Wazuh-Engine Testing\nDESCRIPTION: Commands to install the necessary Python packages for running Wazuh-Engine tests. These packages include tools for API communication, test utilities, and specific test suites.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip3 install tools/api-communication\npip3 install test/engine-test-utils\npip3 install tools/engine-suite\npip3 install test/health_test/engine-health-test\npip3 install test/integration_tests/engine-it\npip3 install test/helper_tests/engine_helper_test\n```\n\n----------------------------------------\n\nTITLE: Checking SSH LogLevel Configuration\nDESCRIPTION: Verifies SSH LogLevel is properly set to INFO as per security best practices\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_27\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && !r:LogLevel\\.+INFO;\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM Device Connection Controls\nDESCRIPTION: Verifies whether unauthorized device removal or connection is prevented in VMware ESX VM configuration. The rule checks if Isolation.tools.connectable.disable is missing or set to false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: vmx\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> !r:^Isolation.tools.connectable.disable;\nd:/vmfs/volumes -> .vmx$ -> r:^Isolation.tools.connectable.disable && r:false;\n```\n\n----------------------------------------\n\nTITLE: Flatbuffers Schema Compilation\nDESCRIPTION: Generates C++ headers from Flatbuffers schema files using custom commands and targets\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nlist(APPEND Schemas\n            cve5\n            vulnerabilityCandidate\n            vulnerabilityDescription\n            vulnerabilityRemediations\n            packageTranslation\n            messageBuffer\n)\n\nmessage(\"Compiling schemas\")\nadd_custom_target(compile_schemas)\nforeach(schema IN LISTS Schemas)\n  set(FILE \"./schemas/${schema}.fbs\")\n  set(VULNERABILITY_OUTPUT_HEADER_GENERATED \"${CMAKE_CURRENT_SOURCE_DIR}/include/${schema}_generated.h\")\n  set(VULNERABILITY_OUTPUT_HEADER \"${CMAKE_CURRENT_SOURCE_DIR}/include/${schema}_schema.h\")\n\n  add_custom_command(\n      OUTPUT \"${VULNERABILITY_OUTPUT_HEADER_GENERATED}\"\n      COMMAND ${SRC_FOLDER}/external/flatbuffers/build/flatc\n      ARGS --cpp\n      ARGS -o \"${CMAKE_CURRENT_SOURCE_DIR}/include\" \"${FILE}\"\n      ARGS --no-warnings\n      COMMENT \"Building C++ header for ${schema} schema.\"\n      DEPENDS ${FILE}\n      WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})\n\n  add_custom_command(\n      OUTPUT \"${VULNERABILITY_OUTPUT_HEADER}\"\n      COMMAND bash -c \"echo -e '// This file was generated from ${FILE} , do not modify \\\\n#ifndef ${schema}_HEADER\\\\n#define ${schema}_HEADER\\\\nauto constexpr ${schema}_SCHEMA = R\\\"('`cat ${FILE}`')\\\" ;\\\\n#endif // ${schema}_HEADER\\\\n ' > ./include/${schema}_schema.h\"\n      COMMENT \"Creating header from schema file: '${schema}'\"\n      DEPENDS ${VULNERABILITY_OUTPUT_HEADER_GENERATED}\n      WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}\n      VERBATIM)\n\n  add_custom_target(${schema}_schema_target DEPENDS ${VULNERABILITY_OUTPUT_HEADER})\n  add_dependencies(compile_schemas ${schema}_schema_target)\nendforeach()\n```\n\n----------------------------------------\n\nTITLE: Adding Multiple Unique Values with array_append_unique_any in Wazuh\nDESCRIPTION: Demonstrates using array_append_unique_any to add multiple values that don't already exist in the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_75\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_unique_any(5, 6)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking SSH HostbasedAuthentication Configuration\nDESCRIPTION: Verifies that SSH host-based authentication is disabled in sshd_config for CIS compliance 6.2.7.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_30\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Root Login Configuration\nDESCRIPTION: Verifies if SSH root login is allowed in sshd configuration. Based on CIS benchmark 6.2.8 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Validating Custom Field Indexing in Wazuh Health Test (Bash)\nDESCRIPTION: These commands validate custom field indexing by creating an OpenSearch instance, ingesting events, and verifying custom fields in the index. Options allow for testing specific integrations, rule folders, or all decoders/rules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\n# To run a specific integration\nengine-health-test dynamic -e health_test/environment validate_custom_field_indexing --integration windows\n# To run a specific rule folder\nengine-health-test dynamic -e health_test/environment validate_custom_field_indexing --rule_folder windows\n# To run all tests in decoders\nengine-health-test dynamic -e health_test/environment validate_custom_field_indexing --target decoder\n# To run all tests in rules\nengine-health-test dynamic -e health_test/environment vvalidate_custom_field_indexing --target rules\n# To skip specific tests in decoders\nengine-health-test dynamic -e health_test/environment validate_custom_field_indexing --target decoder --skip windows,wazuh-core\n```\n\n----------------------------------------\n\nTITLE: Starting Wazuh Engine Docker Container (Bash)\nDESCRIPTION: Command to start the previously created Wazuh engine Docker container.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/docker/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ndocker start engine-container\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine-Geo Installation\nDESCRIPTION: Command to verify the successful installation of the engine-geo script by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_geo/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-geo --version\n```\n\n----------------------------------------\n\nTITLE: Checking System Shutdown on Audit Failure in Windows Registry\nDESCRIPTION: This snippet verifies if 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'. It aligns with CIS Benchmark 2.3.2.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Camera Prevention Setting\nDESCRIPTION: Verifies that enabling the lock screen camera is prevented by checking registry keys. The check fails if NoLockScreenCamera is not set to 1 or doesn't exist under the Personalization key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_38\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenCamera -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenCamera;\n```\n\n----------------------------------------\n\nTITLE: Custom Target Collection Function in CMake\nDESCRIPTION: Recursive function to collect all build targets from subdirectories into a single list.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_5\n\nLANGUAGE: cmake\nCODE:\n```\nfunction(get_all_targets _result _dir)\n    get_property(_subdirs DIRECTORY \"${_dir}\" PROPERTY SUBDIRECTORIES)\n    foreach(_subdir IN LISTS _subdirs)\n        get_all_targets(${_result} \"${_subdir}\")\n    endforeach()\n\n    get_directory_property(_sub_targets DIRECTORY \"${_dir}\" BUILDSYSTEM_TARGETS)\n    set(${_result} ${${_result}} ${_sub_targets} PARENT_SCOPE)\nendfunction()\n```\n\n----------------------------------------\n\nTITLE: Integer Greater Than Check - int_greater()\nDESCRIPTION: Checks if an integer field is greater than a specified value. Accepts integers between -2^63 and 2^63-1 and returns boolean result.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_12\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_greater(1)\n```\n\n----------------------------------------\n\nTITLE: Initializing Builder Interface Library in CMake\nDESCRIPTION: Sets up the interface library for the builder component with base dependencies and include directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/builder/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(builder_ibuilder INTERFACE)\ntarget_include_directories(builder_ibuilder INTERFACE ${IFACE_DIR})\ntarget_link_libraries(builder_ibuilder INTERFACE base)\nadd_library(builder::ibuilder ALIAS builder_ibuilder)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Firewall Rules Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Settings: Apply local firewall rules' is set to 'Yes' by checking registry keys. This check ensures the Windows Firewall applies local firewall rules in the private profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_50\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Blank Password Usage Limitation in Windows Registry\nDESCRIPTION: This snippet verifies if 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'. It aligns with CIS Benchmark 2.3.1.4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LimitBlankPasswordUse -> 0;\n```\n\n----------------------------------------\n\nTITLE: Parsing File Paths in YAML\nDESCRIPTION: Shows the use of parse_file function to extract components from a file path. It parses the input string as a file path and returns an object with path details.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_110\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_file($input_field)\n```\n\n----------------------------------------\n\nTITLE: Building Wazuh Engine Docker Image (Bash)\nDESCRIPTION: Commands to build the Docker image for the Wazuh engine development environment. It sets the version, builds the image using docker buildx, and tags it as the latest version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/docker/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nexport VERSION=20250414-0\ndocker buildx build -t engine-container:$VERSION . --no-cache\n# Tag the image as latest to use it as the default image (recommended)\ndocker tag engine-container:$VERSION engine-container:latest\n```\n\n----------------------------------------\n\nTITLE: Using as Function for IP Lookup in Wazuh\nDESCRIPTION: Demonstrates the as function signature which performs a query to the MaxMind GeoLite2-ASN database for IP address information. It returns autonomous system number and organization name for a given IP address.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_44\n\nLANGUAGE: yaml\nCODE:\n```\nfield: as(ip, [...])\n```\n\n----------------------------------------\n\nTITLE: Addition of Two Integers using int_calculate in Wazuh\nDESCRIPTION: Demonstrates using int_calculate to add two integer values. The operation is performed successfully and the result is stored in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_52\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('sum', $operand_left, $operand_right)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": 1,\n  \"operand_right\": 1\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": 1,\n  \"operand_right\": 1,\n  \"target_field\": 2\n}\n```\n\n----------------------------------------\n\nTITLE: Adding Multiple Values to Arrays with array_append_any in Wazuh\nDESCRIPTION: Demonstrates using array_append_any function to add multiple numeric values to an array. The function successfully appends values regardless of type matching.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_69\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_any(5, 6)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5,\n    6\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Registry Settings\nDESCRIPTION: Registry checks to verify that printing over HTTP is disabled per CIS benchmark 18.8.20.1.7. The check ensures DisableHTTPPrinting is set to 1 in the Windows NT Printers policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_57\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Using 'concat_any' Function for Flexible String Concatenation in Wazuh\nDESCRIPTION: Demonstrates the 'concat_any' function which joins strings even when some references don't exist. Unlike 'concat', this function continues even with null values, making it more resilient.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_47\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: concat_any('hello', ' ', 'yes')\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello yes\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: concat_any($operand_left, $operand_right)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": null,\n  \"operand_right\": \"hello\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": null,\n  \"operand_right\": \"hello\",\n  \"target_field\": \"hello\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: concat_any($operand_left, 'hello')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": null\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": null,\n  \"target_field\": \"hello\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Network Parameters in Red Hat Linux\nDESCRIPTION: Verifies network parameters such as source routing, ICMP broadcasts, and IP forwarding.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: text\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Validating Successful Assets in Wazuh Health Test (Bash)\nDESCRIPTION: These commands validate that successful decoders and rules are properly added to wazuh.decoders and wazuh.rules respectively. Various options allow for testing specific integrations, rule folders, or all decoders/rules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\n# Validate specific integration\nengine-health-test dynamic -e health_test/environment validate_successful_assets --integration windows\n# Validate specific rule folder\nengine-health-test dynamic -e health_test/environment validate_successful_assets --rule_folder windows\n# Validate all rules\nengine-health-test dynamic -e health_test/environment validate_successful_assets --target rule\n# Validate all decoders\nengine-health-test dynamic -e health_test/environment validate_successful_assets --target decoder\n```\n\n----------------------------------------\n\nTITLE: Integer Conversion Function in Wazuh\nDESCRIPTION: Transforms a number to an integer by either truncating or rounding. Handles positive and negative numbers with different rounding behaviors.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_62\n\nLANGUAGE: yaml\nCODE:\n```\nfield: to_int(number_to_transform, operation_mode)\n```\n\n----------------------------------------\n\nTITLE: Detecting X11 Server in RHEL7\nDESCRIPTION: Checks for the presence of X11 (X Window System) by looking for the gdm-x-session process. X11 should be disabled on servers for security reasons.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: bash\nCODE:\n```\np:gdm-x-session;\n```\n\n----------------------------------------\n\nTITLE: Visualizing Filter Schema with Mermaid\nDESCRIPTION: Mermaid diagram illustrating the schema structure of Filter assets in Wazuh security policies, showing key components like name, metadata, and allow stage for event evaluation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_29\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Filter schema\n---\nkanban\n  Output[Output schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    %% assetParents[\"parents\"]\n    assetChecks[\"allow\"]\n```\n\n----------------------------------------\n\nTITLE: Detecting Talk Server in RHEL7\nDESCRIPTION: Checks for the presence of talk server in xinetd and systemd configurations. Talk is an insecure communication service and should be disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/talk -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/ntalk.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Creating Library and Executable Targets\nDESCRIPTION: Defines build targets for the keystore static library and wazuh-keystore executable, including library linkage and RPATH settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/CMakeLists.txt#2025-04-17_snippet_5\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(keystore STATIC ${KEYSTORE_SRC})\n\ntarget_link_libraries(keystore rocksdb wazuhext)\n\nadd_executable(wazuh-keystore src/main.cpp)\n\ntarget_link_libraries(wazuh-keystore keystore)\n\nset_target_properties(wazuh-keystore PROPERTIES\n    BUILD_RPATH_USE_ORIGIN TRUE\n    BUILD_RPATH \"$ORIGIN/../lib\"\n)\n\nadd_subdirectory(testtool)\n```\n\n----------------------------------------\n\nTITLE: Engine Diff Tool Usage Guide\nDESCRIPTION: Displays the complete usage guide for the Engine Diff Tool, including all available command-line options and arguments. It explains how to compare two files, specify input format, and control output verbosity.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_diff/README.md#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\nusage: engine-diff [-h] [--version] [-in {yaml,json}] [-q, --quiet] [--no-order] fileA fileB\n\nCompare two events in yaml format, returns SAME if no differences found, DIFFERENT otherwise. The script loads the events, orders them and\nmakes a diff using delta, credits to dandavison for his awesome tool (https://github.com/dandavison/delta)\n\npositional arguments:\n  fileA                 First file to compare\n  fileB                 Second file to compare\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  -in {yaml,json}, --input {yaml,json}\n                        Input format (default: json)\n  -q, --quiet           Print only the result\n  --no-order            Do not order the events when comparing\n```\n\n----------------------------------------\n\nTITLE: Checking Network Parameters - ICMP Broadcast Acceptance\nDESCRIPTION: Verifies if ICMP broadcast acceptance is enabled in IPv4 configuration. Part of CIS benchmark 4.2.5 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\n```\n\n----------------------------------------\n\nTITLE: Merging Specific Keys using merge_key_in() in Wazuh\nDESCRIPTION: The merge_key_in() function merges a specific key from a given object into the target field. It allows selective merging based on a key reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_93\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: merge_key_in({'input_key_1': {'v1': 'k1'}, 'input_key_2': {'v2': 'k2'}}, $key)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: merge_key_in($any_object, $key)\n```\n\n----------------------------------------\n\nTITLE: API Integration Test Script Usage Help\nDESCRIPTION: Command-line help output showing available options for the run_tests.py script used to execute API integration tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/README.md#2025-04-17_snippet_2\n\nLANGUAGE: text\nCODE:\n```\n$ python3 run_tests.py -h\nusage: run_tests.py [options]\n\nAPI integration tests\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -l TEST_LIST, --list TEST_LIST\n                        Specify a list of tests separated by a comma.\n  -e, --exclude         Run every test excluding the already saved in the RESULTS_FOLDER.\n  -r, --results         Get result summary from the already run tests.\n  -k KEYWORD, --keyword KEYWORD\n                        Specify the keyword to filter tests out. Default None.\n  -R {both,yes,no}, --rbac {both,yes,no}\n                        Specify what to do with RBAC tests. Run everything, only RBAC ones or no RBAC. Default \"both\".\n  -i ITERATIONS, --iterations ITERATIONS\n                        Specify how many times will every test be run. Default 1.\n```\n\n----------------------------------------\n\nTITLE: Concatenating Strings with 'concat' Function in Wazuh\nDESCRIPTION: Examples of using the 'concat' function to join strings, numbers, and objects. The function concatenates multiple values in the order provided and stores the result in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_46\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: concat('yes', ' ', 'no', 'hello', 'yes')\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello noyesyes\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: concat($operand_left, 'hello')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": null\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: concat($operand_left, 2, $operand_right_1)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": {\n    \"key\": \"value\"\n  },\n  \"operand_right_1\": \"hello\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": {\n    \"key\": \"value\"\n  },\n  \"operand_right_1\": \"hello\",\n  \"target_field\": \"{\\\"key\\\":\\\"value\\\"}2hello\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Script Block Logging Configuration\nDESCRIPTION: Ensures that 'Turn on PowerShell Script Block Logging' is disabled by verifying the EnableScriptBlockLogging registry value is set to 0 or does not exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_87\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Creating Indexer Connector Executable\nDESCRIPTION: Defines the indexer connector tool executable target and its source files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/tool/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(indexer_connector_tool\n    ${INDEXER_CONNECTOR_TOOL_SRC}\n    )\n```\n\n----------------------------------------\n\nTITLE: Checking String Ends With in YAML\nDESCRIPTION: Checks if the string stored in the field ends with the provided value. The function evaluates to false if it doesn't end with the value or in case of an error.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_7\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: ends_with('wazuh!!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello wazuh!!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring JSON Search Benchmark Executable with CMake\nDESCRIPTION: Creates an executable target 'jsonSearch_benchmark' from the source file and links it with required libraries 'base' and 'benchmark::benchmark_main'\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/json/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(jsonSearch_benchmark\n    ${CMAKE_CURRENT_LIST_DIR}/jsonSearch_benchmark.cpp\n)\ntarget_link_libraries(jsonSearch_benchmark base benchmark::benchmark_main)\n```\n\n----------------------------------------\n\nTITLE: Checking System Shutdown Without Logon in Windows Registry\nDESCRIPTION: Verifies that 'Shutdown: Allow system to be shut down without having to log on' is disabled. Flags a violation if ShutdownWithoutLogon registry value is set to 1, which would allow unauthorized system shutdown.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_24\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ShutdownWithoutLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Using match_value Function for Array Comparison in Wazuh\nDESCRIPTION: Demonstrates how to use the match_value function to check if an array contains specific values. The example shows how to verify if target_field matches the contents of an array variable.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_25\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: match_value($array)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"array\": [\n    [\n      true,\n      \"hello\",\n      2\n    ]\n  ],\n  \"target_field\": [\n    true,\n    \"hello\",\n    2\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: YAML Definition Reference Usage\nDESCRIPTION: Demonstrates how to reference previously defined definitions in parsing operations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_20\n\nLANGUAGE: yaml\nCODE:\n```\nparse|field:\n    - <$header> from <$source> to <$destination> deny\n```\n\n----------------------------------------\n\nTITLE: Remote Access Tool Detection Rules\nDESCRIPTION: Rules for detecting remote access software like GoToMyPC. Includes executable paths, registry entries, and service configurations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_applications_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\n[Remote Access - GoToMyPC {PCI_DSS: 10.6.1}] [any] []\nf:\\Program Files\\Citrix\\GoToMyPC;\nf:\\Program Files\\Citrix\\GoToMyPC\\g2svc.exe;\nf:\\Program Files\\Citrix\\GoToMyPC\\g2comm.exe;\nf:\\Program Files\\expertcity\\GoToMyPC;\nr:HKLM\\software\\microsoft\\windows\\currentversion\\run -> gotomypc;\nr:HKEY_LOCAL_MACHINE\\software\\citrix\\gotomypc;\nr:HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\services\\gotomypc;\np:r:g2svc.exe;\np:r:g2pre.exe;\n```\n\n----------------------------------------\n\nTITLE: Checking for Squid Proxy Server in RHEL7\nDESCRIPTION: Detects if Squid proxy server is enabled in runlevel directories. Proxy server should be disabled if not required.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_23\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsquid$;\n```\n\n----------------------------------------\n\nTITLE: Detecting Security Issues in User Accounts on Red Hat Linux\nDESCRIPTION: Checks for accounts with empty passwords and non-root accounts with UID 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: text\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Project Settings\nDESCRIPTION: Initial CMake configuration including project name, C++ standard setting, and basic definitions\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(vulnerability_scanner)\n\nenable_testing()\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nadd_definitions(-DPROMISE_TYPE=PromiseType::NORMAL)\n```\n\n----------------------------------------\n\nTITLE: Verifying Randomized Virtual Memory Region Placement in RHEL7\nDESCRIPTION: Checks if randomized virtual memory region placement is enabled by examining the /proc/sys/kernel/randomize_va_space file. This security feature helps prevent certain types of attacks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nf:/proc/sys/kernel/randomize_va_space -> !r:^2$;\n```\n\n----------------------------------------\n\nTITLE: Checking for Empty Password Accounts\nDESCRIPTION: Detects accounts with empty passwords in /etc/shadow.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_34\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Using array_append with Variable Reference in Wazuh Normalization\nDESCRIPTION: Shows successful usage of array_append with a reference to a variable, appending a numeric value to an array of floating-point numbers.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_68\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append($any_object)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": 2,\n  \"target_field\": [\n    1.2,\n    2.3,\n    3.5,\n    4.9\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": 2,\n  \"target_field\": [\n    1.2,\n    2.3,\n    3.5,\n    4.9,\n    2\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Identifying Enabled Boot Services in Red Hat Linux\nDESCRIPTION: Detects various enabled boot services such as Samba, NFS, NIS, NetFS, Apache, TUX, SNMPD, DNS, MySQL, PostgreSQL, Webmin, Squid, and Kudzu.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: text\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\nd:$rc_dirs -> ^S\\d\\dypbind$;\nd:$rc_dirs -> ^S\\d\\dypserv$;\nd:$rc_dirs -> ^S\\d\\dnetfs$;\nd:$rc_dirs -> ^S\\d\\dapache$;\nd:$rc_dirs -> ^S\\d\\dhttpd$;\nd:$rc_dirs -> ^S\\d\\dtux$;\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\nd:$rc_dirs -> ^S\\d\\dnamed$;\nd:$rc_dirs -> ^S\\d\\dmysqld$;\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\nd:$rc_dirs -> ^S\\d\\dwebmin$;\nd:$rc_dirs -> ^S\\d\\dsquid$;\nd:$rc_dirs -> ^S\\d\\dkudzu$;\n```\n\n----------------------------------------\n\nTITLE: Checking Field Existence in YAML\nDESCRIPTION: Checks whether the specified field exists in the event. The function evaluates to true if the field exists, otherwise it's false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_8\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: exists()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": 1234\n}\n```\n\n----------------------------------------\n\nTITLE: Using array_append_any with Variable References in Wazuh\nDESCRIPTION: Shows how array_append_any handles variable references, including null values. Only the valid non-null reference is appended to the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_70\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_any($any_object, $any_object_2)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": null,\n  \"any_object_2\": 6,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": null,\n  \"any_object_2\": 6,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    6\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off downloading of print drivers over HTTP' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off downloading of print drivers over HTTP' setting is enabled in the Windows registry. This check ensures that downloading print drivers over HTTP is disabled for enhanced security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_214\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Creating Static Library for Queue Implementation in CMake\nDESCRIPTION: Defines a static library 'queue' with its source file, include directories, and dependencies including the interface library and external libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/queue/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\n# # Queue\nadd_library(queue STATIC\n  ${SRC_DIR}/concurrentQueue.cpp)\n\n# target_link_libraries(queue\ntarget_include_directories(queue\n  PUBLIC\n  ${INC_DIR}\n  ${CameronQueue_SOURCE_DIR}\n)\n\ntarget_link_libraries(queue\n  PUBLIC\n  base # Only for the loggin\n  queue::iqueue\n  unofficial-concurrentqueue::concurrentqueue\n  metrics::imetrics\n)\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Engine Unit and Component Tests\nDESCRIPTION: Command to run all unit and component tests for the Wazuh Engine using CTest, with parallelization based on the number of processor cores.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-tests.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ncd ${WAZUH_REPO_DIR}/src/engine/build\nctest -j$(nproc)\n```\n\n----------------------------------------\n\nTITLE: Checking User-mounted Removable Devices\nDESCRIPTION: Detects configuration allowing user-mounted removable devices (CD-ROM and floppy) on the console.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Using array_not_contains Function in Wazuh Rules\nDESCRIPTION: The array_not_contains function verifies that none of the specified elements exist in a target array. It accepts multiple data types as arguments and provides the inverse functionality of array_contains.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nfield: array_not_contains(element, [...])\n```\n\n----------------------------------------\n\nTITLE: Checking xinetd Service Configurations in SLES12\nDESCRIPTION: These rules check for various xinetd services that should be disabled according to CIS benchmarks. It looks for specific configuration files and checks if the services are enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/talk -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/chargen-udp -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/chargen -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/daytime-udp -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/daytime -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/echo-udp -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/echo -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/discard-udp -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/discard -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/time-udp -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/time -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Generating JSON Mapping File in Python\nDESCRIPTION: Command to generate the JSON mapping file that contains API integration test mappings. Running this command creates 'integration_test_api_endpoints.json' in the script directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/mapping/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npython3 _test_mapping.py\n```\n\n----------------------------------------\n\nTITLE: Deleting Object Fields with delete() Function in Wazuh\nDESCRIPTION: Demonstrates using delete() to remove an object field from an event.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_79\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: delete()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": {\n    \"key\": \"value\"\n  }\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Setup Event Log Behavior Settings in Registry\nDESCRIPTION: Registry check to verify the Setup Event Log behavior when log file reaches maximum size is disabled as required by CIS benchmark 18.9.26.3.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_74\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring General Restrictions in YAML\nDESCRIPTION: Example of setting general restrictions between arguments with brief and details.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_5\n\nLANGUAGE: yaml\nCODE:\n```\ngeneral_restrictions:\n  - brief: some restriction brief\n    arguments:\n      argument_id: some_value\n      argument_id: some_value\n    details: some restriction detail\n```\n\n----------------------------------------\n\nTITLE: Decoding Bitmask Using KVDB in YAML\nDESCRIPTION: This snippet shows how to use the kvdb_decode_bitmask function to decode values based on a bitmask using a reference table from KVDB. It's used in the map stage of normalization.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_85\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_decode_bitmask('testing', 'test_bitmask', $mask)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Log File Path\nDESCRIPTION: Verifies that Windows Firewall Public Profile log file path is set to %SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log according to CIS benchmark 9.3.7. Checks both policy and system registry locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_62\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Default Permissions in Windows Registry\nDESCRIPTION: Verifies that 'System objects: Strengthen default permissions of internal system objects' is enabled. Checks if ProtectionMode registry value is set to 1 to ensure stronger security for internal system objects like symbolic links.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_26\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager -> ProtectionMode -> !1;\n```\n\n----------------------------------------\n\nTITLE: Starting Wazuh Server with Systemd\nDESCRIPTION: Starts the Wazuh Server service using systemd service management.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-server.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nsystemctl start wazuh-server\n```\n\n----------------------------------------\n\nTITLE: Setting up Build Environment for Wazuh Agent in Dockerfile\nDESCRIPTION: This Dockerfile sets up a build environment using Alpine Linux, installs dependencies, clones the Wazuh repository, and compiles the Wazuh agent. It then creates a minimal runtime image with the compiled agent.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/build-image.md#2025-04-17_snippet_0\n\nLANGUAGE: Dockerfile\nCODE:\n```\nFROM alpine:3.14 as builder\n\nARG WAZUH_VERSION=v4.3.10\nARG WAZUH_TAG=4.3.10\n\nWORKDIR /wazuh\n\nRUN apk add --no-cache \\\n    git \\\n    make \\\n    gcc \\\n    g++ \\\n    libc-dev \\\n    libstdc++ \\\n    tar \\\n    openssl-dev \\\n    procps \\\n    linux-headers \\\n    cmake \\\n    sqlite-dev \\\n    msgpack-c-dev \\\n    libmcrypt-dev \\\n    readline-dev \\\n    && git clone --branch $WAZUH_VERSION --single-branch https://github.com/wazuh/wazuh.git . \\\n    && cd src \\\n    && make deps \\\n    && make -j$(nproc) TARGET=agent USE_AUDIT=no USE_SELINUX=no DISABLE_SHARED=yes USE_FRAMEWORK_LIB=no \\\n    && make -j$(nproc) install INSTALLDIR=/wazuh-install DISABLE_SHARED=yes USE_FRAMEWORK_LIB=no\n\nFROM alpine:3.14\n\nCOPY --from=builder /wazuh-install /wazuh-install\n\nRUN apk add --no-cache \\\n    procps \\\n    libstdc++ \\\n    libgcc \\\n    openssl \\\n    sqlite-libs\n\nWORKDIR /wazuh-install\n\nCMD [\"/wazuh-install/bin/wazuh-control\", \"start\"]\n```\n\n----------------------------------------\n\nTITLE: Executing Engine Health Test in Python\nDESCRIPTION: This snippet shows the location of the engine-health-test tool, which performs comprehensive health checks on the Wazuh ruleset. It runs automated tests to ensure the ruleset operates as expected.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/internal-tools.md#2025-04-17_snippet_0\n\nLANGUAGE: Python\nCODE:\n```\nsrc/engine/test/health_test/engine-health-test\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Protocol Configuration\nDESCRIPTION: Checks if SSH Protocol version 1 is enabled in sshd configuration. Based on CIS benchmark 6.2.1 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH IgnoreRhosts Configuration\nDESCRIPTION: Verifies if SSH IgnoreRhosts is disabled, which is a security risk according to CIS benchmark 6.2.6\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Building Regex Benchmark Executable with CMake\nDESCRIPTION: Creates a CMake build configuration that compiles a regex benchmarking executable and links it with required dependencies. The executable is built from regex_bench.cpp and linked against Google Benchmark and RE2 libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/regex/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\n# Configuration regex test\nadd_executable(regex_bench\n  regex_bench.cpp\n)\n\n# Build benchmarks\ntarget_link_libraries(regex_bench benchmark::benchmark_main re2::re2)\n```\n\n----------------------------------------\n\nTITLE: Checking xinetd Services for Security Vulnerabilities\nDESCRIPTION: Examines various xinetd service configurations to ensure potentially insecure services like telnet, FTP, rsh/rlogin/rcp, tftpd, imap, and pop3 are disabled as recommended by CIS benchmark.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: plaintext\nCODE:\n```\n[CIS - Red Hat Linux - 2.3 - Telnet enabled on xinetd {CIS: 2.3 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/telnet -> !r:^# && r:disable && r:no;\n\n[CIS - Red Hat Linux - 2.4 - VSFTP enabled on xinetd {CIS: 2.4 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/vsftpd -> !r:^# && r:disable && r:no;\n\n[CIS - Red Hat Linux - 2.4 - WU-FTP enabled on xinetd {CIS: 2.4 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/wu-ftpd -> !r:^# && r:disable && r:no;\n\n[CIS - Red Hat Linux - 2.5 - rsh/rlogin/rcp enabled on xinetd {CIS: 2.5 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.c/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.c/shell -> !r:^# && r:disable && r:no;\n\n[CIS - Red Hat Linux - 2.6 - tftpd enabled on xinetd {CIS: 2.6 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/tftpd -> !r:^# && r:disable && r:no;\n\n[CIS - Red Hat Linux - 2.7 - imap enabled on xinetd {CIS: 2.7 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/imap -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.c/imaps -> !r:^# && r:disable && r:no;\n\n[CIS - Red Hat Linux - 2.8 - pop3 enabled on xinetd {CIS: 2.8 Red Hat Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/xinetd.c/ipop3 -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.c/pop3s -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Configuration Settings\nDESCRIPTION: Validates User Account Control (UAC) settings including admin approval mode, elevation prompts, and virtualization settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> FilterAdministratorToken -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableVirtualization -> 0;\n```\n\n----------------------------------------\n\nTITLE: Partition Mount Options Check\nDESCRIPTION: Rules to validate mount options and partition configurations for security compliance\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:/tmp && !r:nodev;\nf:/etc/fstab -> !r:^# && r:/tmp && !r:nosuid;\nf:/etc/fstab -> !r:^# && r:/tmp && !r:noexec;\nf:/etc/fstab -> !r^# && !r:/var;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Outbound Connections Setting\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to allow outbound connections by default according to CIS benchmark 9.3.3. Checks both policy and system registry paths.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_58\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Reveal Button Settings in Registry\nDESCRIPTION: Registry checks to verify that 'Do not display the password reveal button' is enabled as required by CIS benchmark 18.9.15.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_68\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> DisablePasswordReveal -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> !DisablePasswordReveal;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Wazuh Components\nDESCRIPTION: Sets up CMake build configuration with minimum version requirement and adds subdirectories for various Wazuh components including scanner, database feed manager, and database query modules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nadd_subdirectory(scanner)\nadd_subdirectory(databaseFeedManager)\nadd_subdirectory(wazuhDBQuery)\nadd_subdirectory(rocksDBQuery)\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Schema Tool\nDESCRIPTION: Command to install the engine-schema tool via pip from the engine-suite package.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_schema/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip install wazuh/src/engine/tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Legacy Service Security Checks\nDESCRIPTION: Rules to verify that potentially dangerous legacy services like telnet, rsh, and NIS are properly disabled in xinetd configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/shell -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Defining Beagle Worm Detection Rules\nDESCRIPTION: Rules to detect the Beagle Worm by checking for specific files with multiple 'open' suffixes. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: text\nCODE:\n```\n[Beagle worm {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\winxp.exe;\nf:%WINDIR%\\Sysnative\\winxp.exe;\nf:%WINDIR%\\System32\\winxp.exeopen;\nf:%WINDIR%\\Sysnative\\winxp.exeopen;\nf:%WINDIR%\\System32\\winxp.exeopenopen;\nf:%WINDIR%\\Sysnative\\winxp.exeopenopen;\nf:%WINDIR%\\System32\\winxp.exeopenopenopen;\nf:%WINDIR%\\Sysnative\\winxp.exeopenopenopen;\nf:%WINDIR%\\System32\\winxp.exeopenopenopenopen;\nf:%WINDIR%\\Sysnative\\winxp.exeopenopenopenopen;\n```\n\n----------------------------------------\n\nTITLE: Multiplication of Two Integers using int_calculate in Wazuh\nDESCRIPTION: Demonstrates multiplying two integers using int_calculate. The operation is performed successfully and the result is stored in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_54\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('mul', $operand_left, $operand_right)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": -45,\n  \"operand_right\": 2\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": -45,\n  \"operand_right\": 2,\n  \"target_field\": -90\n}\n```\n\n----------------------------------------\n\nTITLE: Deleting String Fields with delete() Function in Wazuh\nDESCRIPTION: Shows how the delete() function is used to remove a string field from an event.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_78\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: delete()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"-- Hi wazuh! --\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Virtualization Settings in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Virtualize file and registry write failures to per-user locations' is enabled. Checks if EnableVirtualization registry value is set to 1 to maintain compatibility with legacy applications.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_35\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableVirtualization -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging File Path\nDESCRIPTION: Verifies that Windows Firewall Private Profile logging file path is correctly set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' by checking registry keys using regular expressions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_34\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Setting up Directory Variables in CMake\nDESCRIPTION: Defines variables for source, include, and interface directories used throughout the CMake configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/metrics/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n```\n\n----------------------------------------\n\nTITLE: Agent ossec.conf Template Structure in XML\nDESCRIPTION: The configuration template structure for Wazuh agent components. It includes client settings for connecting to the manager server, buffer configuration, and various monitoring modules like rootcheck, syscollector, and syscheck.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/config/README.md#2025-04-17_snippet_1\n\nLANGUAGE: xml\nCODE:\n```\n<ossec_config>\n    <client>\n      <server>\n        <address>192.168.10.100</address>\n      </server>\n      <config-profile>distribution, distributionVersion</config-profile>\n    </client>\n    <client_buffer>\n      <!-- Agent buffer options -->\n      <disabled>no</disabled>\n      <queue_size>5000</queue_size>\n      <events_per_second>500</events_per_second>\n    </client_buffer>\n\n    logging.template\n\n    rootcheck.template\n\n    wodle-openscap.template\n\n    wodle-syscollector.template\n\n    syscheck.template\n\n    localfile-logs*\n\n    localfile-commands.template\n\n    localfile-extra.template\n\n    <active-response>\n      <disabled>no</disabled>\n    </active-response>\n</ossec_config>\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Local Firewall Rules Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Apply local firewall rules' is set to 'Yes' by checking registry keys. This check ensures the Windows Firewall will properly apply local firewall rules in the domain profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_40\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Starting Wazuh Server with SysV Init\nDESCRIPTION: Starts the Wazuh Server using the traditional SysV init script method.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-server.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nservice wazuh-server start\n```\n\n----------------------------------------\n\nTITLE: Decoding Hexadecimal to ASCII with 'decode_base16' in Wazuh\nDESCRIPTION: Demonstrates the 'decode_base16' function which converts a hexadecimal string into its corresponding ASCII representation. The function maps the result to the specified target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_49\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: decode_base16($hex)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"hex\": \"48656C6C6F20776F726C6421\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"hex\": \"48656C6C6F20776F726C6421\",\n  \"target_field\": \"Hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Integer Not Equal Check\nDESCRIPTION: Validates if a numeric field is not equal to 22. Shows successful and failed validation examples.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_17\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_not_equal(22)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": 2\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_not_equal($any_number)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_number\": 22,\n  \"target_field\": 22\n}\n```\n\n----------------------------------------\n\nTITLE: Checking for MySQL Command History\nDESCRIPTION: This check ensures that MySQL command history is disabled by looking for .mysql_history files in home directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_enterprise_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 1.3: Disable MySQL Command History] [any] [https://workbench.cisecurity.org/files/1310/download]\nd:$home_dirs -> ^.mysql_history$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile State\nDESCRIPTION: Verifies that Windows Firewall Public Profile is enabled according to CIS benchmark 9.3.1. Checks both policy and system registry paths for the EnableFirewall value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_56\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Application Installation Detection in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Detect application installations and prompt for elevation' is enabled. Checks if EnableInstallerDetection registry value is set to 1 to ensure proper elevation for installation activities.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_31\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableInstallerDetection -> 0;\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !EnableInstallerDetection;\n```\n\n----------------------------------------\n\nTITLE: Creating Logic Expression Benchmark Executable in CMake\nDESCRIPTION: This CMake snippet creates an executable named 'logicExpression_benchmarks' from the source file 'evaluator_bench.cpp'. It then links the executable with the benchmark main library and a custom 'logicexpr' library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/logicExpression/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_executable(logicExpression_benchmarks\n  evaluator_bench.cpp\n)\n\ntarget_link_libraries(logicExpression_benchmarks benchmark::benchmark_main logicexpr)\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off printing over HTTP' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off printing over HTTP' setting is enabled in the Windows registry. This check ensures that printing over HTTP is disabled for enhanced security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_210\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer User Control Configuration\nDESCRIPTION: Verifies that 'Allow user control over installs' is disabled by checking if the EnableUserControl registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_84\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Safe DLL Search Mode\nDESCRIPTION: Registry check to verify that 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode' is set to 'Enabled' per CIS benchmark 18.3.8. The check confirms that SafeDllSearchMode is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_79\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Rule Schema Visualization with Mermaid\nDESCRIPTION: A Mermaid diagram showing the structure of a rule in the Wazuh security engine. It illustrates the components of a rule including name, metadata, parents, checks, and rule_enrichment stages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_27\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Rule schema\n---\nkanban\n  Rule[Rule schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    assetParents[\"parents\"]\n    assetChecks[\"checks\"]\n    ruleNormalize[\"rule_enrichment\"]\n```\n\n----------------------------------------\n\nTITLE: Checking Solicited Remote Assistance Settings in Registry\nDESCRIPTION: Registry checks to ensure that 'Configure Solicited Remote Assistance' is disabled as required by CIS benchmark 18.8.31.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_63\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Defining KVDB Library Directories in CMake\nDESCRIPTION: Sets up directory variables for source, include, and interface files of the KVDB library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/kvdb/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n```\n\n----------------------------------------\n\nTITLE: Running All Wazuh Health Tests (Bash)\nDESCRIPTION: This command runs all health suite tests. It requires a pre-built environment and can only be run once without recreating the environment due to asset and database loading during execution.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_10\n\nLANGUAGE: bash\nCODE:\n```\nengine-health-test run_all -e health_test/environment -r ruleset -t health_test_directory\n```\n\n----------------------------------------\n\nTITLE: Configuring Unix Utils Unit Test Build\nDESCRIPTION: Sets up build configuration for Unix-like systems (Linux and macOS), with platform-specific source files and library dependencies. Includes special handling for Apple systems.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/utils/tests/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nelse()\n    if (APPLE)\n      add_executable(utils_unit_test\n        ${UTIL_CXX_UNITTEST_COMMON_SRC}\n        ${UTIL_CXX_UNITTEST_CPP17_SRC}\n      )\n    else()\n      add_executable(utils_unit_test\n        ${UTIL_CXX_UNITTEST_COMMON_SRC}\n        ${UTIL_CXX_UNITTEST_LINUX_SRC}\n        ${UTIL_CXX_UNITTEST_CPP17_SRC}\n      )\n    endif(APPLE)\n\n    target_link_libraries(utils_unit_test\n        debug gtestd\n        debug gmockd\n        optimized gtest\n        optimized gmock\n        rocksdb\n        crypto\n        dl\n        pthread\n        rt\n        lzma\n        z\n        minizip\n        archive\n    )\n```\n\n----------------------------------------\n\nTITLE: Template Search Algorithm Example\nDESCRIPTION: An example demonstrating how the template search algorithm works. It follows a hierarchical path based on distribution and version, starting with the most specific template and falling back to more generic ones if the specific template is not found.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/config/README.md#2025-04-17_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\n_GetTemplate \"syscheck.manager.template\" \"centos\" \"7\"_\n\n    1º centos/7/syscheck.manager.template\n    2º centos/7/syscheck.template\n    3º centos/syscheck.template\n    4º generic/syscheck.template\n```\n\n----------------------------------------\n\nTITLE: Checking Startup Services in SLES12\nDESCRIPTION: These rules check for various services that should not be enabled at startup according to CIS benchmarks. It looks for startup scripts in the rc directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\nd:$rc_dirs -> ^S\\d\\dapache2$;\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\nd:$rc_dirs -> ^S\\d\\dsquid$;\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\nd:$rc_dirs -> ^S\\d\\drsyncd$;\n```\n\n----------------------------------------\n\nTITLE: Checking Root Login Permission in SSH Configuration\nDESCRIPTION: Verifies that root login is disabled in the SSH configuration for improved security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 3: Root can log in] [any] [3]\nf:$sshd_file -> !r:^\\s*PermitRootLogin\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Configuring Filesystem Library Build in CMake\nDESCRIPTION: Configures a static library build with archive, XZ compression and hash helper components. Sets up include directories and links required external dependencies including LibArchive and LZMA. Includes test configuration when ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/fs/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nproject(filesystem)\n\nenable_testing()\n\n####################################################################################################\n# FS\n####################################################################################################\n# Defs\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n\nadd_library(fs_ifs INTERFACE)\ntarget_include_directories(fs_ifs INTERFACE ${IFACE_DIR})\nadd_library(fs::ifs ALIAS fs_ifs)\n\nadd_library(${PROJECT_NAME} STATIC\n    ${SRC_DIR}/archiveHelper.cpp\n    ${SRC_DIR}/xzHelper.cpp\n    ${SRC_DIR}/hashHelper.cpp\n)\ntarget_include_directories(${PROJECT_NAME}\n    PUBLIC\n    ${INC_DIR}\n\n    PRIVATE\n    ${INC_DIR}/xz\n    ${SRC_DIR}\n)\ntarget_link_libraries(${PROJECT_NAME}\n    PUBLIC\n    fs::ifs\n    PRIVATE\n    liblzma::liblzma\n    LibArchive::LibArchive\n)\n\n# Tests\nif(ENGINE_BUILD_TEST)\n    set(TEST_DIR ${CMAKE_CURRENT_LIST_DIR}/test)\n    set(TEST_SRC_DIR ${TEST_DIR}/src)\n    set(INPUT_FILES ${TEST_DIR}/input_files)\n\n    file(COPY ${INPUT_FILES} DESTINATION ${CMAKE_CURRENT_BINARY_DIR})\n\n    add_executable(${PROJECT_NAME}_utest\n        ${TEST_SRC_DIR}/archiveHelper_test.cpp\n        ${TEST_SRC_DIR}/hashHelper_test.cpp\n        ${TEST_SRC_DIR}/xzHelper_test.cpp\n    )\n\n    target_link_libraries(${PROJECT_NAME}_utest\n        PRIVATE\n        ${PROJECT_NAME}\n        GTest::gtest_main\n        RocksDB::rocksdb\n        CURL::libcurl\n        filesystem\n    )\n    gtest_discover_tests(${PROJECT_NAME}_utest)\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Using string_less_or_equal with Equal Values in Wazuh\nDESCRIPTION: Shows that string_less_or_equal returns true when the strings are equal. Unlike string_less, this function handles equality as a successful comparison.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_41\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_less_or_equal('hello world!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Using array_append_unique with Variable References in Wazuh\nDESCRIPTION: Demonstrates how array_append_unique with a variable reference fails when the referenced value already exists in the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_73\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_unique($any_object)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": 5,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": 5,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Elevation Prompt Behavior for Standard Users in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for standard users' is configured to automatically deny elevation requests. Checks if ConsentPromptBehaviorUser registry value is set properly.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_30\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorUser;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Error Reporting' Registry Setting\nDESCRIPTION: Verifies if the 'Disabled' registry key is set to 1 to disable Windows Error Reporting.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_172\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Builder Images Workflow Configuration\nDESCRIPTION: JSON configuration for the builder images workflow, specifying package parameters like architecture and system type.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/packages/README.md#2025-04-17_snippet_2\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"ref\":\"4.9.0\",\n    \"inputs\":\n        {\n         \"tag\":\"auto\",\n         \"architecture\":\"amd64\",\n         \"system\":\"rpm\",\n         \"revision\":\"test\",\n         \"is_stage\":\"false\",\n         \"legacy\":\"false\"\n        }\n}\n```\n\n----------------------------------------\n\nTITLE: Engine Catalog CLI Usage\nDESCRIPTION: Comprehensive command-line interface documentation showing all available options and subcommands for the engine-catalog tool.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_catalog/README.md#2025-04-17_snippet_3\n\nLANGUAGE: console\nCODE:\n```\nengine-catalog [-h] [--version] [--api-socket API_SOCKET] [-n NAMESPACE] [--format {json,yml,yaml}] {delete,get,update,create,validate,load} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --api-socket API_SOCKET\n                        Path to the Wazuh API socket\n  -n NAMESPACE, --namespace NAMESPACE\n                        Namespace to use for the catalog\n  --format {json,yml,yaml}\n                        Input/Output format\n\nsubcommands:\n  {delete,get,update,create,validate,load}\n    delete              delete asset-type[/asset-name[/version]]: Delete an asset or a collection.\n    get                 Get asset-type[/asset-id[/item-version]]: Get an asset or list a collection.\n    update              Update an asset.\n    create              Create an asset.\n    validate            validate an asset.\n    load                Load item-type path: Tries to create and add all the items found in the path to the collection.\n```\n\n----------------------------------------\n\nTITLE: Visualizing Output Schema with Mermaid\nDESCRIPTION: Mermaid diagram illustrating the schema structure of Output assets in Wazuh security policies, showing key components like name, metadata, parents, checks, and output stage.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_28\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Output schema\n---\nkanban\n  Output[Output schema]\n    assetName[\"name\"]@{ priority: 'Very Low'}\n    assetMetadata[\"metadata\"]@{ priority: 'Very Low'}\n    assetParents[\"parents\"]\n    assetChecks[\"checks\"]\n    OutputNormalize[\"output stage\"]\n```\n\n----------------------------------------\n\nTITLE: Defining MySQL Configuration File Locations\nDESCRIPTION: This snippet defines variables for home directories, environment files, and MySQL configuration file locations. These variables are used in subsequent security checks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_enterprise_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$home_dirs=/usr2/home/*,/home/*,/home,/*/home/*,/*/home,/;\n$enviroment_files=/*/home/*/\\.bashrc,/*/home/*/\\.profile,/*/home/*/\\.bash_profile,/home/*/\\.bashrc,/home/*/\\.profile,/home/*/\\.bash_profile;\n$mysql-cnfs=/etc/mysql/my.cnf,/etc/mysql/mariadb.cnf,/etc/mysql/conf.d/*.cnf,/etc/mysql/mariadb.conf.d/*.cnf,~/.my.cnf;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Inbound Connections Setting\nDESCRIPTION: Ensures that Windows Firewall Public Profile is configured to block inbound connections by default according to CIS benchmark 9.3.2. Examines registry settings in both policy and system locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_57\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Appending Values to Arrays with array_append in Wazuh Normalization\nDESCRIPTION: Demonstrates using array_append to add values to an array field. If the operation fails when appending values that don't match the array element type, as shown in this example where the operation errors.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_67\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append([1, 2])\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Network Security Authentication Settings\nDESCRIPTION: Validates network security settings including LAN Manager authentication levels, NTLM SSP security, and Kerberos encryption types.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters -> SupportedEncryptionTypes -> !2147483644;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Allow Basic authentication' for WinRM Service Registry Setting\nDESCRIPTION: Checks if 'AllowBasic' is set to 0 (Disabled) for WinRM service to prevent Basic authentication which sends credentials in plain text.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_133\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Secure Locations for UIAccess Applications in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is enabled. Checks if EnableSecureUIAPaths registry value is set to 1 to limit elevation to applications in trusted locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_32\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableSecureUIAPaths -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Last User Name Display Settings in Windows Registry\nDESCRIPTION: This snippet verifies if 'Interactive logon: Do not display last user name' is set to 'Enabled'. It aligns with CIS Benchmark 2.3.7.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DontDisplayLastUserName;\n```\n\n----------------------------------------\n\nTITLE: Checking RPC Endpoint Mapper Client Authentication\nDESCRIPTION: Ensures that RPC Endpoint Mapper Client Authentication is enabled by checking if 'EnableAuthEpResolution' is not set to 1 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_99\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> EnableAuthEpResolution -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> !EnableAuthEpResolution;\n```\n\n----------------------------------------\n\nTITLE: P2P Software Detection Rules\nDESCRIPTION: Rules for detecting peer-to-peer file sharing applications including UTorrent, LimeWire, BitTorrent, and Kazaa. Includes registry keys, file paths, and running processes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_applications_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\n[P2P - UTorrent {PCI_DSS: 10.6.1}] [any] []\np:r:utorrent.exe;\n\n[P2P - LimeWire {PCI_DSS: 11.4}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Limewire;\nr:HKLM\\software\\microsoft\\windows\\currentversion\\run -> limeshop;\nf:\\Program Files\\limewire;\nf:\\Program Files\\limeshop;\n```\n\n----------------------------------------\n\nTITLE: HTTP Print Driver Download Registry Check\nDESCRIPTION: Registry check to ensure downloading of print drivers over HTTP is disabled per CIS benchmark 18.8.20.1.2\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_324\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Engine Test Usage Commands\nDESCRIPTION: Main command usage showing available options and subcommands for the engine-test tool.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-test [-h] [-c CONFIG_FILE] [-v] {run,add,get,list,delete} ...\n\noptions:\n  -h, --help            show this help message and exit\n  -c CONFIG_FILE, --config CONFIG_FILE\n                        Configuration file. Default: /var/ossec/etc/engine-test.conf\n  -v, --version         show program's version number and exit\n\nsubcommands:\n  {run,add,get,list,delete}\n    run                 Run integration\n    add                 Add integration\n    get                 Get integration\n    list                List of integrations\n    delete              Delete integration\n```\n\n----------------------------------------\n\nTITLE: Setting Up Base Library Unit Tests in CMake\nDESCRIPTION: Configures unit tests for the 'base' library when ENGINE_BUILD_TEST is enabled. It sets up test directories, creates a test interface library, and defines test executables with their source files and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/base/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_DIR ${CMAKE_CURRENT_LIST_DIR}/test)\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\nadd_library(base_test INTERFACE)\ntarget_include_directories(base_test INTERFACE ${TEST_DIR}/include)\ntarget_link_libraries(base_test INTERFACE base GTest::gmock)\nadd_library(base::test ALIAS base_test)\n\nadd_executable(base_utest\n    ${UNIT_SRC_DIR}/stringUtils_test.cpp\n    ${UNIT_SRC_DIR}/ipUtils_test.cpp\n    ${UNIT_SRC_DIR}/result_test.cpp\n    ${UNIT_SRC_DIR}/graph_test.cpp\n    ${UNIT_SRC_DIR}/name_test.cpp\n    ${UNIT_SRC_DIR}/utils/wazuhProtocol/wazuhRequest_test.cpp\n    ${UNIT_SRC_DIR}/utils/wazuhProtocol/wazuhResponse_test.cpp\n    ${UNIT_SRC_DIR}/utils/rocksDBSafeQueuePrefix_test.cpp\n    ${UNIT_SRC_DIR}/utils/rocksDBSafeQueue_test.cpp\n    ${UNIT_SRC_DIR}/utils/rocksDBWrapper_test.cpp\n    ${UNIT_SRC_DIR}/utils/threadEventDispatcher_test.cpp\n    ${UNIT_SRC_DIR}/utils/threadSafeQueue_test.cpp\n    ${UNIT_SRC_DIR}/utils/timeUtils_test.cpp\n    ${UNIT_SRC_DIR}/dotPath_test.cpp\n    ${UNIT_SRC_DIR}/json_test.cpp\n    ${UNIT_SRC_DIR}/error_test.cpp\n    ${UNIT_SRC_DIR}/timer_test.cpp\n    ${UNIT_SRC_DIR}/expression_test.cpp\n    ${UNIT_SRC_DIR}/utils/singletonLocator_test.cpp\n    ${UNIT_SRC_DIR}/utils/keyValue_test.cpp\n    ${UNIT_SRC_DIR}/utils/evpHelper_test.cpp\n)\ntarget_include_directories(base_utest\n    PRIVATE\n    ${TEST_SRC_DIR}\n    ${SRC_DIR}\n    ${INC_DIR}/base\n)\ntarget_link_libraries(base_utest\n    PUBLIC\n    base::test\n\n    PRIVATE\n    base\n    GTest::gtest_main\n    RocksDB::rocksdb\n    OpenSSL::Crypto\n    OpenSSL::SSL\n)\ngtest_discover_tests(base_utest)\n\n# TODO this test needs to be instantiated alone because the logger is initialized on tests\nadd_executable(base_logger_utest\n    ${UNIT_SRC_DIR}/logger_test.cpp\n)\ntarget_include_directories(base_logger_utest\n    PRIVATE\n    ${TEST_SRC_DIR}\n    ${INC_DIR}/base\n)\ntarget_link_libraries(base_logger_utest\n    PRIVATE\n    base\n    GTest::gtest_main\n)\ngtest_discover_tests(base_logger_utest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Transcription Configuration\nDESCRIPTION: Verifies that 'Turn on PowerShell Transcription' is disabled by checking if the EnableTranscripting registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_88\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription -> EnableTranscripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Client Session Security in Windows Registry\nDESCRIPTION: Verifies that 'Network security: Minimum session security for NTLM SSP based clients' is configured correctly. Checks if NTLMMinClientSec registry value is set to 537395200 for proper NTLMv2 session security and 128-bit encryption.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_22\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinClientSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinClientSec;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Windows CEIP\nDESCRIPTION: Registry check to ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled'. Validates the CEIPEnable registry value equals 0 or exists in the SQMClient Windows policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_241\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Configuring Sanitizer Flags\nDESCRIPTION: Conditionally adds sanitizer flags for debug builds when FSANITIZE is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(FSANITIZE)\n  set(CMAKE_CXX_FLAGS_DEBUG \"-g -fsanitize=address,leak,undefined\")\nendif(FSANITIZE)\n```\n\n----------------------------------------\n\nTITLE: File Downloader Component Implementation - C++\nDESCRIPTION: The file downloader component is responsible for downloading files from URLs and managing their storage. It supports compressed and uncompressed files, calculates file hashes to prevent duplicate processing, and updates the context with download paths. Files are stored in either a Downloads folder (compressed) or Contents folder (uncompressed).\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/FILE_DOWNLOADER.md#2025-04-17_snippet_0\n\nLANGUAGE: cpp\nCODE:\n```\n// Relevant file paths:\n// src/components/fileDownloader.hpp\n// src/components/updaterContext.hpp\n\n// Key context fields:\nstruct Context {\n    struct ConfigData {\n        string url;              // Source URL for file download\n        string compressionType;   // Indicates if file is compressed\n    };\n    string downloadsFolder;      // Output path for compressed files\n    string contentsFolder;       // Output path for uncompressed files \n    json data;                  // Contains paths and stage status\n    string outputFolder;         // Base path for destination files\n    string downloadedFileHash;   // Hash of last processed file\n};\n```\n\n----------------------------------------\n\nTITLE: CIS Basic System Validation Check\nDESCRIPTION: Verifies basic system requirements including Debian version file existence and Linux kernel type.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/debian_version;\nf:/proc/sys/kernel/ostype -> Linux;\n```\n\n----------------------------------------\n\nTITLE: Parsing Delimiter-Separated Values in YAML\nDESCRIPTION: Demonstrates the parse_dsv function for extracting values separated by a custom delimiter. It specifies delimiter, quote, and escape characters, along with output field names.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_109\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_dsv($input_field, '|', \"'\", '\\\\', 'out1', 'out2')\n```\n\n----------------------------------------\n\nTITLE: Path Structure Before Decompression\nDESCRIPTION: Shows the initial paths structure before the zip file is decompressed, containing the path to the downloaded zip file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/ZIP_DECOMPRESSOR.md#2025-04-17_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n\"paths\": [\n    \"/tmp/outputFolder/downloads/file.zip\"\n]\n```\n\n----------------------------------------\n\nTITLE: Mixing Literal and Reference Values with array_append_unique_any in Wazuh\nDESCRIPTION: Demonstrates array_append_unique_any with both literal and reference values, successfully adding only values that are unique to the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_77\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_unique_any(5, $any_object_2)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object_2\": null,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object_2\": null,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive Logon Cache Limit in Windows Registry\nDESCRIPTION: This snippet checks if the 'Interactive logon: Number of previous logons to cache' setting is set to 4 or fewer. It looks for values greater than 4 or the absence of the setting in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> a;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> b;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> c;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> e;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> f;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> \\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> !CachedLogonsCount;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Registration if URL connection is referring to Microsoft.com' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off Registration if URL connection is referring to Microsoft.com' setting is enabled in the Windows registry. This check ensures that registration is disabled when the URL refers to Microsoft.com.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_211\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Parsing Quoted Strings in Wazuh Normalization (YAML)\nDESCRIPTION: The parse_quoted function is used to parse quoted strings in the Wazuh normalization process. While specific details are not provided, it likely extracts content within quotes from the input field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_116\n\nLANGUAGE: yaml\nCODE:\n```\nfield: parse_quoted(input_field, [...])\n```\n\n----------------------------------------\n\nTITLE: Target Field Configuration in YAML\nDESCRIPTION: Examples of configuring target field types and subtypes for filter and transformation helpers.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_6\n\nLANGUAGE: yaml\nCODE:\n```\ntarget_field:\n  type: array\n  generate: string\n```\n\nLANGUAGE: yaml\nCODE:\n```\ntarget_field:\n  type:\n    - number\n    - string\n    - object\n    - boolean\n    - array\n```\n\n----------------------------------------\n\nTITLE: Installing Engine-Geo Script via Pip\nDESCRIPTION: Command to install the engine-suite package, which includes the engine-geo script. It uses pip to install from the local tools directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_geo/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Checking Offer Remote Assistance Configuration\nDESCRIPTION: Ensures that Offer Remote Assistance is disabled by checking if 'fAllowUnsolicited' is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_97\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n```\n\n----------------------------------------\n\nTITLE: Downloading and Setting Up Wazuh Development Container\nDESCRIPTION: Script commands to download, make executable, and run the development container setup script from the Wazuh repository. The script provides a containerized environment for Wazuh engine development with pre-installed dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/devContainer/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncurl -o download_devContainer.sh https://raw.githubusercontent.com/wazuh/wazuh/main/src/engine/tools/devContainer/download_devContainer.sh\nchmod +x download_devContainer.sh\n./download_devContainer.sh -h\n```\n\n----------------------------------------\n\nTITLE: Performing Binary AND Operation in YAML\nDESCRIPTION: Transforms hexadecimal values into unsigned integers and performs an AND operation bit by bit. The operation evaluates to true if the result is other than 0x0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_5\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: binary_and('0x4F1')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"0x1\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking for rsh/rlogin/rcp Services in RHEL7\nDESCRIPTION: Detects if rsh, rlogin, or rcp services are enabled in xinetd or systemd configurations. These are legacy, insecure services that should be disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/shell -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/rexec@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/rlogin@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/rsh@.service -> r:ExecStart;\n```\n\n----------------------------------------\n\nTITLE: Verifying NTP Configuration in RHEL7\nDESCRIPTION: Checks if NTP is properly configured with appropriate restrictions and options. Proper NTP configuration is important for accurate system time and logging.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/ntp.conf -> r:restrict default kod nomodify notrap nopeer noquery && r:^server;\nf:/etc/sysconfig/ntpd -> r:OPTIONS=\"-u ntp:ntp -p /var/run/ntpd.pid\";\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging Size Limit\nDESCRIPTION: Verifies that Windows Firewall Public Profile logging size limit is set to at least 16384 KB by checking registry keys with multiple regular expressions to ensure the value is sufficient.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_35\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Verifying ICMP Redirect Settings in Windows Registry\nDESCRIPTION: Checks if ICMP redirects are disabled to prevent overriding OSPF generated routes in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_43\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> EnableICMPRedirect -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !EnableICMPRedirect;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Digest Authentication Configuration\nDESCRIPTION: Ensures that 'Disallow Digest authentication' for WinRM client is enabled by verifying the AllowDigest registry value is set to 0 or does not exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_91\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowDigest -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> !AllowDigest;\n```\n\n----------------------------------------\n\nTITLE: Coverage Report Configuration in CMake\nDESCRIPTION: Sets up code coverage reporting using lcov and genhtml when ENABLE_COVERAGE_REPORT is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_7\n\nLANGUAGE: cmake\nCODE:\n```\nif(DEFINED ENABLE_COVERAGE_REPORT AND ENABLE_COVERAGE_REPORT)\n    message(STATUS \"Coverage report generation is enabled.\")\n\n    add_custom_target(coverage\n        COMMAND lcov --capture --directory ${CMAKE_BINARY_DIR} --output-file ${CMAKE_BINARY_DIR}/coverage.info --ignore-errors mismatch\n        COMMAND lcov --remove ${CMAKE_BINARY_DIR}/coverage.info '/usr/*' '*/test/*' '*/build/vcpkg_installed/*' --output-file ${CMAKE_BINARY_DIR}/coverage.info --ignore-errors mismatch\n        COMMAND genhtml ${CMAKE_BINARY_DIR}/coverage.info --output-directory ${CMAKE_BINARY_DIR}/coverage_report\n        COMMENT \"Generating coverage report in ${CMAKE_BINARY_DIR}/coverage_report\"\n    )\nelse()\n    message(STATUS \"Coverage report generation is not enabled.\")\nendif()\n```\n\n----------------------------------------\n\nTITLE: Verifying WinRM Remote Server Management Setting in Registry\nDESCRIPTION: Checks that the 'Allow remote server management through WinRM' setting is disabled by verifying the AllowAutoConfig value in the WinRM Service registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_328\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowAutoConfig -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Router Library Build in CMake\nDESCRIPTION: Sets up source directories and creates a static library for the API router component. Configures include directories and links required dependencies including base, api adapter, router interface, and policy interface.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/router/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(api_router STATIC\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_router\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_router\n    PUBLIC\n    base\n    api::adapter\n    router::irouter\n    api::policy::ipolicy\n)\nadd_library(api::router ALIAS api_router)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off downloading of print drivers over HTTP' Setting\nDESCRIPTION: Registry checks to verify if the 'DisableWebPnPDownload' key is set to 1, which disables downloading print drivers over HTTP. Performs two checks - one for incorrect value and one for missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_60\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Interactive Logon Settings Registry Check\nDESCRIPTION: Registry checks to enforce display of last username, CTRL+ALT+DEL requirement, machine inactivity limits, password expiration warnings, and smart card removal behavior.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableCAD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\w\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> ScRemoveOption -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off handwriting personalization data sharing'\nDESCRIPTION: Verifies that the PreventHandwritingDataSharing registry value is set to 1, which prevents the handwriting recognition personalization data from being sent to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_184\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Parsing Double-Precision Floating-Point Numbers in YAML\nDESCRIPTION: Illustrates the use of parse_double function to convert string input to double-precision floating-point numbers. The function attempts to parse the input string as a double value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_108\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_double($input_field)\n```\n\n----------------------------------------\n\nTITLE: Out of Source Build Check Macro\nDESCRIPTION: Implements a macro to ensure builds occur outside the source directory, preventing source tree pollution.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nMACRO(MACRO_ENSURE_OUT_OF_SOURCE_BUILD MSG)\n     STRING(COMPARE EQUAL \"${CMAKE_SOURCE_DIR}\"\n     \"${CMAKE_BINARY_DIR}\" insource)\n     GET_FILENAME_COMPONENT(PARENTDIR ${CMAKE_SOURCE_DIR} PATH)\n     STRING(COMPARE EQUAL \"${CMAKE_SOURCE_DIR}\"\n     \"${PARENTDIR}\" insourcesubdir)\n    IF(insource OR insourcesubdir)\n        MESSAGE(FATAL_ERROR \"${MSG}\")\n    ENDIF(insource OR insourcesubdir)\nENDMACRO(MACRO_ENSURE_OUT_OF_SOURCE_BUILD)\n```\n\n----------------------------------------\n\nTITLE: Verifying Partition Mount Options in Red Hat Linux\nDESCRIPTION: Checks for proper mount options (nodev, nosuid) on various partitions including /var, /tmp, /opt, /home, and removable media.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: text\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/var && !r:nodev;\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/tmp && !r:nodev;\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/opt && !r:nodev;\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/home && !r:nodev ;\nf:/etc/fstab -> !r:^# && r:/media && !r:nodev;\nf:/etc/fstab -> !r:^# && r:/media && !r:nosuid;\n```\n\n----------------------------------------\n\nTITLE: Extracting Text Between Delimiters with parse_between Function\nDESCRIPTION: Demonstrates the parse_between function which extracts text found between specified start and end delimiters. The function succeeds when the input string begins with the start delimiter and ends with the end delimiter.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_98\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_between($input_field, '[', ']')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"[Hello, World!]\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"[Hello, World!]\",\n  \"target_field\": \"Hello, World!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Main Builder Static Library in CMake\nDESCRIPTION: Defines the main builder static library with source files, include directories, and dependencies. Includes various components like policy, stage, map, filter, and transform builders.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/builder/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nSET(BUILDER_PUB_INCS\n    ${INC_DIR}\n)\nSET(BUILDER_PRI_INCS\n    ${SRC_DIR}\n    ${INC_DIR}/builder\n)\nadd_library(builder STATIC\n    ${SRC_DIR}/builder.cpp\n    ${SRC_DIR}/allowedFields.cpp\n    ${SRC_DIR}/policy/factory.cpp\n    # ... additional source files ...\n)\ntarget_include_directories(builder PUBLIC ${BUILDER_PUB_INCS} PRIVATE ${BUILDER_PRI_INCS})\ntarget_link_libraries(builder\n    PUBLIC\n    builder::ibuilder\n    store::istore\n    # ... additional dependencies ...\n)\n```\n\n----------------------------------------\n\nTITLE: Setting Directory Permissions\nDESCRIPTION: Sets 755 permissions for all directories in the module structure\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n# chmod 755 wazuh\n# chmod 755 wazuh/alerts\n# chmod 755 wazuh/alerts/config\n# chmod 755 wazuh/alerts/ingest\n# chmod 755 wazuh/archives\n# chmod 755 wazuh/archives/config\n# chmod 755 wazuh/archives/ingest\n```\n\n----------------------------------------\n\nTITLE: Mixing Literal and Reference Values with array_append_any in Wazuh\nDESCRIPTION: Demonstrates array_append_any with both literal and reference values, where null references are ignored but literal values are added to the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_71\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_any(5, $any_object_2)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object_2\": null,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object_2\": null,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Account Optional Settings in Registry\nDESCRIPTION: Registry checks to verify that 'Allow Microsoft accounts to be optional' is enabled as required by CIS benchmark 18.9.6.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_64\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Order Prints\" picture task' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off the \"Order Prints\" picture task' setting is enabled in the Windows registry. It verifies the NoOnlinePrintsWizard value is set to 1 in the specified registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_199\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Failed Alphanumeric Parsing Example with parse_alphanumeric\nDESCRIPTION: Shows a case where parse_alphanumeric fails because the input string contains non-alphanumeric characters, resulting in no change to the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_97\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_alphanumeric($field_to_parse)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"field_to_parse\": \"Not{isalphanum}\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"field_to_parse\": \"Not{isalphanum}\",\n  \"target_field\": \"any_value\"\n}\n```\n\n----------------------------------------\n\nTITLE: Create Integration Scaffold Command Help\nDESCRIPTION: Help output for the create subcommand which sets up a new integration directory\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_2\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration create -h\nusage: engine-integration create [-h] name\n\npositional arguments:\n  name        Name of the integration\n\noptions:\n  -h, --help  show this help message and exit\n```\n\n----------------------------------------\n\nTITLE: Usage Instructions for Engine Clear Tool in Bash\nDESCRIPTION: Provides the complete usage instructions for the Engine Clear Tool, including all available arguments and options. This includes positional arguments for specifying resources to clear and various optional flags for customization.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_clear/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-clear [-h] [--version] [--api-sock API_SOCK] [-f, --force] [-n, --namespaces [NAMESPACES ...]] [resources ...]\n\npositional arguments:\n  resources             Resources to clear. Default:['kvdbs', 'decoder', 'rule', 'output', 'filter', 'integration', 'policy']\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --api-sock API_SOCK   Path to the engine-api socket\n  -f, --force           Force the execution of the command\n  -n, --namespaces [NAMESPACES ...]\n                        Namespace to delete the resources from. Default:['user', 'wazuh', 'system']\n```\n\n----------------------------------------\n\nTITLE: Validating Search Companion Registry Settings\nDESCRIPTION: Registry checks to ensure Search Companion content file updates are disabled per CIS benchmark 18.8.20.1.9. Validates that the DisableContentFileUpdates key is set to 1 or exists in the SearchCompanion policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_159\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Check Password Reveal Button Setting\nDESCRIPTION: Ensures that the password reveal button is disabled by checking the DisablePasswordReveal registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_103\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> DisablePasswordReveal -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> !DisablePasswordReveal;\n```\n\n----------------------------------------\n\nTITLE: Converting Epoch Time to Human-Readable Dates with 'date_from_epoch'\nDESCRIPTION: Shows how to use the 'date_from_epoch' function to convert UNIX timestamp values to ISO-formatted date strings in the format 'YYYY-MM-DDTHH:MM:SSZ'.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_48\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: date_from_epoch($epoch)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"epoch\": 0\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"epoch\": 0,\n  \"target_field\": \"1970-01-01T00:00:00.000000Z\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: date_from_epoch($epoch)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"epoch\": 1715958658\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"epoch\": 1715958658,\n  \"target_field\": \"2024-05-17T15:10:58.000000Z\"\n}\n```\n\n----------------------------------------\n\nTITLE: Engine Test Delete Command Usage\nDESCRIPTION: Command syntax for removing integrations from the configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-test delete [-h] integration-name\n\npositional arguments:\n  integration-name  Integration name\n\noptions:\n  -h, --help        show this help message and exit\n```\n\n----------------------------------------\n\nTITLE: Configuring HLP Static Library Build in CMake\nDESCRIPTION: Defines the HLP static library build configuration including source files, include directories, and external dependencies. The library includes various parsers for different data formats like JSON, XML, CSV, and others.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/hlp/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(hlp STATIC\n  src/parsers/literal.cpp\n  src/parsers/text.cpp\n  src/parsers/eof.cpp\n  src/parsers/number.cpp\n  src/parsers/alphanumeric.cpp\n  src/parsers/bool.cpp\n  src/parsers/between.cpp\n  src/parsers/date.cpp\n  src/parsers/encodings.cpp\n  src/parsers/json.cpp\n  src/parsers/ip.cpp\n  src/parsers/ignore.cpp\n  src/parsers/xml.cpp\n  src/parsers/quoted.cpp\n  src/parsers/file.cpp\n  src/parsers/web.cpp\n  src/parsers/parse_field.cpp\n  src/parsers/kvmap.cpp\n  src/parsers/dsv_csv.cpp\n)\ntarget_include_directories(hlp\nPUBLIC\n  include/\nPRIVATE\n  src/\n  src/parsers/\n  include/hlp/\n)\ntarget_link_libraries(hlp PUBLIC base PRIVATE FastFloat::fast_float date::date date::date-tz pthread CURL::libcurl pugixml)\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Port Configuration in Wazuh Rootcheck\nDESCRIPTION: Verifies that the SSH daemon is not listening on the default port 22 to reduce the risk of automated attacks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 1: Port 22 {PCI_DSS: 2.2.4}] [any] [1]\nf:$sshd_file -> !r:^# && r:Port\\.+22;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service RunAs Credentials Storage Configuration\nDESCRIPTION: Verifies that 'Disallow WinRM from storing RunAs credentials' is enabled by checking if DisableRunAs is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_94\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> DisableRunAs -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> !DisableRunAs;\n```\n\n----------------------------------------\n\nTITLE: Validating HTTP Printing Registry Settings\nDESCRIPTION: Registry checks to ensure printing over HTTP is disabled per CIS benchmark 18.8.20.1.7. Validates that the DisableHTTPPrinting key is set to 1 or exists in the Windows NT Printers policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_157\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off printing over HTTP' Registry Setting\nDESCRIPTION: Verifies the DisableHTTPPrinting registry key is set to 1 in the Windows NT Printers path, which disables the ability to print over HTTP. This prevents potential information leakage and reduces attack surface by limiting network printing options.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_87\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Using EngineHandler in Python for Engine Management\nDESCRIPTION: Example of how to use the EngineHandler class to start an engine, interact with its API, and then stop it. This snippet demonstrates the basic workflow for engine testing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/engine-test-utils/README.md#2025-04-17_snippet_1\n\nLANGUAGE: python\nCODE:\n```\nfrom engine_handler.handler import EngineHandler\n\nengine_handler = EngineHandler(\n            \"path/to/engine\", \"path/to/configuration.env\")\n\n# Start the Engine\nengine_handler.start()\n\n# Do somenthing with the Engine, the api is available through the handler\nrequest = {}\nerror, response = engine_handler.api_client.send_recv(request)\n\n# Stop the Engine\nengine_handler.stop()\n```\n\n----------------------------------------\n\nTITLE: Defining Rules for Detecting Suspicious System Processes\nDESCRIPTION: Rules to detect potentially malicious system processes running outside their expected locations. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: text\nCODE:\n```\n[Possible Malware - Svchost running outside system32 {PCI_DSS: 11.4}] [all] []\np:r:svchost.exe && !%WINDIR%\\System32\\svchost.exe;\nf:!%WINDIR%\\SysWOW64;\n\n[Possible Malware - Inetinfo running outside system32\\inetsrv {PCI_DSS: 11.4}] [all] []\np:r:inetinfo.exe && !%WINDIR%\\System32\\inetsrv\\inetinfo.exe;\nf:!%WINDIR%\\SysWOW64;\n```\n\n----------------------------------------\n\nTITLE: Authentication and Boot Security Checks\nDESCRIPTION: Verification rules for single user mode authentication, interactive boot settings, and core dump restrictions. These checks help ensure proper system security at boot time.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/inittab -> !r:^# && r:S:wait;\nf:/etc/sysconfig/init -> !r:^# && r:PROMPT=no;\nf:/etc/security/limits.conf -> !r:^# && !r:hard\\.+core\\.+0;\n```\n\n----------------------------------------\n\nTITLE: Displaying Engine Router Usage Instructions\nDESCRIPTION: Shows the usage instructions for the engine-router tool, including available options and subcommands for managing routes and EPS settings in the Wazuh engine.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_router/README.md#2025-04-17_snippet_3\n\nLANGUAGE: console\nCODE:\n```\nusage: engine-router [-h] [--version] [--api-socket API_SOCKET] {get,delete,add,reload,update,list,ingest,eps-get,eps-enable,eps-disable,eps-update} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --api-socket API_SOCKET\n                        Path to the Wazuh API socket\n\nsubcommands:\n  {get,delete,add,reload,update,list,ingest,eps-get,eps-enable,eps-disable,eps-update}\n    get                 Get a route details\n    delete              Delete a route\n    add                 Add a route\n    reload              Reload/rebuild a route\n    update              Update a route. it only supports the update of the priority\n    list                Get routes table\n    ingest              Ingest an event\n    eps-get             Get EPS status on the engine\n    eps-enable          Enable EPS on the engine\n    eps-disable         Disable EPS on the engine\n    eps-update          Change EPS settings.\n```\n\n----------------------------------------\n\nTITLE: Running All Integration Tests\nDESCRIPTION: Executes all integration tests in the specified test environment.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nengine-it -e /tmp/engine-integration-test -t ./test/integration_tests run\n```\n\n----------------------------------------\n\nTITLE: Listing Wazuh Agents with Status Information in CSV Format\nDESCRIPTION: This CSV data represents a Wazuh deployment with one master server and 12 agents. Each row contains the agent ID, name, IP address, and connection status. The master server uses a specific IP (127.0.0.1) while agents use 'any'. Agents show various states including Active, Disconnected, and Never connected.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/env/configurations/base/manager/healthcheck/agent_control_check.txt#2025-04-17_snippet_0\n\nLANGUAGE: csv\nCODE:\n```\n000,wazuh-master (server),127.0.0.1,Active/Local,\n001,wazuh-agent1,any,Active,\n002,wazuh-agent2,any,Active,\n003,wazuh-agent3,any,Active,\n004,wazuh-agent4,any,Active,\n005,wazuh-agent5,any,Active,\n006,wazuh-agent6,any,Active,\n007,wazuh-agent7,any,Active,\n008,wazuh-agent8,any,Active,\n009,wazuh-agent9,any,Disconnected,\n010,wazuh-agent10,any,Disconnected,\n011,wazuh-agent11,any,Never connected,\n012,wazuh-agent12,any,Never connected,\n```\n\n----------------------------------------\n\nTITLE: Validating Web Services Registry Settings\nDESCRIPTION: Registry checks to ensure Internet downloads for web publishing and online ordering wizards are disabled per CIS benchmark 18.8.20.1.6. Validates that the NoWebServices key is set to 1 or exists in the Explorer policies path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_156\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Visualizing Event Flow in Wazuh Rules Tree\nDESCRIPTION: This diagram shows the flow of events through the rules tree in Wazuh's default policy. It illustrates the two main layers: Wazuh Rules for default processing and User Rules for custom processing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_8\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Event flow on rules\n---\nflowchart LR\n\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\nclassDef TreeBoxClass font-size: 15px,stroke-width:2px,stroke-dasharray: 5 5\n\n subgraph wazuhRulesTree[\"Wazuh Rules\"]\n  direction TB\n\n  wazuhRules01(\" \")\n  wazuhRules02(\" \")\n  wazuhRules03(\" \")\n  wazuhRules04(\" \")\n  wazuhRules05(\" \")\n  wazuhRules06(\" \")\n  wazuhRules07(\" \")\n  wazuhRules08(\" \")\n\n  wazuhRules01 --> wazuhRules02 & wazuhRules03 & wazuhRules04\n  wazuhRules02 --> wazuhRules05\n  wazuhRules03 --> wazuhRules06 & wazuhRules07\n  wazuhRules04 --> wazuhRules08\n end\n\n subgraph userRulesTree[\"User rules\"]\n  direction TB\n\n  userRules01(\" \")\n  userRules02(\" \")\n  userRules03(\" \")\n  userRules04(\" \")\n  userRules05(\" \")\n  userRules06(\" \")\n  userRules07(\" \")\n  userRules08(\" \")\n\n  userRules01 --> userRules02 & userRules03 & userRules04\n  userRules02 --> userRules05\n  userRules03 --> userRules06 & userRules07\n  userRules04 --> userRules08\n\n end\n\n wazuhRulesTree:::TreeBoxClass\n userRulesTree:::TreeBoxClass\n eventInput:::EventBoxClass\n eventOutput:::EventBoxClass\n\n %% Pipeline\n eventInput@{shape: doc, label: \"Normalized</br>Event\"}==>wazuhRulesTree & userRulesTree-.->eventOutput@{shape: doc, label: \"Security</br>event\"}\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Search Encrypted Files Indexing Setting\nDESCRIPTION: Verifies that indexing of encrypted files is disabled as required by CIS benchmark 18.9.54.2. Checks that the AllowIndexingEncryptedStoresOrItems registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_120\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowIndexingEncryptedStoresOrItems -> !0;\n```\n\n----------------------------------------\n\nTITLE: Retrieving KVDB Value in YAML\nDESCRIPTION: This snippet shows how to use the kvdb_get function to retrieve a value from KVDB using a specified key. The retrieved value is stored in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_87\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_get('testing', $key)\n```\n\n----------------------------------------\n\nTITLE: Test Target Collection and Filtering in CMake\nDESCRIPTION: Collects and filters test targets that end with _test, _ctest, or _utest suffixes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_6\n\nLANGUAGE: cmake\nCODE:\n```\nset(ALL_TARGETS)\nset(test_targets_to_build)\n\nget_all_targets(ALL_TARGETS ${CMAKE_CURRENT_SOURCE_DIR})\n\nforeach(target ${ALL_TARGETS})\n    if(${target} MATCHES \"_test$\" OR ${target} MATCHES \"_ctest$\" OR ${target} MATCHES \"_utest$\")\n        list(APPEND test_targets_to_build ${target})\n        message(STATUS \"Test target: ${target}\")\n    endif()\nendforeach()\n\nadd_custom_target(all_tests DEPENDS ${test_targets_to_build})\n```\n\n----------------------------------------\n\nTITLE: Verifying MySQL Configuration Settings\nDESCRIPTION: Multiple checks for various MySQL configuration settings in my.cnf files, including allow-suspicious-udfs, local_infile, skip-grant-tables, skip_symbolic_links, secure_file_priv, sql_mode, log_error, log_warnings, log-raw, old_passwords, secure_auth, password storage, and master_info_repository.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_community_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nf:$mysql-cnfs -> !r:^# && r:allow-suspicious-udfs\\.+true;\nf:$mysql-cnfs -> r:allow-suspicious-udfs\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:local-infile\\s*=\\s*1;\nf:$mysql-cnfs -> r:local-infile\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:skip-grant-tables\\s*=\\s*true;\nf:$mysql-cnfs -> !r:skip-grant-tables\\s*=\\s*false;\nf:$mysql-cnfs -> r:skip-grant-tables\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:skip_symbolic_links\\s*=\\s*no;\nf:$mysql-cnfs -> !r:skip_symbolic_links\\s*=\\s*yes;\nf:$mysql-cnfs -> r:skip_symbolic_links\\s*$;\n\nf:$mysql-cnfs -> r:^# && r:secure_file_priv=\\s*\\S+\\s*;\nf:$mysql-cnfs -> !r:secure_file_priv=\\s*\\S+\\s*;\nf:$mysql-cnfs -> r:secure_file_priv\\s*$;\n\nf:$mysql-cnfs -> !r:strict_all_tables\\s*$;\n\nf:$mysql-cnfs -> r:^# && r:log_error\\s*=\\s*\\S+\\s*;\nf:$mysql-cnfs -> !r:log_error\\s*=\\s*\\S+\\s*;\nf:$mysql-cnfs -> r:log_error\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/\\S*\\s*;\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/var/\\S*\\s*;\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/usr/\\S*\\s*;\nf:$mysql-cnfs -> r:log_bin\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*0;\nf:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*1;\nf:$mysql-cnfs -> !r:log_warnings\\s*=\\s*\\d+;\nf:$mysql-cnfs -> r:log_warnings\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:log-raw\\s*=\\s*on;\nf:$mysql-cnfs -> r:log-raw\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*1;\nf:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*on;\nf:$mysql-cnfs -> !r:old_passwords\\s*=\\s*2;\nf:$mysql-cnfs -> r:old_passwords\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:secure_auth\\s*=\\s*off;\nf:$mysql-cnfs -> !r:secure_auth\\s*=\\s*on;\nf:$mysql-cnfs -> r:secure_auth\\s*$;\n\nf:$mysql-cnfs -> !r:^# && r:^\\s*password\\.*;\n\nf:$mysql-cnfs -> !r:no_auto_create_user\\s*$;\nf:$mysql-cnfs -> r:^# && r:\\s*no_auto_create_user\\s*$;\n\nf:$mysql-cnfs -> !r:plugin-load\\s*=\\s*validate_password.so\\s*$;\nf:$mysql-cnfs -> !r:validate-password\\s*=\\s*force_plus_permanent\\s*$;\nf:$mysql-cnfs -> !r:validate_password_length\\s*=\\s*14\\s$;\nf:$mysql-cnfs -> !r:validate_password_mixed_case_count\\s*=\\s*1\\s*$;\nf:$mysql-cnfs -> !r:validate_password_number_count\\s*=\\s*1\\s*$;\nf:$mysql-cnfs -> !r:validate_password_special_char_count\\s*=\\s*1;\nf:$mysql-cnfs -> !r:validate_password_policy\\s*=\\s*medium\\s*;\n\nf:$mysql-cnfs -> !r:^# && r:master_info_repository\\s*=\\s*file;\nf:$mysql-cnfs -> !r:master_info_repository\\s*=\\s*table;\nf:$mysql-cnfs -> r:master_info_repository\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Chat Application Detection Rules\nDESCRIPTION: Rules for detecting various chat and instant messaging applications like Skype, Yahoo Messenger, ICQ, AOL, and MSN. Includes file paths, registry entries, and process names.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_applications_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n[Chat/IM/VoIP - Skype {PCI_DSS: 10.6.1}] [any] []\nf:\\Program Files\\Skype\\Phone;\nf:\\Documents and Settings\\All Users\\Documents\\My Skype Pictures;\nf:\\Documents and Settings\\Skype;\nf:\\Documents and Settings\\All Users\\Start Menu\\Programs\\Skype;\nr:HKLM\\SOFTWARE\\Skype;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Skype;\np:r:Skype.exe;\n```\n\n----------------------------------------\n\nTITLE: Library Configuration and Linking\nDESCRIPTION: Configures the vulnerability scanner shared library with dependencies and build settings\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(vulnerability_scanner SHARED\n    ${VULNERABILITY_SCANNER_SRC}\n    )\n\nadd_dependencies(database_feed compile_schemas)\n\ntarget_link_libraries(vulnerability_scanner vdscanner database_feed router content_manager indexer_connector router gcc_s flatbuffers)\n\nset_target_properties(vulnerability_scanner PROPERTIES\n        BUILD_RPATH_USE_ORIGIN TRUE\n        BUILD_RPATH \"$ORIGIN/../lib\"\n)\n```\n\n----------------------------------------\n\nTITLE: Test Configuration Setup\nDESCRIPTION: Configures test-related components including mock library and component tests, conditional on ENGINE_BUILD_TEST flag.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/bk/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\nadd_library(bk_mocks INTERFACE)\ntarget_include_directories(bk_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(bk_mocks INTERFACE GTest::gmock bk::ibk)\nadd_library(bk::mocks ALIAS bk_mocks)\n\nadd_executable(bk_ctest\n    ${COMPONENT_SRC_DIR}/bk_test.cpp\n)\ntarget_link_libraries(bk_ctest GTest::gtest_main bk::taskf bk::rx bk::mocks)\ngtest_discover_tests(bk_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Checking Application Log Maximum Size Settings in Registry\nDESCRIPTION: Registry checks to ensure the Application Event Log maximum size is set to at least 32,768 KB as required by CIS benchmark 18.9.26.1.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_71\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off handwriting personalization data sharing\nDESCRIPTION: Validates registry settings to ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled' by checking the PreventHandwritingDataSharing value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_317\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Defining Wazuh Project Structure\nDESCRIPTION: This snippet outlines the core directory structure of the Wazuh project. It includes the 'framework' directory and two subdirectories under 'apis': 'communications' and 'server_management', which likely contain API-related functionalities.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/framework/requirements-docs.txt#2025-04-17_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\nframework/\napis/communications\napis/server_management\n```\n\n----------------------------------------\n\nTITLE: Example Usage of setupEnvironment.py for Wazuh-Engine Testing\nDESCRIPTION: An example command demonstrating how to use the setupEnvironment.py script to set up the Wazuh-Engine test environment in a specific directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n./setupEnvironment.py -e /tmp/engine\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Clear Tool using pip in Bash\nDESCRIPTION: Demonstrates how to install the Engine Clear Tool using pip. The tool is packaged within the engine-suite Python package.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_clear/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Memory Dump Setting\nDESCRIPTION: Verifies that automatic sending of memory dumps for OS-generated error reports is disabled as required by CIS benchmark 18.9.70.3. Checks that the AutoApproveOSDumps registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_124\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> AutoApproveOSDumps -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !AutoApproveOSDumps;\n```\n\n----------------------------------------\n\nTITLE: Implementing int_calculate Arithmetic Operations in Wazuh Normalization\nDESCRIPTION: The int_calculate function performs basic arithmetic operations on integers, supporting addition (sum), subtraction (sub), multiplication (mul), and division (div). It accepts an operator and two operands, with values limited to 64-bit integer range.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_56\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('sum', 1, 9223372036854775807)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('sum', $operand_left, $operand_right)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('sub', 9223372036854775807, -1)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('sub', $operand_left, $operand_right)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('mul', 4611686018427387904, 2)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('mul', $operand_left, $operand_right)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('div', 0, 8)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('div', $operand_left, $operand_right)\n```\n\n----------------------------------------\n\nTITLE: List Extracted Subcommand Usage\nDESCRIPTION: Help output for the list-extracted subcommand showing its arguments and options.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_decoder/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-decoder list-extracted [-h] decoder\n\npositional arguments:\n  decoder     Decoder to analyze\n\noptions:\n  -h, --help  show this help message and exit\n```\n\n----------------------------------------\n\nTITLE: Domain Controller Security Settings\nDESCRIPTION: Validates various domain controller security settings including LDAP signing requirements, machine account password changes, and server operator task scheduling permissions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NTDS\\Parameters -> LDAPServerIntegrity -> !2\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RefusePasswordChange -> 1\n```\n\n----------------------------------------\n\nTITLE: Using Engine-Diff Tool for Event Comparison\nDESCRIPTION: This snippet shows the usage of the engine-diff tool, which compares two event files in YAML or JSON format. It provides options for specifying input format, quiet mode, and disabling event ordering.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nengine-diff [-h] [--version] [-in {yaml,json}] [-q, --quiet] [--no-order] fileA fileB\n```\n\n----------------------------------------\n\nTITLE: Registry Check for HTTP Print Driver Downloads\nDESCRIPTION: Verifies that 'Turn off downloading of print drivers over HTTP' is set to 'Enabled' by checking if the DisableWebPnPDownload registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_277\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure printing over HTTP is disabled according to CIS benchmark 18.8.20.1.7. The rules verify if the DisableHTTPPrinting registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_265\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Defining Python Package Dependencies\nDESCRIPTION: Specifies the exact versions of Python packages required for the project. Includes pytest and related plugins for testing, jsonschema for JSON validation, and docker for container operations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/qa/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: text\nCODE:\n```\npytest==7.2.2\npytest-html==4.1.1\npytest-md-report==0.6.2\njsonschema==4.17.3\ndocker\n```\n\n----------------------------------------\n\nTITLE: Checking Network Configuration in SLES12\nDESCRIPTION: These rules check various network configuration parameters as recommended by CIS benchmarks. It includes checks for IP forwarding and packet redirects.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Metrics Static Library in CMake\nDESCRIPTION: Creates a static library for metrics, specifies source files, sets up include directories, and links dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/metrics/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(metrics STATIC\n    ${SRC_DIR}/exporter/indexerMetricsExporter.cpp\n    ${SRC_DIR}/manager.cpp\n)\ntarget_include_directories(metrics\n    PUBLIC\n    ${INC_DIR}\n\n    PRIVATE\n    ${SRC_DIR}\n)\ntarget_link_libraries(metrics\n  PUBLIC\n  metrics::imetrics\n  base\n  indexerconnector::iindexerconnector\n\n  PRIVATE\n  opentelemetry-cpp::api\n  opentelemetry-cpp::metrics\n  opentelemetry-cpp::sdk\n  opentelemetry-cpp::resources\n)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off printing over HTTP'\nDESCRIPTION: Verifies that the DisableHTTPPrinting registry value is set to 1, which prevents Windows from printing over HTTP connections.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_188\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: URL Protocol Handling\nDESCRIPTION: URL protocol prefixes supported by the offline downloader for determining the download method. Supports file:// for local filesystem and http:// or https:// for server downloads.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/OFFLINE_DOWNLOADER.md#2025-04-17_snippet_1\n\nLANGUAGE: cpp\nCODE:\n```\nfile://\nhttp://\nhttps://\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off handwriting personalization data sharing' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off handwriting personalization data sharing' is properly enabled in Windows Server 2012 R2. The check validates that PreventHandwritingDataSharing registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_223\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Using ip_version Function to Determine IP Protocol Version in Wazuh\nDESCRIPTION: The ip_version function checks the protocol version of an IP address and returns 'IPv4' or 'IPv6' accordingly. It supports IPv4 addresses in dotted-decimal format and IPv6 addresses in RFC 2373 representation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_57\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: ip_version($ip)\n```\n\n----------------------------------------\n\nTITLE: Asset Operation Definition in YAML\nDESCRIPTION: Example showing the basic structure of operation definitions in YAML format for Wazuh Engine assets\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_16\n\nLANGUAGE: yaml\nCODE:\n```\ntarget_field: operation\n```\n\n----------------------------------------\n\nTITLE: Defining Base Directories and Interface Library Setup\nDESCRIPTION: Sets up basic directory paths and configures the interface library bk_ibk with its dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/bk/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(bk_ibk INTERFACE)\ntarget_include_directories(bk_ibk INTERFACE ${IFACE_DIR})\ntarget_link_libraries(bk_ibk INTERFACE base)\nadd_library(bk::ibk ALIAS bk_ibk)\n```\n\n----------------------------------------\n\nTITLE: Variable Definitions for PHP and Web Directories\nDESCRIPTION: Defines path variables for PHP configuration files and common web root directories that will be used in subsequent rules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: ini\nCODE:\n```\n$php.ini=/etc/php.ini,/var/www/conf/php.ini,/etc/php5/apache2/php.ini;\n$web_dirs=/var/www,/var/htdocs,/home/httpd,/usr/local/apache,/usr/local/apache2,/usr/local/www;\n```\n\n----------------------------------------\n\nTITLE: Compiling Schemas and Generating Headers in CMake\nDESCRIPTION: Creates custom commands to compile schemas into C++ headers and generate schema header files. It sets up a custom target 'compile_schemas' that depends on all individual schema targets.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/feedmanager/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_custom_target(compile_schemas)\nforeach(schema IN LISTS Schemas)\n  set(FILE \"./schemas/${schema}.fbs\")\n  set(VULNERABILITY_OUTPUT_HEADER_GENERATED \"${CMAKE_CURRENT_SOURCE_DIR}/include/${schema}_generated.h\")\n  set(VULNERABILITY_OUTPUT_HEADER \"${CMAKE_CURRENT_SOURCE_DIR}/include/${schema}_schema.h\")\n\n  add_custom_command(\n      OUTPUT \"${VULNERABILITY_OUTPUT_HEADER_GENERATED}\"\n      COMMAND ${FLATC}\n      ARGS --cpp\n      ARGS -o \"${CMAKE_CURRENT_SOURCE_DIR}/include\" \"${FILE}\"\n      ARGS --no-warnings\n      COMMENT \"Building C++ header for ${schema} schema.\"\n      DEPENDS ${FILE}\n      WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR})\n\n  add_custom_command(\n      OUTPUT \"${VULNERABILITY_OUTPUT_HEADER}\"\n      COMMAND bash -c \"echo -e '// This file was generated from ${FILE} , do not modify \\\\n#ifndef ${schema}_HEADER\\\\n#define ${schema}_HEADER\\\\nauto constexpr ${schema}_SCHEMA = R\\\"('`cat ${FILE}`')\\\" ;\\\\n#endif // ${schema}_HEADER\\\\n ' > ./include/${schema}_schema.h\"\n      COMMENT \"Creating header from schema file: '${schema}'\"\n      DEPENDS ${VULNERABILITY_OUTPUT_HEADER_GENERATED}\n      WORKING_DIRECTORY ${CMAKE_CURRENT_SOURCE_DIR}\n      VERBATIM)\n\n  add_custom_target(${schema}_schema_target DEPENDS ${VULNERABILITY_OUTPUT_HEADER})\n  add_dependencies(compile_schemas ${schema}_schema_target)\nendforeach()\n```\n\n----------------------------------------\n\nTITLE: Building Static Indexer Connector Library\nDESCRIPTION: Creates the main static library by gathering source files and configuring include directories and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nfile(GLOB INDEXER_CONNECTOR_SRC\n    \"src/*.cpp\"\n    )\n\nadd_library(indexerconnector STATIC\n    ${INDEXER_CONNECTOR_SRC}\n    )\n\ntarget_include_directories(indexerconnector PUBLIC ${CMAKE_CURRENT_LIST_DIR}/include)\ntarget_link_libraries(indexerconnector\n  PUBLIC\n   indexerconnector::iindexerconnector\n  PRIVATE\n  RocksDB::rocksdb\n  urlrequest\n)\n```\n\n----------------------------------------\n\nTITLE: Configuring Unit Tests for API Policy in CMake\nDESCRIPTION: Conditionally sets up unit tests for the API policy module. Defines mock libraries, creates test executable, sets include directories, links dependencies, and discovers tests using GTest.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/policy/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_library(api_policy_mocks INTERFACE)\n    target_include_directories(api_policy_mocks INTERFACE ${TEST_MOCK_DIR})\n    target_link_libraries(api_policy_mocks INTERFACE api::policy::ipolicy GTest::gmock)\n    add_library(api::policy::mocks ALIAS api_policy_mocks)\n\n    add_executable(api_policy_utest\n        ${UNIT_SRC_DIR}/policy_test.cpp\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n    )\n    target_include_directories(api_policy_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_policy_utest\n        PRIVATE\n        api::policy\n        api::policy::mocks\n        GTest::gtest_main\n        builder::mocks\n        store::mocks\n        api::adapter::test\n    )\n    gtest_discover_tests(api_policy_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Configuring Mock Library for Wazuh Store Tests in CMake\nDESCRIPTION: Sets up an interface library for mocks used in testing, linking with Google Test and the store interface.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_5\n\nLANGUAGE: CMake\nCODE:\n```\n## Mocks\nadd_library(store_mocks INTERFACE)\ntarget_include_directories(store_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(store_mocks INTERFACE GTest::gmock store::istore)\nadd_library(store::mocks ALIAS store_mocks)\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Network Server Client Disconnect Settings\nDESCRIPTION: Registry check to ensure forced client disconnection when logon hours expire is enabled. Validates the EnableForcedLogOff registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Messenger Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Windows Messenger Customer Experience Improvement Program' setting is enabled in the Windows registry. It verifies the CEIP value in the Messenger Client policy key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_303\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Specifying Development Requirements for Wazuh Project\nDESCRIPTION: This line indicates that the development requirements for the Wazuh project are specified in a separate file named 'requirements-dev.txt'. This is a common practice in Python projects to manage dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/framework/requirements-docs.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n-r requirements-dev.txt\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Suite Package with pip\nDESCRIPTION: Command to install the engine-suite package using pip, which includes the engine-policy tool.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_policy/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Running Valgrind Check Script in Bash\nDESCRIPTION: This snippet shows how to use the check_Valgrind.sh script to run software tests with Valgrind. It demonstrates two usage examples: running a specific test and running all tests except for certain directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nbash tools/check_Valgrind.sh -t build/source/router/ -r OrchestratorTesterTest*\n```\n\nLANGUAGE: bash\nCODE:\n```\nbash tools/check_Valgrind.sh -e build/source/bk/:build/source/builder/:build/source/kvdb/\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off printing over HTTP' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off printing over HTTP' setting is enabled in the Windows registry. It verifies the DisableHTTPPrinting value in the Printers key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_165\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Allow Basic authentication' for WinRM Client Registry Setting\nDESCRIPTION: Checks if 'AllowBasic' is set to 0 (Disabled) for WinRM client to prevent Basic authentication which sends credentials in plain text.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_130\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Performing Floating-Point Math with 'float_calculate' in Wazuh\nDESCRIPTION: Examples of using the 'float_calculate' function to perform arithmetic operations (sum, sub, mul, div) on floating-point numbers. Shows how the function handles operations and its limitations with very large numbers.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_51\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: float_calculate('sum', 1.7976931348623157e+308, 1.7976931348623157e+308)\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: float_calculate('sum', $operand_left, $operand_right)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": -1.7976931348623157e+308,\n  \"operand_right\": -1.7976931348623157e+308\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"operand_left\": -1.7976931348623157e+308,\n  \"operand_right\": -1.7976931348623157e+308\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: float_calculate('sub', 1.7976931348623157e+308, -1.7976931348623157e+308)\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Content Manager Test Project\nDESCRIPTION: Configures a CMake project for content manager component tests. Sets up the build environment, copies test input files, defines source files, and links required testing libraries including GTest, GMock, and other dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/tests/component/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(content_manager_component_tests)\n\n# Copy input files to the build directory\nfile(COPY input_files DESTINATION ${CMAKE_CURRENT_BINARY_DIR})\n\nfile(GLOB PROJECT_SOURCES\n    *.cpp\n    ${CMAKE_SOURCE_DIR}/content_manager/src/*[!main]*.cpp\n)\n\nadd_executable(${PROJECT_NAME} ${PROJECT_SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n    debug gtest_maind\n    debug gtestd\n    debug gmockd\n    optimized gtest_main\n    optimized gtest\n    optimized gmock\n    urlrequest\n    router\n    rocksdb\n    pthread\n)\n\ntarget_link_libraries(${PROJECT_NAME} content_manager)\n\nadd_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Validating Registration Wizard Registry Settings\nDESCRIPTION: Registry checks to ensure Registration Wizard doesn't redirect to Microsoft.com per CIS benchmark 18.8.20.1.8. Validates that the NoRegistration key is set to 1 or exists in the Registration Wizard Control policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_158\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off handwriting recognition error reporting'\nDESCRIPTION: Registry check rule that verifies if 'Turn off handwriting recognition error reporting' is properly configured by ensuring PreventHandwritingErrorReports registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_254\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Publish to Web Task\nDESCRIPTION: Registry check to ensure 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled'. Validates the NoPublishingWizard registry value equals 1 or exists in the Explorer policies path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_239\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Publish to Web\" task' registry setting\nDESCRIPTION: Verifies that the NoPublishingWizard registry value is set to 1 to disable the \"Publish to Web\" task for files and folders as recommended by CIS benchmark 18.8.20.1.11.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_133\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Asset Schema Visualization with Mermaid\nDESCRIPTION: Flowchart diagram showing the structure of asset schemas, including attributes and stages components\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_14\n\nLANGUAGE: mermaid\nCODE:\n```\nflowchart TB\n\nclassDef AssetsClass fill:#3f51b5,stroke-width:2px,fill-opacity:0.5, font-size: 20px, min-width:350px\nclassDef partsAssetsClass font-size:15px,stroke-width:2px,stroke-dasharray:10px,rx:15,ry:15, min-width:250px\nclassDef AttributesClass min-width: 200px\n\n subgraph assetSchema[\"Asset Schema\"]\n    direction TB\n    attributes:::partsAssetsClass ~~~ stages:::partsAssetsClass\n end\n assetSchema:::AssetsClass\n\n subgraph attributes[\"Attributes\"]\n    direction LR\n    attr_1([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n    attr_2([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n    attr_3([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n    attr_4([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n  end\n\n subgraph stages[\"Stages\"]\n    direction LR\n    stage_1([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n    stage_2([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n    stage_3([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n    stage_4([\"&emsp;&emsp;&emsp;&emsp;&emsp;...&emsp;&emsp;&emsp;&emsp;&emsp;\"]):::AttributesClass\n  end\n```\n\n----------------------------------------\n\nTITLE: Engine Decoder Tool Usage Help\nDESCRIPTION: Main help output showing available subcommands and options for the engine-decoder tool.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_decoder/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-decoder [-h] [--version] {list-extracted,helper-function} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n\nsubcommands:\n  {list-extracted,helper-function}\n    list-extracted      List all extracted fields from a decoder\n    helper-function     Change the helper function name on all the decoders\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet download for Web publishing and online ordering wizards' Registry Setting\nDESCRIPTION: Verifies that 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled' by checking the NoWebServices value in the Explorer registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Setting Values in KVDB using kvdb_set() in Wazuh\nDESCRIPTION: The kvdb_set() function inserts or updates a key-value pair in a specified KVDB database. It returns a boolean indicating success or failure of the operation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_91\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_set('testing', 'new_key', 'any_value')\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_set('testing', $key, $value)\n```\n\n----------------------------------------\n\nTITLE: Checking Registration Wizard Registry Settings\nDESCRIPTION: Registry checks to verify that Registration is disabled when URL is referring to Microsoft.com per CIS benchmark 18.8.20.1.8. The check ensures NoRegistration is set to 1 in the Registration Wizard Control policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_58\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Array Append Function in Wazuh\nDESCRIPTION: Adds values or references to a target array field. The target field will be created if it doesn't exist or overridden if it's not an array. Only elements of the same type can be added.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_65\n\nLANGUAGE: yaml\nCODE:\n```\nfield: array_append(any_object, [...])\n```\n\n----------------------------------------\n\nTITLE: Fixing worker services hanging on connection loss\nDESCRIPTION: Fixed a bug that could leave some worker's services hanging if the connection to the master was broken.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_1\n\nLANGUAGE: Python\nCODE:\n```\n# Fix for worker services hanging on master connection loss\n```\n\n----------------------------------------\n\nTITLE: Creating RBAC Interface Library in CMake\nDESCRIPTION: Defines an interface library for RBAC and sets up its include directories. This library serves as a base for other RBAC-related targets.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/rbac/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(rbac_irbac INTERFACE)\ntarget_include_directories(rbac_irbac INTERFACE ${IFACE_DIR})\nadd_library(rbac::irbac ALIAS rbac_irbac)\n```\n\n----------------------------------------\n\nTITLE: Defining Sober Worm Detection Rules\nDESCRIPTION: Extensive list of file checks to detect various components of the Sober Worm. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: text\nCODE:\n```\n[Sober Worm {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\nonzipsr.noz;\nf:%WINDIR%\\Sysnative\\nonzipsr.noz;\nf:%WINDIR%\\System32\\clonzips.ssc;\nf:%WINDIR%\\Sysnative\\clonzips.ssc;\nf:%WINDIR%\\System32\\clsobern.isc;\nf:%WINDIR%\\Sysnative\\clsobern.isc;\nf:%WINDIR%\\System32\\sb2run.dii;\nf:%WINDIR%\\Sysnative\\sb2run.dii;\nf:%WINDIR%\\System32\\winsend32.dal;\nf:%WINDIR%\\Sysnative\\winsend32.dal;\nf:%WINDIR%\\System32\\winroot64.dal;\nf:%WINDIR%\\Sysnative\\winroot64.dal;\nf:%WINDIR%\\System32\\zippedsr.piz;\nf:%WINDIR%\\Sysnative\\zippedsr.piz;\nf:%WINDIR%\\System32\\winexerun.dal;\nf:%WINDIR%\\Sysnative\\winexerun.dal;\nf:%WINDIR%\\System32\\winmprot.dal;\nf:%WINDIR%\\Sysnative\\winmprot.dal;\nf:%WINDIR%\\System32\\dgssxy.yoi;\nf:%WINDIR%\\Sysnative\\dgssxy.yoi;\nf:%WINDIR%\\System32\\cvqaikxt.apk;\nf:%WINDIR%\\Sysnative\\cvqaikxt.apk;\nf:%WINDIR%\\System32\\sysmms32.lla;\nf:%WINDIR%\\Sysnative\\sysmms32.lla;\nf:%WINDIR%\\System32\\Odin-Anon.Ger;\nf:%WINDIR%\\Sysnative\\Odin-Anon.Ger;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Connection Security Rules Application\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to not apply local connection security rules by checking registry keys. The check fails if AllowLocalIPsecPolicyMerge is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_33\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Listing Python Dependencies for Wazuh\nDESCRIPTION: This code snippet lists the Python package dependencies required for the Wazuh project. It includes matplotlib and seaborn for data visualization, pandas for data manipulation, and psutil for system and process utilities.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/acceptance_test/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: Python\nCODE:\n```\nmatplotlib\nseaborn\npandas\npsutil\n```\n\n----------------------------------------\n\nTITLE: Configuring Main Store Library in CMake for Wazuh\nDESCRIPTION: Sets up the main store library as a static library, specifying source files, include directories, and linking with the store interface.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\n## Store\nadd_library(store STATIC\n    ${SRC_DIR}/store.cpp\n)\ntarget_include_directories(store\n    PUBLIC\n    ${INC_DIR}\n)\ntarget_link_libraries(store store::istore)\n```\n\n----------------------------------------\n\nTITLE: Checking Peer-to-Peer Networking Services Setting in Windows Registry\nDESCRIPTION: This snippet verifies if 'Turn off Microsoft Peer-to-Peer Networking Services' is enabled. It checks the Disabled value in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the \"Order Prints\" picture task' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off the \"Order Prints\" picture task' is properly enabled in Windows Server 2012 R2. The check validates that NoOnlinePrintsWizard registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_216\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 4 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for the system installation phase, including options to start Wazuh after installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_13\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 4\ninstalling=\"Installing the system\"\nstartwazuh=\"Do you want to start Wazuh after the installation?\"\nnowazuhstart=\"Wazuh will not start at the end of installation.\"\nyeswazuhstart=\"Wazuh will start at the end of installation.\"\nrunningmake=\"Running the Makefile\"\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Suite Package in Python\nDESCRIPTION: This snippet demonstrates the installation of the engine-suite package using pip. The package is a comprehensive tool for managing, cleaning, and comparing resources, as well as updating decoders and managing integrations within the Wazuh environment.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip3 install tools/engine_suite\n```\n\n----------------------------------------\n\nTITLE: Directory Structure Layout in Bash\nDESCRIPTION: Shows the directory structure for the helper function testing system, including configuration files, test descriptions, and databases.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nhelper/\n├── configuration_files\n├   └── general.conf\n├── engine-helper-test\n├── helpers_description\n|    └── filter\n|     └── ...\n|    └── map\n|     └── ...\n|    └── transformation\n|     └── ...\n├── mmdb\n│   └── testdb-asn.mmdb\n│   └── testdeb-city.mmdb\n├── README.md\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Disallow WinRM from storing RunAs credentials' Registry Setting\nDESCRIPTION: Checks if 'DisableRunAs' is set to 1 (Enabled) to prevent WinRM from storing RunAs credentials, enhancing security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_135\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> DisableRunAs -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> !DisableRunAs;\n```\n\n----------------------------------------\n\nTITLE: Visualizing Decoder Tree Structure in Wazuh\nDESCRIPTION: This diagram illustrates the hierarchical structure of decoders in Wazuh. It shows how events are processed through multiple levels of decoders, with each level potentially modifying or enriching the event data.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_5\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Decoder tree\n---\nflowchart TD\n\n%% Style\nclassDef AssetSuccessClass fill:#2196f3,stroke-width:2px,fill-opacity:0.8\nclassDef AssetFailClass fill:#f50057,stroke-width:2px,fill-opacity:0.8\nclassDef AssetNotExecutedClass fill:#90a4ae,stroke-width:2px,fill-opacity:0.8\n\n\n%% First Level\ndecoderR(\"root decoder\"):::AssetSuccessClass\ndecoderR --x decoder1\ndecoderR --> decoder2 --> decoder21\ndecoderR -.-> decoder3 -.-> decoder31\n\ndecoder1(\"decoder 1\"):::AssetFailClass\ndecoder2(\"decoder 2\"):::AssetSuccessClass\n\ndecoder1 -.-> decoder11 & decoder12\ndecoder2 -.-> decoder22\n\ndecoder11(\"decoder 1-1\"):::AssetNotExecutedClass\ndecoder12(\"decoder 1-2\"):::AssetNotExecutedClass\ndecoder21(\"decoder 2-1\"):::AssetSuccessClass\ndecoder22(\"decoder 2-2\"):::AssetNotExecutedClass\ndecoder3(\"decoder 3\"):::AssetNotExecutedClass\ndecoder31(\"decoder 3-1\"):::AssetNotExecutedClass\nlinkStyle 0 stroke:#f50057,stroke-width:2px\n```\n\n----------------------------------------\n\nTITLE: CMake Build Configuration with Conditional Subdirectories\nDESCRIPTION: Configures CMake build settings with version requirement and conditional subdirectory inclusion based on unit testing and server target flags. Includes special handling for analyzer compilers and flatbuffers integration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/utils/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nif(UNIT_TEST)\n    add_subdirectory(tests)\n\n    if(NOT ((CMAKE_C_COMPILER MATCHES \".*ccc-analyzer\") OR (CMAKE_CXX_COMPILER MATCHES \".*c\\\\+\\\\+-analyzer\")))\n      add_subdirectory(benchmark)\n    endif()\nendif()\n\nif (${TARGET} STREQUAL \"server\")\n    add_subdirectory(flatbuffers)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Outdated Web Application Detection\nDESCRIPTION: Rules to identify outdated versions of common web applications like WordPress, Joomla, and osCommerce that may have security vulnerabilities.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: ini\nCODE:\n```\n[Web vulnerability - Outdated WordPress installation {PCI_DSS: 6.5, 6.6, 11.4}] [any] [http://sucuri.net/latest-versions]\nd:$web_dirs -> ^version.php$ -> r:^\\.wp_version && >:$wp_version = '4.4.2';\n\n[Web vulnerability - Outdated Joomla installation {PCI_DSS: 6.5, 6.6, 11.4}] [any] [http://sucuri.net/latest-versions]\nd:$web_dirs -> ^version.php$ -> r:var \\.RELEASE && r:'3.4.8';\n\n[Web vulnerability - Outdated osCommerce (v2.2) installation {PCI_DSS: 6.5, 6.6, 11.4}] [any] [http://sucuri.net/latest-versions]\nd:$web_dirs -> ^application_top.php$ -> r:'osCommerce 2.2-;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot Loader Password Settings in Red Hat Linux\nDESCRIPTION: Verifies if LILO and GRUB boot loaders have passwords set for security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: text\nCODE:\n```\nf:/etc/lilo.conf -> !r:^# && !r:restricted;\nf:/etc/lilo.conf -> !r:^# && !r:password=;\nf:/boot/grub/menu.lst -> !r:^# && !r:password;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP Registry Settings\nDESCRIPTION: Registry checks to verify that the Windows Customer Experience Improvement Program is disabled per CIS benchmark 18.8.20.1.13. The check ensures CEIPEnable is set to 0 in the SQMClient\\Windows policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_49\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Validating Registration Control Registry Settings\nDESCRIPTION: Registry checks to ensure Microsoft registration features are disabled via NoRegistration key\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_146\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the Windows Messenger Customer Experience Improvement Program'\nDESCRIPTION: Registry check rule that verifies if 'Turn off the Windows Messenger Customer Experience Improvement Program' is properly configured by ensuring CEIP registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_248\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Publish to Web\" task' Registry Setting\nDESCRIPTION: Verifies if the 'NoPublishingWizard' registry key is set to 1 to disable the 'Publish to Web' task for files and folders.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_169\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Documenting Package Scanning Test Case in Markdown\nDESCRIPTION: Test case description that outlines the process of scanning packages, cleaning up data, and performing re-scans on agent-assigned packages in Wazuh.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/scanner/TC-005/README.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n## Description\\nThis Test Case is designed to assess the behavior when a package undergoes a scanning process, followed by data cleanup, and then initiates a re-scan for all packages assigned to a specific agent.\n```\n\n----------------------------------------\n\nTITLE: Checking for Avahi Daemon in RHEL7\nDESCRIPTION: Detects if the Avahi daemon (for mDNS/DNS-SD) is running. Avahi should be disabled if not needed to reduce attack surface.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: bash\nCODE:\n```\np:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Test Environment for Wazuh\nDESCRIPTION: Sets up CMake build configuration for testing, including debug flags with coverage and sanitizer options. Configures include paths for Google Test framework and Wazuh keystore module.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/tests/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nset(CMAKE_CXX_FLAGS_DEBUG \"-g --coverage -fsanitize=address,leak,undefined\")\n\ninclude_directories(${SRC_FOLDER}/external/googletest/googletest/include/)\ninclude_directories(${SRC_FOLDER}/external/googletest/googlemock/include/)\ninclude_directories(${SRC_FOLDER}/shared_modules/keystore/)\n\nlink_directories(${SRC_FOLDER}/external/googletest/lib/)\n\nadd_subdirectory(component)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Windows Error Reporting Settings\nDESCRIPTION: Registry check to verify that 'Turn off Windows Error Reporting' is enabled. Checks if the Disabled key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_119\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet download for Web publishing wizards' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Internet download for Web publishing and online ordering wizards' setting is enabled in the Windows registry. It verifies the NoWebServices value in the Explorer key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_164\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Validating Handwriting Error Reporting Registry Settings\nDESCRIPTION: Registry checks to ensure handwriting recognition error reporting is disabled per CIS benchmark 18.8.20.1.4. Validates that the PreventHandwritingErrorReports key is set to 1 or exists in the HandwritingErrorReports policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_154\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Wazuh Server Config File Path\nDESCRIPTION: The default path location for the main Wazuh server configuration file, which uses YAML format for configuration settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/configuration/configuration-files.md#2025-04-17_snippet_0\n\nLANGUAGE: path\nCODE:\n```\n/etc/wazuh-server/wazuh-server.yml\n```\n\n----------------------------------------\n\nTITLE: Setting up CMake Project with Sanitizer Options\nDESCRIPTION: Configures CMake project with optional sanitizer flags for debugging. Sets minimum CMake version and configures debug flags with address, leak and undefined behavior sanitizers when FSANITIZE is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/testtool/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nif (FSANITIZE)\nset(CMAKE_CXX_FLAGS_DEBUG \"-g -fsanitize=address,leak,undefined\")\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Security Feature Settings\nDESCRIPTION: Validates various Windows security settings including Search privacy, KMS validation, Store application, Windows Defender, and remote management configurations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_25\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> ConnectedSearchPrivacy -> !3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> NoGenTicket -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> RemoveWindowsStore -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Size\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16384 KB or greater' as required by CIS benchmark 9.1.8. The check uses regex patterns to match different possible sizes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Defining Rules for Detecting Modified Hosts File Entries\nDESCRIPTION: Rules to detect potentially malicious modifications to the hosts file, targeting anti-virus and security websites. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: text\nCODE:\n```\n[Anti-virus site on the hosts file] [any] []\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:avp.ch|avp.ru|nai.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:avp.ch|avp.ru|nai.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:awaps.net|ca.com|mcafee.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:awaps.net|ca.com|mcafee.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:microsoft.com|f-secure.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:microsoft.com|f-secure.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:sophos.com|symantec.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:sophos.com|symantec.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:my-etrust.com|viruslist.ru;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:my-etrust.com|viruslist.ru;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:networkassociates.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:networkassociates.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:kaspersky|grisoft.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:kaspersky|grisoft.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:symantecliveupdate.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:symantecliveupdate.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:clamav.net|bitdefender.com;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:clamav.net|bitdefender.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:antivirus.com|sans.org;\nf:%WINDIR%\\Sysnative\\Drivers\\etc\\HOSTS -> r:antivirus.com|sans.org;\n```\n\n----------------------------------------\n\nTITLE: Configuring Store Component and Unit Tests in CMake for Wazuh\nDESCRIPTION: Sets up executables for store component and unit tests, linking with necessary libraries and discovering tests using Google Test.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_7\n\nLANGUAGE: CMake\nCODE:\n```\n# TODO FIX THIS CMAKE (Separe unit tests from component tests)\n## Store component test\nadd_executable(store_ctest\n    ${COMPONENT_SRC_DIR}/store_test.cpp\n)\ntarget_link_libraries(store_ctest GTest::gtest_main store::fileDriver store)\ngtest_discover_tests(store_ctest)\n\nadd_executable(store_utest\n    ${UNIT_SRC_DIR}/store_test.cpp\n)\ntarget_link_libraries(store_utest GTest::gtest_main store::mocks store)\ngtest_discover_tests(store_utest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Checking Convenience PIN Sign-in Configuration\nDESCRIPTION: Verifies that convenience PIN sign-in is disabled by checking if 'AllowDomainPINLogon' is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_96\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Disallow copying of user input methods to the system account for sign-in' Registry Setting\nDESCRIPTION: Ensures 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled' by checking the BlockUserInputMethodsForSignIn value in the Control Panel\\International registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> BlockUserInputMethodsForSignIn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> !BlockUserInputMethodsForSignIn;\n```\n\n----------------------------------------\n\nTITLE: Defining RC Scripts Location for Red Hat Linux Security Checks\nDESCRIPTION: Sets the variable $rc_dirs to specify the locations of RC scripts for security checks. This variable is used in subsequent checks to verify system configurations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Installing engine-test-utils via pip in Bash\nDESCRIPTION: Command to install the engine-test-utils package using pip. This assumes the package is available in the current directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/engine-test-utils/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip install ./engine-test-utils\n```\n\n----------------------------------------\n\nTITLE: Displaying Directory Structure for Wazuh Ruleset in Markdown\nDESCRIPTION: This code snippet shows the directory structure of the Wazuh ruleset project using a tree-like representation in Markdown format. It outlines the main directories and their purposes within the project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/README.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n    ├── wazuh/ruleset\n    │ ├── decoders            # Wazuh decoders created/updated by Wazuh\n    │ ├── rules               # Wazuh rules created/updated by Wazuh\n    │ ├── rootcheck           # Wazuh rootchecks created/updated by Wazuh\n    │ ├── sca                 # Security Configuration Assessment created/updated by Wazuh\n    │ ├── lists               # CDB lists created/updated by Wazuh\n    |\n    │ ├── testing             # Ruleset test scripts\n    |\n    │ ├── README.md\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off Windows Error Reporting'\nDESCRIPTION: Verifies that the Disabled registry value is set to 1, which turns off Windows Error Reporting to prevent sending error information to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_181\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Disable HTTP Printing\nDESCRIPTION: Ensures HTTP printing is disabled through registry settings to prevent remote printing over HTTP\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Preventing Duplicate Values with array_append_unique in Wazuh\nDESCRIPTION: Shows how array_append_unique fails when attempting to add a value that already exists in the array, preserving the array's uniqueness.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_72\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_unique('hello')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    \"hola\",\n    \"hello\",\n    \"salut\",\n    \"ciao\"\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    \"hola\",\n    \"hello\",\n    \"salut\",\n    \"ciao\"\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring VDScanner CMake Project\nDESCRIPTION: Main CMake configuration that sets up the VDScanner static library project with position-independent code and required dependencies. Defines source files, include directories, and links with database_feed library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/vdscanner/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(vdscanner)\n\nenable_testing()\n\nfile(GLOB VDSCANNER_SRC\n    \"src/*.cpp\"\n    \"src/versionMatcher/*.cpp\"\n    )\n\n# Add fpic flag\nset(CMAKE_POSITION_INDEPENDENT_CODE ON)\n\nadd_library(vdscanner STATIC\n    ${VDSCANNER_SRC}\n    )\n\ntarget_include_directories(vdscanner PUBLIC include)\n\ntarget_link_libraries(vdscanner PUBLIC database_feed)\n\nadd_subdirectory(tools)\n```\n\n----------------------------------------\n\nTITLE: Verifying Safe DLL Search Mode in Windows Registry\nDESCRIPTION: Checks if Safe DLL search mode is enabled in the Windows registry, which is recommended for improved security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_45\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Messenger Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: Verifies if the 'CEIP' registry key is set to 0 to disable the Windows Messenger Customer Experience Improvement Program.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_170\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Order Prints' Picture Task Registry Settings\nDESCRIPTION: Registry checks to verify that the 'Order Prints' picture task is disabled per CIS benchmark 18.8.20.1.10. The check ensures NoOnlinePrintsWizard is set to 1 in the Explorer policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_46\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Registration for Microsoft.com' registry setting\nDESCRIPTION: Verifies that the NoRegistration registry value is set to 1 to disable Registration when URLs refer to Microsoft.com as recommended by CIS benchmark 18.8.20.1.8.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_130\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Order Prints\" picture task' registry setting\nDESCRIPTION: Verifies that the NoOnlinePrintsWizard registry value is set to 1 to disable the \"Order Prints\" picture task as recommended by CIS benchmark 18.8.20.1.10.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_132\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off handwriting personalization data sharing' registry setting\nDESCRIPTION: Verifies that the PreventHandwritingDataSharing registry value is set to 1 to disable handwriting data sharing as recommended by CIS benchmark 18.8.20.1.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_125\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Project for Keystore Tests\nDESCRIPTION: Sets up a CMake project for keystore component tests, including dependency configuration, source file compilation, and test executable creation. Links against Google Test framework in both debug and release configurations, keystore library, and pthread.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/tests/component/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(keystore_component_tests)\n\nfile(GLOB SOURCES\n        *.cpp\n        )\n\nadd_executable(${PROJECT_NAME} ${SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n        debug gtestd\n        debug gtest_maind\n        optimized gtest\n        optimized gtest_main\n        keystore\n        pthread\n        )\n\nadd_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that the Windows Customer Experience Improvement Program is turned off by ensuring the CEIPEnable value is set to 0 or doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_96\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Verifying Internet Connection Wizard Settings in Windows Registry\nDESCRIPTION: This snippet checks if the Internet Connection Wizard is disabled for Microsoft.com URLs by verifying the 'ExitOnMSICW' key in the Internet Connection Wizard registry path. It ensures the value is set to 1 or the key doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_194\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Customer Experience Improvement Program Registry Setting\nDESCRIPTION: Verifies if 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled' by checking the CEIPEnable registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_202\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Engine Schema Help Command\nDESCRIPTION: Displays the help menu showing available commands and options for the engine-schema tool.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_schema/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n$ engine-schema --help\nusage: engine-schema [-h] [--version] {generate,integrate} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n\nsubcommands:\n  {generate,integrate}\n    generate            Generate the schema and associated configuration\n    integrate           Generate the schema and associated configuration and apply them to an Engine\n                        instance\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Vulnerability Scanner Test Tool\nDESCRIPTION: Sets up CMake build configuration including minimum version requirement, sanitizer flags for debug builds, source file collection, and executable target creation with necessary library linkage.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/scanner/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nif(FSANITIZE)\nset(CMAKE_CXX_FLAGS_DEBUG \"-g -fsanitize=address,leak,undefined\")\nendif()\n\nfile(GLOB VD_SCANNER_TESTTOOL_SRC\n    \"*.cpp\"\n    )\n\nadd_executable(vd_scanner_testtool\n    ${VD_SCANNER_TESTTOOL_SRC}\n    )\n\ntarget_link_libraries(vd_scanner_testtool vulnerability_scanner)\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Session Time Limits\nDESCRIPTION: Verifies timeout settings for idle and disconnected Remote Desktop sessions through extensive registry pattern matching.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_24\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\n```\n\n----------------------------------------\n\nTITLE: Windows Registry Security Checks\nDESCRIPTION: Registry checks to verify security settings compliance with CIS benchmarks for Windows Server 2012 R2. Includes checks for diagnostic tools, system services, remote desktop configurations, and security features.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_325\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> DisableQueryRemoteServer -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> !DisableQueryRemoteServer;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> !ScenarioExecutionEnabled;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> DisabledByGroupPolicy -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> !DisabledByGroupPolicy;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> Enabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> !Enabled;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpServer -> Enabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> DisableLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> !DisableLocation;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fSingleSessionPerUser -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fSingleSessionPerUser;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCcm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCcm;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableLPT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableLPT;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisablePNPRedir -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisablePNPRedir;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> ConnectedSearchPrivacy -> !3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !ConnectedSearchPrivacy;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> NoGenTicket -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> !NoGenTicket;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> RemoveWindowsStore -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !RemoveWindowsStore;\n```\n\n----------------------------------------\n\nTITLE: Checking for xinetd Service in RHEL7\nDESCRIPTION: Detects if xinetd service is present in systemd configurations. xinetd is a super-server daemon that should be disabled if not needed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: bash\nCODE:\n```\nf:/usr/lib/systemd/system/xinetd.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Setting Include and Link Directories\nDESCRIPTION: Configures include paths for dependencies and link directories for external libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/CMakeLists.txt#2025-04-17_snippet_4\n\nLANGUAGE: cmake\nCODE:\n```\ninclude_directories(include)\ninclude_directories(src)\ninclude_directories(${SRC_FOLDER}/external/rocksdb/include)\ninclude_directories(${SRC_FOLDER}/external/openssl/include)\ninclude_directories(${SRC_FOLDER}/external/cJSON)\ninclude_directories(${SHARED_MODULES}/utils)\ninclude_directories(${SHARED_MODULES}/common)\n\nlink_directories(${SRC_FOLDER})\nlink_directories(${SRC_FOLDER}/external/rocksdb/build)\n```\n\n----------------------------------------\n\nTITLE: Checking Connected User Enumeration on Domain-Joined Computers\nDESCRIPTION: Ensures that connected users are not enumerated on domain-joined computers by checking if 'DontEnumerateConnectedUsers' is not set to 1 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_93\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontEnumerateConnectedUsers -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontEnumerateConnectedUsers;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' Registry Setting\nDESCRIPTION: Verifies the ExitOnMSICW registry key is set to 1 in the Internet Connection Wizard path, which prevents the Internet Connection Wizard from running when a URL refers to Microsoft.com. This reduces automated connections to Microsoft servers.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_85\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: SELinux Configuration Checks\nDESCRIPTION: Validates SELinux security settings including enforcement state, policy type, and troubleshooting tools configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/grub.conf -> r:selinux=0;\nf:/etc/grub2.cfg -> r:selinux=0;\nf:/etc/selinux/config -> !r:SELINUX=enforcing;\nf:/etc/selinux/config -> !r:SELINUXTYPE=targeted;\n```\n\n----------------------------------------\n\nTITLE: VSCode Python Formatting Configuration\nDESCRIPTION: JSON configuration for VSCode settings.json to enable automatic formatting and lint fixing on save using Ruff.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/tools/ci/README.md#2025-04-17_snippet_3\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"[python]\": {\n      \"editor.formatOnSave\": true,\n      \"editor.defaultFormatter\": \"charliermarsh.ruff\",\n      \"editor.codeActionsOnSave\": {\n          \"source.fixAll\": \"explicit\"\n        }\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Displaying Path Error Message in Wazuh Installation Script (Bash)\nDESCRIPTION: This Bash snippet shows an error message that appears when a user attempts to execute the Wazuh installation script from a different directory. It instructs the user to change to the script's directory and run it with the correct syntax using ./install.sh.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/errors/0x1-location.txt#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n Error 0x1.\n This script can only be executed from the same directory.\n Change directory to where this script is before running it.\n You must run it as ./install.sh .\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Registry Settings\nDESCRIPTION: Verifies that downloading of print drivers over HTTP is disabled by checking registry values. The check ensures DisableWebPnPDownload is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_22\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Array Type Check\nDESCRIPTION: Validates if a field contains an array value. Shows examples of successful and failed validations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_19\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: is_array()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [1, 2, 3, 4]\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: is_array()\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\n----------------------------------------\n\nTITLE: Configuring VDScanner Test Suite\nDESCRIPTION: Test configuration section that sets up unit and component test executables when ENGINE_BUILD_TEST is enabled. Configures test directories, source files, and links against Google Test framework.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/vdscanner/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\nadd_executable(vdscanner_utest\n    ${UNIT_SRC_DIR}/versionMatcher_test.cpp\n    ${UNIT_SRC_DIR}/scannerHelper_test.cpp\n    ${UNIT_SRC_DIR}/packageScanner_test.cpp\n    ${UNIT_SRC_DIR}/factoryOrchestrator_test.cpp\n    ${UNIT_SRC_DIR}/responseBuilder_test.cpp\n    ${UNIT_SRC_DIR}/scanContext_test.cpp\n    ${UNIT_SRC_DIR}/descriptionsHelper_test.cpp\n)\ntarget_compile_definitions(vdscanner_utest PUBLIC FLATBUFFER_SCHEMAS_DIR=\"${CMAKE_CURRENT_LIST_DIR}/../feedmanager/schemas/\")\ntarget_link_libraries(vdscanner_utest GTest::gmock GTest::gtest_main vdscanner feedmanager::mocks)\ngtest_discover_tests(vdscanner_utest)\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Helper Function Subcommand Usage\nDESCRIPTION: Help output for the helper-function subcommand showing its arguments and options for updating helper function names.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_decoder/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-decoder helper-function [-h] [-o OLD-NAME] [-n NEW-NAME] [-l LIST-FILE] [-d DIRECTORY]\n\noptions:\n  -h, --help            show this help message and exit\n  -o OLD-NAME, --old-name OLD-NAME\n                        Helper Function Name to be changed\n  -n NEW-NAME, --new-name NEW-NAME\n                        New Helper Function Name\n  -l LIST-FILE, --list-file LIST-FILE\n                        Path to list of {\"old\":\"new\"} helper functions names\n  -d DIRECTORY, --directory DIRECTORY\n                        Directory where to look for decoders\n```\n\n----------------------------------------\n\nTITLE: Creating Static HTTP Server Library\nDESCRIPTION: Defines the main HTTP server static library with its source files, include directories, and library dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/httpsrv/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(httpsrv STATIC\n    ${SRC_DIR}/server.cpp\n)\ntarget_include_directories(httpsrv\n    PUBLIC\n    ${INC_DIR}\n\n    PRIVATE\n    ${SRC_DIR}\n    ${INC_DIR}/httpsrv\n)\ntarget_link_libraries(httpsrv\n    PUBLIC\n    httpsrv::ihttpsrv\n    base\n    eMessages\n    httplib::httplib\n)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger Customer Experience Improvement Program Registry Setting\nDESCRIPTION: Verifies if 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled' by checking the CEIP registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_201\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Services Registry Settings\nDESCRIPTION: Verifies that Internet download for Web publishing and online ordering wizards is disabled by checking registry values. The check ensures NoWebServices is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_26\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Red Hat/Fedora Version for CIS Benchmark Applicability\nDESCRIPTION: Verifies the version of Red Hat Enterprise Linux or Fedora release to ensure the CIS benchmark is applicable. Uses regular expressions to match specific release versions in system files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\n[CIS - Testing against the CIS Red Hat Enterprise Linux Benchmark v1.0.5] [any required] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 4;\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 3;\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 2.1;\nf:/etc/fedora-release -> r:^Fedora && r:release 1;\nf:/etc/fedora-release -> r:^Fedora && r:release 2;\nf:/etc/fedora-release -> r:^Fedora && r:release 3;\nf:/etc/fedora-release -> r:^Fedora && r:release 4;\nf:/etc/fedora-release -> r:^Fedora && r:release 5;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Settings\nDESCRIPTION: Registry check to verify that 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled' per CIS benchmark 18.3.6. The check confirms that NoNameReleaseOnDemand is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_78\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Engine Helper Tests\nDESCRIPTION: Commands to set up the environment and run helper tests for the Wazuh Engine. Initializes the test state, validates helper descriptions, generates tests, runs the tests, and validates documentation generation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-tests.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\n# Clean and set up the environment\ncd ${WAZUH_REPO_DIR} # Path of the cloned wa repository\nrm -rf /tmp/actions\npython3 src/engine/test/setupEnvironment.py -e /tmp/actions\n# Initial state\nengine-helper-test -e /tmp/actions init --mmdb src/engine/test/helper_tests/mmdb/ --conf src/engine/test/helper_tests/configuration_files/config.env\n# Validate helper descriptions\nengine-helper-test -e /tmp/actions validate --input-dir src/engine/test/helper_tests/helpers_description/\n# Generate tests\nengine-helper-test -e /tmp/actions generate-tests --input-dir src/engine/test/helper_tests/helpers_description/ -o /tmp/helper_tests/\n# Run tests\nengine-helper-test -e /tmp/actions run --input-dir /tmp/helper_tests/\n# Validate documentation generation\nengine-helper-test -e /tmp/actions generate-doc --input-dir src/engine/test/helper_tests/helpers_description/ -o /tmp/helper_docs/\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com'\nDESCRIPTION: Verifies that the ExitOnMSICW registry value is set to 1, which prevents the Internet Connection Wizard from connecting to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_186\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Internet download for Web publishing and online ordering wizards'\nDESCRIPTION: Registry check rule that verifies if 'Turn off Internet download for Web publishing and online ordering wizards' is properly configured by ensuring NoWebServices registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_256\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Search Companion content file updates' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off Search Companion content file updates' is properly enabled in Windows Server 2012 R2. The check validates that DisableContentFileUpdates registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_229\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Test Tool\nDESCRIPTION: Commands for installing the engine-test tool via pip and verifying the installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install wazuh/src/engine/tools/engine-suite\n```\n\nLANGUAGE: bash\nCODE:\n```\nengine-test --version\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Database Feed Manager Test Tool\nDESCRIPTION: Defines a CMake build configuration that sets up a test tool executable with necessary compiler flags and library dependencies. It includes sanitizer options for debug builds, links against curl library, and specifies multiple project dependencies including database_feed, indexer_connector, and rocksdb.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/databaseFeedManager/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\nproject(database_feed_manager_testtool)\n\nif(FSANITIZE)\nset(CMAKE_CXX_FLAGS_DEBUG \"-g -fsanitize=address,leak,undefined\")\nendif()\n\nlink_directories(${SRC_FOLDER}/external/curl/lib/.libs/)\n\nfile(GLOB DATABASE_FEED_MANAGER_TESTTOOL_SRC\n    \"*.cpp\"\n    )\n\nadd_executable(${PROJECT_NAME}\n    ${DATABASE_FEED_MANAGER_TESTTOOL_SRC}\n    )\n\ntarget_link_libraries(${PROJECT_NAME}\n        database_feed\n        indexer_connector\n        router\n        content_manager\n        flatbuffers\n        rocksdb\n        urlrequest\n        curl\n)\n```\n\n----------------------------------------\n\nTITLE: Installing Pre-commit Package\nDESCRIPTION: Command to install the pre-commit tool using pip. Required for setting up git hooks for automated code quality checks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/tools/ci/README.md#2025-04-17_snippet_1\n\nLANGUAGE: console\nCODE:\n```\npip install pre-commit\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Firewall Rules Application\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to not apply local firewall rules by checking registry keys. The check fails if AllowLocalPolicyMerge is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_32\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Using EVTX2XML Command Line Tool\nDESCRIPTION: Command line usage syntax for converting EVTX files to XML format. Accepts an EVTX file path or URL as input and optionally an output path for the XML file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/evtx2xml/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nevtx2xml <evtx_file_path_or_url> [xml_output_path]\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off downloading of print drivers over HTTP\nDESCRIPTION: Validates registry settings to ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled' by checking the DisableWebPnPDownload value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_316\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Verifying Daemon umask Setting in RHEL7\nDESCRIPTION: Checks if the default umask for daemons is set to 027 or stricter in /etc/sysconfig/init. This helps ensure proper file permissions for files created by daemons.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/sysconfig/init -> !r:^# && r:^umask && <:umask 027;\n```\n\n----------------------------------------\n\nTITLE: Configuring YAML Library in CMake\nDESCRIPTION: Sets up the YAML library as a static library, links it with yaml-cpp and base libraries, and configures include directories. This snippet defines the core library build process.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/yml/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(yml STATIC\n    ${CMAKE_CURRENT_LIST_DIR}/src/yml.cpp\n)\n\ntarget_link_libraries(yml yaml-cpp::yaml-cpp base)\n\ntarget_include_directories(yml PUBLIC\n    ${CMAKE_CURRENT_LIST_DIR}/include\n)\n```\n\n----------------------------------------\n\nTITLE: Checking Background Refresh of Group Policy Settings\nDESCRIPTION: Ensures that background refresh of Group Policy is enabled by checking if 'DisableBkGndGroupPolicy' is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_91\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableBkGndGroupPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Data Sharing Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure handwriting personalization data sharing is disabled according to CIS benchmark 18.8.20.1.3. The rules verify if the PreventHandwritingDataSharing registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_261\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: SSH Security Configuration Check\nDESCRIPTION: Validates SSH server configuration for security compliance including protocol version, authentication methods, and root login settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Configuring Benchmark Executable for Helper Functions in CMake\nDESCRIPTION: This CMake snippet creates an executable for benchmarking helper functions, specifically for filters. It sets up the necessary include directories and links required libraries, including benchmark, logicexpr, builders, and base libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/helperFunctions/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_executable(helpersFunctions_benchmarks\n    filters_bench.cpp\n)\n\n# TODO: Because is necessary to add logicExpressions (This shoulb be changed public in builder)\ntarget_include_directories(helpersFunctions_benchmarks PRIVATE \"${ENGINE_SOURCE_DIR}/builder\")\ntarget_link_libraries(helpersFunctions_benchmarks benchmark::benchmark_main logicexpr builders base defs::mocks)\n```\n\n----------------------------------------\n\nTITLE: Defining PF Firewall Support Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring PF firewall integration in active response, including table name and setup instructions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_16\n\nLANGUAGE: Bash\nCODE:\n```\n# Pf support\npfenable=\"Do you want to use the PF firewall in the active response?\"\nnopf=\"PF response disabled.\"\npftablename=\"Name of the PF table to use?\"\npfmessage=\"Add the following lines to the beginning of your PF rules\"\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Messenger CEIP' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off the Windows Messenger Customer Experience Improvement Program' is properly enabled in Windows Server 2012 R2. The check validates that CEIP registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_218\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Customer Experience Improvement Program' Setting\nDESCRIPTION: Registry checks to verify if the 'CEIPEnable' key is set to 0, which disables the Windows Customer Experience Improvement Program. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_71\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Wazuh Keystore Test Tool\nDESCRIPTION: Configures a CMake build system for the wazuh-keystore-testtool project. Sets up C++17 compilation standards, configures sanitizer options for debug builds, sets up include and link directories for dependencies, and creates an executable linked with required libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/testtool/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(wazuh-keystore-testtool)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nif(FSANITIZE)\n  set(CMAKE_CXX_FLAGS_DEBUG \"-g -fsanitize=address,leak,undefined\")\nendif(FSANITIZE)\n\nif (NOT SRC_FOLDER)\n    get_filename_component(SRC_FOLDER     ${CMAKE_SOURCE_DIR}/../../ ABSOLUTE)\nendif()\n\nif (NOT SHARED_MODULES)\n    get_filename_component(SHARED_MODULES ${CMAKE_SOURCE_DIR}/../ ABSOLUTE)\nendif()\n\ninclude_directories(${SRC_FOLDER}/external/rocksdb/include)\ninclude_directories(${SRC_FOLDER}/external/openssl/include)\ninclude_directories(${SRC_FOLDER}/external/cJSON)\ninclude_directories(${SHARED_MODULES}/utils)\ninclude_directories(${SHARED_MODULES}/common)\n\nlink_directories(${SRC_FOLDER})\nlink_directories(${SRC_FOLDER}/external/rocksdb/build)\n\nadd_executable(${PROJECT_NAME} main.cpp)\ntarget_link_libraries(${PROJECT_NAME} rocksdb wazuhext keystore)\n```\n\n----------------------------------------\n\nTITLE: Verifying Telnet Service Configuration\nDESCRIPTION: Ensures telnet service is disabled in xinetd configuration\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Main Geo Library Target Configuration\nDESCRIPTION: Configures the main geo library target with its include directories and link libraries, including both public and private dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/geo/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(geo\n      ${SRCS}\n)\ntarget_include_directories(geo\n    PUBLIC\n    ${INC_DIR}\n\n    PRIVATE\n    ${SRC_DIR}\n    ${INC_DIR}/geo\n)\ntarget_link_libraries(geo\n    PUBLIC\n    ${PUBLIC_LINKS}\n\n    PRIVATE\n    ${PRIVATE_LINKS}\n)\n```\n\n----------------------------------------\n\nTITLE: Setting Up Builder Test Configuration in CMake\nDESCRIPTION: Configures test executables for unit and component testing, including mock libraries and test discovery. Conditional compilation based on ENGINE_BUILD_TEST flag.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/builder/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n    set(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\n    add_library(builder_mocks INTERFACE)\n    target_include_directories(builder_mocks INTERFACE ${TEST_MOCK_DIR})\n    target_link_libraries(builder_mocks INTERFACE GTest::gmock builder::ibuilder)\n    add_library(builder::mocks ALIAS builder_mocks)\n\n    add_executable(builder_ctest\n        ${COMPONENT_SRC_DIR}/builder_test.cpp\n        ${COMPONENT_SRC_DIR}/validator_test.cpp\n    )\n    # ... additional test configuration ...\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Connecting to Wazuh Engine Container via SSH (Bash)\nDESCRIPTION: Commands to connect to the Wazuh engine container using SSH. It includes options for connecting via localhost or container IP.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/docker/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nssh root@localhost -p 4022\n```\n\nLANGUAGE: bash\nCODE:\n```\ndocker inspect --format='{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' engine-container\n```\n\nLANGUAGE: bash\nCODE:\n```\nssh root@<IP_ADDRESS>\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Domain Profile Settings\nDESCRIPTION: Checks Windows Firewall domain profile configuration including firewall state, inbound/outbound rules, and notification settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Search Companion content file updates' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Search Companion content file updates' setting is enabled in the Windows registry. It verifies the DisableContentFileUpdates value is set to 1 in the specified registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_198\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Configuring Metrics Interface Library in CMake\nDESCRIPTION: Creates an interface library for metrics, sets up include directories, and links dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/metrics/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(metrics_imetrics INTERFACE)\ntarget_include_directories(metrics_imetrics INTERFACE ${IFACE_DIR})\ntarget_link_libraries(metrics_imetrics INTERFACE base)\nadd_library(metrics::imetrics ALIAS metrics_imetrics)\n```\n\n----------------------------------------\n\nTITLE: Registry Check for HTTP Printing\nDESCRIPTION: Verifies that 'Turn off printing over HTTP' is set to 'Enabled' by checking if the DisableHTTPPrinting registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_282\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Registration' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off Registration if URL connection is referring to Microsoft.com' is properly enabled in Windows Server 2012 R2. The check validates that NoRegistration registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_228\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Negative string_greater Example with Reference in Wazuh\nDESCRIPTION: Shows a case where string_greater returns false because the target field is lexicographically less than the referenced value. This demonstrates lexicographical comparison.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_34\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_greater($any_string)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_string\": \"wazuh\",\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Setting\nDESCRIPTION: Registry check to ensure Windows Error Reporting is disabled by verifying Disabled is set to 1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_140\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Zip File Content Structure\nDESCRIPTION: Illustrates the internal directory structure of the zip file, showing the hierarchy of contained files and folders.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/ZIP_DECOMPRESSOR.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n|-- data\n|   |-- file_b.xml\n|   `-- file_c.xml\n`-- file_a.json\n```\n\n----------------------------------------\n\nTITLE: Signing WPK Certificate with Root CA\nDESCRIPTION: Signs the WPK certificate with the root CA, valid for 730 days\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nopenssl x509 -req -days 730 -in wpkcert.csr -CA wpk_root.pem -CAkey wpk_root.key -out wpkcert.pem -CAcreateserial\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Customer Experience Improvement Program' registry setting\nDESCRIPTION: Verifies that the CEIPEnable registry value is set to 0 to disable the Windows Customer Experience Improvement Program as recommended by CIS benchmark 18.8.20.1.13.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_135\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Engine-Geo Script Usage and Options\nDESCRIPTION: Displays the usage information and available options for the engine-geo script. It shows the main command structure, subcommands, and general options like help and version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_geo/README.md#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\nusage: engine-geo [-h] [--version] [--api-socket API_SOCKET] {add,delete,list,remote-upsert} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --api-socket API_SOCKET\n                        Path to the Wazuh API socket\n\nsubcommands:\n  {add,delete,list,remote-upsert}\n    add                 Add a GeoIP database\n    delete              Remove a GeoIP database\n    list                List all GeoIP databases in use by the manager\n    remote-upsert       Download and update a GeoIP database from a remote URL\n```\n\n----------------------------------------\n\nTITLE: Checking for TFTP Server in RHEL7\nDESCRIPTION: Detects if TFTP server is enabled in xinetd or systemd configurations. TFTP is an insecure file transfer protocol and should be disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/tftp.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Flatbuffer Tool\nDESCRIPTION: Sets up a CMake build configuration for a Flatbuffer tool project. Configures C++17 as the standard, includes necessary directories, and links against the Flatbuffers library. Creates an executable from source files in the src directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/utils/flatbuffers/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(flatbuffer_tool)\n\nenable_testing()\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\n# Include directories\ninclude_directories(include)\ninclude_directories(${SRC_FOLDER})\ninclude_directories(${SRC_FOLDER}/external/flatbuffers/include)\n\n# Link directories\nlink_directories(${SRC_FOLDER}/external/flatbuffers/build)\n\nfile(GLOB FLATBUFFERS_TOOL_SRC\n    \"src/*.cpp\"\n    )\n\nadd_executable(flatbuffer_tool ${FLATBUFFERS_TOOL_SRC})\n\ntarget_link_libraries(flatbuffer_tool flatbuffers)\n```\n\n----------------------------------------\n\nTITLE: Check AutoPlay Settings for Non-Volume Devices\nDESCRIPTION: Ensures that AutoPlay is disabled for non-volume devices by verifying the NoAutoplayfornonVolume registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_101\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoAutoplayfornonVolume -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoAutoplayfornonVolume;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Settings in Windows Registry\nDESCRIPTION: This snippet verifies if downloading print drivers over HTTP is disabled by checking the 'DisableWebPnPDownload' key in the Windows NT Printers registry path. It ensures the value is set to 1 or the key doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_191\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking NTP Configuration in SLES12\nDESCRIPTION: This rule checks for proper NTP configuration as recommended by CIS benchmarks. It examines the NTP configuration file and options.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/ntp.conf -> r:restrict default kod nomodify notrap nopeer noquery && r:^server;\nf:/etc/sysconfig/ntpd -> r:OPTIONS=\"-u ntp:ntp -p /var/run/ntpd.pid\";\n```\n\n----------------------------------------\n\nTITLE: Creating Database Feed Library in CMake\nDESCRIPTION: Configures and creates the static library 'database_feed'. It sets up include directories, dependencies, and links necessary libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/feedmanager/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nfile(GLOB DATABASE_FEED_SRC\n    \"src/*.cpp\"\n    )\n\n# Add fpic flag\nset(CMAKE_POSITION_INDEPENDENT_CODE ON)\n\nadd_library(database_feed STATIC\n    ${DATABASE_FEED_SRC}\n    )\n\ntarget_include_directories(database_feed PUBLIC ${CMAKE_CURRENT_SOURCE_DIR}/include)\n\nadd_dependencies(database_feed compile_schemas)\n\ntarget_link_libraries(database_feed\n        PUBLIC\n        base\n        PRIVATE\n        flatbuffers::flatbuffers\n        RocksDB::rocksdb\n        filesystem\n        )\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Empty Passwords Configuration\nDESCRIPTION: Verifies that empty passwords are not permitted in SSH configuration for CIS compliance 6.2.9.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_32\n\nLANGUAGE: regex\nCODE:\n```\nf:$sshd_file -> !r:^\\s*PermitEmptyPasswords\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Verifying Handwriting Data Sharing Configuration in Registry\nDESCRIPTION: This snippet checks if handwriting personalization data sharing is disabled in the registry as recommended by CIS benchmark 18.8.20.1.3. It verifies if the 'PreventHandwritingDataSharing' key is set to 1 under the TabletPC registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_91\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Running Pytest Command for API Integration Tests\nDESCRIPTION: Example command to run API integration tests using pytest with warning suppression.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/README.md#2025-04-17_snippet_1\n\nLANGUAGE: text\nCODE:\n```\n$ python3 -m pytest test_agent_GET_endpoints.tavern.yaml --disable-warnings\n========================================== test session starts ===========================================\nplatform linux -- Python 3.9.9, pytest-5.4.3, py-1.11.0, pluggy-0.13.1\nrootdir: /home/user/git/wazuh/api/test/integration, inifile: pytest.ini\nplugins: html-2.1.1, metadata-2.0.1, tavern-1.0.0\ncollected 92 items                                                                                       \n\ntest_agent_GET_endpoints.tavern.yaml ............................................................. [ 66%]\n...............................                                                                    [100%]\n\n============================== 92 passed, 98 warnings in 217.61s (0:03:37) ===============================\n```\n\n----------------------------------------\n\nTITLE: Setting Directory Variables in CMake\nDESCRIPTION: Defines variables for source, include, and interface directories used throughout the configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/policy/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n```\n\n----------------------------------------\n\nTITLE: Path Structure After Decompression\nDESCRIPTION: Demonstrates the updated paths structure after the zip file has been decompressed, listing all extracted files in their new locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/ZIP_DECOMPRESSOR.md#2025-04-17_snippet_2\n\nLANGUAGE: json\nCODE:\n```\n\"paths\": [\n    \"/tmp/outputFolder/contents/file_a.json\",\n    \"/tmp/outputFolder/contents/file_b.xml\",\n    \"/tmp/outputFolder/contents/file_c.xml\"\n]\n```\n\n----------------------------------------\n\nTITLE: Defining Source Directories for Logpar Library in CMake\nDESCRIPTION: Sets up variables for source, include, and interface directories of the Logpar library. These variables are used throughout the CMake configuration for specifying file locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/logpar/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\n# Defs\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n```\n\n----------------------------------------\n\nTITLE: Verifying Network Selection UI Display Settings in Windows Registry\nDESCRIPTION: Checks if the network selection UI is disabled in the Windows registry for improved security and user experience.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_57\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n```\n\n----------------------------------------\n\nTITLE: XML Configuration for Additional CA Certificates\nDESCRIPTION: Example ossec.conf configuration for adding multiple CA certificates\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_10\n\nLANGUAGE: plaintext\nCODE:\n```\n<active-response>\n  <ca_store>/var/ossec/etc/wpk_root.pem</ca_store>\n  <ca_store>/path/to/certificate</ca_store>\n</active-response>\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Source Routing Protection Level\nDESCRIPTION: Verifies that IPv6 source routing protection is set to the highest level by checking registry keys. The check fails if DisableIPSourceRouting is not set to 2 or doesn't exist under the Tcpip6 Parameters key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_41\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off access to the Store' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off access to the Store' setting is enabled in the Windows registry. This check ensures that access to the Windows Store is disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_213\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Verifying Internet Services Registry Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks for Windows Server 2012 R2 security settings based on CIS benchmarks section 18.8.20.1.x. Each rule verifies if registry keys are properly configured to disable various Internet-based features that could present security risks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_272\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Configuring Test Mocks for Indexer Connector\nDESCRIPTION: Sets up mock libraries for testing when ENGINE_BUILD_TEST is enabled, including Google Test integration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    # Mocks\n    set(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n\n    add_library(indexerconnector_mocks INTERFACE)\n    target_include_directories(indexerconnector_mocks INTERFACE ${TEST_MOCK_DIR})\n    target_link_libraries(indexerconnector_mocks INTERFACE GTest::gmock indexerconnector::iindexerconnector)\n    add_library(indexerconnector::mocks ALIAS indexerconnector_mocks)\n\n    add_library(httprequest_mocks INTERFACE)\n    target_include_directories(httprequest_mocks INTERFACE ${TEST_MOCK_DIR})\n    target_link_libraries(httprequest_mocks INTERFACE GTest::gmock)\n    add_library(httprequest::mock ALIAS httprequest_mocks)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Order Prints Task\nDESCRIPTION: Registry check to ensure 'Turn off the \"Order Prints\" picture task' is set to 'Enabled'. Validates the NoOnlinePrintsWizard registry value equals 1 or exists in the Explorer policies path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_238\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' Registry Setting\nDESCRIPTION: Verifies that 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled' by checking the DisableQueryRemoteServer value in the ScriptedDiagnosticsProvider\\Policy registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> DisableQueryRemoteServer -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> !DisableQueryRemoteServer;\n```\n\n----------------------------------------\n\nTITLE: Parsing CSV Data in YAML\nDESCRIPTION: Shows how to use the parse_csv function to extract comma-separated values into specified output fields. The function splits the input string by commas and assigns values to named fields.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_107\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_csv($input_field, 'out1', 'out2', 'out3')\n```\n\n----------------------------------------\n\nTITLE: Defining SSH Configuration File Path in Bash\nDESCRIPTION: Sets the path to the SSH daemon configuration file for subsequent checks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$sshd_file=/etc/ssh/sshd_config;\n```\n\n----------------------------------------\n\nTITLE: Python Test Requirements Specification\nDESCRIPTION: Defines the required Python packages and their exact versions needed for testing the Wazuh project. Includes pytest and its plugins for testing functionality, coverage reporting, and API testing via tavern.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/framework/requirements-dev.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n-r requirements.txt\n\nfreezegun==0.3.15\npy==1.11.0\npytest==7.3.1\npytest-asyncio==0.18.1\npytest-cov==4.1.0\npytest-html==2.1.1\npytest-trio==0.8.0\ntavern==1.23.5\n```\n\n----------------------------------------\n\nTITLE: Configuring YAML Unit Tests in CMake\nDESCRIPTION: Sets up the unit tests for the YAML library when ENGINE_BUILD_TEST is enabled. It defines the test executable, links necessary libraries, discovers tests using GTest, and sets up a test file path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/yml/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\nadd_executable(yml_utest\n    ${UNIT_SRC_DIR}/yml_test.cpp\n)\ntarget_link_libraries(yml_utest PRIVATE GTest::gtest_main base yml)\ngtest_discover_tests(yml_utest)\n\nset(TEST_FILE \"${UNIT_SRC_DIR}/testFile.yml\")\ntarget_compile_definitions(yml_utest PRIVATE\n  TEST_FILE=\"${TEST_FILE}\"\n)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Defining Part 2 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for setting up the installation environment, including installation location and directory management prompts.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_3\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 2\nsettingupenv=\"Setting up the installation environment\"\nwheretoinstall=\"Choose where to install Wazuh\"\ninstallat=\"Installation will be made at \"\ndeletedir=\"The installation directory already exists. Should I delete it?\"\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off Windows Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: Verifies the CEIPEnable registry key is set to 0 in the SQMClient\\Windows path, which disables the Windows Customer Experience Improvement Program. This prevents Windows from collecting and sending system usage data to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_79\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Error Reporting'\nDESCRIPTION: Registry check rule that verifies if 'Turn off Windows Error Reporting' is properly configured by ensuring Disabled registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_250\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM Floppy Drive Presence\nDESCRIPTION: Checks if a virtual floppy drive is present in VMware ESX VM configuration files. The rule searches for floppy[n].present settings that are not explicitly set to false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: vmx\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> r:^floppy\\d+.present && r:!false;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Catalog Static Library in CMake\nDESCRIPTION: Defines a static library for the API catalog, specifying source files, include directories, and library dependencies. This library implements the core functionality of the API catalog.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/catalog/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(api_catalog STATIC\n  ${SRC_DIR}/catalog.cpp\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_catalog\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_catalog\n    PUBLIC\n    base\n    api::catalog::icatalog\n    api::adapter\n\n    PRIVATE\n    yml\n)\nadd_library(api::catalog ALIAS api_catalog)\n```\n\n----------------------------------------\n\nTITLE: Checking Explorer Data Execution Prevention Settings\nDESCRIPTION: Validates that Data Execution Prevention for Explorer is not turned off, as required by CIS benchmark 18.9.30.3. Checks that the NoDataExecutionPrevention registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_107\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that Windows Error Reporting is turned off by ensuring the Disabled value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_97\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Detecting SNMP Server in RHEL7\nDESCRIPTION: Checks for the presence of SNMP server in runlevel directories. SNMP should be disabled if not needed for monitoring.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_24\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Creating Component Test Executable for Metrics in CMake\nDESCRIPTION: Sets up the component test executable for metrics, specifying the test source file and linking necessary libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/metrics/CMakeLists.txt#2025-04-17_snippet_5\n\nLANGUAGE: CMake\nCODE:\n```\nadd_executable(metrics_ctest\n  ${COMPONENT_SRC_DIR}/metrics_test.cpp\n)\ntarget_link_libraries(metrics_ctest\n  GTest::gtest_main\n  metrics\n  indexerconnector::mocks\n  base::test\n)\ngtest_discover_tests(metrics_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Service Status Check Rules\nDESCRIPTION: Collection of rules to verify the enabled/disabled status of various system services including Kudzu, PostgreSQL, MySQL, DNS, and NetFS. Complies with PCI_DSS 2.2.2 where applicable.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_19\n\nLANGUAGE: conf\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dkudzu$;\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\nd:$rc_dirs -> ^S\\d\\dmysqld$;\nd:$rc_dirs -> ^S\\d\\dnamed$;\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Handwriting Data Sharing\nDESCRIPTION: Verifies that 'Turn off handwriting personalization data sharing' is set to 'Enabled' by checking if the PreventHandwritingDataSharing registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_278\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Web Publishing and Online Ordering Wizards Settings\nDESCRIPTION: Registry check to verify that 'Turn off Internet download for Web publishing and online ordering wizards' is enabled. Checks if the NoWebServices key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_111\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Testing File Mappings with Python Script\nDESCRIPTION: Command to test the mapping for a specific file by providing its relative path from the wazuh folder. Returns the list of associated test files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/mapping/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npython3 _test_mapping.py framework/wazuh/agent.py\n```\n\n----------------------------------------\n\nTITLE: Setting Up File Driver Library for Wazuh Store in CMake\nDESCRIPTION: Configures a static library for the file driver, specifying source files, include directories, and linking with the store interface.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\n## File driver\nadd_library(store_fileDriver STATIC\n    ${DRIVER_DIR}/fileDriver/src/fileDriver.cpp\n)\ntarget_include_directories(store_fileDriver\n    PUBLIC\n    ${DRIVER_DIR}/fileDriver/include\n)\ntarget_link_libraries(store_fileDriver store::istore)\nadd_library(store::fileDriver ALIAS store_fileDriver)\n```\n\n----------------------------------------\n\nTITLE: Verifying MySQL User Interactive Login\nDESCRIPTION: This check ensures that the MySQL user does not have interactive login capabilities by examining the /etc/passwd file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_enterprise_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 1.5: Disable Interactive Login] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:/etc/passwd -> r:^mysql && !r:\\.*/bin/false$|/sbin/nologin$;\n```\n\n----------------------------------------\n\nTITLE: Configuring Benchmark Build in CMake\nDESCRIPTION: Conditional inclusion of benchmark directory based on ENGINE_BUILD_BENCHMARK flag.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_4\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_BENCHMARK)\nadd_subdirectory(${ENGINE_BENCHMARK_DIR})\nendif(ENGINE_BUILD_BENCHMARK)\n```\n\n----------------------------------------\n\nTITLE: Initializing Test Environment\nDESCRIPTION: Loads all necessary test configurations and prepares the environment for testing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nengine-it -e /tmp/engine-integration-test -t ./test/integration_tests init -b ./build/main\n```\n\n----------------------------------------\n\nTITLE: Example Upgrade Result File Content\nDESCRIPTION: Content of the upgrade_result file indicating successful upgrade\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\n0\n```\n\n----------------------------------------\n\nTITLE: Verifying MySQL User Shell Restrictions\nDESCRIPTION: Checks if the MySQL user is properly restricted from interactive login, as per CIS recommendation 1.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_community_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/passwd -> r:^mysql && !r:\\.*/bin/false$|/sbin/nologin$;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the \"Publish to Web\" task' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off the \"Publish to Web\" task for files and folders' is properly enabled in Windows Server 2012 R2. The check validates that NoPublishingWizard registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_217\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Setting Up Wazuh API Subdirectories in CMake\nDESCRIPTION: Adds multiple subdirectories for different API components including adapter, catalog, geo, policy, router, tester, kvdb, and event modules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nadd_subdirectory(adapter)\nadd_subdirectory(catalog)\nadd_subdirectory(geo)\nadd_subdirectory(policy)\nadd_subdirectory(router)\nadd_subdirectory(tester)\nadd_subdirectory(kvdb)\nadd_subdirectory(event)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Windows Error Reporting\nDESCRIPTION: Registry check to ensure 'Turn off Windows Error Reporting' is set to 'Enabled'. Validates the Disabled registry value equals 1 or exists in the Windows Error Reporting policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_242\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer Security Prompt Setting in Registry\nDESCRIPTION: Ensures that the 'Prevent Internet Explorer security prompt for Windows Installer scripts' setting is disabled by checking the SafeForScripting value in the Windows Installer registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_327\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> SafeForScripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: File Path Structure in C++\nDESCRIPTION: Reference paths to key component files in the project structure, including the offline downloader implementation and updater context definition.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/OFFLINE_DOWNLOADER.md#2025-04-17_snippet_0\n\nLANGUAGE: cpp\nCODE:\n```\n../../src/components/offlineDownloader.hpp\n../../src/components/updaterContext.hpp\n```\n\n----------------------------------------\n\nTITLE: Recursive Key Merging using merge_recursive_key_in() in Wazuh\nDESCRIPTION: The merge_recursive_key_in() function performs a deep merge of nested structures from a specific key in the given object into the target field. It recursively combines all levels of the object structure.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_94\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: merge_recursive_key_in({'input_key_1': {'v1': 'k1', 'nested': {'n1': 'value1'}}, 'input_key_2': {'v2': 'k2'}}, $key)\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: merge_recursive_key_in($any_object, $key)\n```\n\n----------------------------------------\n\nTITLE: Checking Removable Media Mount Options\nDESCRIPTION: Rules to verify 'nodev' and 'nosuid' mount options for removable media (/media) and check for user-mountable configurations according to CIS Debian Linux benchmark 7.2-7.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:/media && !r:nodev;\nf:/etc/fstab -> !r:^# && r:/media && !r:nosuid;\nf:/etc/fstab -> !r:^# && r:/media && r:user;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring email notifications, including SMTP server settings and email address prompts.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_4\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3\nconfiguring=\"Configuring\"\nmailnotify=\"Do you want e-mail notification?\"\nnomail=\"Email notification disabled\"\nwhatsemail=\"What's your e-mail address?\"\nyoursmtp=\"We found your SMTP server as\"\nusesmtp=\"Do you want to use it?\"\nusingsmtp=\"Using SMTP server: \"\nwhatsmtp=\"What's your SMTP server ip/host?\"\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Messenger Customer Experience Improvement Program' Setting\nDESCRIPTION: Registry checks to verify if the 'CEIP' key is set to 0, which disables the Windows Messenger Customer Experience Improvement Program. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_70\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Online Print Ordering\nDESCRIPTION: Checks if 'Turn off the \"Order Prints\" picture task' is properly enabled by verifying the NoOnlinePrintsWizard registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_38\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Network Parameters Security Check - Source Routing\nDESCRIPTION: Checks if source routed packet acceptance is enabled (should be disabled for security). Part of CIS benchmark 7.2.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Configuring Interface Library Target\nDESCRIPTION: Creates and configures an interface library target for the HTTP server with necessary include directories and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/httpsrv/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(httpsrv_ihttpsrv INTERFACE)\ntarget_include_directories(httpsrv_ihttpsrv INTERFACE ${IFACE_DIR})\ntarget_link_libraries(httpsrv_ihttpsrv INTERFACE base)\nadd_library(httpsrv::ihttpsrv ALIAS httpsrv_ihttpsrv)\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Temporary Folders Per Session Setting\nDESCRIPTION: Verifies that Terminal Services is configured to use temporary folders per session as required by CIS benchmark 18.9.52.3.11.2. Checks that the PerSessionTempDir registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_118\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> PerSessionTempDir -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Order Prints Picture Task Settings\nDESCRIPTION: Registry check to verify that 'Turn off the \"Order Prints\" picture task' is enabled. Checks if the NoOnlinePrintsWizard key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_115\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM Parallel Port Presence\nDESCRIPTION: Checks if a virtual parallel port is present in VMware ESX VM configuration files. The rule searches for parallel[n].present settings that are not explicitly set to false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: vmx\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> r:^parallel\\d+.present && r:!false;\n```\n\n----------------------------------------\n\nTITLE: Doxygen Documentation Generation in CMake\nDESCRIPTION: Configures Doxygen documentation generation when ENGINE_BUILD_DOCUMENTATION is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_8\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_DOCUMENTATION)\nfind_package(Doxygen)\nif (DOXYGEN_FOUND)\n    set(DOXYGEN_IN ${ENGINE_DOC_DIR}/Doxyfile.in)\n    set(DOXYGEN_OUT ${CMAKE_CURRENT_BINARY_DIR}/Doxyfile)\n\n    configure_file(${DOXYGEN_IN} ${DOXYGEN_OUT} @ONLY)\n\n    add_custom_target( doc_doxygen\n      COMMAND ${DOXYGEN_EXECUTABLE} ${DOXYGEN_OUT}\n      WORKING_DIRECTORY ${CMAKE_CURRENT_BINARY_DIR}\n      COMMENT \"Generating API documentation with Doxygen\"\n    )\n\nelse (DOXYGEN_FOUND)\n  message(\"Doxygen need to be installed to generate the doxygen documentation\")\nendif (DOXYGEN_FOUND)\nendif(ENGINE_BUILD_DOCUMENTATION)\n```\n\n----------------------------------------\n\nTITLE: Network Service Security Check\nDESCRIPTION: Checks for potentially insecure network services running on inetd including telnet, FTP, rsh, tftp, imap, and pop3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/inetd.conf -> !r:^# && r:telnet;\nf:/etc/inetd.conf -> !r:^# && r:/ftp;\nf:/etc/inetd.conf -> !r:^# && r:shell|login;\nf:/etc/inetd.conf -> !r:^# && r:tftp;\nf:/etc/inetd.conf -> !r:^# && r:imap;\nf:/etc/inetd.conf -> !r:^# && r:pop;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for HTTP Printing Settings\nDESCRIPTION: Registry check to verify that 'Turn off printing over HTTP' is enabled. Checks if the DisableHTTPPrinting key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_112\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Health Tests (Bash)\nDESCRIPTION: These commands run health tests by injecting events into the engine and evaluating output against expected events. Options allow for testing specific integrations, rule folders, or all decoders/rules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\n# To run a specific integration\nengine-health-test dynamic -e health_test/environment run --integration windows\n# To run a specific rule folder\nengine-health-test dynamic -e health_test/environment run --rule_folder windows\n# To run all tests in decoders\nengine-health-test dynamic -e health_test/environment run --target decoder\n# To run all tests in rules\nengine-health-test dynamic -e health_test/environment run --target rules\n# To skip specific tests in decoders\nengine-health-test dynamic -e health_test/environment run --target decoder --skip windows,wazuh-core\n```\n\n----------------------------------------\n\nTITLE: Configuring RocksDB Tool Project in CMake\nDESCRIPTION: This CMake snippet sets up a project for a RocksDB tool. It includes necessary directories, gathers source files, creates an executable, and links required libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/vdscanner/tools/rocksdb/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nproject(rocksdb_tool)\n\ninclude_directories(${CMAKE_SOURCE_DIR}/source/base/include)\n\nfile(GLOB ROCKSDB_TOOL_SRC\n    \"*.cpp\"\n    )\n\nadd_executable(${PROJECT_NAME}\n    ${ROCKSDB_TOOL_SRC}\n    )\n\ntarget_link_libraries(${PROJECT_NAME} PRIVATE RocksDB::rocksdb flatbuffers::flatbuffers)\n```\n\n----------------------------------------\n\nTITLE: Negative starts_with Example in Wazuh\nDESCRIPTION: Shows a case where starts_with returns false because the target field doesn't start with the specified string literal. This demonstrates how the function handles non-matching prefixes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_30\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: starts_with('wazuh!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello wazuh!\"\n}\n```\n\n----------------------------------------\n\nTITLE: OS Version Check Configuration\nDESCRIPTION: Verifies the SUSE Linux Enterprise Server 12 version through /etc/os-release file\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/os-release -> r:^PRETTY_NAME=\"SUSE Linux Enterprise Server 12\";\nf:/etc/os-release -> r:^PRETTY_NAME=\"SUSE Linux Enterprise Server 12 SP1\";\nf:/etc/os-release -> r:^PRETTY_NAME=\"SUSE Linux Enterprise Server 12 SP2\";\nf:/etc/os-release -> r:^PRETTY_NAME=\"SUSE Linux Enterprise Server 12 SP3\";\nf:/etc/os-release -> r:^PRETTY_NAME=\"SUSE Linux Enterprise Server 12 SP4\";\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Integration Tool\nDESCRIPTION: Commands to install and verify the engine-integration tool via pip\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip install wazuh/src/engine/tools/engine-suite\n```\n\nLANGUAGE: bash\nCODE:\n```\nengine-integration --version\n```\n\n----------------------------------------\n\nTITLE: Verifying Public Key Authentication in SSH Configuration\nDESCRIPTION: Checks if public key authentication is enabled, which is generally more secure than password authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 4: No Public Key authentication {PCI_DSS: 2.2.4}] [any] [4]\nf:$sshd_file -> !r:^\\s*PubkeyAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'No auto-restart with logged on users' Registry Setting\nDESCRIPTION: Checks if 'NoAutoRebootWithLoggedOnUsers' is set to 0 (Disabled) to allow automatic restarts after updates even with logged on users.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_138\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoRebootWithLoggedOnUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Running Specific Feature Test\nDESCRIPTION: Executes a specific feature test by providing the path to the feature file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nengine-it -e /tmp/engine-integration-test -t ./test/integration_tests run -f test/integration_tests/catalog/api.feature\n```\n\n----------------------------------------\n\nTITLE: Using starts_with Function in Wazuh\nDESCRIPTION: Demonstrates how to use the starts_with function to check if a string field begins with a specified prefix. The function returns true if the field starts with the given string, false otherwise.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_28\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: starts_with('hello')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello wazuh!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Search Companion Updates\nDESCRIPTION: Registry check to ensure 'Turn off Search Companion content file updates' is set to 'Enabled'. Validates the DisableContentFileUpdates registry value equals 1 or exists in the SearchCompanion policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_237\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off location' Registry Setting\nDESCRIPTION: Verifies that 'Turn off location' is set to 'Enabled' by checking the DisableLocation value in the LocationAndSensors registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_21\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> DisableLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> !DisableLocation;\n```\n\n----------------------------------------\n\nTITLE: Installing Engine KVDB Tool\nDESCRIPTION: Command to install the engine-kvdb tool via pip from the engine-suite package\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_kvdb/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Removing Array Custom Fields with erase_custom_fields() in Wazuh\nDESCRIPTION: Demonstrates the erase_custom_fields() function removing an array field that doesn't belong to the schema.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_83\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: erase_custom_fields()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Configuration\nDESCRIPTION: Verifies ICMP redirect acceptance settings following CIS benchmark 4.2.2\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/accept_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Dependency Management Functions\nDESCRIPTION: Helper functions for finding and creating imported targets for external dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nfunction(action package_name target_name)\n    if (${package_name}_FOUND)\n        if (NOT TARGET ${target_name})\n            add_library(${target_name} INTERFACE IMPORTED)\n            set_target_properties(${target_name} PROPERTIES\n                INTERFACE_INCLUDE_DIRECTORIES \"${${package_name}_INCLUDE_DIRS}\")\n            message(STATUS \"Created imported target ${target_name}\")\n        else()\n            message(STATUS \"Target ${target_name} already exists\")\n        endif()\n    else()\n        message(FATAL_ERROR \"${package_name} not found!\")\n    endif()\nendfunction()\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Empty Passwords Configuration\nDESCRIPTION: Verifies if empty passwords are permitted in SSH, which is a security risk according to CIS benchmark 6.2.9\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off handwriting personalization data sharing'\nDESCRIPTION: Registry check rule that verifies if 'Turn off handwriting personalization data sharing' is properly configured by ensuring PreventHandwritingDataSharing registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_253\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Schedule Configuration\nDESCRIPTION: Verifies that 'Configure Automatic Updates: Scheduled install day' is set to '0 - Every day' by checking if ScheduledInstallDay is set to 0 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_96\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> ScheduledInstallDay -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !ScheduledInstallDay;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off handwriting personalization data sharing' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off handwriting personalization data sharing' setting is enabled in the Windows registry. This check ensures that handwriting personalization data sharing is disabled for enhanced privacy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_215\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH HostbasedAuthentication Configuration\nDESCRIPTION: Checks if SSH host-based authentication is enabled in sshd configuration. Based on CIS benchmark 6.2.7 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Setting Directory Paths for HTTP Server Library\nDESCRIPTION: Defines the base directory paths for source files, headers, and interfaces used in the HTTP server library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/httpsrv/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Keys for Windows Security Compliance in Windows Server 2012 R2\nDESCRIPTION: These registry checks validate whether specific Windows security settings are correctly configured according to CIS benchmarks. Each check verifies either that a registry key exists with the expected value or reports if the key is missing entirely. The patterns use 'r:' prefix to indicate registry checks with logical conditions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_174\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Order Prints picture task Registry Settings\nDESCRIPTION: Checks if 'Turn off the \"Order Prints\" picture task' is enabled by verifying that NoOnlinePrintsWizard is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_293\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Empty Password Permission in SSH Configuration\nDESCRIPTION: Ensures that empty passwords are not allowed for SSH authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 6: Empty passwords allowed {PCI_DSS: 2.2.4}] [any] [6]\nf:$sshd_file -> !r:^\\s*PermitEmptyPasswords\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking Daemon UMASK Setting in Red Hat Linux\nDESCRIPTION: Ensures the default UMASK for daemons is set to 027 or higher in the /etc/init.d/functions file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: text\nCODE:\n```\nf:/etc/init.d/functions -> !r:^# && r:^umask && >:umask 027;\n```\n\n----------------------------------------\n\nTITLE: TCP/IP Keep-Alive Configuration\nDESCRIPTION: Checks if TCP/IP keep-alive packets timing is set to 300,000 milliseconds (5 minutes) through registry configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Publish to Web Task Settings\nDESCRIPTION: Registry check to verify that 'Turn off the \"Publish to Web\" task for files and folders' is enabled. Checks if the NoPublishingWizard key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_116\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Creating Root CA Certificate for WPK\nDESCRIPTION: Generates a new X509 root CA certificate and key valid for 1825 days using OpenSSL\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nopenssl req -x509 -new -nodes -newkey rsa:2048 -keyout wpk_root.key -out wpk_root.pem -batch -days 1825\n```\n\n----------------------------------------\n\nTITLE: Directory Structure for Engine-Geo Script\nDESCRIPTION: Shows the directory structure of the engine-geo script within the engine-suite package. It includes the main script files and command modules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_geo/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n├── engine_geo/\n|   └── cmds\n|       └── __init__.py\n|       └── ...\n|   └── __init__.py\n|   └── __main__.py\n```\n\n----------------------------------------\n\nTITLE: Generate Command Help\nDESCRIPTION: Shows help information for the generate subcommand, including available options and parameters.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_schema/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n$ engine-schema generate --help\nusage: engine-schema generate [-h] [--ecs-version ECS_VERSION] [--output-dir OUTPUT_DIR] {integration} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --ecs-version ECS_VERSION\n                        [default=\"v8.8.0\"] ECS version to use for the schema generation\n  --output-dir OUTPUT_DIR\n                        [default=\"./\"] Root directory to store generated files\n\nsubcommands:\n  {integration}\n    integration         Add schema integration fields\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Logon Prevention Setting\nDESCRIPTION: Verifies that automatic logon is disabled by checking registry keys. The check fails if AutoAdminLogon is not set to 0 in the Winlogon registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_40\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Directory Structure of Engine Policy Tool\nDESCRIPTION: Shows the file and directory structure of the engine-policy tool within the engine-suite package.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_policy/README.md#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nengine_policy/\n├── README.md\n├── cmds # Command modules\n│   ├── __init__.py\n│   ├── ...\n|   └── ...\n├── __main__.py # Main script\n```\n\n----------------------------------------\n\nTITLE: Validating ExecShield Configuration\nDESCRIPTION: Checks that ExecShield protection is properly enabled in kernel parameters\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/kernel/exec-shield -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Security Authentication Settings\nDESCRIPTION: Validates Kerberos encryption types and LAN Manager authentication level settings for secure network authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_21\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters -> SupportedEncryptionTypes -> !2147483644;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> !5;\n```\n\n----------------------------------------\n\nTITLE: Installing API Communication Library via pip\nDESCRIPTION: Command to install the API communication library using pip.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/api-communication/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip3 install tools/api-communication/\n```\n\n----------------------------------------\n\nTITLE: Schema Configuration Example for Wazuh Engine\nDESCRIPTION: A JSON example showing the structure of the Wazuh Engine schema configuration. The configuration defines field names with their data types and whether they can contain multiple values (array).\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_12\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"name\": \"schema/engine-schema/0\",\n  \"fields\": {\n    \"@timestamp\": {\n      \"type\": \"date\",\n      \"array\": false\n    },\n    \"agent.build.original\": {\n      \"type\": \"keyword\",\n      \"array\": false\n    },\n    \"agent.ephemeral_id\": {\n      \"type\": \"keyword\",\n      \"array\": false\n    },\n    \"agent.id\": {\n      \"type\": \"keyword\",\n      \"array\": false\n    }\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off the \"Publish to Web\" task for files and folders'\nDESCRIPTION: Verifies that the NoPublishingWizard registry value is set to 1, which removes the \"Publish to Web\" feature from Windows Explorer.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_178\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM diskShrink Setting\nDESCRIPTION: Checks if the diskShrink tool is enabled in VMware ESX VM configuration, which could allow disk modification operations that may cause denial of service. The rule checks if isolation.tools.diskShrink.disable is missing or set to false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: vmx\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.diskShrink.disable;\nd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.diskShrink.disable && r:false;\n```\n\n----------------------------------------\n\nTITLE: Displaying Directory Structure for Engine Diff Tool\nDESCRIPTION: Shows the directory structure of the Engine Diff Tool project, including the main Python files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_diff/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n├── engine_diff/\n|   └── __init__.py\n|   └── __main__.py\n```\n\n----------------------------------------\n\nTITLE: Calculating SHA-1 Hash with sha1 Function in Wazuh Normalization\nDESCRIPTION: The sha1 function calculates the SHA-1 hash of a string, returning a 40-digit hexadecimal number. The result is mapped to the target field, replacing it if it already exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_60\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: sha1($any_string)\n```\n\n----------------------------------------\n\nTITLE: Validating SSH MaxAuthTries Setting\nDESCRIPTION: Ensures SSH MaxAuthTries is set to 4 or less to prevent brute force attacks\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_28\n\nLANGUAGE: config\nCODE:\n```\nf:$sshd_file -> !r:^\\s*MaxAuthTries\\s+4\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Root Login Configuration\nDESCRIPTION: Verifies that SSH root login is disabled in sshd configuration for CIS compliance 6.2.8.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_31\n\nLANGUAGE: regex\nCODE:\n```\nf:$sshd_file -> !r:^\\s*PermitRootLogin\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Registry Settings\nDESCRIPTION: Verifies that handwriting recognition error reporting is disabled by checking registry values. The check ensures PreventHandwritingErrorReports is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_24\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Adding Dependency on Protobuf Code Generation in CMake\nDESCRIPTION: This snippet adds a dependency on the Protobuf code generation target to the eMessages library, ensuring that the code is generated before the library is built.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/proto/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\nif(TARGET generate_protobuf_code)\n    add_dependencies(eMessages generate_protobuf_code)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Microsoft Network Server Security Registry Check\nDESCRIPTION: Registry checks for network server security settings including session idle time limits and digital signature requirements.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RequireSecuritySignature -> !1;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Vulnerability Scanner Tests\nDESCRIPTION: Sets up a CMake project for vulnerability scanner component tests with Google Test integration. Configures debug flags with coverage and sanitizer options, includes all test sources, and links required testing libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/tests/component/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(vulnerability_scanner_component_tests)\n\nset(CMAKE_CXX_FLAGS_DEBUG \"-g --coverage -fsanitize=address,leak,undefined\")\n\nfile(GLOB PROJECT_SOURCES\n    *.cpp\n    ${SRC_FOLDER}/vulnerability_scanner/src/*[!main]*.cpp\n)\n\nadd_executable(${PROJECT_NAME} ${PROJECT_SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n        debug gtest_maind\n        debug gtestd\n        optimized gtest_main\n        optimized gtest\n        )\n\ntarget_link_libraries(${PROJECT_NAME} vulnerability_scanner)\n\nadd_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Defining Variables for MySQL Configuration Files\nDESCRIPTION: Sets variables for home directories, environment files, and MySQL configuration file locations. These variables are used in subsequent checks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_community_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$home_dirs=/usr2/home/*,/home/*,/home,/*/home/*,/*/home,/;\n$enviroment_files=/*/home/*/\\.bashrc,/*/home/*/\\.profile,/*/home/*/\\.bash_profile,/home/*/\\.bashrc,/home/*/\\.profile,/home/*/\\.bash_profile;\n$mysql-cnfs=/etc/mysql/my.cnf,/etc/mysql/mariadb.cnf,/etc/mysql/conf.d/*.cnf,/etc/mysql/mariadb.conf.d/*.cnf,~/.my.cnf;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Error Reporting' registry setting\nDESCRIPTION: Verifies that the Disabled registry value is set to 1 to disable Windows Error Reporting as recommended by CIS benchmark 18.8.20.1.14.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_136\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Basic Authentication Configuration\nDESCRIPTION: Verifies that 'Allow Basic authentication' for WinRM service is disabled by checking if the AllowBasic registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_92\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Python Package Dependencies\nDESCRIPTION: Specifies required Python packages and their versions. Includes pytest 7.2.2 for testing functionality and trustme 1.1.0 for SSL/TLS certificate handling.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/qa/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: text\nCODE:\n```\npytest==7.2.2\ntrustme==1.1.0\n```\n\n----------------------------------------\n\nTITLE: Checking Empty Password Accounts\nDESCRIPTION: Identifies accounts with empty passwords in /etc/shadow file, which is a security vulnerability according to PCI DSS requirement 10.2.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Validating Publish to Web Task Registry Settings\nDESCRIPTION: Registry checks to ensure the \"Publish to Web\" task for files and folders is disabled per CIS benchmark 18.8.20.1.11. Validates that the NoPublishingWizard key is set to 1 or exists in the Explorer policies path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_161\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Running ASAN Check Script in Bash\nDESCRIPTION: This snippet demonstrates the usage of the check_ASAN.sh script to run tests with AddressSanitizer, ThreadSanitizer, or MemorySanitizer. It shows two examples: running a specific test and running all tests except for certain directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nbash tools/check_ASAN.sh -t build/source/router/ --regex OrchestratorTest*\n```\n\nLANGUAGE: bash\nCODE:\n```\nbash tools/check_ASAN.sh -e build/source/bk/:build/source/builder/:build/source/kvdb/\n```\n\n----------------------------------------\n\nTITLE: Displaying Directory Structure for API Communication Library\nDESCRIPTION: Shows the file and folder structure of the API communication library project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/api-communication/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n├── api-communication/\n|   └── src\n|     └── api-communication\n|           └── proto\n|               └── __init__.py\n|               └── components_pb2.py\n|               └── components_pb2.pyi\n|           └── __init_.py\n|           └── client.py\n|           └── command.py\n|     └── README.md\n|     └── setup.cfg\n|     └── setup.py\n```\n\n----------------------------------------\n\nTITLE: Configuring Content Manager Project with CMake\nDESCRIPTION: This CMake script sets up the content_manager project, configures include and link directories, defines the source files, and creates a shared library. It also sets up testing and includes subdirectories for testtool and unit tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(content_manager)\n\nenable_testing()\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\nif (NOT SRC_FOLDER)\n    get_filename_component(SRC_FOLDER     ${CMAKE_SOURCE_DIR}/../../ ABSOLUTE)\nendif()\n\nif (NOT SHARED_MODULES)\n    get_filename_component(SHARED_MODULES ${SRC_FOLDER}/shared_modules/ ABSOLUTE)\nendif()\n\n# Include directories\ninclude_directories(include)\n\ninclude_directories(${SRC_FOLDER})\ninclude_directories(${SRC_FOLDER}/headers)\ninclude_directories(${SRC_FOLDER}/external/cJSON)\ninclude_directories(${SRC_FOLDER}/external/nlohmann)\ninclude_directories(${SRC_FOLDER}/external/curl/include/curl)\ninclude_directories(${SRC_FOLDER}/external/lzma/src/liblzma/api)\ninclude_directories(${SRC_FOLDER}/external/rocksdb/include)\ninclude_directories(${SRC_FOLDER}/external/zlib/)\ninclude_directories(${SRC_FOLDER}/external/zlib/contrib/)\n\ninclude_directories(${SHARED_MODULES})\ninclude_directories(${SHARED_MODULES}/utils)\ninclude_directories(${SHARED_MODULES}/router/include)\ninclude_directories(${SHARED_MODULES}/http-request/include)\ninclude_directories(${SHARED_MODULES}/content_manager/src/components)\n\n# Link directories\nlink_directories(${SRC_FOLDER})\nlink_directories(${SRC_FOLDER}/external/lzma/build/)\nlink_directories(${SRC_FOLDER}/external/rocksdb/build/)\nlink_directories(${SRC_FOLDER}/external/zlib/)\nlink_directories(${SRC_FOLDER}/external/zlib/contrib/minizip/)\nlink_directories(${SHARED_MODULES}/router/build)\nlink_directories(${SHARED_MODULES}/http-request/build)\nlink_directories(${SRC_FOLDER}/external/flatbuffers/build/)\n\nfile(GLOB CONTENT_DOWNLOAD_SRC\n    \"src/*.cpp\"\n    )\n\nadd_library(content_manager SHARED\n    ${CONTENT_DOWNLOAD_SRC}\n    )\n\ntarget_link_libraries(content_manager router urlrequest gcc_s wazuhext lzma rocksdb flatbuffers)\n\nset_target_properties(content_manager PROPERTIES\n        BUILD_RPATH_USE_ORIGIN TRUE\n        BUILD_RPATH \"$ORIGIN/../lib\"\n)\n\nadd_subdirectory(testtool)\nif(UNIT_TEST)\n    add_subdirectory(tests)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Project for Wazuh Content Manager Tests\nDESCRIPTION: Creates a CMake build configuration for content manager unit tests. Sets up project requirements, copies test input files, configures source files, and links required dependencies including gtest, gmock, and various Wazuh libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/tests/unit/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(content_manager_unit_tests)\n\n# Copy input files to the build directory\nfile(COPY input_files DESTINATION ${CMAKE_CURRENT_BINARY_DIR})\n\nfile(GLOB PROJECT_SOURCES\n    *.cpp\n    ${CMAKE_SOURCE_DIR}/content_manager/src/*[!main]*.cpp\n)\n\nadd_executable(${PROJECT_NAME} ${PROJECT_SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n    debug gtestd\n    debug gmockd\n    optimized gtest\n    optimized gmock\n    urlrequest\n    router\n    wazuhext\n    lzma\n    rocksdb\n    pthread\n)\n\nadd_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: TZDB Configuration Function\nDESCRIPTION: Function to download and configure the IANA Time Zone Database (TZDB) for the project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nfunction(configure_tzdb)\n    set(TZDB_VERSION \"2024a\")\n    set(TZDB_URL \"https://ftp.iana.org/tz/releases/tzdb-${TZDB_VERSION}.tar.lz\")\n    set(TZDB_DIR \"${CMAKE_BINARY_DIR}/tzdb\")\n    set(TZDB_TAR \"${CMAKE_BINARY_DIR}/tzcode${TZDB_VERSION}.tar.lz\")\n    set(TZDB_HLP_TEST_DIR \"${CMAKE_BINARY_DIR}/source/hlp/data\")\n\n    find_program(WGET wget)\n    find_program(TAR tar)\n    find_program(LZIP lzip)\n\n    if(NOT WGET)\n        message(FATAL_ERROR \"wget is required but not found. Please install wget.\")\n    endif()\n\n    if(NOT TAR)\n        message(FATAL_ERROR \"tar is required but not found. Please install tar.\")\n    endif()\n\n    if(NOT LZIP)\n        message(FATAL_ERROR \"lzip is required but not found. Please install lzip.\")\n    endif()\n\n    if(NOT EXISTS ${TZDB_TAR})\n        message(STATUS \"Downloading tzdb version ${TZDB_VERSION} from ${TZDB_URL}\")\n        execute_process(\n            COMMAND ${WGET} ${TZDB_URL} -O ${TZDB_TAR}\n            RESULT_VARIABLE DOWNLOAD_RESULT\n        )\n        if(NOT DOWNLOAD_RESULT EQUAL 0)\n            message(FATAL_ERROR \"Failed to download tzdb from ${TZDB_URL}\")\n        endif()\n    endif()\n\n    if(NOT EXISTS ${TZDB_DIR})\n        message(STATUS \"Creating directory ${TZDB_DIR} for extraction\")\n        file(MAKE_DIRECTORY ${TZDB_DIR})\n\n        message(STATUS \"Extracting tzdb version ${TZDB_VERSION} into ${TZDB_DIR}\")\n        execute_process(\n            COMMAND ${TAR} --lzip --strip-components=1 -xvf ${TZDB_TAR} -C ${TZDB_DIR}\n            RESULT_VARIABLE EXTRACT_RESULT\n        )\n        if(NOT EXTRACT_RESULT EQUAL 0)\n            message(FATAL_ERROR \"Failed to extract tzdb file ${TZDB_TAR}\")\n        endif()\n    endif()\n\n    file(MAKE_DIRECTORY ${TZDB_HLP_TEST_DIR})\n    file(COPY ${TZDB_DIR} DESTINATION ${TZDB_HLP_TEST_DIR} FILES_MATCHING PATTERN \"*\")\n\nendfunction()\n```\n\n----------------------------------------\n\nTITLE: Network Service Security Checks\nDESCRIPTION: Configuration checks for network-related services like Avahi, NFS, FTP, HTTP and SNMP to ensure they are properly disabled when not needed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\nf:/etc/xinetd.d/vsftpd -> !r:^# && r:disable && r:no;\nd:$rc_dirs -> ^S\\d\\dhttpd$;\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Private Profile Outbound Connections\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Outbound connections' is set to 'Allow (default)' in compliance with CIS benchmark 9.2.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_20\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine Diff Tool Installation\nDESCRIPTION: Shows the command to verify the installation of the Engine Diff Tool by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_diff/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-diff --version\n```\n\n----------------------------------------\n\nTITLE: Configuring Main Defs Library in CMake\nDESCRIPTION: Defines the main 'defs' library as a static library, sets up its source files, include directories, and links it with the interface definitions and base libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/defs/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(defs STATIC\n  ${CMAKE_CURRENT_LIST_DIR}/src/defs.cpp\n)\ntarget_include_directories(defs\nPUBLIC\n  ${CMAKE_CURRENT_LIST_DIR}/include\nPRIVATE\n  ${CMAKE_CURRENT_LIST_DIR}/src\n  ${CMAKE_CURRENT_LIST_DIR}/include/defs\n)\ntarget_link_libraries(defs defs::idefinitions base)\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Search Companion content file updates' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Search Companion content file updates' setting is enabled in the Windows registry. It verifies the DisableContentFileUpdates value in the SearchCompanion key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_167\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Building Wazuh Server Documentation with bash\nDESCRIPTION: Command to build the Wazuh Server documentation using the build script. The compiled documentation output will be generated in the 'book' directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n./build.sh\n```\n\n----------------------------------------\n\nTITLE: Generating Coverage Report for Wazuh Health Tests (Bash)\nDESCRIPTION: This command generates a coverage report for an asset, providing detailed information on successful and failed traces for each stage of the asset.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_11\n\nLANGUAGE: bash\nCODE:\n```\nengine-health-test dynamic -e health_test/environment coverage_validate -i INTEGRATION --rule_folder rule_folder --skip SKIP --target TARGET\n```\n\n----------------------------------------\n\nTITLE: Network Parameters Security Check - ICMP Redirects\nDESCRIPTION: Validates ICMP redirect acceptance settings which should be disabled per CIS benchmark 7.2.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/accept_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Defining Directory Variables in CMake\nDESCRIPTION: Sets up basic directory path variables for interface, source, and include files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM Serial Port Presence\nDESCRIPTION: Checks if a virtual serial port is present in VMware ESX VM configuration files. The rule searches for serial[n].present settings that are not explicitly set to false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: vmx\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> r:^serial\\d+.present && r:!false;\n```\n\n----------------------------------------\n\nTITLE: Windows Registry Security Policy Checks\nDESCRIPTION: Registry checks to verify various Windows security settings including disabling features like Store access, web publishing, error reporting and customer experience programs. Each check verifies registry keys and their values match security requirements.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_123\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off handwriting personalization data sharing' Setting\nDESCRIPTION: Registry checks to verify if the 'PreventHandwritingDataSharing' key is set to 1, which prevents sharing of handwriting personalization data. Performs two checks for incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_61\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Print Driver Download Settings\nDESCRIPTION: Registry check to verify that 'Turn off downloading of print drivers over HTTP' is enabled. Checks if the DisableWebPnPDownload key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_121\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Features Configuration\nDESCRIPTION: Registry checks for various security features including SmartScreen, DEP, heap termination, and shell protocol settings. Ensures critical security protections are properly enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_77\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoHeapTerminationOnCorruption -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Rhosts Usage in SSH Authentication\nDESCRIPTION: Checks if the use of rhosts or shosts files for authentication is disabled for security reasons.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 7: Rhost or shost used for authentication {PCI_DSS: 2.2.4}] [any] [7]\nf:$sshd_file -> !r:^\\s*IgnoreRhosts\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off Windows Customer Experience Improvement Program'\nDESCRIPTION: Verifies that the CEIPEnable registry value is set to 0, which disables the Windows Customer Experience Improvement Program.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_180\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Registration Wizard Control Settings\nDESCRIPTION: Registry check to verify that 'Turn off Registration if URL connection is referring to Microsoft.com' is enabled. Checks if the NoRegistration key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_113\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Slideshow Prevention Setting\nDESCRIPTION: Verifies that enabling the lock screen slideshow is prevented by checking registry keys. The check fails if NoLockScreenSlideshow is not set to 1 or doesn't exist under the Personalization key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_39\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenSlideshow -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenSlideshow;\n```\n\n----------------------------------------\n\nTITLE: Checking Partition Mount Options in /etc/fstab\nDESCRIPTION: Rules to verify 'nodev' mount option is set for various partitions (/var, /tmp, /opt, /home) in accordance with CIS Debian Linux benchmark 7.1 and PCI DSS 2.2.4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/var && !r:nodev;\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/tmp && !r:nodev;\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/opt && !r:nodev;\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/home && !r:nodev;\n```\n\n----------------------------------------\n\nTITLE: Using 'as' Function to Get Public IP Information in Wazuh\nDESCRIPTION: This example demonstrates how to use the 'as' function to retrieve information about a public IP address. It maps the IP's AS number and organization name to a target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_45\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: as($ip)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"ip\": \"1.2.3.4\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"ip\": \"1.2.3.4\",\n  \"target_field\": {\n    \"number\": 1234,\n    \"organization\": {\n      \"name\": \" Wazuh Organization\"\n    }\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Order Prints\" picture task' Registry Setting\nDESCRIPTION: Verifies if the 'NoOnlinePrintsWizard' registry key is set to 1 to disable the 'Order Prints' picture task.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_168\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Configuring Schema Framework Directory Paths and Libraries\nDESCRIPTION: Sets up directory paths and creates the main schema framework libraries including an interface library and static library with their dependencies and include paths.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/schemf/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n\nadd_library(schemf_ischema INTERFACE)\ntarget_include_directories(schemf_ischema INTERFACE ${IFACE_DIR})\ntarget_link_libraries(schemf_ischema INTERFACE base)\nadd_library(schemf::ischema ALIAS schemf_ischema)\n\nadd_library(schemf STATIC\n  ${SRC_DIR}/schema.cpp\n  ${SRC_DIR}/field.cpp\n  ${SRC_DIR}/validator.cpp\n)\n\ntarget_include_directories(schemf\nPUBLIC\n  ${INC_DIR}\nPRIVATE\n  ${SRC_DIR}\n  ${INC_DIR}/schemf\n)\ntarget_link_libraries(schemf PUBLIC schemf::ischema PRIVATE hlp base)\n```\n\n----------------------------------------\n\nTITLE: Variables Definition for RHEL7 Security Checks\nDESCRIPTION: Defines key variables used throughout the security checks including SSH configuration file path and RC script directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: config\nCODE:\n```\n$sshd_file=/etc/ssh/sshd_config;\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Extracting Version Matches from Ossec Log\nDESCRIPTION: Bash command to extract and save version matches from ossec.log for a specific agent. The command filters debug logs containing match information and appends them to an agent-specific log file in the Reports folder.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/versionMatcher/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ngrep \"DEBUG: Match found.*Agent '$AGENT_NAME'\" /var/ossec/logs/ossec.log >> PATH/TO/REPORT/FOLDER/$AGENT_NAME.log\n```\n\n----------------------------------------\n\nTITLE: Installing Cryptography Package\nDESCRIPTION: Installing required Python cryptography package using pip\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\npip install cryptography\n```\n\n----------------------------------------\n\nTITLE: Configuring API Router Unit Tests in CMake\nDESCRIPTION: Conditionally sets up unit test configuration when ENGINE_BUILD_TEST is enabled. Creates test executable, configures test source directories, and links test-specific dependencies including GTest and mock components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/router/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_executable(api_router_utest\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n    )\n    target_include_directories(api_router_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_router_utest\n        PRIVATE\n        api::router\n        GTest::gtest_main\n        router::mocks\n        api::adapter::test\n    )\n    gtest_discover_tests(api_router_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Private Profile Local Firewall Rules\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Settings: Apply local firewall rules' is set to 'Yes (default)' in compliance with CIS benchmark 9.2.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_22\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalPolicyMerge -> 0; \nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Apache Web Server in RHEL7\nDESCRIPTION: Checks for the presence of Apache web server in runlevel directories. Web server should be disabled if not needed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_20\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dhttpd$;\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine KVDB Installation\nDESCRIPTION: Command to verify the successful installation of engine-kvdb by checking its version\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_kvdb/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-kvdb --version\n```\n\n----------------------------------------\n\nTITLE: Setting Directory Variables and Interface Library Configuration\nDESCRIPTION: Defines source directories and creates an interface library 'geo_igeo' with its dependencies and includes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/geo/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n\nadd_library(geo_igeo INTERFACE)\ntarget_include_directories(geo_igeo INTERFACE ${IFACE_DIR})\ntarget_link_libraries(geo_igeo INTERFACE base)\nadd_library(geo::igeo ALIAS geo_igeo)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Search Companion Content File Updates Settings\nDESCRIPTION: Registry check to verify that 'Turn off Search Companion content file updates' is enabled. Checks if the DisableContentFileUpdates key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_114\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Setting Up Test Environment in CMake\nDESCRIPTION: Configures the test environment if ENGINE_BUILD_TEST is enabled. It creates a mock library for feed manager tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/feedmanager/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\n# Tests\nif(ENGINE_BUILD_TEST)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n\nadd_library(feedmanager_mocks INTERFACE)\ntarget_include_directories(feedmanager_mocks INTERFACE ${TEST_MOCK_DIR})\nadd_library(feedmanager::mocks ALIAS feedmanager_mocks)\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Retrieving Object Keys Using get_key_in in YAML\nDESCRIPTION: This snippet demonstrates how to use the get_key_in function to retrieve values from an object using a dynamic key. It's typically used in the map stage of normalization.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_84\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: get_key_in({'key': 'name', 'key2': 'surname'}, $key)\n```\n\n----------------------------------------\n\nTITLE: Running Integration Validation\nDESCRIPTION: Example command to validate a specific Windows integration\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nengine-health-test dynamic -e health_test/environment assets_validate --integration windows\n```\n\n----------------------------------------\n\nTITLE: Defining Ginwui Backdoor Detection Rules\nDESCRIPTION: Rules to detect the Ginwui Backdoor by checking for specific files and registry entries. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: text\nCODE:\n```\n[Ginwui Backdoor {PCI_DSS: 11.4}] [any] [http://www.iss.net/threats/ginwui.html]\nf:%WINDIR%\\System32\\zsyhide.dll;\nf:%WINDIR%\\Sysnative\\zsyhide.dll;\nf:%WINDIR%\\System32\\zsydll.dll;\nf:%WINDIR%\\Sysnative\\zsydll.dll;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\zsydll;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows -> AppInit_DLLs -> r:zsyhide.dll;\n```\n\n----------------------------------------\n\nTITLE: Building the Wazuh Engine\nDESCRIPTION: Commands to clone the Wazuh repository, navigate to the engine directory, and build the engine using CMake. The build process uses all available CPU cores for parallel compilation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/build-sources.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\ngit clone --recurse-submodules https://github.com/wazuh/wazuh.git\ncd wazuh/src/engine\ncmake --preset=relwithdebinfo\ncmake --build build -j$(nproc)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Outbound Connections\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to allow outbound connections by default by checking registry keys. The check fails if DefaultOutboundAction is set to 1 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_30\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off downloading of print drivers over HTTP Registry Settings\nDESCRIPTION: Checks if 'Turn off downloading of print drivers over HTTP' is enabled by verifying that DisableWebPnPDownload is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_299\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Validating Internet Connection Wizard Registry Settings\nDESCRIPTION: Registry checks to ensure Internet Connection Wizard doesn't redirect to Microsoft.com per CIS benchmark 18.8.20.1.5. Validates that the ExitOnMSICW key is set to 1 or exists in the Internet Connection Wizard policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_155\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Connection Security Rules\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Settings: Apply local connection security rules' is set to 'Yes (default)' as required by CIS benchmark 9.2.6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_23\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Check Microsoft Accounts Optional Setting\nDESCRIPTION: Verifies that 'Allow Microsoft accounts to be optional' is enabled by checking the MSAOptional registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_100\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: Verifies if the 'CEIPEnable' registry key is set to 0 to disable the Windows Customer Experience Improvement Program.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_171\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Web Services in Wizards\nDESCRIPTION: Verifies that 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled' by checking if the NoWebServices registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_281\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Successful Connections\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes' as required by CIS benchmark 9.1.10.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Web Exploit Detection Rules\nDESCRIPTION: Rules for detecting suspicious files and patterns that may indicate web server compromise, including common exploit filenames and backdoor signatures.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: ini\nCODE:\n```\n[Web exploits (uncommon file name inside htdocs) - Possible compromise  {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> ^.yop$;\n\n[Web exploits (uncommon file name inside htdocs) - Possible compromise {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> ^id$;\n\n[Web exploits (uncommon file name inside htdocs) - Possible compromise {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> ^.ssh$;\n\n[Web exploits (uncommon file name inside htdocs) - Possible compromise {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> ^...$;\n\n[Web exploits (uncommon file name inside htdocs) - Possible compromise {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> ^.shell$;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Error Reporting' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Windows Error Reporting' setting is enabled in the Windows registry. It verifies the Disabled value in the Windows Error Reporting policy key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_305\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying Handwriting Data Sharing Settings in Windows Registry\nDESCRIPTION: This snippet checks if handwriting personalization data sharing is disabled by verifying the 'PreventHandwritingDataSharing' key in the TabletPC registry path. It ensures the value is set to 1 or the key doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_192\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Creating Custom Target for Protobuf Code Generation in CMake\nDESCRIPTION: This snippet sets up a custom target for Protobuf code generation. It checks for the presence of the protoc compiler and the ENGINE_GENERATE_PROTO flag before creating the target. The target executes a shell script to generate the Protobuf code.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/proto/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nfind_program(PROTOC_EXECUTABLE NAMES protoc)\n\nif(PROTOC_EXECUTABLE)\n    message(STATUS \"Found protoc: ${PROTOC_EXECUTABLE}\")\n    set(VCPKG_INSTALLED_DIR ${CMAKE_BINARY_DIR}/vcpkg_installed/${VCPKG_TARGET_TRIPLET})\n\n    if(NOT ENGINE_GENERATE_PROTO)\n        message(INFO \"ENGINE_GENERATE_PROTO is OFF. Skipping Protobuf generation.\")\n        return()\n    endif()\n    add_custom_target(generate_protobuf_code\n        COMMAND VCPKG_INSTALLED_DIR=${VCPKG_INSTALLED_DIR} /bin/sh ${GENERATE_PROTOBUF_SCRIPT}\n    )\nelse()\n    message(WARNING \"protoc not found. Skipping Protobuf generation.\")\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Core Dump Restrictions in RHEL7\nDESCRIPTION: Verifies that core dumps are restricted in the /etc/security/limits.conf file. This is a security measure to prevent sensitive information from being exposed via core dumps.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/security/limits.conf -> !r:^# && !r:hard\\.+core\\.+0;\n```\n\n----------------------------------------\n\nTITLE: Installing EVTX2XML Python Package\nDESCRIPTION: Command to install the evtx2xml package using pip package manager from a local directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/evtx2xml/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip install ./evtx2xml\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Behavior Settings in Registry\nDESCRIPTION: Registry check to verify the Security Event Log behavior when log file reaches maximum size is disabled as required by CIS benchmark 18.9.26.2.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_72\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring Logic Expression Interface Library in CMake\nDESCRIPTION: Sets up the logicexpr interface library, defining include directories and linking dependencies. It uses the IFACE_DIR variable to specify the interface directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/logicexpr/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\n# Defs\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n\nadd_library(logicexpr INTERFACE)\ntarget_include_directories(logicexpr INTERFACE ${IFACE_DIR})\ntarget_link_libraries(logicexpr INTERFACE parsec base)\n```\n\n----------------------------------------\n\nTITLE: Configuring API Geo Library Build in CMake\nDESCRIPTION: Defines and configures the main api_geo static library build including source directories, include paths, and library dependencies. Creates an alias target api::geo for the library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/geo/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(api_geo STATIC\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_geo\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_geo\n    PUBLIC\n    api::adapter\n    geo::igeo\n)\nadd_library(api::geo ALIAS api_geo)\n```\n\n----------------------------------------\n\nTITLE: Detecting NIS Client in RHEL7\nDESCRIPTION: Checks for the presence of NIS client services in runlevel directories and systemd configurations. NIS is considered insecure and should be disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dypbind$;\nf:/usr/lib/systemd/system/ypbind.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Verifying System Shutdown Restrictions\nDESCRIPTION: Ensures system cannot be shut down without logging on by checking the ShutdownWithoutLogon registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ShutdownWithoutLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Engine Test Get Command Usage\nDESCRIPTION: Command syntax for retrieving integration details.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-test get [-h] integration-name\n\npositional arguments:\n  integration-name  Integration name\n\noptions:\n  -h, --help        show this help message and exit\n```\n\n----------------------------------------\n\nTITLE: Checking Non-root UID 0 Accounts\nDESCRIPTION: Detects accounts with UID 0 other than root in /etc/passwd file. This is a security check aligned with CIS benchmark 13.5 and PCI DSS requirement 10.2.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Access Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that access to the Windows Store is turned off by ensuring the NoUseStoreOpenWith value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_98\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Backdoor and Malware Detection Rules\nDESCRIPTION: Rules to detect common backdoor patterns and web-based malware, including base64 encoded PHP eval statements and compromised .htaccess files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: ini\nCODE:\n```\n[Web vulnerability - Backdoors / Web based malware found - eval(base64_decode) {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> .php$ -> r:eval\\(base64_decode\\(\\paWYo;\n\n[Web vulnerability - Backdoors / Web based malware found - eval(base64_decode(POST)) {PCI_DSS: 6.5, 6.6, 11.4}] [any] []\nd:$web_dirs -> .php$ -> r:eval\\(base64_decode\\(\\S_POST;\n\n[Web vulnerability - .htaccess file compromised {PCI_DSS: 6.5, 6.6, 11.4}] [any] [http://blog.sucuri.net/2011/05/understanding-htaccess-attacks-part-1.html]\nd:$web_dirs -> ^.htaccess$ -> r:RewriteCond \\S+HTTP_REFERERS \\S+google;\n\n[Web vulnerability - .htaccess file compromised - auto append {PCI_DSS: 6.5, 6.6, 11.4}] [any] [http://blog.sucuri.net/2011/05/understanding-htaccess-attacks-part-1.html]\nd:$web_dirs -> ^.htaccess$ -> r:php_value auto_append_file;\n```\n\n----------------------------------------\n\nTITLE: Negative string_not_equal Example with Reference in Wazuh\nDESCRIPTION: Shows a case where string_not_equal returns false because the target field matches the referenced value exactly. This demonstrates the negative case of string inequality comparison.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_43\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_not_equal($any_string)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_string\": \"hello world!\",\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Adding Subdirectories in CMake for Wazuh Project\nDESCRIPTION: This CMake snippet adds the 'unit' and 'component' subdirectories to the build process. These directories likely contain unit tests and component-specific code for the Wazuh project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/test/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_subdirectory(unit)\nadd_subdirectory(component)\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Acceptance Tests in Bash\nDESCRIPTION: Command to execute the main acceptance test script that runs performance tests on Wazuh-Engine and Wazuh-Analysisd components\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/acceptance_test/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n./acceptance_test.sh\n```\n\n----------------------------------------\n\nTITLE: Verifying Boot-Start Driver Initialization Policy in Windows Registry\nDESCRIPTION: Checks if the Boot-Start Driver Initialization Policy is set to 'Good, unknown and bad but critical' in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_53\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Empty Passwords Configuration\nDESCRIPTION: Checks if empty passwords are permitted in SSH configuration. Based on CIS benchmark 6.2.9 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen App Notifications Settings in Registry\nDESCRIPTION: Registry checks to verify that app notifications on the lock screen are disabled according to CIS benchmark 18.8.25.4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_60\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DisableLockScreenAppNotifications -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DisableLockScreenAppNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Internet Connection Wizard' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is properly enabled in Windows Server 2012 R2. The check validates that ExitOnMSICW registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_225\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Project for VDScanner Tool\nDESCRIPTION: This CMake snippet sets up the project configuration for the VDScanner tool. It defines the project name, collects source files, creates an executable, and links necessary libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/vdscanner/tools/scanner/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nproject(vdscanner_tool)\n\nfile(GLOB VDSCANNER_TOOL_SRC\n    \"*.cpp\"\n    )\n\nadd_executable(${PROJECT_NAME}\n    ${VDSCANNER_TOOL_SRC}\n    )\n\ntarget_link_libraries(${PROJECT_NAME} PUBLIC vdscanner base httplib::httplib)\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off the \"Order Prints\" picture task' Registry Setting\nDESCRIPTION: Checks if the NoOnlinePrintsWizard registry key is set to 1 in Explorer policies, which disables the \"Order Prints\" online service for pictures. This prevents users from sending images to online printing services.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_76\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Automatic Updates Configuration in Registry\nDESCRIPTION: Verifies that the 'Turn off Automatic Download and Install of updates' is disabled by checking if the AutoDownload registry value is not set to 4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_80\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Upgrade Offer Setting\nDESCRIPTION: Verifies that offers to update to the latest version of Windows are disabled as required by CIS benchmark 18.9.61.2. Checks that the DisableOSUpgrade registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_122\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows CEIP' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off Windows Customer Experience Improvement Program' is properly enabled in Windows Server 2012 R2. The check validates that CEIPEnable registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_219\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that Internet Connection Wizard is turned off when URL connection refers to Microsoft.com by ensuring the ExitOnMSICW value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_102\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Require a password when a computer wakes (plugged in)' Registry Setting\nDESCRIPTION: Ensures 'Require a password when a computer wakes (plugged in)' is set to 'Enabled' by checking the ACSettingIndex value in the Power\\PowerSettings registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> !ACSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Defining Gpcoder Trojan Detection Rules\nDESCRIPTION: Rules to detect the Gpcoder Trojan by checking for specific files and registry entries. Includes PCI DSS compliance reference and external link.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: text\nCODE:\n```\n[Gpcoder Trojan {PCI_DSS: 11.4}] [any] [http://symantec.com/security_response/writeup.jsp?docid=2007-071711-3132-99]\nf:%WINDIR%\\System32\\ntos.exe;\nf:%WINDIR%\\Sysnative\\ntos.exe;\nf:%WINDIR%\\System32\\wsnpoem;\nf:%WINDIR%\\Sysnative\\wsnpoem;\nf:%WINDIR%\\System32\\wsnpoem\\audio.dll;\nf:%WINDIR%\\Sysnative\\wsnpoem\\audio.dll;\nf:%WINDIR%\\System32\\wsnpoem\\video.dll;\nf:%WINDIR%\\Sysnative\\wsnpoem\\video.dll;\nr:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run -> userinit -> r:ntos.exe;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP/IP Keep-Alive Time Setting in Windows Registry\nDESCRIPTION: This snippet verifies if the 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 300,000 (5 minutes). It checks the KeepAliveTime value in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n```\n\n----------------------------------------\n\nTITLE: Using starts_with Function with Reference in Wazuh\nDESCRIPTION: Shows how to use the starts_with function with a referenced value instead of a literal string. The example demonstrates a failure case where the referenced value doesn't match.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_29\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: starts_with($conteined)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"conteined\": \"hello!\",\n  \"target_field\": \"hello wazuh!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Settings in Windows Registry\nDESCRIPTION: This snippet verifies if handwriting recognition error reporting is disabled by checking the 'PreventHandwritingErrorReports' key in the HandwritingErrorReports registry path. It ensures the value is set to 1 or the key doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_193\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Setting Up Protobuf Code Generation Environment in CMake\nDESCRIPTION: This snippet sets up the directory paths and script locations for Protobuf code generation. It defines the include directory for eMessages and the location of the code generation script.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/proto/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(ENGINE_EMESSAGES_INCLUDE_DIR ${ENGINE_SOURCE_DIR}/proto/include)\nset(GENERATE_PROTOBUF_SCRIPT ${ENGINE_SOURCE_DIR}/proto/generateCode.sh)\n```\n\n----------------------------------------\n\nTITLE: Detecting DHCP Server in RHEL7\nDESCRIPTION: Checks for the presence of DHCP server in systemd configurations. DHCP server should be disabled if not needed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: bash\nCODE:\n```\nf:/usr/lib/systemd/system/dhcpd.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Installation Header in Markdown\nDESCRIPTION: Simple markdown header indicating installation section\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/getting-started/installation.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Installation\n```\n\n----------------------------------------\n\nTITLE: Linking Required Libraries\nDESCRIPTION: Links the necessary libraries (base, indexerconnector, and urlrequest) to the indexer connector tool executable.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/tool/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\ntarget_link_libraries(indexer_connector_tool base indexerconnector urlrequest)\n```\n\n----------------------------------------\n\nTITLE: Configuring HLP Benchmarks in CMake\nDESCRIPTION: CMake commands to set up the hlp_benchmarks executable. It specifies include directories and links the necessary libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/hlp/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\n# target_include_directories(hlp_benchmarks PRIVATE \"${ENGINE_SOURCE_DIR}/hlp\")\n# target_link_libraries(hlp_benchmarks benchmark::benchmark_main hlp)\n```\n\n----------------------------------------\n\nTITLE: Configuring API Adapter Library in CMake\nDESCRIPTION: Sets up the API adapter library as an interface library, configures include directories, and links required dependencies. It also creates an alias target for easier referencing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/adapter/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(api_adapter INTERFACE)\ntarget_include_directories(api_adapter\n    INTERFACE\n    ${INC_DIR}\n)\ntarget_link_libraries(api_adapter\n    INTERFACE\n    base\n    httpsrv\n    eMessages\n)\nadd_library(api::adapter ALIAS api_adapter)\n```\n\n----------------------------------------\n\nTITLE: Configuring API Catalog Interface Library in CMake\nDESCRIPTION: Sets up an interface library for the API catalog, defining include directories and dependencies. This library serves as a base for other components to link against.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/catalog/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(api_catalog_icatalog INTERFACE)\ntarget_include_directories(api_catalog_icatalog INTERFACE ${IFACE_DIR})\ntarget_link_libraries(api_catalog_icatalog INTERFACE base eMessages builder::ibuilder store::istore)\nadd_library(api::catalog::icatalog ALIAS api_catalog_icatalog)\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Server Session Security in Windows Registry\nDESCRIPTION: Verifies that 'Network security: Minimum session security for NTLM SSP based servers' is configured correctly. Checks if NTLMMinServerSec registry value is set to 537395200 for proper NTLMv2 session security and 128-bit encryption.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_23\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Checking User-mounted Removable Media Permissions\nDESCRIPTION: Detects configurations that allow user-mounted removable media (CD-ROM and floppy) on the console.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Tester Library in CMake\nDESCRIPTION: Sets up the API tester library, including source directories, include paths, and library dependencies. It creates a static library named 'api_tester' and an alias 'api::tester'.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/tester/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(api_tester STATIC\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_tester\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_tester\n    PUBLIC\n    base\n    api::adapter\n    router::irouter\n    api::policy::ipolicy\n    api::event\n)\nadd_library(api::tester ALIAS api_tester)\n```\n\n----------------------------------------\n\nTITLE: Displaying Full Traces in Wazuh Engine\nDESCRIPTION: This code snippet demonstrates full traces for a successful syslog decoder in the Wazuh Engine. It shows detailed parsing attempts, successes, and failures for various fields within the event.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_39\n\nLANGUAGE: plaintext\nCODE:\n```\ntraces:\n[🟢] decoder/syslog/0 -> success\n  ↳ [/event/original: <event.start/Jun 14 15:16:01> <host.hostname> <TAG/alphanumeric/->[<process.pid>]:<~/ignore/ ><message>] -> Failure: Parse operation failed: Parser <event.start/Jun 14 15:16:01> failed at: 2018-08-14T14:30:02.203151+02:00 linux-sqrz systemd[4179]: Stopped target Basic System.\n  ↳ [/event/original: <event.start/Jun 14 15:16:01> <host.hostname> <TAG/alphanumeric/->:<~/ignore/ ><message>] -> Failure: Parse operation failed: Parser <event.start/Jun 14 15:16:01> failed at: 2018-08-14T14:30:02.203151+02:00 linux-sqrz systemd[4179]: Stopped target Basic System.\n  ↳ [/event/original: <event.start/2018-08-14T14:30:02.203151+02:00> <host.hostname> <TAG/alphanumeric/->[<process.pid>]: <message>] -> Success\n  ↳ event.kind: map(\"event\") -> Success\n  ↳ wazuh.decoders: array_append(\"syslog\") -> Success\n  ↳ related.hosts: array_append($host.hostname) -> Success\n  ↳ process.name: rename($TAG) -> Success\n  ↳ host.ip: array_append($tmp.host_ip) -> Failure: 'tmp.host_ip' not found\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Windows Handwriting Recognition Error Reporting\nDESCRIPTION: Checks if the 'Turn off handwriting recognition error reporting' setting is properly enabled by verifying the PreventHandwritingErrorReports registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_32\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Uppercase Conversion Function in Wazuh\nDESCRIPTION: Converts any lowercase characters in a string to uppercase. The result replaces the target field if it exists or creates it if it doesn't.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_64\n\nLANGUAGE: yaml\nCODE:\n```\nfield: upcase(lower_characters)\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Basic Settings\nDESCRIPTION: Sets up basic CMake configuration including minimum version requirements, C++ standard settings, and project metadata.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.22.1 FATAL_ERROR)\n\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_EXPORT_COMPILE_COMMANDS ON)\nset(CMAKE_CXX_STANDARD_REQUIRED True)\n\nproject(wazuh-engine\n    VERSION 0.1\n    LANGUAGES CXX\n)\n```\n\n----------------------------------------\n\nTITLE: Installing API Communication Package in Python\nDESCRIPTION: This snippet shows how to install the api_communication package using pip. The package is designed to facilitate communication with the engine API, allowing execution of commands and operations on engine components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip3 install tools/api_communication\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Behavior Settings in Registry\nDESCRIPTION: Registry check to verify the Application Event Log behavior when log file reaches maximum size is disabled as required by CIS benchmark 18.9.26.1.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_70\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Registration if URL connection is referring to Microsoft.com' Registry Setting\nDESCRIPTION: Verifies that 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled' by checking the NoRegistration value in the Registration Wizard Control registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Microsoft Internet Connection Wizard\nDESCRIPTION: Checks if 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is properly enabled by verifying the ExitOnMSICW registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_33\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Request Settings in Windows Registry\nDESCRIPTION: Verifies that the computer is set to ignore NetBIOS name release requests except from WINS servers in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_44\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Simultaneous Internet Connection Minimization Settings in Windows Registry\nDESCRIPTION: Verifies that the policy to minimize the number of simultaneous connections to the Internet or a Windows Domain is enabled in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_50\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Data Sharing Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that handwriting personalization data sharing is turned off by ensuring the PreventHandwritingDataSharing value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_100\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Registry Setting\nDESCRIPTION: Registry check to ensure downloading print drivers over HTTP is disabled by verifying DisableWebPnPDownload is set to 1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_139\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Registration if URL connection Registry Settings\nDESCRIPTION: Checks if 'Turn off Registration if URL connection is referring to Microsoft.com' is enabled by verifying that NoRegistration is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_291\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Require a password when a computer wakes (on battery)' Registry Setting\nDESCRIPTION: Verifies that 'Require a password when a computer wakes (on battery)' is set to 'Enabled' by checking the DCSettingIndex value in the Power\\PowerSettings registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> !DCSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Network Parameter Security Settings\nDESCRIPTION: Checks for proper network security parameters including IP forwarding and packet redirect settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: regex\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Check AutoRun Default Behavior\nDESCRIPTION: Verifies that AutoRun default behavior is set to not execute any autorun commands through the NoAutorun registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_102\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoAutorun -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoAutorun;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off printing over HTTP' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off printing over HTTP' setting is enabled in the Windows registry. It verifies the DisableHTTPPrinting value is set to 1 in the specified registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_196\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Configuring Wazuh API Interface Library\nDESCRIPTION: Creates and configures an interface library named 'api' with include directories and links to all component libraries. Sets up the necessary dependencies for the main API library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(api INTERFACE)\ntarget_include_directories(api INTERFACE\n  ${CMAKE_CURRENT_SOURCE_DIR}/include\n)\ntarget_link_libraries(api INTERFACE\n  api::catalog\n  api::geo\n  api::policy\n  api::router\n  api::tester\n  api::kvdb\n  api::event\n)\n```\n\n----------------------------------------\n\nTITLE: Network Parameter Security Checks\nDESCRIPTION: Verifies secure network parameter settings including IP forwarding and routing configurations\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring HLP Unit Tests in CMake\nDESCRIPTION: Sets up the unit test configuration for the HLP library using Google Test framework. Includes test source files and necessary link dependencies. Tests are only built when ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/hlp/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\nadd_executable(hlp_utest\n  ${UNIT_SRC_DIR}/hlp_test.cpp\n  ${UNIT_SRC_DIR}/text_test.cpp\n  ${UNIT_SRC_DIR}/literal_test.cpp\n  ${UNIT_SRC_DIR}/numeric_test.cpp\n  ${UNIT_SRC_DIR}/eof_test.cpp\n  ${UNIT_SRC_DIR}/alnum_test.cpp\n  ${UNIT_SRC_DIR}/bool_test.cpp\n  ${UNIT_SRC_DIR}/between_test.cpp\n  ${UNIT_SRC_DIR}/date_test.cpp\n  ${UNIT_SRC_DIR}/binary_test.cpp\n  ${UNIT_SRC_DIR}/json_test.cpp\n  ${UNIT_SRC_DIR}/ip_test.cpp\n  ${UNIT_SRC_DIR}/ignore_test.cpp\n  ${UNIT_SRC_DIR}/xml_test.cpp\n  ${UNIT_SRC_DIR}/quoted_test.cpp\n  ${UNIT_SRC_DIR}/file_test.cpp\n  ${UNIT_SRC_DIR}/web_test.cpp\n  ${UNIT_SRC_DIR}/kvmap_test.cpp\n  ${UNIT_SRC_DIR}/dsv_csv_test.cpp\n)\n\ntarget_link_libraries(hlp_utest PRIVATE hlp GTest::gtest_main)\ngtest_discover_tests(hlp_utest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Checking Partition Scheme for /var and /home\nDESCRIPTION: Verifies if /var and /home are on separate partitions as recommended by CIS benchmark. Checks the /etc/fstab file for these mount points.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\n[CIS - Red Hat Linux - - Build considerations - Robust partition scheme - /var is not on its own partition] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/fstab -> !r:/var;\n\n[CIS - Red Hat Linux - - Build considerations - Robust partition scheme - /home is not on its own partition] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_RHLinux_Benchmark_v1.0.5.pdf]\nf:/etc/fstab -> !r:/home;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Minimum Version\nDESCRIPTION: Specifies the minimum required CMake version to build the project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/tool/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n```\n\n----------------------------------------\n\nTITLE: TaskFlow Library Configuration\nDESCRIPTION: Configures the TaskFlow static library with its source files, include directories, and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/bk/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nset(TASKF_SRC_DIR ${SRC_DIR}/taskf)\n\nadd_library(bk_taskf STATIC\n    ${TASKF_SRC_DIR}/controller.cpp\n)\ntarget_include_directories(bk_taskf\n    PUBLIC\n    ${INC_DIR}\n    ${taskflow_SOURCE_DIR}\n\n    PRIVATE\n    ${TASKF_SRC_DIR}\n    ${INC_DIR}/bk/taskf\n)\ntarget_link_libraries(bk_taskf PUBLIC bk::ibk)\nadd_library(bk::taskf ALIAS bk_taskf)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Memory Dumps Configuration\nDESCRIPTION: Ensures that 'Automatically send memory dumps for OS-generated error reports' is disabled by verifying the AutoApproveOSDumps registry value is set to 0 or does not exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_83\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> AutoApproveOSDumps -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !AutoApproveOSDumps;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Settings\nDESCRIPTION: Verifies that Windows Error Reporting is disabled by checking registry values. The check ensures Disabled is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_20\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Configuring Base Library in CMake\nDESCRIPTION: Defines the 'base' library, its source files, include directories, and dependencies. It uses the fmt and spdlog libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/base/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(base STATIC\n    ${SRC_DIR}/utils/wazuhProtocol/wazuhRequest.cpp\n    ${SRC_DIR}/utils/ipUtils.cpp\n    ${SRC_DIR}/utils/stringUtils.cpp\n    ${SRC_DIR}/utils/timeUtils.cpp\n    ${SRC_DIR}/expression.cpp\n    ${SRC_DIR}/json.cpp\n    ${SRC_DIR}/logging.cpp\n)\ntarget_include_directories(base\n    PUBLIC\n    ${INC_DIR}\n\n    PRIVATE\n    ${INC_DIR}/base\n    ${SRC_DIR}\n)\ntarget_link_libraries(base\n    PUBLIC\n    fmt::fmt-header-only\n    spdlog::spdlog\n)\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Secure Desktop for Elevation Prompts in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Switch to the secure desktop when prompting for elevation' is enabled. Checks if PromptOnSecureDesktop registry value is set to 1 to provide a more secure elevation environment.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_34\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> PromptOnSecureDesktop -> 0;\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Turn off Internet Services and Web Downloads\nDESCRIPTION: Verifies registry settings to disable web services and internet downloads, including web publishing wizards and online ordering features\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.4 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring OpenSCAP policy monitoring checks during installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_8\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.4\nrunopenscap=\"Do you want to run policy monitoring checks? (OpenSCAP)\"\nnorunopenscap=\"Not running OpenSCAP (policy monitoring checks)\"\nyesrunopenscap=\"Running OpenSCAP (policy monitoring checks)\"\n```\n\n----------------------------------------\n\nTITLE: Using APIClient to Retrieve Resources from Wazuh Engine\nDESCRIPTION: Demonstrates how to use the APIClient class to connect to the Wazuh engine and retrieve a resource. It includes error handling and uses protobuf for request and response messages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/api-communication/README.md#2025-04-17_snippet_2\n\nLANGUAGE: python\nCODE:\n```\n# Import the APIClient class\nfrom api_communication.client import APIClient \n# Import the proto file, with the request and response messages\nfrom api_communication.proto.catalog_pb2 import ResourceGet_Request, ResourceGet_Response\n\nclient = APIClient()\nclient.connect()\n\n    # Create the json request \n    json_request = dict()\n    json_request['namespaceid'] = args['namespace']\n    json_request['name'] = args['asset']\n    json_request['format'] = args['format']\n\n    # Create the api request\n    try:\n        client = APIClient(api_socket)\n        error, response = client.jsend(\n            json_request, ResourceGet_Request(), ResourceGet_Response())\n\n        if error:\n            sys.exit(f'Error getting asset or collection: {error}')\n\n        print(response['content'])\n\n    except Exception as e:\n        sys.exit(f'Error getting asset or collection: {e}')\n\n    return 0\n```\n\n----------------------------------------\n\nTITLE: IPv6 Configuration Check\nDESCRIPTION: Validates that IPv6 is properly disabled by checking if the DisabledComponents parameter is set to 0xff (255).\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> DisabledComponents -> !ff;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !DisabledComponents;\n```\n\n----------------------------------------\n\nTITLE: Integer Greater Than or Equal Check - int_greater_or_equal()\nDESCRIPTION: Validates if an integer field is greater than or equal to specified value. Accepts integers between -2^63 and 2^63-1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_13\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_greater_or_equal(22)\n```\n\n----------------------------------------\n\nTITLE: Checking Printer Driver Installation Restrictions in Windows Registry\nDESCRIPTION: This snippet verifies if 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'. It aligns with CIS Benchmark 2.3.4.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> AddPrinterDrivers -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Minimization Policy in Windows Registry\nDESCRIPTION: Verifies that the policy to minimize simultaneous connections to the Internet or Windows Domain is enabled by checking if 'fMinimizeConnections' is not set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_84\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Setting File Permissions\nDESCRIPTION: Sets 644 permissions for all YML and JSON configuration files in the module\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\n# chmod 644 wazuh/module.yml\n# chmod 644 wazuh/_meta/config.yml\n# chmod 644 wazuh/_meta/docs.asciidoc\n# chmod 644 wazuh/_meta/fields.yml\n# chmod 644 wazuh/alerts/manifest.yml\n# chmod 644 wazuh/alerts/config/alerts.yml\n# chmod 644 wazuh/alerts/ingest/pipeline.json\n# chmod 644 wazuh/archives/manifest.yml\n# chmod 644 wazuh/archives/config/archives.yml\n# chmod 644 wazuh/archives/ingest/pipeline.json\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Windows Customer Experience Improvement Program' setting is enabled in the Windows registry. It verifies the CEIPEnable value in the SQMClient\\Windows policy key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_304\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows System User Enumeration Settings in Registry\nDESCRIPTION: Registry checks that verify user enumeration settings are properly configured according to CIS benchmarks. These checks ensure domain-joined computers don't enumerate connected users and related security settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_58\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontEnumerateConnectedUsers -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontEnumerateConnectedUsers;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Restart Configuration\nDESCRIPTION: Ensures that 'No auto-restart with logged on users for scheduled automatic updates installations' is disabled by verifying the NoAutoRebootWithLoggedOnUsers registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_97\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoRebootWithLoggedOnUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating HTTP Printing Registry Settings\nDESCRIPTION: Registry checks to verify HTTP printing is disabled via DisableHTTPPrinting key\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_145\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Windows Messenger CEIP Settings\nDESCRIPTION: Registry check to verify that 'Turn off the Windows Messenger Customer Experience Improvement Program' is enabled. Checks if the CEIP key exists and is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_117\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Anonymous Access Controls\nDESCRIPTION: Checks registry settings related to anonymous access to network resources including named pipes, shares and registry paths.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionPipes -> !r:lsarpc|netlogon|samr;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionShares -> r:\\.+;\n```\n\n----------------------------------------\n\nTITLE: Checking for IMAP and POP3 Services in RHEL7\nDESCRIPTION: Detects if IMAP and POP3 services (Cyrus and Dovecot) are enabled in xinetd configuration. These services should be disabled if not required.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_21\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/cyrus-imapd -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/dovecot -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Check HTTP Print Driver Download Registry Settings\nDESCRIPTION: Confirms that downloading print drivers over HTTP is disabled by checking registry keys under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_143\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Displaying Graph History Traces in Wazuh Engine\nDESCRIPTION: This code snippet shows an example of graph history traces in the Wazuh Engine. It displays the processing status of various decoders, indicating whether they succeeded or failed in processing an event.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_38\n\nLANGUAGE: plaintext\nCODE:\n```\ntraces:\n[🔴] decoder/zeek-x509/0 -> failed\n[🔴] decoder/zeek-weird/0 -> failed\n[🔴] decoder/zeek-traceroute/0 -> failed\n[🔴] decoder/zeek-stats/0 -> failed\n[🔴] decoder/zeek-software/0 -> failed\n[🔴] decoder/zeek-socks/0 -> failed\n[🔴] decoder/zeek-snmp/0 -> failed\n[🔴] decoder/zeek-smb_mapping/0 -> failed\n[🔴] decoder/zeek-smb_files/0 -> failed\n[🔴] decoder/apache-error/0 -> failed\n[🔴] decoder/zeek-smb_cmd/0 -> failed\n[🔴] decoder/zeek-ssl/0 -> failed\n[🔴] decoder/snort-json/0 -> failed\n[🔴] decoder/squid-access/0 -> failed\n[🔴] decoder/zeek-known_certs/0 -> failed\n[🔴] decoder/suricata/0 -> failed\n[🔴] decoder/zeek-irc/0 -> failed\n[🔴] decoder/microsoft-exchange-server-smtp/0 -> failed\n[🔴] decoder/snort-plaintext/0 -> failed\n[🔴] decoder/pfsense-firewall/0 -> failed\n[🔴] decoder/pfsense-dhcp/0 -> failed\n[🔴] decoder/apache-access/0 -> failed\n[🔴] decoder/snort-plaintext-csv/0 -> failed\n[🔴] decoder/zeek-sip/0 -> failed\n[🔴] decoder/pfsense-unbound/0 -> failed\n[🔴] decoder/iis/0 -> failed\n[🔴] decoder/zeek-signature/0 -> failed\n[🔴] decoder/modsecurity-nginx/0 -> failed\n[🔴] decoder/microsoft-dhcpv6/0 -> failed\n[🔴] decoder/zeek-conn/0 -> failed\n[🔴] decoder/zeek-modbus/0 -> failed\n[🔴] decoder/microsoft-exchange-server-imap4-pop3/0 -> failed\n[🔴] decoder/pfsense-php-fpm/0 -> failed\n[🔴] decoder/microsoft-exchange-server-messagetracking/0 -> failed\n[🔴] decoder/microsoft-exchange-server-httpproxy/0 -> failed\n[🔴] decoder/zeek-kerberos/0 -> failed\n[🔴] decoder/modsecurity-apache/0 -> failed\n[🔴] decoder/microsoft-dhcp/0 -> failed\n[🔴] decoder/zeek-pe/0 -> failed\n[🔴] decoder/windows-event/0 -> failed\n[🔴] decoder/zeek-capture_loss/0 -> failed\n[🔴] decoder/zeek-dhcp/0 -> failed\n[🔴] decoder/zeek-dnp3/0 -> failed\n[🔴] decoder/zeek-dns/0 -> failed\n[🔴] decoder/zeek-smtp/0 -> failed\n[🔴] decoder/zeek-http/0 -> failed\n[🔴] decoder/zeek-rfb/0 -> failed\n[🔴] decoder/zeek-files/0 -> failed\n[🔴] decoder/zeek-ftp/0 -> failed\n[🔴] decoder/zeek-ssh/0 -> failed\n[🔴] decoder/zeek-ocsp/0 -> failed\n[🔴] decoder/zeek-dce_rpc/0 -> failed\n[🔴] decoder/zeek-intel/0 -> failed\n[🔴] decoder/zeek-syslog/0 -> failed\n[🔴] decoder/zeek-known_hosts/0 -> failed\n[🔴] decoder/zeek-dpd/0 -> failed\n[🔴] decoder/zeek-known_services/0 -> failed\n[🔴] decoder/zeek-mysql/0 -> failed\n[🔴] decoder/zeek-ntlm/0 -> failed\n[🔴] decoder/zeek-tunnel/0 -> failed\n[🔴] decoder/zeek-notice/0 -> failed\n[🔴] decoder/zeek-ntp/0 -> failed\n[🔴] decoder/zeek-radius/0 -> failed\n[🟢] decoder/syslog/0 -> success\n[🔴] decoder/sysmon-linux/0 -> failed\n[🔴] decoder/system-auth/0 -> failed\n[🔴] decoder/snort-plaintext-syslog/0 -> failed\n[🔴] decoder/wazuh-dashboard/0 -> failed\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Customer Experience Improvement Program'\nDESCRIPTION: Registry check rule that verifies if 'Turn off Windows Customer Experience Improvement Program' is properly configured by ensuring CEIPEnable registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_249\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Creating Static Library for API Policy in CMake\nDESCRIPTION: Defines a static library for API policy, specifies source files, sets include directories, and links dependencies. Creates an alias for easier referencing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/policy/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(api_policy STATIC\n  ${SRC_DIR}/policy.cpp\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_policy\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_policy\n    PUBLIC\n    base\n    api::policy::ipolicy\n    api::adapter\n    store::istore\n    builder::ibuilder\n)\nadd_library(api::policy ALIAS api_policy)\n```\n\n----------------------------------------\n\nTITLE: Non-root UID 0 Account Check Rule\nDESCRIPTION: Rule to detect non-root accounts with UID 0 in /etc/passwd file. This is a security check that complies with CIS benchmark 9.2.5 and PCI_DSS 10.2.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking Anonymous SAM Account Enumeration Settings\nDESCRIPTION: Registry checks to prevent anonymous enumeration of SAM accounts and ensure proper security restrictions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_20\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymousSAM -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymous -> !1;\n```\n\n----------------------------------------\n\nTITLE: Setting Output Directories and Source Files\nDESCRIPTION: Configures runtime output directory and defines source files for the keystore component.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nset(ORIGINAL_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_RUNTIME_OUTPUT_DIRECTORY})\nset(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${SRC_FOLDER})\n\nfile(GLOB KEYSTORE_SRC\n    \"src/keyStore.cpp\"\n    )\n```\n\n----------------------------------------\n\nTITLE: Configuring Store Interface Library in CMake\nDESCRIPTION: Creates an interface library for the store module, setting up include directories and linking with the base library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\n## Interface\nadd_library(store_istore INTERFACE)\ntarget_include_directories(store_istore INTERFACE ${IFACE_DIR})\ntarget_link_libraries(store_istore INTERFACE base)\nadd_library(store::istore ALIAS store_istore)\n```\n\n----------------------------------------\n\nTITLE: Defining Source Directories for Wazuh Store Module in CMake\nDESCRIPTION: Sets up directory variables for source, include, interface, and driver files. These variables are used throughout the configuration to specify file locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\n# Defs\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n\nset(DRIVER_DIR ${CMAKE_CURRENT_LIST_DIR}/drivers)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off downloading of print drivers over HTTP'\nDESCRIPTION: Verifies that the DisableWebPnPDownload registry value is set to 1, which prevents Windows from downloading printer drivers over HTTP connections.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_183\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP Registry Settings\nDESCRIPTION: Verifies that the Windows Customer Experience Improvement Program is disabled by checking registry values. The check ensures CEIPEnable is set to 0 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_19\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Restrictions for Local Accounts on Network Logons\nDESCRIPTION: Ensures that UAC restrictions apply to local accounts on network logons by verifying 'LocalAccountTokenFilterPolicy' is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_85\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> LocalAccountTokenFilterPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off printing over HTTP Registry Settings\nDESCRIPTION: Checks if 'Turn off printing over HTTP' is enabled by verifying that DisableHTTPPrinting is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_290\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Configuring Output in Wazuh Engine (YAML)\nDESCRIPTION: Example showing how to configure output destinations for processed events in the Wazuh Engine.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_36\n\nLANGUAGE: yaml\nCODE:\n```\noutputs:\n  - output_name: configuration\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Suite Package\nDESCRIPTION: Commands for installing the engine-suite package. Includes options for standard installation and development mode installation with additional packages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip3 install tools/engine-suite\n```\n\nLANGUAGE: bash\nCODE:\n```\npip3 install -e tools/engine-suite[dev]\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the advertising ID' Registry Setting\nDESCRIPTION: Verifies that 'Turn off the advertising ID' is set to 'Enabled' by checking the DisabledByGroupPolicy value in the AdvertisingInfo registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_19\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> DisabledByGroupPolicy -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> !DisabledByGroupPolicy;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Log Size Setting\nDESCRIPTION: Checks if the Windows Firewall Private Profile log size is set to at least 16384 KB as recommended by CIS benchmark 9.2.8. Includes checks for both policy and system registry locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_53\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking Server SPN Target Name Validation Level\nDESCRIPTION: Verifies the SMB server name hardening level is properly configured to accept client-provided SPNs or higher.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_19\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> SMBServerNameHardeningLevel -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !SMBServerNameHardeningLevel;\n```\n\n----------------------------------------\n\nTITLE: Directory Structure Display in Bash\nDESCRIPTION: Shows the directory structure of the engine decoder tool implementation, displaying the main package and command modules organization.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_decoder/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n├── engine_decoder/\n|   └── cmds\n|       └── __init__.py\n|       └── list_extracted.py\n|       └── syntax_update.py\n|   └── __init__.py\n|   └── __main__.py\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Private Profile State\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Firewall state' is set to 'On' in compliance with CIS benchmark 9.2.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off the \"Publish to Web\" task for files and folders' Registry Setting\nDESCRIPTION: Verifies the NoPublishingWizard registry key is set to 1 in Explorer policies, which disables the \"Publish to Web\" task in Windows. This prevents users from easily publishing sensitive data to web locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_77\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet Connection Wizard for Microsoft.com' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' setting is enabled in the Windows registry. It verifies the ExitOnMSICW value in the Internet Connection Wizard key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_163\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Registry Settings\nDESCRIPTION: Verifies that printing over HTTP is disabled by checking registry values. The check ensures DisableHTTPPrinting is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_27\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking IP Source Routing Protection Level in Windows Registry\nDESCRIPTION: Verifies that IP source routing protection is set to the highest level in the Windows registry. This helps protect against packet spoofing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_42\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking for MYSQL_PWD Environment Variable\nDESCRIPTION: This check looks for the MYSQL_PWD environment variable in various environment files, which could pose a security risk if used.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_enterprise_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 1.6: 'MYSQL_PWD' Is in Use] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$enviroment_files -> r:\\.*MYSQL_PWD\\.*;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Search Companion content file updates' Registry Setting\nDESCRIPTION: Ensures 'Turn off Search Companion content file updates' is set to 'Enabled' by checking the DisableContentFileUpdates value in the SearchCompanion registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off access to the Store'\nDESCRIPTION: Registry check rule that verifies if 'Turn off access to the Store' is properly configured by ensuring NoUseStoreOpenWith registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_251\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Setting Up RBAC Test Environment in CMake\nDESCRIPTION: Configures the test environment for RBAC, including mock libraries and test executables. This section is only processed if ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/rbac/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\n# Tests\nif(ENGINE_BUILD_TEST)\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n\nadd_library(rbac_mocks INTERFACE)\n\ntarget_include_directories(rbac_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(rbac_mocks INTERFACE GTest::gmock rbac::irbac)\nadd_library(rbac::mocks ALIAS rbac_mocks)\n\nadd_executable(rbac_test\n  ${TEST_SRC_DIR}/rbac_test.cpp\n  ${TEST_SRC_DIR}/permission_test.cpp\n  ${TEST_SRC_DIR}/role_test.cpp\n)\n\ntarget_include_directories(rbac_test\n    PRIVATE\n    ${TEST_SRC_DIR}\n)\n\ntarget_link_libraries(rbac_test GTest::gtest_main base rbac store::mocks)\ngtest_discover_tests(rbac_test)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Successful Connections Logging\nDESCRIPTION: Ensures that Windows Firewall Public Profile is configured to log successful connections according to CIS benchmark 9.3.10. Checks both policy and system registry paths for LogSuccessfulConnections value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_65\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Local Admin Password Management\nDESCRIPTION: Registry check to verify that 'Enable Local Admin Password Management' is set to 'Enabled' per CIS benchmark 18.2.3. The check confirms that AdmPwdEnabled is set to 1 in the AdmPwd registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_70\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> AdmPwdEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !AdmPwdEnabled;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Unencrypted Traffic Configuration\nDESCRIPTION: Ensures that 'Allow unencrypted traffic' for WinRM service is disabled by verifying the AllowUnencryptedTraffic registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_93\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Creating Interface Library for Queue in CMake\nDESCRIPTION: Defines an interface library 'queue_iqueue' with its include directories and dependencies, and creates an alias 'queue::iqueue'.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/queue/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\n# # Interface\nadd_library(queue_iqueue INTERFACE)\ntarget_include_directories(queue_iqueue INTERFACE ${IFACE_DIR})\ntarget_link_libraries(queue_iqueue INTERFACE base)\nadd_library(queue::iqueue ALIAS queue_iqueue)\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Shell Access Setting in Windows Registry\nDESCRIPTION: Ensures that the 'Allow Remote Shell Access' setting is disabled by checking the AllowRemoteShellAccess value in the WinRM Service WinRS registry key. Also verifies the absence of the AllowRemoteShellAccess key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_329\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> AllowRemoteShellAccess -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> !AllowRemoteShellAccess;\n```\n\n----------------------------------------\n\nTITLE: Parsing IP Addresses in Wazuh Normalization (YAML/JSON)\nDESCRIPTION: The parse_ip function validates and parses strings representing IP addresses in IPv4 or IPv6 format. It checks for compliance with IP addressing standards and stores the valid IP address in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_113\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_ip($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"192.168.1.1\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"192.168.1.1\",\n  \"target_field\": \"192.168.1.1\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Build Type for Wazuh Benchmarks in CMake\nDESCRIPTION: This snippet checks if the build type is set to Release or RelWithDebInfo. If not, it displays a warning message about potentially inaccurate benchmark results.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nif(NOT CMAKE_BUILD_TYPE STREQUAL \"Release\"\n        AND NOT CMAKE_BUILD_TYPE STREQUAL \"RelWithDebInfo\")\n    message(WARNING\n        \"Building and running benchmarks with a non release build will give bogus data\"\n        )\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen App Notification Settings\nDESCRIPTION: Ensures that app notifications on the lock screen are disabled by checking if 'DisableLockScreenAppNotifications' is not set to 1 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_95\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DisableLockScreenAppNotifications -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DisableLockScreenAppNotifications;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Allow unencrypted traffic' for WinRM Client Registry Setting\nDESCRIPTION: Checks if 'AllowUnencryptedTraffic' is set to 0 (Disabled) for WinRM client to prevent unencrypted communication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_131\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Asset Processing Flow Diagram with Mermaid\nDESCRIPTION: Flowchart showing the event processing stages and possible outcomes (success/failure) in the asset processing pipeline\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_15\n\nLANGUAGE: mermaid\nCODE:\n```\nflowchart TB\n\nclassDef partsAssetsClass font-size:15px,stroke-width:2px,stroke-dasharray:10px,rx:15,ry:15\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\nclassDef stateFailClass fill:#f50057,stroke-width:2px,fill-opacity:0.5\nclassDef stateSuccessClass fill:#2196f3,stroke-width:2px,fill-opacity:0.8\n\neventInput@{ shape: doc, label: \"Event input\"}\neventInput:::EventBoxClass\neventInput ---> stage_1\n\nsubgraph stages[\"Stages\"]\n   direction TB\n   stage_1([\"Process stage 1\"])\n   stage_2([\"Process stage 2\"])\n   stage_3([\"Process stage ...\"])\n   stage_4([\"Process stage n\"])\n   stage_1 --->|success| stage_2\n   stage_2 --->|success| stage_3\n   stage_3 --->|success| stage_4\nend\nstages:::partsAssetsClass\n\nfailedState@{ shape: dbl-circ, label: \"Asset fail\" }\nfailedState:::stateFailClass\nstage_1 --->|failed|failedState\nstage_2 --->|failed|failedState\nstage_3 --->|failed|failedState\n\nsuccessState@{ shape: dbl-circ, label: \"Asset success\" }\nsuccessState:::stateSuccessClass\nstage_4 --->|success| successState\n```\n\n----------------------------------------\n\nTITLE: Basic Parser Expression Example for Client-Server Connection\nDESCRIPTION: A simple parser expression that captures an IP address or hostname into client.ip or client.address fields, and optionally captures a port into server.port if present.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_32\n\nLANGUAGE: yaml\nCODE:\n```\n<client.ip>?<client.address> connected to <server.ip>(?:<server.port>)\n```\n\n----------------------------------------\n\nTITLE: Creating Required Folders for Wazuh Engine\nDESCRIPTION: Commands to create the necessary folder structure for running Wazuh Engine tests. Sets up directories with proper permissions and ownership based on the current user.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-tests.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n# Create the necessary folders\nexport WHOAMI=$(whoami)\nsudo install -d -m 0750 -o ${WHOAMI} /var/lib/wazuh-server/\nsudo install -d -m 0750 -o ${WHOAMI} /var/lib/wazuh-server/engine/\nsudo install -d -m 0750 -o ${WHOAMI} /run/wazuh-server/\n```\n\n----------------------------------------\n\nTITLE: Checking 'Enable Windows NTP Client' Registry Setting\nDESCRIPTION: Ensures 'Enable Windows NTP Client' is set to 'Enabled' by checking the Enabled value in the W32Time\\TimeProviders\\NtpClient registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_20\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> Enabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> !Enabled;\n```\n\n----------------------------------------\n\nTITLE: Installing Health Test Package\nDESCRIPTION: Command to install the engine health test package using pip\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip install ./engine-health-test\n```\n\n----------------------------------------\n\nTITLE: Verifying WDigest Authentication Settings in Windows Registry\nDESCRIPTION: Checks if WDigest Authentication is disabled in the Windows registry for improved security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_51\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Dropped Packets Logging\nDESCRIPTION: Verifies that Windows Firewall Private Profile is configured to log dropped packets according to CIS benchmark 9.2.9. Checks both policy and system registry paths for LogDroppedPackets value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_54\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Services Registry Settings\nDESCRIPTION: Registry checks to verify that Internet download for Web publishing and online ordering wizards is disabled per CIS benchmark 18.8.20.1.6. The check ensures NoWebServices is set to 1 in the Explorer policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_56\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Order Prints Task Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that the 'Order Prints' picture task is turned off by ensuring the NoOnlinePrintsWizard value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_107\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Command Line Inclusion in Process Creation Events\nDESCRIPTION: Ensures that command line details are not included in process creation events by checking if 'ProcessCreationIncludeCmdLine_Enabled' is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_87\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit -> ProcessCreationIncludeCmdLine_Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Logging for Successful Connections\nDESCRIPTION: Verifies that Windows Firewall Domain Profile is configured to log successful connections by checking registry keys. The check fails if LogSuccessfulConnections is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_27\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Secure Channel Data Signing in Windows Registry\nDESCRIPTION: This snippet checks if 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'. It corresponds to CIS Benchmark 2.3.6.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SignSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Internet Connection Wizard Settings\nDESCRIPTION: Registry check to verify that 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is enabled. Checks if the ExitOnMSICW key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_110\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Order Prints\" picture task' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off the \"Order Prints\" picture task' setting is enabled in the Windows registry. It verifies the NoOnlinePrintsWizard value in the Explorer policy key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_301\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Inbound Connections\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Inbound connections' is set to 'Block (default)' as required by CIS benchmark 9.2.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_19\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Systemd Service Configuration\nDESCRIPTION: Service configurations for NIS server and client services in systemd\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_2\n\nLANGUAGE: systemd\nCODE:\n```\nf:/usr/lib/systemd/system/ypserv.service -> r:Exec;\nf:/usr/lib/systemd/system/ypbind.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off handwriting recognition error reporting Registry Settings\nDESCRIPTION: Checks if the 'Turn off handwriting recognition error reporting' setting is enabled by verifying that PreventHandwritingErrorReports is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_287\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Visualizing Rules Tree Structure in Wazuh\nDESCRIPTION: This diagram illustrates the hierarchical structure of rules in Wazuh. It shows how events are processed through multiple levels of rules, with each matching rule potentially triggering its child rules for evaluation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_7\n\nLANGUAGE: mermaid\nCODE:\n```\n---\ntitle: Rules tree\n---\nflowchart TD\n\n%% Style\n  classDef AssetSuccessClass fill:#2196f3,stroke-width:2px,fill-opacity:0.8\n  classDef AssetFailClass fill:#f50057,stroke-width:2px,fill-opacity:0.8\n  classDef AssetNotExecutedClass fill:#90a4ae,stroke-width:2px,fill-opacity:0.8\n  ruleR(\"root rule\") --x rule1(\"rule 1\")\n  rule1 -.-> rule11(\"rule 1-1\") & rule12(\"rule 1-2\")\n  ruleR --> rule2(\"rule 2\")\n  rule2 --> rule21(\"rule 2-1\")\n  rule2 --x rule22(\"rule 2-2\")\n  rule2 --> rule23(\"rule 2-3\")\n  ruleR --> rule3(\"rule 3\")\n  rule3 --> rule31(\"rule 3-1\")\n\n  ruleR:::AssetSuccessClass\n  rule1:::AssetFailClass\n  rule11:::AssetNotExecutedClass\n  rule12:::AssetNotExecutedClass\n  rule2:::AssetSuccessClass\n  rule21:::AssetSuccessClass\n  rule22:::AssetFailClass\n  rule23:::AssetSuccessClass\n  rule3:::AssetSuccessClass\n  rule31:::AssetSuccessClass\n  linkStyle 0,5 stroke:#f50057,stroke-width:2px\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Search Companion content file updates are disabled according to CIS benchmark 18.8.20.1.9. The rules verify if the DisableContentFileUpdates registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_267\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Verifying Maximum Authentication Attempts in SSH\nDESCRIPTION: Checks if the maximum number of authentication attempts is set to the recommended value of 4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 9: Wrong Maximum number of authentication attempts {PCI_DSS: 2.2.4}] [any] [9]\nf:$sshd_file -> !r:^\\s*MaxAuthTries\\s+4\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Camera Settings in Windows Registry\nDESCRIPTION: Registry check to verify that the 'Prevent enabling lock screen camera' policy is set to 'Enabled' per CIS benchmark 18.1.1.1. The check validates that NoLockScreenCamera is set to 1 in the Windows Personalization registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_66\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenCamera -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking Screen Saver Grace Period\nDESCRIPTION: Registry check to verify that 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires' is set to 'Enabled: 5 or fewer seconds' per CIS benchmark 18.3.9. The check confirms that ScreenSaverGracePeriod is 5 or less.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_80\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> r:\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Setting Up Test Library and Subdirectories\nDESCRIPTION: Configures the test library interface and adds tool and test subdirectories to the build.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(indexerconnector_test INTERFACE)\ntarget_include_directories(indexerconnector_test INTERFACE ${CMAKE_CURRENT_LIST_DIR}/src)\nadd_library(indexerconnector::test ALIAS indexerconnector_test)\n\nadd_subdirectory(tool)\nadd_subdirectory(test)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Internet download for Web publishing wizards' Setting\nDESCRIPTION: Registry checks to verify if the 'NoWebServices' key is set to 1, which disables Internet downloads for Web publishing and online ordering wizards. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_64\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Successfully Adding Unique Values with array_append_unique in Wazuh\nDESCRIPTION: Shows a successful use of array_append_unique where the value being added doesn't already exist in the array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_74\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_unique(5)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    5\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Router Interface Library\nDESCRIPTION: Creates and configures the router interface library with necessary include directories and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(router_irouter INTERFACE)\ntarget_include_directories(router_irouter INTERFACE ${IFACE_DIR})\ntarget_link_libraries(router_irouter INTERFACE base)\nadd_library(router::irouter ALIAS router_irouter)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the \"Order Prints\" picture task'\nDESCRIPTION: Registry check rule that verifies if 'Turn off the \"Order Prints\" picture task' is properly configured by ensuring NoOnlinePrintsWizard registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_246\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store OS Upgrade Configuration in Registry\nDESCRIPTION: Ensures that 'Turn off the offer to update to the latest version of Windows' is enabled by verifying the DisableOSUpgrade value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_81\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Visualizing Event Router Flow with Mermaid\nDESCRIPTION: Flowchart showing how events are routed through the orchestrator to different security policies based on filters.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_0\n\nLANGUAGE: mermaid\nCODE:\n```\nflowchart LR\n\nclassDef EventBoxClass font-size: 15px,stroke-width:2px, color:#fff, fill:#3f51b5\n\nsubgraph routerTable[\"Router Table\"]\n  direction TB\n\n  routeC\n  routeB\n  routeA\n\n\n  subgraph routeA[\"Route prod\"]\n   direction LR\n   policyA(\"Security Policy\")\n   filterA{\"Filter\"}\n   filterA -.-> policyA\n  end\n\n  subgraph routeB[\"Route QA\"]\n   direction LR\n   policyB(\"Security Policy\")\n   filterB{\"Filter\"}\n   filterB -.-> policyB\n  end\n\n  subgraph routeC[\"Route Dev\"]\n   direction LR\n   policyC(\"Security Policy\")\n   filterC{\"Filter\"}\n   filterC -.-> policyC\n  end\nend\n\nsubgraph orchestrator[\"Orchestrator (Simplified)\"]\n  direction LR\n  routeSelector(\"Route</br>selector\")\n  routerTable\nend\n\neventA@{ shape: doc, label: \"Incoming</br>event\" }\neventA:::EventBoxClass\neventA-->routeSelector\nrouteSelector-.->filterA & filterB & filterC\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Catalog\nDESCRIPTION: Command to install the engine-catalog tool via pip from the tools/engine-suite directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_catalog/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Checking Network Security Settings\nDESCRIPTION: Validates network security settings including digital signing requirements and idle session timeouts. Covers multiple CIS benchmarks for Microsoft network client and server configurations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters\n```\n\n----------------------------------------\n\nTITLE: Checking Boot-Start Driver Initialization Policy in Windows Registry\nDESCRIPTION: Verifies that the Boot-Start Driver Initialization Policy is set correctly by checking if 'DriverLoadPolicy' is not set to 3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_88\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off Windows Error Reporting' Registry Setting\nDESCRIPTION: Checks if the Disabled registry key is set to 1 in the Windows Error Reporting path, which disables the automatic error reporting feature in Windows. This prevents sending potentially sensitive crash data to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_80\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Disallow Digest authentication' for WinRM Client Registry Setting\nDESCRIPTION: Checks if 'AllowDigest' is set to 0 (Enabled) for WinRM client to disallow Digest authentication which is less secure.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_132\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowDigest -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> !AllowDigest;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off handwriting recognition error reporting' Registry Setting\nDESCRIPTION: Verifies that 'Turn off handwriting recognition error reporting' is set to 'Enabled' by checking the PreventHandwritingErrorReports value in the HandwritingErrorReports registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking User-Mounted Removable Partitions\nDESCRIPTION: Detects if user-mounted removable partitions are allowed on the console.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_35\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Internet Connection Wizard\nDESCRIPTION: Registry check to ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'. Validates the ExitOnMSICW registry value equals 1 or exists in the Internet Connection Wizard policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_233\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off the \"Publish to Web\" task for files and folders\nDESCRIPTION: Validates registry settings to ensure 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled' by checking the NoPublishingWizard value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_311\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Configuration\nDESCRIPTION: Ensures that 'Configure Automatic Updates' is enabled by verifying that NoAutoUpdate registry value is not set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_95\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Checking Machine Inactivity Limit Registry Settings\nDESCRIPTION: Verifies the machine inactivity timeout is set to 900 or fewer seconds but not 0. Checks various registry patterns to ensure compliance with CIS benchmark 2.3.7.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Access Registry Setting\nDESCRIPTION: Registry check to ensure Store access is disabled by verifying NoUseStoreOpenWith is set to 1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_138\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Order Prints Feature\nDESCRIPTION: Verifies that 'Turn off the \"Order Prints\" picture task' is set to 'Enabled' by checking if the NoOnlinePrintsWizard registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_285\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: SSH Configuration Check - Protocol Version\nDESCRIPTION: Checks SSH configuration to ensure Protocol version 1 is not enabled, as required by CIS benchmark 9.2.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Firewall Rules Setting\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to not apply local firewall rules according to CIS benchmark 9.3.5. Examines registry settings in both policy and system locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_60\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking OneDrive File Storage Usage Prevention\nDESCRIPTION: Verifies that OneDrive usage for file storage is prevented as required by CIS benchmark 18.9.47.1. Checks that the DisableFileSyncNGSC registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_110\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> DisableFileSyncNGSC -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> !DisableFileSyncNGSC;\n```\n\n----------------------------------------\n\nTITLE: Network Access Password Storage Check\nDESCRIPTION: Verifies that storage of passwords and credentials for network authentication is disabled through registry settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> DisableDomainCreds -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !DisableDomainCreds;\n```\n\n----------------------------------------\n\nTITLE: Linking Libraries for Wazuh Engine Benchmark in CMake\nDESCRIPTION: This snippet links the necessary libraries to the 'engine_bench_main' target. It includes the Google Benchmark library, as well as 'base' and 'metrics' libraries, which are likely internal Wazuh components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\ntarget_link_libraries(engine_bench_main\n    PUBLIC\n    benchmark::benchmark\n    base\n    metrics\n    )\n```\n\n----------------------------------------\n\nTITLE: Adding Subdirectories for Wazuh Benchmark Components in CMake\nDESCRIPTION: This snippet adds subdirectories for various benchmark components including regex, hlp, logicExpression, and json. There's a commented-out line for 'helperFunctions' which is planned for future implementation after refactoring.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\nadd_subdirectory(regex)\nadd_subdirectory(hlp)\nadd_subdirectory(logicExpression)\n# add_subdirectory(helperFunctions) TODO Implment after refactoring\nadd_subdirectory(json)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Connect Now Settings in Windows Registry\nDESCRIPTION: These snippets verify if 'Configuration of wireless settings using Windows Connect Now' is disabled and 'Prohibit access of the Windows Connect Now wizards' is enabled. They check multiple registry values related to WCN settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_8\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> EnableRegistrars -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !EnableRegistrars;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableUPnPRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableUPnPRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableInBand802DOT11Registrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableInBand802DOT11Registrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableFlashConfigRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableFlashConfigRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableWPDRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableWPDRegistrar;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> DisableWcnUi -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> !DisableWcnUi;\n```\n\n----------------------------------------\n\nTITLE: Integer Less Than or Equal Check - int_less_or_equal()\nDESCRIPTION: Checks if an integer field is less than or equal to specified value. Accepts integers between -2^63 and 2^63-1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_15\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_less_or_equal(22)\n```\n\n----------------------------------------\n\nTITLE: RxCpp Library Configuration\nDESCRIPTION: Sets up the RxCpp static library with its source files, include paths, and necessary dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/bk/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nset(RXCPP_SRC_DIR ${SRC_DIR}/rx)\n\nadd_library(bk_rx STATIC\n    ${RXCPP_SRC_DIR}/controller.cpp\n)\ntarget_include_directories(bk_rx\n    PUBLIC\n    ${INC_DIR}\n    ${RxCpp_SOURCE_DIR}/Rx/v2/src\n\n    PRIVATE\n    ${RXCPP_SRC_DIR}\n    ${INC_DIR}/bk/rx\n)\ntarget_link_libraries(bk_rx PUBLIC bk::ibk)\nadd_library(bk::rx ALIAS bk_rx)\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Registry Settings\nDESCRIPTION: Registry checks to verify that downloading of print drivers over HTTP is disabled per CIS benchmark 18.8.20.1.2. The check ensures DisableWebPnPDownload is set to 1 in the Windows NT Printers policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_52\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Autoplay for Non-Volume Devices Settings in Registry\nDESCRIPTION: Registry checks to ensure that 'Disallow Autoplay for non-volume devices' is enabled as required by CIS benchmark 18.9.8.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_65\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoAutoplayfornonVolume -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoAutoplayfornonVolume;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Warning Registry Settings\nDESCRIPTION: Ensures password expiration warning is set between 5 and 14 days by checking PasswordExpiryWarning registry values. Maps to CIS benchmark 2.3.7.7.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning\n```\n\n----------------------------------------\n\nTITLE: Engine Integration CLI Help Command\nDESCRIPTION: Main help output showing all available subcommands and options for the engine-integration tool\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_1\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration -h\nusage: engine-integration [-h] [--version] [-v]\n                          {create,generate-doc,generate-graph,generate-manifest,add,delete,update}\n                          ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  -v, --verbose         Print traceback on error messages\n\nsubcommands:\n  {create,generate-doc,generate-graph,generate-manifest,add,delete,update}\n    create              Create a new integration project scaffold on the current\n                        directory\n    generate-doc        Generate documentation for the integration, must be run\n                        from the integration directory\n    generate-graph      Generate dot graph for the integration, must be run from\n                        the integration directory\n    generate-manifest   Generate the manifest file of all assets of the\n                        currentintegration. Name of the integration is taken\n                        from the name of thedirectory used\n    add                 Add integration components to the Engine Catalog. If a\n                        step fails it will undo the previous ones\n    delete              Delete integration assets from the Engine Catalog. If a\n                        step fails it continue with the next\n    update              Updates all available intgration components, deletes if\n                        no longer present, adds when new.\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Outbound Connections in Windows Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Outbound connections' is set to 'Allow'. Flags a violation if DefaultOutboundAction registry value is set to 1, which would block outbound connections by default.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_38\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Store Access\nDESCRIPTION: Checks if 'Turn off access to the Store' is properly enabled by verifying the NoUseStoreOpenWith registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_43\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Encryption Level Setting\nDESCRIPTION: Verifies that Terminal Services client connection encryption level is set to High Level as required by CIS benchmark 18.9.52.3.9.3. Checks that the MinEncryptionLevel registry value is set to 3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_116\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MinEncryptionLevel -> !3;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Allow user control over installs' Registry Setting\nDESCRIPTION: Checks if the 'EnableUserControl' registry value is set to 0 (Disabled) to prevent users from changing installation options that affect the system.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_125\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: Creating WPK Certificate and Key\nDESCRIPTION: Generates a new certificate signing request (CSR) and private key for WPK signing\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nopenssl req -new -nodes -newkey rsa:2048 -keyout wpkcert.key -out wpkcert.csr -subj '/C=US/ST=CA/O=Wazuh'\n```\n\n----------------------------------------\n\nTITLE: Checking Background Refresh of Group Policy Settings in Windows Registry\nDESCRIPTION: Verifies that background refresh of Group Policy is not disabled in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_56\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableBkGndGroupPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Port Redirection Settings\nDESCRIPTION: Validates COM port, LPT port, and PnP device redirection settings for Remote Desktop Services through registry checks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_23\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCcm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableLPT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisablePNPRedir -> !1;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off handwriting personalization data sharing' Registry Setting\nDESCRIPTION: Verifies the PreventHandwritingDataSharing registry key is set to 1 in the TabletPC path, which prevents Windows from sending handwriting recognition data to Microsoft. This protects potentially sensitive handwritten content from being shared.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_83\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Registration Wizard Registry Settings\nDESCRIPTION: Verifies that Registration Wizard is disabled for Microsoft.com references by checking registry values. The check ensures NoRegistration is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_28\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off handwriting recognition error reporting' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off handwriting recognition error reporting' is properly enabled in Windows Server 2012 R2. The check validates that PreventHandwritingErrorReports registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_224\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Logon Settings\nDESCRIPTION: Registry check to verify that 'MSS: (AutoAdminLogon) Enable Automatic Logon' is set to 'Disabled' per CIS benchmark 18.3.1. The check confirms that AutoAdminLogon is set to 0 in the Winlogon registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_74\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Domain Controller Authentication Registry Settings\nDESCRIPTION: Verifies domain controller authentication is required to unlock workstations by checking ForceUnlockLogon registry value. Corresponds to CIS benchmark 2.3.7.8.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ForceUnlockLogon\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Connection Security Rules Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Apply local connection security rules' is set to 'Yes' by checking registry keys. This check ensures the Windows Firewall applies local connection security rules in the domain profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_41\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Environment Setup and Test Execution in Bash\nDESCRIPTION: Commands for setting up the test environment, initializing configurations, validating helpers, generating and running tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncd ./wazuh/src/engine\npython3 test/setupEnvironment.py -e /tmp/environment\nengine-helper-test -e /tmp/environment init -b build/main --mmdb test/helper_tests/mmdb/ --conf test/helper_tests/configuration_files/general.conf\nengine-helper-test -e /tmp/environment validate --input-dir test/helper_tests/helpers_description/\nengine-helper-test -e /tmp/environment generate-tests --input-dir test/helper_tests/helpers_description/ -o /tmp/helper_tests\nengine-helper-test -e /tmp/environment run --input-dir /tmp/helper_tests\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Publish to Web Feature\nDESCRIPTION: Verifies that 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled' by checking if the NoPublishingWizard registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_286\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Example Versions File Content\nDESCRIPTION: Format of versions file containing WPK package versions and their SHA1 hashes\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_12\n\nLANGUAGE: plaintext\nCODE:\n```\nv3.0.0-beta7 0e116931df8edd6f4382f6f918d76bc14d9caf10\nv3.0.0-beta6 ba45f0fe9ca4b3c3b4c3b42b4a2e647f3e2df4a3\nv3.0.0-beta5 30e750a84bc8333cb77995d99694425cacdad30d\n```\n\n----------------------------------------\n\nTITLE: Checking IPv4 Source Routing Protection\nDESCRIPTION: Registry check to verify that 'MSS: (DisableIPSourceRouting) IP source routing protection level' is set to 'Enabled: Highest protection' per CIS benchmark 18.3.3. The check confirms that DisableIPSourceRouting is set to 2 for IPv4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_76\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Temp Folder Deletion Setting\nDESCRIPTION: Verifies that Terminal Services is configured to delete temp folders upon exit as required by CIS benchmark 18.9.52.3.11.1. Checks that the DeleteTempDirsOnExit registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_117\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DeleteTempDirsOnExit -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Case Insensitivity for Non-Windows Subsystems in Windows Registry\nDESCRIPTION: Verifies that 'System objects: Require case insensitivity for non-Windows subsystems' is enabled. Checks if ObCaseInsensitive registry value is set to 1 for consistent behavior across different subsystems.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_25\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Kernel -> ObCaseInsensitive -> !1;\n```\n\n----------------------------------------\n\nTITLE: Configuring HLP2 Benchmarks in CMake\nDESCRIPTION: CMake commands to create and configure the hlp2_benchmarks executable. It specifies the source file and links the required libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/hlp/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\n# add_executable(hlp2_benchmarks\n#   hlp2_bench.cpp\n# )\n# target_link_libraries(hlp2_benchmarks benchmark::benchmark_main hlp2)\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure downloading of print drivers over HTTP is disabled according to CIS benchmark 18.8.20.1.2. The rules verify if the DisableWebPnPDownload registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_260\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Converting Text to Lowercase with 'downcase' Function in Wazuh\nDESCRIPTION: Shows how to use the 'downcase' function to convert strings to lowercase. The function works with both literal strings and field references, replacing any existing field values.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_50\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: downcase('ABCD')\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"abcd\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: downcase($upper_characters)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"upper_characters\": \"AbcD\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"upper_characters\": \"AbcD\",\n  \"target_field\": \"abcd\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: downcase('aBcDECF')\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"abcdecf\"\n}\n```\n\n----------------------------------------\n\nTITLE: Creating Wazuh Engine Benchmark Main Library in CMake\nDESCRIPTION: This snippet creates a library named 'engine_bench_main' using the 'wazuhBenchMain.cpp' file. It's set up as an object library, which is typically used for code that will be linked into other targets.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(engine_bench_main\n    OBJECT\n    wazuhBenchMain.cpp\n    )\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Private Profile Logging Path\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' in compliance with CIS benchmark 9.2.7.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_24\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Screen Saver Grace Period Settings in Windows Registry\nDESCRIPTION: Verifies that the screen saver grace period is set to 5 seconds or less in the Windows registry for enhanced security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_46\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> r:\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Installing Engine Diff Tool via pip\nDESCRIPTION: Provides the command to install the Engine Diff Tool using pip. It's packaged as part of the engine-suite Python package.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_diff/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install tools/engine-suite\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Size Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Logging: Size limit (KB)' is set to '16384 KB or greater' by checking registry keys. This check ensures sufficient log space for firewall activity in the domain profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_43\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Verifying LLTD Driver Settings in Windows Registry\nDESCRIPTION: These snippets check if 'Turn on Mapper I/O (LLTDIO) driver' and 'Turn on Responder (RSPNDR) driver' are disabled. They verify multiple registry values related to LLTD settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableLLTDIO -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitLLTDIOOnPrivateNet -> !0;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableRspndr -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitRspndrOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Configure Automatic Updates' Registry Setting\nDESCRIPTION: Checks if 'NoAutoUpdate' is not set to 1 to ensure Automatic Updates are enabled for critical security patches.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_136\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Negative regex_match Example in Wazuh\nDESCRIPTION: Shows a case where regex_match returns false because the input string doesn't match the specified pattern. This demonstrates how the function handles mismatches.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_27\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: regex_match('^(bye pcre\\\\d)$')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"ye pcre2\"\n}\n```\n\n----------------------------------------\n\nTITLE: Check Event Log Size Settings\nDESCRIPTION: Verifies maximum log file sizes and retention settings for Application, Security, Setup, and System event logs.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_104\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Basic Authentication Configuration\nDESCRIPTION: Ensures that 'Allow Basic authentication' for WinRM client is disabled by verifying the AllowBasic registry value is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_89\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off Registration if URL connection is referring to Microsoft.com' Registry Setting\nDESCRIPTION: Checks if the NoRegistration registry key is set to 1 in the Registration Wizard Control path, which disables automatic registration when a URL connects to Microsoft.com. This prevents unwanted data sharing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_74\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Publish to Web task Registry Settings\nDESCRIPTION: Checks if 'Turn off the \"Publish to Web\" task for files and folders' is enabled by verifying that NoPublishingWizard is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_294\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Automatic Update Setting\nDESCRIPTION: Verifies that automatic download and installation of updates from Windows Store is not turned off as required by CIS benchmark 18.9.61.1. Checks that the AutoDownload registry value is set to 4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_121\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Successful Connections Logging Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes' by checking registry keys. This check ensures the Windows Firewall logs successful connections for complete network activity auditing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_45\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Services Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Internet download for Web publishing and online ordering wizards is disabled according to CIS benchmark 18.8.20.1.6. The rules verify if the NoWebServices registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_264\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Windows Messenger Customer Experience Improvement Program Registry Settings\nDESCRIPTION: Checks if 'Turn off the Windows Messenger Customer Experience Improvement Program' is enabled by verifying that CEIP is set to 0 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_295\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Setting Directory Ownership\nDESCRIPTION: Sets root user and group ownership recursively for all files in the wazuh directory\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n# chown -R root:root wazuh\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM diskWiper Setting\nDESCRIPTION: Checks if the diskWiper tool is enabled in VMware ESX VM configuration, which could allow disk modification operations that may cause denial of service. The rule checks if isolation.tools.diskWiper.disable is missing or set to false.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: vmx\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.diskWiper.disable;\nd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.diskWiper.disable && r:false;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Explorer Enclosures Download Prevention\nDESCRIPTION: Verifies that downloading of enclosures in Internet Explorer is prevented as required by CIS benchmark 18.9.53.1. Checks that the DisableEnclosureDownload registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_119\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> DisableEnclosureDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> !DisableEnclosureDownload;\n```\n\n----------------------------------------\n\nTITLE: Generating Builder Images GitHub Workflow\nDESCRIPTION: cURL command to trigger GitHub workflow for generating and pushing builder images with authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/packages/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncurl -L -X POST -H \"Accept: application/vnd.github+json\" -H \"Authorization: Bearer $GH_WORKFLOW_TOKEN\" -H \"X-GitHub-Api-Version: 2022-11-28\" --data-binary \"@$(pwd)/wazuh-agent-test-amd64-rpm.json\" \"https://api.github.com/repos/wazuh/wazuh/actions/workflows/packages-upload-agent-images-amd.yml/dispatches\"\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off access to the Store' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off access to the Store' is properly enabled in Windows Server 2012 R2. The check validates that NoUseStoreOpenWith registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_221\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Visualizing Wazuh Engine Architecture with Mermaid\nDESCRIPTION: A mermaid flowchart diagram illustrating the simplified architecture of the Wazuh engine. It shows the relationships and connections between different modules such as API, Geolocator, KVDB, Global, Server, Persistent Storage, Builder, Orchestrator, and Backend.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/architecture.md#2025-04-17_snippet_0\n\nLANGUAGE: mermaid\nCODE:\n```\n---\nconfig:\n  title: \"Simplified architecture\"\n  nodeSpacing: 30\n  rankSpacing: 25\n  flowchart:\n    curve: stepAfter\n    subGraphTitleMargin:\n      top: 20\n      bottom: 20\n---\nflowchart LR\n\nclassDef SubmoduleClass font-size:15px,stroke-width:2px,stroke-dasharray:10px,rx:15,ry:15\nclassDef ModuleClass  font-size:15px,stroke-width:2px,rx:15,ry:15\n\n%% ----------------------------------\n%%                  API\n%% ----------------------------------\n\nsubgraph apiModule[\"API\"]\n   direction LR\n   api_orchestrator@{ shape: stadium, label: \"Orchestrator manager\" }\n   api_kvdb@{ shape: stadium, label: \"KVDB manager\" }\n   api_metrics@{ shape: stadium, label: \"Metric manager\" }\n   api_geo@{ shape: stadium, label: \"Geo manager\" }\n   api_orchestrator ~~~ api_kvdb\n   api_metrics ~~~ api_geo\n\n   api_catalog@{ shape: disk, label: \"Catalog of assets\" }\n   api_policies@{ shape: disk, label: \"Policies\" }\n   api_policies ~~~ api_catalog\nend\napiModule:::ModuleClass\n\n\n%% ----------------------------------\n%%                  Geo module\n%% ----------------------------------\nsubgraph geoModule[\"Geolocator\"]\n  geo_mmdb@{ shape: disk, label: \"MaxMind DBs\" }\nend\ngeoModule:::ModuleClass\n\n%% ----------------------------------\n%%                  KVDB\n%% ----------------------------------\nsubgraph kvdbModule[\"KVDB\"]\n    direction TB\n    kvdb_db_2@{ shape: docs, label: \"Key-Value DataBases\" }\nend\nkvdbModule:::ModuleClass\n\n%% ----------------------------------\n%%              Global module\n%% ----------------------------------\nsubgraph globalModule[\"Global\"]\n    global_metrics(\"Metrics\")\n    global_logger(\"Logger\")\nend\nglobalModule:::ModuleClass\n\n%% ----------------------------------\n%%                  Server\n%% ----------------------------------\n\nsubgraph serverModule[\"Server\"]\n   direction RL\n   server_API>Server API]\n   server_engine>Server engine]\nend\nserverModule:::ModuleClass\n\n%% ----------------------------------\n%%           Storage\n%% ----------------------------------\nstorageModule@{ shape: cyl, label: \"Persistent</br>Storage\" }\nstorageModule:::ModuleClass\n\n%% ----------------------------------\n%%           Builder\n%% ----------------------------------\nsubgraph builderModule[\"Builder\"]\n builder_asset@{ shape: stadium, label: \"Builder asset\" }\n builder_policy@{ shape: stadium, label: \"Builder policy\" }\n builder_parser@{ shape: stadium, label: \"Builder parser\" }\n builder_hp@{ shape: stadium, label: \"Builder helper function\" }\n\n builder_policy ~~~ builder_asset --- builder_parser & builder_hp\n builder_parser --- builder_catalog_hf@{ shape: disk, label: \"Catalog of helper functions\" }\n builder_hp --- builder_catalog_parser@{ shape: disk, label: \"Catalog of parser\" }\n\nend\nbuilderModule:::ModuleClass\n\n%% ----------------------------------\n%%           Orchestrator\n%% ----------------------------------\nsubgraph orchestratorModule[\"Orchestrator\"]\n   direction RL\n   orchestrator_router@{ shape: stadium, label: \"Router\" }\n   orchestrator_tester@{ shape: stadium, label: \"Tester\" }\n   orchestrator_routerTable@{ shape: disk, label: \"Routes\" }\n   orchestrator_sessionTable@{ shape: disk, label: \"Session\" }\n   orchestrator_router --- orchestrator_routerTable\n   orchestrator_tester --- orchestrator_sessionTable\nend\norchestratorModule:::ModuleClass\n\nsubgraph backendModule[\"Backend\"]\n\nend\n\n%% ----------------------------------\n%%           Modules conexion\n%% ----------------------------------\nserverModule ------- orchestratorModule & apiModule\norchestratorModule ---- backendModule\nbuilderModule & apiModule --- geoModule & kvdbModule\napiModule --- storageModule\n\napiModule ------ builderModule\n\norchestratorModule  ------ builderModule\norchestratorModule ----- apiModule\nstorageModule --- builderModule\n```\n\n----------------------------------------\n\nTITLE: Checking IP Forwarding Configuration\nDESCRIPTION: Verifies system configuration files to ensure IP forwarding is disabled for both IPv4 and IPv6 as per CIS benchmark requirement 4.1.1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_25\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Setting Up Directory Paths\nDESCRIPTION: Configures source and shared module paths with conditional logic to allow override\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif (NOT SRC_FOLDER)\n    get_filename_component(SRC_FOLDER     ${CMAKE_SOURCE_DIR}/../../ ABSOLUTE)\nendif (NOT SRC_FOLDER)\n\nif (NOT SHARED_MODULES)\n    get_filename_component(SHARED_MODULES ${SRC_FOLDER}/shared_modules/ ABSOLUTE)\nendif (NOT SHARED_MODULES)\n```\n\n----------------------------------------\n\nTITLE: Configuring Unit Tests\nDESCRIPTION: Sets up unit test executable configuration with test directories and required dependencies when testing is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/httpsrv/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(httpsrv_utest\n    ${UNIT_SRC_DIR}/server_test.cpp\n)\ntarget_include_directories(httpsrv_utest\n    PRIVATE\n    ${TEST_SRC_DIR}\n)\ntarget_link_libraries(httpsrv_utest\n    PRIVATE\n    httpsrv\n    GTest::gtest_main\n)\ngtest_discover_tests(httpsrv_utest)\n```\n\n----------------------------------------\n\nTITLE: Configuring Tests for Queue Library in CMake\nDESCRIPTION: Sets up test configurations when ENGINE_BUILD_TEST is enabled. It defines mock libraries, component tests, and links necessary dependencies for testing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/queue/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\n# Tests\nif(ENGINE_BUILD_TEST)\n  set(TEST_SRC_DIR ${TEST_DIR}/src)\n  set(TEST_SRC_COMPONENT_DIR ${TEST_SRC_DIR}/component)\n  set(TEST_SRC_UNIT_DIR ${TEST_SRC_DIR}/unit)\n  set(TEST_MOCK_DIR ${TEST_DIR}/mocks)\n\n  # Mocks\n  add_library(queue_mocks INTERFACE)\n  target_include_directories(queue_mocks INTERFACE ${TEST_MOCK_DIR})\n  target_link_libraries(queue_mocks INTERFACE GTest::gmock queue)\n  add_library(queue::mocks ALIAS queue_mocks)\n\n  # Component test\n  add_executable(queue_ctest\n    ${TEST_SRC_COMPONENT_DIR}/queue_test.cpp\n  )\n\n  target_link_libraries(queue_ctest\n    GTest::gtest_main\n    base\n    queue\n    metrics::mocks\n    base::test\n  )\n  gtest_discover_tests(queue_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Dropped Packets Logging Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes' by checking registry keys. This check ensures the Windows Firewall logs dropped packets for security auditing in the domain profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_44\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Heap Termination on Corruption Settings\nDESCRIPTION: Validates that heap termination on corruption is not turned off, as required by CIS benchmark 18.9.30.4. Checks that the NoHeapTerminationOnCorruption registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_108\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoHeapTerminationOnCorruption -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Settings\nDESCRIPTION: Registry checks to verify that Windows Error Reporting is disabled per CIS benchmark 18.8.20.1.14. The check ensures Disabled is set to 1 in the Windows Error Reporting policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_50\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Validating Order Prints Task Registry Settings\nDESCRIPTION: Registry checks to ensure the \"Order Prints\" picture task is disabled per CIS benchmark 18.8.20.1.10. Validates that the NoOnlinePrintsWizard key is set to 1 or exists in the Explorer policies path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_160\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Geo Unit Tests Build in CMake\nDESCRIPTION: Sets up the unit test build configuration for api_geo library. This includes test executable creation, linking test dependencies, and test discovery. Only builds when ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/geo/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_executable(api_geo_utest\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n    )\n    target_include_directories(api_geo_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_geo_utest\n        PRIVATE\n        api::geo\n        geo::mocks\n        GTest::gtest_main\n        api::adapter::test\n    )\n    gtest_discover_tests(api_geo_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Secure RPC Communication Setting\nDESCRIPTION: Verifies that Terminal Services requires secure RPC communication as required by CIS benchmark 18.9.52.3.9.2. Checks that the fEncryptRPCTraffic registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_115\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fEncryptRPCTraffic -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fEncryptRPCTraffic;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile State in Windows Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Firewall state' is turned on. Checks if EnableFirewall registry value is set to 1 in both policy and current configuration paths to ensure the firewall is active.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_36\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off Registration if URL connection is referring to Microsoft.com\nDESCRIPTION: Validates registry settings to ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled' by checking the NoRegistration value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_308\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Verifying Store Access Configuration in Registry\nDESCRIPTION: This snippet checks if access to the Store is disabled in the registry as recommended by CIS benchmark 18.8.20.1.1. It verifies if the 'NoUseStoreOpenWith' key is set to 1 under the Explorer registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_89\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off downloading of print drivers over HTTP' registry setting\nDESCRIPTION: Verifies that the DisableWebPnPDownload registry value is set to 1 to disable downloading print drivers over HTTP as recommended by CIS benchmark 18.8.20.1.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_124\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Source Routing Protection\nDESCRIPTION: Registry check to verify that 'MSS: (DisableIPSourceRouting IPv6) IP source routing protection level' is set to 'Enabled: Highest protection' per CIS benchmark 18.3.2. The check confirms that DisableIPSourceRouting is set to 2 for IPv6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_75\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile State\nDESCRIPTION: Verifies that Windows Firewall Public Profile is enabled by checking registry keys. The check fails if EnableFirewall is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_28\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Test Property Configuration in YAML\nDESCRIPTION: Examples of configuring custom tests with arguments and expected results.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_8\n\nLANGUAGE: yaml\nCODE:\n```\ntest:\n  - arguments:\n      id_argument: any_value\n      id_argument: any_value\n      target_field: any_value\n    should_pass: whether or not it should happen\n    expected: [1,2,3,4]\n    description: any description\n```\n\nLANGUAGE: yaml\nCODE:\n```\ntest:\n  - arguments:\n      id_argument:\n        source: any_source\n        value: any_value\n      id_argument:\n        source: any_source\n        value: any_value\n      target_field: any_value\n    should_pass: whether or not it should happen\n    expected: any_value\n    description: any description\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Windows Error Reporting Registry Settings\nDESCRIPTION: Checks if 'Turn off Windows Error Reporting' is enabled by verifying that Disabled is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_297\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Specifying Python Package Requirements\nDESCRIPTION: Defines exact version requirements for two Python packages: evtx version 0.8.2 and requests version 2.32.3. Used for dependency management and environment replication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/evtx2xml/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nevtx==0.8.2\nrequests==2.32.3\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Configure Automatic Updates: Scheduled install day' Registry Setting\nDESCRIPTION: Checks if 'ScheduledInstallDay' is set to 0 (Every day) to ensure updates are installed daily for maximum security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_137\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> ScheduledInstallDay -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !ScheduledInstallDay;\n```\n\n----------------------------------------\n\nTITLE: Compiling WPK Package\nDESCRIPTION: Creates WPK package using custom SSL certificate and key\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\ntools/agent-upgrade/wpkpack.py output/myagent.wpk path/to/wpkcert.pem path/to/wpkcert.key *\n```\n\n----------------------------------------\n\nTITLE: Check Store Access Registry Settings\nDESCRIPTION: Validates that access to the Windows Store is disabled by checking registry keys under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_142\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Validating Event Indexing in Wazuh Health Test (Bash)\nDESCRIPTION: These commands validate event indexing by creating an OpenSearch instance, ingesting events, and comparing output with expected results. Options allow for testing specific integrations, rule folders, or all decoders/rules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\n# To run a specific integration\nengine-health-test dynamic -e health_test/environment validate_event_indexing --integration windows\n# To run a specific rule folder\nengine-health-test dynamic -e health_test/environment validate_event_indexing --rule_folder windows\n# To run all tests in decoders\nengine-health-test dynamic -e health_test/environment validate_event_indexing --target decoder\n# To run all tests in rules\nengine-health-test dynamic -e health_test/environment validate_event_indexing --target rules\n# To skip specific tests in decoders\nengine-health-test dynamic -e health_test/environment validate_event_indexing --target decoder --skip windows,wazuh-core\n```\n\n----------------------------------------\n\nTITLE: Parsing FQDN in Wazuh Normalization (YAML/JSON)\nDESCRIPTION: The parse_fqdn function is used to validate and extract domain names. It checks if the input contains a valid domain name format (max 255 characters, only a-z, A-Z, 0-9, ., -) and stores it in the target field if valid.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_112\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_fqdn($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"www.someurl.co\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"www.someurl.co\",\n  \"target_field\": \"www.someurl.co\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Shell Protocol Protected Mode Settings\nDESCRIPTION: Validates that shell protocol protected mode is not turned off, as required by CIS benchmark 18.9.30.5. Checks that the PreXPSP2ShellProtocolBehavior registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_109\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> PreXPSP2ShellProtocolBehavior -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Event Unit Tests in CMake\nDESCRIPTION: Sets up unit tests for the API event library when ENGINE_BUILD_TEST is enabled. It creates an executable 'api_event_utest' with test source files and links necessary dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/event/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_executable(api_event_utest\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n        ${UNIT_SRC_DIR}/ndJsonParser_test.cpp\n    )\n    target_include_directories(api_event_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_event_utest\n        PRIVATE\n        api::event\n        router::mocks\n        GTest::gtest_main\n        api::adapter::test\n    )\n    gtest_discover_tests(api_event_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Skipped Test Configuration in YAML\nDESCRIPTION: Configuration for skipping specific test suites using the skipped property.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_7\n\nLANGUAGE: yaml\nCODE:\n```\nskipped:\n  - success_cases\n  - different_type\n  - different_source\n  - different_target_field_type\n  - allowed\n```\n\n----------------------------------------\n\nTITLE: Trimming Characters Using trim() in Wazuh Normalization\nDESCRIPTION: The trim() function removes specified characters from the beginning, end, or both sides of a string. It takes two parameters: trim_place (begin, end, or both) and the character to remove. The result replaces the original value in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_118\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: trim('end', '-')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"-- Hi wazuh! --\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"-- Hi wazuh! \"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: trim('begin', '-')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"-- Hi wazuh! --\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \" Hi wazuh! --\"\n}\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: trim('both', '-')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"-- Hi wazuh! --\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \" Hi wazuh! \"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Parsec Interface Library\nDESCRIPTION: Defines and configures the Parsec interface library, setting up include directories and linking with base library. Sets the interface directory path and creates the library target.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/parsec/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n\nadd_library(parsec INTERFACE)\ntarget_include_directories(parsec INTERFACE ${IFACE_DIR})\ntarget_link_libraries(parsec INTERFACE base)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Connection Security Rules Setting\nDESCRIPTION: Ensures that Windows Firewall Public Profile is configured to not apply local connection security rules according to CIS benchmark 9.3.6. Checks both policy and system registry paths.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_61\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Loading Decoders in Wazuh Health Test (Bash)\nDESCRIPTION: This command loads decoders into the Wazuh health test environment. It creates filters, loads integrations, and adds decoders to the policy. This step is necessary for decoder tests to function correctly.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nengine-health-test dynamic -e health_test/environment load_decoders\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Search Companion content file updates' Setting\nDESCRIPTION: Registry checks to verify if the 'DisableContentFileUpdates' key is set to 1, which prevents Search Companion from downloading content file updates. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_67\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Main Library Source and Dependencies Configuration\nDESCRIPTION: Sets up source files and defines public/private library dependencies for the main geo library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/geo/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nset(SRCS\n    ${SRC_DIR}/manager.cpp\n    ${SRC_DIR}/downloader.cpp\n    ${SRC_DIR}/locator.cpp\n)\nset(PRIVATE_LINKS\n    urlrequest\n    maxminddb::maxminddb\n)\nset(PUBLIC_LINKS\n    geo::igeo\n    store::istore\n)\n```\n\n----------------------------------------\n\nTITLE: Setting Up Test Environment for Wazuh Store Module in CMake\nDESCRIPTION: Configures the test environment, including directory definitions for test sources and mocks. This section is only processed if ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_4\n\nLANGUAGE: CMake\nCODE:\n```\n# Tests\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Turn on PowerShell Script Block Logging' Registry Setting\nDESCRIPTION: Checks if 'EnableScriptBlockLogging' is set to 0 (Disabled) to disable PowerShell script block logging functionality.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_128\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Checking User Account Security\nDESCRIPTION: Rules to detect empty passwords and non-root accounts with root privileges (UID 0) according to CIS Debian Linux benchmarks 9.2 and 13.11.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking Registration Wizard Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Registration Wizard is disabled when URL connection refers to Microsoft.com according to CIS benchmark 18.8.20.1.8. The rules verify if the NoRegistration registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_266\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Search Companion Updates\nDESCRIPTION: Verifies that 'Turn off Search Companion content file updates' is set to 'Enabled' by checking if the DisableContentFileUpdates registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_284\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Store Access Registry Check\nDESCRIPTION: Registry check to ensure access to the Windows Store is disabled per CIS benchmark 18.8.20.1.1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_323\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Domain User Elevation Requirements for Network Location Settings\nDESCRIPTION: Ensures that domain users are required to elevate when setting a network's location by verifying 'NC_StdDomainUserSetLocation' is not set to 1 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_83\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: Checking WDigest Authentication Status in Windows Registry\nDESCRIPTION: Verifies that WDigest Authentication is disabled by checking if 'UseLogonCredential' is not set to 0, which helps prevent credential exposure.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_86\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off access to the Store Registry Settings\nDESCRIPTION: Checks if 'Turn off access to the Store' is enabled by verifying that NoUseStoreOpenWith is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_298\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: RHEL7 Version Verification Check\nDESCRIPTION: Validates that the system is running RHEL7 or compatible distributions by checking the content of /etc/redhat-release file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 7;\nf:/etc/redhat-release -> r:^CentOS && r:release 7;\nf:/etc/redhat-release -> r:^Cloud && r:release 7;\nf:/etc/redhat-release -> r:^Oracle && r:release 7;\nf:/etc/redhat-release -> r:^Better && r:release 7;\nf:/etc/redhat-release -> r:^OpenVZ && r:release 7;\n```\n\n----------------------------------------\n\nTITLE: RC Scripts Directory Definition\nDESCRIPTION: Defines the locations of RC script directories for runlevels 2-5\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Connection Security Rules Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Settings: Apply local connection security rules' is set to 'Yes' by checking registry keys. This check ensures the Windows Firewall applies local connection security rules in the private profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_51\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying CTRL+ALT+DEL Requirement for Logon in Windows Registry\nDESCRIPTION: This snippet checks if 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'. It corresponds to CIS Benchmark 2.3.7.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableCAD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableCAD;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Search Companion content file updates' registry setting\nDESCRIPTION: Verifies that the DisableContentFileUpdates registry value is set to 1 to disable Search Companion content file updates as recommended by CIS benchmark 18.8.20.1.9.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_131\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Vulnerability Scanner Tests\nDESCRIPTION: Configures CMake build settings for vulnerability scanner benchmark tests. Sets up include paths, links required libraries including benchmark and vdscanner, and creates an executable target with associated test.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/tests/benchmark/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(vulnerability_scanner_benchmark_tests)\n\ninclude_directories(${SRC_FOLDER}/external/benchmark/include/)\nlink_directories(${SRC_FOLDER}/external/benchmark/build/src)\n\nfile(GLOB SOURCES\n        *.cpp\n        )\n\nadd_executable(${PROJECT_NAME} ${SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n        benchmark vdscanner\n        )\n\nadd_test(NAME ${PROJECT_NAME} COMMAND ${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Merging KVDB Value with Existing Field in YAML\nDESCRIPTION: This snippet shows how to use the kvdb_get_merge function to retrieve a value from KVDB and merge it with the existing value in the target field. The types must match for successful merging.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_89\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_get_merge('testing', 'key')\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that the Windows Messenger Customer Experience Improvement Program is turned off by ensuring the CEIP value is set to 0 or doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_95\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Catalog Test Suite in CMake\nDESCRIPTION: Sets up the test suite for the API catalog, including mock libraries and unit tests. This configuration is only included when ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/catalog/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_library(api_catalog_mocks INTERFACE)\n    target_include_directories(api_catalog_mocks INTERFACE ${TEST_MOCK_DIR})\n    target_link_libraries(api_catalog_mocks INTERFACE api::catalog::icatalog GTest::gmock)\n    add_library(api::catalog::mocks ALIAS api_catalog_mocks)\n\n\n    add_executable(api_catalog_utest\n        ${UNIT_SRC_DIR}/resource_test.cpp\n        ${UNIT_SRC_DIR}/catalog_test.cpp\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n    )\n    target_include_directories(api_catalog_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_catalog_utest\n        PRIVATE\n        api::catalog\n        api::catalog::mocks\n        GTest::gtest_main\n        builder::mocks\n        store::mocks\n        api::adapter::test\n    )\n    gtest_discover_tests(api_catalog_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Configuring Router Component Tests\nDESCRIPTION: Sets up component-level test executable with necessary source files and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_5\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(router_ctest\n    ${COMPONENT_SRC_DIR}/router_test.cpp\n    ${COMPONENT_SRC_DIR}/tester_test.cpp\n)\ntarget_include_directories(router_ctest PRIVATE ${SRC_DIR})\ntarget_link_libraries(router_ctest\n    GTest::gtest_main\n    base\n    router::router\n    builder::mocks\n    store::mocks\n    bk::mocks\n    queue::mocks\n)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Policy Background Processing Configuration\nDESCRIPTION: Ensures that registry policy processing during periodic background processing is properly configured by checking if 'NoBackgroundPolicy' is not set to 0 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_89\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoBackgroundPolicy;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Log Size\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Logging: Size limit (KB)' is set to '16384 KB or greater' as required by CIS benchmark 9.2.8. Uses regex patterns to match different possible sizes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_25\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w; \nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off Search Companion content file updates' Registry Setting\nDESCRIPTION: Verifies the DisableContentFileUpdates registry key is set to 1 in the SearchCompanion path, which prevents Search Companion from downloading content file updates from Microsoft. This enhances security by reducing network connections.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_75\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Configuring Component Tests\nDESCRIPTION: Sets up component test executable configuration with test directories and required dependencies when testing is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/httpsrv/CMakeLists.txt#2025-04-17_snippet_4\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(httpsrv_ctest\n    ${COMPONENT_SRC_DIR}/server_test.cpp\n    ${TEST_SRC_DIR}/generic_request.pb.cc\n)\ntarget_include_directories(httpsrv_ctest\n    PRIVATE\n    ${TEST_SRC_DIR}\n)\ntarget_link_libraries(httpsrv_ctest\n    PRIVATE\n    httpsrv\n    GTest::gtest_main\n    base::test\n)\ngtest_discover_tests(httpsrv_ctest)\n```\n\n----------------------------------------\n\nTITLE: Verifying Strong Session Key Requirement in Windows Registry\nDESCRIPTION: This snippet checks if 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'. It corresponds to CIS Benchmark 2.3.6.6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireStrongKey -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring API Adapter Tests in CMake\nDESCRIPTION: Sets up test configurations for the API adapter when ENGINE_BUILD_TEST is enabled. This includes creating a test executable, configuring its include directories and dependencies, and setting up a test library for reusable test components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/adapter/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(UTEST_SRC_DIR ${TEST_SRC_DIR}/unit)\n    set(TEST_INC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/include)\n\n    add_executable(api_adapter_utest\n        ${UTEST_SRC_DIR}/adapter_test.cpp\n        ${TEST_SRC_DIR}/generic_request.pb.cc\n    )\n    target_include_directories(api_adapter_utest\n        PRIVATE\n        ${TEST_SRC_DIR}\n    )\n    target_link_libraries(api_adapter_utest\n        PRIVATE\n        api::adapter\n        GTest::gtest_main\n    )\n    gtest_discover_tests(api_adapter_utest)\n\n    add_library(api_adapter_test INTERFACE)\n    target_include_directories(api_adapter_test INTERFACE ${TEST_INC_DIR})\n    target_link_libraries(api_adapter_test\n        INTERFACE\n        api::adapter\n        GTest::gtest\n        base::test\n    )\n    add_library(api::adapter::test ALIAS api_adapter_test)\n\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Machine Account Password Change Settings in Windows Registry\nDESCRIPTION: This snippet verifies if 'Domain member: Disable machine account password changes' is set to 'Disabled'. It aligns with CIS Benchmark 2.3.6.4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> DisablePasswordChange -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Publish to Web' Task Registry Settings\nDESCRIPTION: Registry checks to verify that the 'Publish to Web' task for files and folders is disabled per CIS benchmark 18.8.20.1.11. The check ensures NoPublishingWizard is set to 1 in the Explorer policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_47\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Configuration in Registry\nDESCRIPTION: This snippet checks if handwriting recognition error reporting is disabled in the registry as recommended by CIS benchmark 18.8.20.1.4. It verifies if the 'PreventHandwritingErrorReports' key is set to 1 under the HandwritingErrorReports registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_92\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that printing over HTTP is turned off by ensuring the DisableHTTPPrinting value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_104\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Publish to Web\" task for files and folders' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off the \"Publish to Web\" task for files and folders' setting is enabled in the Windows registry. It verifies the NoPublishingWizard value is set to 1 in the specified registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_200\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Local User Enumeration on Domain-Joined Computers\nDESCRIPTION: Verifies that local users are not enumerated on domain-joined computers by checking if 'EnumerateLocalUsers' is not set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_94\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnumerateLocalUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Windows Customer Experience Improvement Program Registry Settings\nDESCRIPTION: Checks if 'Turn off Windows Customer Experience Improvement Program' is enabled by verifying that CEIPEnable is set to 0 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_296\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Package Generation Configuration\nDESCRIPTION: JSON configuration for the package generation workflow, defining build parameters and options.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/packages/README.md#2025-04-17_snippet_4\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"ref\":\"4.9.0\",\n    \"inputs\":\n        {\n         \"docker_image_tag\":\"auto\",\n         \"architecture\":\"amd64\",\n         \"system\":\"deb\",\n         \"revision\":\"test\",\n         \"is_stage\":\"false\",\n         \"legacy\":\"false\",\n         \"checksum\":\"false\"\n     }\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Server Registry for CIS Compliance\nDESCRIPTION: Registry check rules for various CIS compliance items for Windows Server 2012 R2. Each rule validates registry keys to confirm proper security settings are applied, particularly focusing on disabling unnecessary network and internet features that could pose security risks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_307\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Detecting Telnet Server Enabled on RHEL7\nDESCRIPTION: Checks for the presence of telnet server in xinetd configuration and systemd services. Telnet is an insecure protocol and should be disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/telnet@.service -> r:ExecStart=-/usr/sbin/in.telnetd;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM Server Security Settings\nDESCRIPTION: Verifies NTLM server security settings require NTLMv2 session security and 128-bit encryption by checking registry values.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Registry Settings\nDESCRIPTION: Verifies that the Windows Messenger Customer Experience Improvement Program is disabled by checking registry values. The check ensures CEIP is set to 0 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Slideshow Settings in Windows Registry\nDESCRIPTION: Registry check to verify that the 'Prevent enabling lock screen slide show' policy is set to 'Enabled' per CIS benchmark 18.1.1.2. The check validates that NoLockScreenSlideshow is set to 1 in the Windows Personalization registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_67\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenSlideshow -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenSlideshow;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Registry Settings\nDESCRIPTION: Registry checks to verify that handwriting recognition error reporting is disabled per CIS benchmark 18.8.20.1.4. The check ensures PreventHandwritingErrorReports is set to 1 in the HandwritingErrorReports policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_54\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Loading Rules in Wazuh Health Test (Bash)\nDESCRIPTION: This command loads and adds rules to the Wazuh health test policy. It should be run after completing decoder tests, as it affects expected traces and mappings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nengine-health-test dynamic -e health_test/environment load_rules\n```\n\n----------------------------------------\n\nTITLE: Concatenating Array Elements with join Function in Wazuh Normalization\nDESCRIPTION: The join function concatenates elements of an array into a single string, separated by a specified separator. The result is mapped to the target field, which will be replaced if it already exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_58\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: join($array, ' ')\n```\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: join($array, 'separator')\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Always install with elevated privileges' Registry Setting\nDESCRIPTION: Checks if the 'AlwaysInstallElevated' registry value is set to 0 (Disabled) to prevent packages from installing with elevated privileges.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_126\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> AlwaysInstallElevated -> !0;\n```\n\n----------------------------------------\n\nTITLE: Package Generation Workflow\nDESCRIPTION: cURL command to trigger GitHub workflow for building packages with authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/packages/README.md#2025-04-17_snippet_3\n\nLANGUAGE: json\nCODE:\n```\ncurl -L -X POST -H \"Accept: application/vnd.github+json\" -H \"Authorization: Bearer $GH_WORKFLOW_TOKEN\" -H \"X-GitHub-Api-Version: 2022-11-28\" --data-binary \"@$(pwd)/wazuh-agent-test-amd64-rpm.json\" \"https://api.github.com/repos/wazuh/wazuh/actions/workflows/packages-build-linux-agent-amd.yml/dispatches\"\n```\n\n----------------------------------------\n\nTITLE: Test Configuration and Build Targets\nDESCRIPTION: Sets up test-related directory variables and creates test targets with appropriate dependencies and configurations for unit and component testing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/geo/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\nset(MMDB_PATH_TEST ${TEST_SRC_DIR}/testdb.mmdb)\n\nadd_library(geo_mocks INTERFACE)\ntarget_include_directories(geo_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(geo_mocks INTERFACE geo::igeo GTest::gmock)\nadd_library(geo::mocks ALIAS geo_mocks)\n\nadd_executable(geo_utest\n    ${SRCS}\n    ${UNIT_SRC_DIR}/manager_test.cpp\n    ${UNIT_SRC_DIR}/locator_test.cpp\n)\ntarget_include_directories(geo_utest\n    PRIVATE\n    ${TEST_SRC_DIR}\n    ${SRC_DIR}\n    ${INC_DIR}/geo\n)\ntarget_link_libraries(geo_utest\n    PRIVATE\n    geo\n    geo::mocks # Ensure it compiles\n    ${PRIVATE_LINKS}\n    ${PUBLIC_LINKS}\n    GTest::gtest_main\n    store::mocks\n)\ngtest_discover_tests(geo_utest)\ntarget_compile_definitions(geo_utest PRIVATE MMDB_PATH_TEST=\"${MMDB_PATH_TEST}\")\n\nadd_executable(geo_ctest\n    ${COMPONENT_SRC_DIR}/manager_test.cpp\n)\ntarget_link_libraries(geo_ctest PRIVATE geo GTest::gtest_main store::mocks)\ntarget_compile_definitions(geo_ctest PRIVATE MMDB_PATH_TEST=\"${MMDB_PATH_TEST}\")\ngtest_discover_tests(geo_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Validating Windows SmartScreen Configuration\nDESCRIPTION: Checks if Windows SmartScreen is configured to require administrator approval before running unknown software as required by CIS benchmark 18.9.30.2. Verifies the EnableSmartScreen registry value is set to 2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_106\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableSmartScreen;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off printing over HTTP' registry setting\nDESCRIPTION: Verifies that the DisableHTTPPrinting registry value is set to 1 to disable printing over HTTP as recommended by CIS benchmark 18.8.20.1.7.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_129\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Configuring Main RBAC Library in CMake\nDESCRIPTION: Creates the main RBAC static library, sets its source files, include directories, and links it with necessary dependencies including the RBAC interface library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/rbac/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(rbac STATIC\n  ${SRC_DIR}/rbac.cpp\n)\ntarget_include_directories(rbac\nPUBLIC\n  ${INC_DIR}\nPRIVATE\n  ${SRC_DIR}\n  ${INC_DIR}/rbac\n)\ntarget_link_libraries(rbac PUBLIC rbac::irbac PRIVATE base store::istore)\n```\n\n----------------------------------------\n\nTITLE: Demonstrating merge_recursive_key_in Function in Wazuh Normalization\nDESCRIPTION: Shows a failing example of the merge_recursive_key_in function where the specified key doesn't exist in the source object, resulting in no changes to the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_95\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: merge_recursive_key_in($any_object, $key)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": {\n    \"input_key_1\": {\n      \"v1\": \"k1\",\n      \"nested\": {\n        \"n1\": \"value1\"\n      }\n    },\n    \"input_key_2\": {\n      \"v2\": \"k2\"\n    }\n  },\n  \"key\": \"input_key_not_exists\",\n  \"target_field\": {\n    \"v0\": \"k0\",\n    \"nested\": {\n      \"n2\": \"value2\"\n    }\n  }\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": {\n    \"input_key_1\": {\n      \"v1\": \"k1\",\n      \"nested\": {\n        \"n1\": \"value1\"\n      }\n    },\n    \"input_key_2\": {\n      \"v2\": \"k2\"\n    }\n  },\n  \"key\": \"input_key_not_exists\",\n  \"target_field\": {\n    \"v0\": \"k0\",\n    \"nested\": {\n      \"n2\": \"value2\"\n    }\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Saving Prevention\nDESCRIPTION: Verifies that password saving in Terminal Services is not allowed as required by CIS benchmark 18.9.52.2.2. Checks that the DisablePasswordSaving registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_112\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !DisablePasswordSaving;\n```\n\n----------------------------------------\n\nTITLE: RHEL5 Version Validation Rules\nDESCRIPTION: Configuration rules to verify Red Hat Enterprise Linux 5 and compatible distributions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 5;\nf:/etc/redhat-release -> r:^CentOS && r:release 5;\nf:/etc/redhat-release -> r:^Cloud && r:release 5;\nf:/etc/redhat-release -> r:^Oracle && r:release 5;\nf:/etc/redhat-release -> r:^Better && r:release 5;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Handwriting Recognition Error Reporting Settings\nDESCRIPTION: Registry check to verify that 'Turn off handwriting recognition error reporting' is enabled. Checks if the PreventHandwritingErrorReports key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_109\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Windows Customer Experience Settings\nDESCRIPTION: Validates registry settings that control Windows Customer Experience Improvement Program and error reporting features\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off Windows Error Reporting\nDESCRIPTION: Validates registry settings to ensure 'Turn off Windows Error Reporting' is set to 'Enabled' by checking the Disabled value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_314\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Validating System Event Log Maximum Size Registry Settings\nDESCRIPTION: Checks whether the System event log maximum size is set to at least 32,768 KB as required by CIS benchmark 18.9.26.4.2. The check examines the MaxSize registry value in the System EventLog policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_105\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Internet download for Web publishing Registry Settings\nDESCRIPTION: Checks if 'Turn off Internet download for Web publishing and online ordering wizards' is enabled by verifying that NoWebServices is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_289\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off Windows Customer Experience Improvement Program\nDESCRIPTION: Validates registry settings to ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled' by checking the CEIPEnable value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_313\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Defining Update Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for handling updates to existing Wazuh installations, including prompts and status messages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_15\n\nLANGUAGE: Bash\nCODE:\n```\n# Update\nwanttoupdate=\"You already have Wazuh installed. Do you want to update it?\"\nmustuninstall=\"The installation can't proceed without uninstalling old versions. Exiting.\"\nunabletoupdate=\"Unable to perform update. A full new install will be required.\"\nupdatecompleted=\"Update completed.\"\nupdatefailed=\"Update failed.\"\nupdaterules=\"Do you want to update the rules?\"\nupdatingrules=\"Updating rules.\"\nnotupdatingrules=\"Not updating rules.\"\nupdate_rev_newconf1=\"Backup from your ossec.conf has been created at $INSTALLDIR/etc/ossec.conf.orig\"\nupdate_rev_newconf2=\"Please verify your ossec.conf configuration at $INSTALLDIR/etc/ossec.conf\"\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Domain Profile Logging Path\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Domain: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' in accordance with CIS benchmark 9.1.7.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Web Publishing and Online Ordering Wizards\nDESCRIPTION: Checks if 'Turn off Internet download for Web publishing and online ordering wizards' is properly enabled by verifying the NoWebServices registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_34\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Expiration Policy\nDESCRIPTION: Registry check to verify that 'Do not allow password expiration time longer than required by policy' is set to 'Enabled' per CIS benchmark 18.2.2. The check confirms that PwdExpirationProtectionEnabled is set to 1 in the AdmPwd registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_69\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PwdExpirationProtectionEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PwdExpirationProtectionEnabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Handwriting Personalization Data Sharing\nDESCRIPTION: Checks if 'Turn off handwriting personalization data sharing' is properly enabled by verifying the PreventHandwritingDataSharing registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_45\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Installing Ruff Package\nDESCRIPTION: Command to install the Ruff Python linter and formatter using pip. Note that Python 3.11+ installations may require the --break-system-packages flag.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/tools/ci/README.md#2025-04-17_snippet_0\n\nLANGUAGE: console\nCODE:\n```\npip install ruff\n```\n\n----------------------------------------\n\nTITLE: Example JSON Output Structure in Wazuh\nDESCRIPTION: Shows the structure of a typical JSON output after applying a Wazuh normalization function. Contains both the original field and the transformed target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_66\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_string\": \"Hi Wazuh!\",\n  \"target_field\": \"c4e30dbc1b87ba8f29b24a74dba2f006be2a709e\"\n}\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off handwriting recognition error reporting\nDESCRIPTION: Validates registry settings to ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled' by checking the PreventHandwritingErrorReports value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_318\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.5 Server/Local Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring active response settings, including host-deny and firewall-drop responses for server or local installations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_9\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.5/server/local\nenable_ar=\"Do you want to enable active response?\"\nnoactive=\"Active response disabled\"\nyesactive=\"Active response enabled\"\n\nnohosts=\"host-deny disabled\"\nyeshosts=\"host-deny enabled (local) for levels >= 6\"\nfirewallar=\"Do you want to enable the firewall-drop response?\"\nnofirewall=\"firewall-drop disabled.\"\nyesfirewall=\"firewall-drop enabled (local) for levels >= 6\"\ndefaultwhitelist=\"Default white list for the active response:\"\naddwhite=\"Do you want to add more IPs to the white list?\"\nipswhite=\"IPs (space separated): \"\n```\n\n----------------------------------------\n\nTITLE: Configuring Windows Utils Unit Test Build\nDESCRIPTION: Configures build settings specific to Windows platform, including source files, compiler definitions, and required library linkage for Windows-specific functionality.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/utils/tests/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nif(CMAKE_SYSTEM_NAME STREQUAL \"Windows\")\n    add_executable(utils_unit_test\n      ${UTIL_CXX_UNITTEST_COMMON_SRC}\n      ${UTIL_CXX_UNITTEST_WINDOWS_SRC}\n      ${UTIL_CXX_UNITTEST_CPP17_SRC}\n    )\n    add_definitions(-DWIN32=1\n                    -D_WIN32_WINNT=0x600)\n    target_link_libraries(utils_unit_test\n        debug gtestd\n        debug gmockd\n        optimized gtest\n        optimized gmock\n        pthread\n        crypto\n        ssl\n        -static-libgcc -static-libstdc++\n        ws2_32\n        crypt32\n    )\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Sign-in last interactive user automatically after restart' Registry Setting\nDESCRIPTION: Checks if 'DisableAutomaticRestartSignOn' is set to 1 (Disabled) to prevent automatic sign in after system-initiated restarts.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_127\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableAutomaticRestartSignOn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableAutomaticRestartSignOn;\n```\n\n----------------------------------------\n\nTITLE: Internet Connection Wizard Control Registry Check\nDESCRIPTION: Verifies registry settings to ensure the Internet Connection Wizard is disabled when URL refers to Microsoft.com.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Setting\nDESCRIPTION: Verifies if 'Turn off Windows Error Reporting' is set to 'Enabled' by checking the Disabled registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_203\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Creating Unit Test Executable for Metrics in CMake\nDESCRIPTION: Configures the unit test executable for metrics, specifying test source files, include directories, and linking necessary libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/metrics/CMakeLists.txt#2025-04-17_snippet_4\n\nLANGUAGE: CMake\nCODE:\n```\nadd_executable(metrics_utest\n  ${UNIT_SRC_DIR}/exporter/indexerMetricsExporter_test.cpp\n  ${UNIT_SRC_DIR}/manager_test.cpp\n  ${UNIT_SRC_DIR}/mocks_test.cpp\n  ${UNIT_SRC_DIR}/metrics/metrics_test.cpp\n  ${UNIT_SRC_DIR}/main.cpp\n)\ntarget_include_directories(metrics_utest\n  PRIVATE\n  ${SRC_DIR}\n  ${UNIT_SRC_DIR}\n)\ntarget_link_libraries(metrics_utest\n  GTest::gtest\n  metrics\n  indexerconnector::mocks\n  opentelemetry-cpp::api\n  opentelemetry-cpp::metrics\n  opentelemetry-cpp::sdk\n  opentelemetry-cpp::resources\n  base::test\n  metrics::mocks\n)\ngtest_discover_tests(metrics_utest)\n```\n\n----------------------------------------\n\nTITLE: Example API Downloader Content Publication\nDESCRIPTION: Shows a concrete example of the JSON structure when publishing content downloaded through the ApiDownloader, including the downloaded file path and the downloader stage status.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/PUB_SUB_PUBLISHER.md#2025-04-17_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"paths\": [\n        \"/tmp/testProvider/contents/example.json\"\n    ],\n    \"stageStatus\": [\n        {\n            \"stage\": \"APIDownloader\",\n            \"status\": \"ok\"\n        }\n    ]\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Registration if URL connection is referring to Microsoft.com'\nDESCRIPTION: Registry check rule that verifies if 'Turn off Registration if URL connection is referring to Microsoft.com' is properly configured by ensuring NoRegistration registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_244\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking RSH Service Configuration\nDESCRIPTION: Validates that rsh/rlogin/rcp services are disabled in xinetd\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/xinetd.d/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/shell -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure handwriting recognition error reporting is disabled according to CIS benchmark 18.8.20.1.4. The rules verify if the PreventHandwritingErrorReports registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_262\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Validating MySQL master_info_repository Configuration\nDESCRIPTION: Security rule checks to ensure MySQL master_info_repository is configured to use 'Table' instead of 'File' storage. This is a CIS compliance requirement (9.2) that helps improve security by storing replication information in tables rather than files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_enterprise_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: conf\nCODE:\n```\nf:$mysql-cnfs -> !r:^# && r:master_info_repository\\s*=\\s*file;\nf:$mysql-cnfs -> !r:master_info_repository\\s*=\\s*table;\nf:$mysql-cnfs -> r:master_info_repository\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Registry Settings\nDESCRIPTION: Registry checks to verify that Internet Connection Wizard is disabled when URL is referring to Microsoft.com per CIS benchmark 18.8.20.1.5. The check ensures ExitOnMSICW is set to 1 in the Internet Connection Wizard policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_55\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Default Consent Setting\nDESCRIPTION: Verifies that Windows Error Reporting is configured to always ask before sending data as required by CIS benchmark 18.9.70.2.1. Checks that the DefaultConsent registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_123\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\Consent -> DefaultConsent -> !1;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Windows Messenger CEIP Setting\nDESCRIPTION: Verifies that 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled' by checking if the CEIP registry value is set to 0 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_273\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off Internet Connection Wizard for Microsoft.com\nDESCRIPTION: Validates registry settings to ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled' by checking the ExitOnMSICW value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_319\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Empty Password Detection Rule\nDESCRIPTION: Rule to identify accounts with empty passwords in /etc/shadow file. Complies with PCI_DSS 10.2.5 requirements.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Notification Settings\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Private: Settings: Display a notification' is set to 'No' as required by CIS benchmark 9.2.4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_21\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Data Sharing Registry Settings\nDESCRIPTION: Registry checks to verify that handwriting personalization data sharing is disabled per CIS benchmark 18.8.20.1.3. The check ensures PreventHandwritingDataSharing is set to 1 in the TabletPC policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_53\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Defining Final Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for the completion of installation, including instructions for starting and stopping Wazuh and viewing configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_14\n\nLANGUAGE: Bash\nCODE:\n```\n# Final\nconfigurationdone=\"Configuration finished properly\"\ntostart=\"To start Wazuh\"\ntostop=\"To stop Wazuh\"\nconfigat=\"The configuration can be viewed or modified at\"\naddserveragent=\"In order to connect agent and server, you need to add each agent to the server.\"\npresskey=\"Press ENTER to continue\"\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Registry Settings\nDESCRIPTION: Verifies that Search Companion content file updates are disabled by checking registry values. The check ensures DisableContentFileUpdates is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_29\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Parsing Base64 Encoded Data with parse_binary Function\nDESCRIPTION: Demonstrates the parse_binary function which validates if an input string is properly base64 encoded. When valid, it stores the same string in the target field without modification.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_101\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_binary($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"SGVsbG8sIFdvcmxkIQ==\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"SGVsbG8sIFdvcmxkIQ==\",\n  \"target_field\": \"SGVsbG8sIFdvcmxkIQ==\"\n}\n```\n\n----------------------------------------\n\nTITLE: Parsing Floating-Point Numbers in YAML\nDESCRIPTION: Illustrates the parse_float function for converting string input to floating-point numbers. It attempts to parse the input string as a float value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_111\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_float($input_field)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging for Successful Connections\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to log successful connections by checking registry keys. The check fails if LogSuccessfulConnections is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_37\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Execution Context Headers - C++\nDESCRIPTION: Header file reference for the ExecutionContext class that manages the initialization phase of the Content Manager. The class handles database setup, output folder management, and context configuration.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/EXECUTION_CONTEXT.md#2025-04-17_snippet_0\n\nLANGUAGE: cpp\nCODE:\n```\n../../src/components/executionContext.hpp\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Keystore Library Build\nDESCRIPTION: Sets up CMake project configuration for building a static keystore library, executables, and test components. Includes dependency management for OpenSSL and testing frameworks, with conditional test building based on ENGINE_BUILD_TEST flag.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/keystore/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(keystore)\n\nenable_testing()\n\nfile(GLOB KEYSTORE_SRC\n    \"src/keyStore.cpp\"\n    )\n\nadd_subdirectory(tools)\n\nadd_library(keystore STATIC ${KEYSTORE_SRC})\ntarget_link_libraries(keystore PRIVATE base)\ntarget_include_directories(keystore PUBLIC include)\n\nadd_executable(wazuh-keystore src/main.cpp)\ntarget_link_libraries(wazuh-keystore keystore OpenSSL::SSL OpenSSL::Crypto base filesystem -static-libgcc -static-libstdc++)\n\n# Tests\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\nadd_executable(keystore_ctest\n    ${COMPONENT_SRC_DIR}/keyStoreComponent_test.cpp\n)\ntarget_link_libraries(keystore_ctest GTest::gtest_main keystore OpenSSL::SSL OpenSSL::Crypto base)\ngtest_discover_tests(keystore_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Verifying Network Access Password Storage Setting in Windows Registry\nDESCRIPTION: This snippet checks if the 'Network access: Do not allow storage of passwords and credentials for network authentication' setting is enabled. It verifies the DisableDomainCreds value in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> DisableDomainCreds -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !DisableDomainCreds;\n```\n\n----------------------------------------\n\nTITLE: Checking Print Driver Download Over HTTP Registry Setting\nDESCRIPTION: Verifies if 'Turn off downloading of print drivers over HTTP' is set to 'Enabled' by checking the DisableWebPnPDownload registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_205\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Defining RBAC Library Directories in CMake\nDESCRIPTION: Sets up directory variables for source, include, and interface files of the RBAC library. These variables are used throughout the configuration to specify file locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/rbac/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\n# Defs\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\n```\n\n----------------------------------------\n\nTITLE: Checking String Contains in YAML\nDESCRIPTION: Checks if the value stored in the field contains the provided value. The function evaluates to false if the value is not contained or in case of an error.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_6\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: contains('hello')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello wazuh!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off access to the Store\nDESCRIPTION: Validates registry settings to ensure 'Turn off access to the Store' is set to 'Enabled' by checking the NoUseStoreOpenWith value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_315\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Validating Search Companion Registry Settings\nDESCRIPTION: Registry checks to verify Search Companion content updates are disabled via DisableContentFileUpdates key\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_147\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Handwriting Error Reporting\nDESCRIPTION: Verifies that 'Turn off handwriting recognition error reporting' is set to 'Enabled' by checking if the PreventHandwritingErrorReports registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_279\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: User-mounted Removable Media Rules\nDESCRIPTION: Rules to check for user-mounted removable partition permissions on the console, specifically for CD-ROM and floppy devices.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Windows CEIP\nDESCRIPTION: Checks if 'Turn off Windows Customer Experience Improvement Program' is properly enabled by verifying the CEIPEnable registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_41\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Handwriting Data Sharing Control Registry Check\nDESCRIPTION: Validates registry settings to ensure handwriting personalization data sharing is disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Search Companion content file updates' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off Search Companion content file updates' setting is enabled in the Windows registry. This check ensures that Search Companion content file updates are disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_212\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking for MYSQL_PWD Environment Variable\nDESCRIPTION: Ensures that the MYSQL_PWD environment variable is not in use, as it poses a security risk. This check is based on CIS recommendation 1.6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_mysql5-6_community_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nf:$enviroment_files -> r:\\.*MYSQL_PWD\\.*;\n```\n\n----------------------------------------\n\nTITLE: Detecting NIS Server in RHEL7\nDESCRIPTION: Checks for the presence of NIS server services in runlevel directories and systemd configurations. NIS server should be disabled for security reasons.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dypserv$;\nf:/usr/lib/systemd/system/ypserv.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Verifying Domain User Elevation for Network Location Settings in Windows Registry\nDESCRIPTION: Checks if domain users are required to elevate when setting a network's location in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_49\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Configuration in Registry\nDESCRIPTION: This snippet checks if Windows Error Reporting is disabled in the registry as recommended by CIS benchmark 18.8.20.1.14. It verifies if the 'Disabled' key is set to 1 under the Windows Error Reporting registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_88\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Microsoft Store Access\nDESCRIPTION: Checks registry settings to ensure Microsoft Store access is disabled\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_17\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Access Registry Settings\nDESCRIPTION: Verifies that access to the Windows Store is disabled by checking registry values. The check ensures NoUseStoreOpenWith is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_21\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Configuring Schema Framework Test Environment\nDESCRIPTION: Sets up test environment configuration including test directories, mock library, and test executables for unit and component testing using GTest framework.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/schemf/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\nadd_library(schemf_mocks INTERFACE)\ntarget_include_directories(schemf_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(schemf_mocks INTERFACE GTest::gmock schemf::ischema)\nadd_library(schemf::mocks ALIAS schemf_mocks)\n\nadd_executable(schemf_utest\n    ${UNIT_SRC_DIR}/field_test.cpp\n)\ntarget_link_libraries(schemf_utest PRIVATE schemf GTest::gtest_main)\ngtest_discover_tests(schemf_utest)\n\nadd_executable(schemf_ctest\n    ${COMPONENT_SRC_DIR}/schema_test.cpp\n    ${COMPONENT_SRC_DIR}/validator_test.cpp\n)\ntarget_link_libraries(schemf_ctest PRIVATE schemf GTest::gtest_main schemf::mocks base::test)\ngtest_discover_tests(schemf_ctest)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Parsing Byte Values in YAML\nDESCRIPTION: Demonstrates the use of parse_byte function to convert string input to byte values. The function attempts to parse the input string as a byte value, but fails in this example.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_106\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_byte($input_field)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off Search Companion content file updates'\nDESCRIPTION: Verifies that the DisableContentFileUpdates registry value is set to 1, which prevents Windows Search Companion from downloading content updates from Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_176\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Converting String to Byte Value with parse_byte Function\nDESCRIPTION: Demonstrates the parse_byte function which evaluates if a string represents a numeric value within the byte range (-128 to 127) and converts it to the corresponding numeric value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_105\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_byte($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"127\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"127\",\n  \"target_field\": 127\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Main Indexer Connector Interface Library\nDESCRIPTION: Sets up the interface library for the indexer connector with base dependencies and include directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(indexerconnector_iindexerconnector INTERFACE)\ntarget_include_directories(indexerconnector_iindexerconnector INTERFACE ${CMAKE_CURRENT_LIST_DIR}/interface)\ntarget_link_libraries(indexerconnector_iindexerconnector INTERFACE base)\nadd_library(indexerconnector::iindexerconnector ALIAS indexerconnector_iindexerconnector)\n```\n\n----------------------------------------\n\nTITLE: Checking TCP Data Retransmission Settings in Windows Registry\nDESCRIPTION: These snippets verify if 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' and 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' are set to 3 for both IPv6 and IPv4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !TcpMaxDataRetransmissions;\n\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Installing Python Test Dependencies for Wazuh Engine\nDESCRIPTION: Commands to install Python packages required for Integration Tests, Helper Tests, and Health Check. Also installs Docker for dynamic e2e testing with OpenSearch.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-tests.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncd ${WAZUH_REPO_DIR}\n# Install python tools\nsudo apt-get install python3-pip\npip install src/engine/tools/api-communication/\npip install src/engine/test/engine-test-utils/\npip install src/engine/tools/engine-suite/\npip install src/engine/test/health_test/engine-health-test/\n# The following is needed for dynamic e2e test with opensearch\nsudo apt-get update\nsudo apt-get install ca-certificates curl\nsudo install -m 0755 -d /etc/apt/keyrings\nsudo curl -fsSL https://download.docker.com/linux/ubuntu/gpg -o /etc/apt/keyrings/docker.asc\nsudo chmod a+r /etc/apt/keyrings/docker.asc\n# Add the repository to Apt sources:\necho \\\n  \"deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.asc] https://download.docker.com/linux/ubuntu \\\n  $(. /etc/os-release && echo \\\"$VERSION_CODENAME\\\") stable\" | \\\n  sudo tee /etc/apt/sources.list.d/docker.list > /dev/null\nsudo apt-get update\nsudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\npip install docker\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Policy Processing for Unchanged Group Policy Objects in Windows Registry\nDESCRIPTION: Checks if registry policy processing is enabled even when Group Policy objects have not changed in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_55\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoGPOListChanges;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Internet download for Web publishing' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off Internet download for Web publishing and online ordering wizards' is properly enabled in Windows Server 2012 R2. The check validates that NoWebServices registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_226\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Creating Interface Library for API Policy in CMake\nDESCRIPTION: Defines an interface library for API policy, sets include directories, and links dependencies. Creates an alias for easier referencing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/policy/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(api_policy_ipolicy INTERFACE)\ntarget_include_directories(api_policy_ipolicy INTERFACE ${IFACE_DIR})\ntarget_link_libraries(api_policy_ipolicy INTERFACE base eMessages store::istore)\nadd_library(api::policy::ipolicy ALIAS api_policy_ipolicy)\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine Router Installation\nDESCRIPTION: Command to verify the successful installation of the engine-router tool by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_router/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-router --version\n```\n\n----------------------------------------\n\nTITLE: Checking 'Join Microsoft MAPS' Setting in Windows Registry\nDESCRIPTION: Verifies that the 'Join Microsoft MAPS' setting is disabled by checking the SpynetReporting value in the Windows Defender registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_326\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Check Windows Error Reporting Registry Settings\nDESCRIPTION: Verifies that Windows Error Reporting is disabled by checking registry keys under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_141\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Data Sharing Registry Settings\nDESCRIPTION: Verifies that handwriting personalization data sharing is disabled by checking registry values. The check ensures PreventHandwritingDataSharing is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_23\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Retrieving Multiple KVDB Values as Array in YAML\nDESCRIPTION: This snippet demonstrates how to use the kvdb_get_array function to retrieve multiple values from KVDB using an array of keys. The retrieved values are appended to the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_88\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: kvdb_get_array('testing', ['test'])\n```\n\n----------------------------------------\n\nTITLE: Verifying Router Discovery Setting in Windows Registry\nDESCRIPTION: This snippet checks if 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses' is disabled. It verifies the PerformRouterDiscovery value in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> PerformRouterDiscovery  -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !PerformRouterDiscovery;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off the Windows Messenger Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: Checks if the CEIP registry key is set to 0 in the Messenger Client policies path, which disables the Customer Experience Improvement Program for Windows Messenger. This prevents data collection about messenger usage.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_78\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Validating Store Access Registry Settings\nDESCRIPTION: Registry checks to ensure access to the Windows Store is disabled per CIS benchmark 18.8.20.1.1. Validates that the NoUseStoreOpenWith key is set to 1 or exists in the Windows Explorer policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_151\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Source Route Acceptance Configuration\nDESCRIPTION: Checks if source routed packet acceptance is enabled, which is a security risk according to CIS benchmark 4.2.1\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Detecting Samba Services in RHEL7\nDESCRIPTION: Checks for the presence of Samba services in runlevel directories. Samba should be disabled if not needed for file sharing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_22\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\n```\n\n----------------------------------------\n\nTITLE: Checking Command Line Inclusion in Process Creation Events in Windows Registry\nDESCRIPTION: Verifies that the inclusion of command line in process creation events is disabled in the Windows registry for enhanced security.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_52\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit -> ProcessCreationIncludeCmdLine_Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Services Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that Internet download for Web publishing and online ordering wizards is turned off by ensuring the NoWebServices value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_103\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off downloading of print drivers over HTTP' Registry Setting\nDESCRIPTION: Checks if the DisableWebPnPDownload registry key is set to 1 in the Windows NT Printers path, which prevents Windows from downloading print drivers over HTTP. This reduces attack surface by eliminating a potential avenue for malicious drivers.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_82\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking for VSFTPD Service in RHEL7\nDESCRIPTION: Detects if VSFTPD (Very Secure FTP Daemon) is enabled in xinetd configuration. FTP services should be disabled if not required.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_19\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/xinetd.d/vsftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Failed Boolean Parsing with parse_bool Function\nDESCRIPTION: Shows cases where parse_bool fails because the input string is neither 'true' nor 'false', resulting in no change to the target field regardless of its type.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_104\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_bool($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"hello\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"hello\",\n  \"target_field\": \"any_value\"\n}\n```\n\n----------------------------------------\n\nTITLE: SSH Configuration Check - Authentication Settings\nDESCRIPTION: Validates SSH MaxAuthTries setting to ensure it's set to 4 or less for security, as specified in CIS benchmark 9.2.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:MaxAuthTries && !r:3\\s*$;\nf:/etc/ssh/sshd_config -> r:^#\\s*MaxAuthTries;\nf:/etc/ssh/sshd_config -> !r:MaxAuthTries;\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Package Generator\nDESCRIPTION: Basic command for running the Wazuh package generator script from the packages directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/packages/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nwazuh# cd packages\n./generate_package.sh [OPTIONS]\n```\n\n----------------------------------------\n\nTITLE: Setting Up Router Test Configuration\nDESCRIPTION: Configures test directories and mock libraries for router testing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_4\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n    set(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\n    add_library(router_mocks INTERFACE)\n    target_include_directories(router_mocks INTERFACE ${TEST_MOCK_DIR})\n    target_link_libraries(router_mocks INTERFACE GTest::gmock router::irouter)\n    add_library(router::mocks ALIAS router_mocks)\n```\n\n----------------------------------------\n\nTITLE: Specifying Python Package Dependencies\nDESCRIPTION: This snippet lists Python package dependencies with their specific version requirements. It includes libraries for web frameworks (aiohttp, fastapi), cryptography, data processing, and API handling. The file format is typically used with package managers like pip for installing project dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/framework/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\naiohttp==3.9.5\nbrotli-asgi==1.4.0\ncachetools==4.1.0\nchardet==3.0.4\nconnexion==3.1.0\ncontent-size-limit-asgi==0.1.5\ncryptography==42.0.4\nCython==0.29.36\ndefusedxml==0.6.0\nfastapi==0.111.1\nfuture==0.18.3\ngunicorn==22.0.0\nhttpx==0.26.0\njsonschema==4.20.0\nmore-itertools==8.2.0\nmypy-extensions==0.4.3\nopenapi-spec-validator==0.7.1\nopensearch-py==2.6.0\npsutil==6.1.1\nPyJWT==2.8.0\npython-dateutil==2.8.1\npytz==2020.1\nrsa==4.7.2\nsecure==0.3.0\nSQLAlchemy==2.0.23\nuuid6==2024.07.10\nuvloop==0.17.0\nuvicorn==0.24.0.post1\nxmltodict==0.12.0\n```\n\n----------------------------------------\n\nTITLE: Domain Network Connection Control Registry Check\nDESCRIPTION: Validates registry settings to ensure connections to non-domain networks are prohibited when connected to domain authenticated networks.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fBlockNonDomain -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> !fBlockNonDomain;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Web Publishing Wizards\nDESCRIPTION: Registry check to ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled'. Validates the NoWebServices registry value equals 1 or exists in the Explorer policies path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_234\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Configuring Indexer Connector Unit Tests with CMake\nDESCRIPTION: This CMake snippet sets up the Indexer Connector unit test project. It defines the project name, gathers source files, creates an executable, links necessary libraries, and sets up test discovery using Google Test.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/test/unit/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nproject(indexerconnector_utest)\n\nfile(GLOB SOURCES\n        *.cpp\n)\n\nadd_executable(${PROJECT_NAME} ${SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n        indexerconnector::test\n        httprequest::mock\n        urlrequest\n        GTest::gtest_main\n        GTest::gmock_main\n        pthread\n        base\n)\n\ngtest_discover_tests(${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Notifications in Windows Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Display a notification' is disabled. Checks if DisableNotifications registry value is set to 1 to prevent unnecessary user notifications for blocked connections.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_39\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> !DisableNotifications;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> !DisableNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet Connection Wizard for Microsoft.com' registry setting\nDESCRIPTION: Verifies that the ExitOnMSICW registry value is set to 1 to disable the Internet Connection Wizard when URLs refer to Microsoft.com as recommended by CIS benchmark 18.8.20.1.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_127\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Access Registry Setting\nDESCRIPTION: Verifies if 'Turn off access to the Store' is set to 'Enabled' by checking the NoUseStoreOpenWith registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_204\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that handwriting recognition error reporting is turned off by ensuring the PreventHandwritingErrorReports value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_101\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Installing Python Dependencies for Wazuh API Testing\nDESCRIPTION: Required Python package dependencies with specific versions needed to run the Wazuh API integration tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/README.md#2025-04-17_snippet_0\n\nLANGUAGE: python\nCODE:\n```\npytest==5.4.3\nrequests==2.23.0\npyaml==21.10.1\ntavern==1.0.0\npykwalify==1.7.0\npytest-html==2.1.1\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Windows Messenger CEIP\nDESCRIPTION: Registry check to ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'. Validates the CEIP registry value equals 0 or exists in the Messenger Client policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_240\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Windows Error Reporting is disabled according to CIS benchmark 18.8.20.1.14. The rules verify if the Disabled registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_258\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Handwriting Personalization Data Sharing Settings\nDESCRIPTION: Registry check to verify that 'Turn off handwriting personalization data sharing' is enabled. Checks if the PreventHandwritingDataSharing key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_122\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: RHEL Version Check Rules\nDESCRIPTION: Pattern matching rules to identify Red Hat Enterprise Linux 6 and compatible distributions\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 6;\nf:/etc/redhat-release -> r:^CentOS && r:release 6;\nf:/etc/redhat-release -> r:^Cloud && r:release 6;\nf:/etc/redhat-release -> r:^Oracle && r:release 6;\nf:/etc/redhat-release -> r:^Better && r:release 6;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Inbound Connections in Windows Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Inbound connections' is set to 'Block'. Checks if DefaultInboundAction registry value is set to 1 to block unsolicited inbound network traffic by default.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_37\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking PIN Sign-in Settings in Registry\nDESCRIPTION: Registry check to ensure that convenience PIN sign-in is disabled as required by CIS benchmark 18.8.25.5.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_61\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off handwriting recognition error reporting' registry setting\nDESCRIPTION: Verifies that the PreventHandwritingErrorReports registry value is set to 1 to disable handwriting recognition error reporting as recommended by CIS benchmark 18.8.20.1.4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_126\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet download for Web publishing wizards' registry setting\nDESCRIPTION: Verifies that the NoWebServices registry value is set to 1 to disable Internet downloads for Web publishing and online ordering wizards as recommended by CIS benchmark 18.8.20.1.6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_128\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Enabled Boot Services\nDESCRIPTION: Identifies potentially unnecessary services enabled at boot time, including Kudzu, PostgreSQL, MySQL, DNS, and NetFS, aligned with PCI DSS requirement 2.2.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_sles12_linux_rcl.txt#2025-04-17_snippet_15\n\nLANGUAGE: plaintext\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dkudzu$;\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\nd:$rc_dirs -> ^S\\d\\dmysqld$;\nd:$rc_dirs -> ^S\\d\\dnamed$;\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Failed Base64 Validation with parse_binary Function\nDESCRIPTION: Shows cases where parse_binary fails because the input string is not valid base64 encoded data, resulting in no change to the target field regardless of its type.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_102\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_binary($input_field)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"not base64\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"not base64\",\n  \"target_field\": \"any_value\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking SSH IgnoreRhosts Configuration\nDESCRIPTION: Verifies if SSH IgnoreRhosts option is disabled in sshd configuration. Based on CIS benchmark 6.2.6 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Running Agent Upgrade\nDESCRIPTION: Command to upgrade specific agent using custom WPK package\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_11\n\nLANGUAGE: bash\nCODE:\n```\n/var/ossec/bin/agent_upgrade -a 001 -f path/to/myagent.wpk -x upgrade.sh\n```\n\n----------------------------------------\n\nTITLE: Parsing JSON Log Entry for Wazuh Decoder Test\nDESCRIPTION: This snippet represents a single log entry for testing a Wazuh decoder. It includes a timestamp, JSON data with nested objects, host information, and a test message. The JSON data contains string and numeric values.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/acceptance_test/utils/test_logs.txt#2025-04-17_snippet_0\n\nLANGUAGE: JSON\nCODE:\n```\n[Mon Jan 2 15:04:05 2006] {\"test\":\"valuestr\", \"test2\":\"valuestr\", \"innerJson\": {\"intest\":\"val\", \"intest2\":23}} host test_decoder_example[1234]: Test_example for acceptation test #1\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Search Companion Content Updates\nDESCRIPTION: Checks if 'Turn off Search Companion content file updates' is properly enabled by verifying the DisableContentFileUpdates registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_37\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Monitor Tool in Python\nDESCRIPTION: Command to display help information for the Python-based monitoring tool used to gather performance metrics\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/acceptance_test/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\npython3 utils/monitor.py -h\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Registration Wizard\nDESCRIPTION: Registry check to ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'. Validates the NoRegistration registry value equals 1 or exists in the Registration Wizard Control path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_236\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Custom Clean Targets in CMake\nDESCRIPTION: Defines custom clean targets for removing in-source build files and cleaning build directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/CMakeLists.txt#2025-04-17_snippet_9\n\nLANGUAGE: cmake\nCODE:\n```\nadd_custom_target( clean_insource\n    COMMAND rm -f \"${CMAKE_SOURCE_DIR}/CMakeCache.txt\"\n    COMMAND rm -rf \"${CMAKE_SOURCE_DIR}/CMakeFiles\"\n    COMMAND rm -f \"${CMAKE_SOURCE_DIR}/cmake_install.cmake\"\n    COMMAND rm -f \"${CMAKE_SOURCE_DIR}/Makefile\"\n    ERROR_QUIET )\n\nadd_custom_target( clean_build\n    COMMAND rm -rf \"${CMAKE_SOURCE_DIR}/build/*\"\n    ERROR_QUIET )\n```\n\n----------------------------------------\n\nTITLE: Integer Less Than or Equal Check\nDESCRIPTION: Validates if a numeric field is less than or equal to 2. Shows example of failed validation when input is 22.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_16\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: int_less_or_equal(2)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": 22\n}\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' setting is enabled in the Windows registry. This check ensures that the Internet Connection Wizard is disabled when the URL refers to Microsoft.com.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_208\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Prompt Setting\nDESCRIPTION: Verifies that Terminal Services always prompts for password upon connection as required by CIS benchmark 18.9.52.3.9.1. Checks that the fPromptForPassword registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_114\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fPromptForPassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fPromptForPassword;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Messenger CEIP' registry setting\nDESCRIPTION: Verifies that the CEIP registry value is set to 0 to disable the Windows Messenger Customer Experience Improvement Program as recommended by CIS benchmark 18.8.20.1.12.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_134\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Defining Configuration Options for Wazuh Installation Script in Bash\nDESCRIPTION: Sets up basic configuration variables used throughout the Wazuh installation script, including yes/no options and installation types (agent, local, server).\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_0\n\nLANGUAGE: Bash\nCODE:\n```\n# Configuration\nyes=\"y\"\nno=\"n\"\nyesmatch=\"y\"\nnomatch=\"n\"\nagent=\"agent\"\nlocal=\"local\"\nserver=\"server\"\nhelp=\"help\"\n```\n\n----------------------------------------\n\nTITLE: Validating Windows Messenger CEIP Registry Settings\nDESCRIPTION: Registry checks to ensure the Windows Messenger Customer Experience Improvement Program is disabled per CIS benchmark 18.8.20.1.12. Validates that the CEIP key is set to 0 or exists in the Messenger client policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_148\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Access Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure access to the Store is disabled according to CIS benchmark 18.8.20.1.1. The rules verify if the NoUseStoreOpenWith registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_259\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Verifying Removable Media Formatting Permissions in Windows Registry\nDESCRIPTION: This snippet checks if 'Devices: Allowed to format and eject removable media' is set to 'Administrators'. It corresponds to CIS Benchmark 2.3.4.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_5\n\nLANGUAGE: Windows Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 2;\n```\n\n----------------------------------------\n\nTITLE: Collecting Source Files\nDESCRIPTION: Gathers all CPP source files in the current directory using glob pattern matching.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/tool/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nfile(GLOB INDEXER_CONNECTOR_TOOL_SRC\n    \"*.cpp\"\n    )\n```\n\n----------------------------------------\n\nTITLE: SELinux Configuration Rules\nDESCRIPTION: Rules to check SELinux enforcement state and policy configuration\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_3\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/grub.conf -> !r:selinux=0;\nf:/etc/selinux/config -> r:SELINUX=enforcing;\nf:/etc/selinux/config -> r:SELINUXTYPE=targeted;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Notification Settings\nDESCRIPTION: Ensures that Windows Firewall Public Profile is configured to display notifications according to CIS benchmark 9.3.4. Checks both policy and system registry paths for DisableNotifications value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_59\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Assistance Offer Settings in Registry\nDESCRIPTION: Registry check to ensure that 'Configure Offer Remote Assistance' is disabled as required by CIS benchmark 18.8.31.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_62\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off Registration if URL connection is referring to Microsoft.com'\nDESCRIPTION: Verifies that the NoRegistration registry value is set to 1, which disables automatic registration with Microsoft when URL connections reference Microsoft.com domains.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_175\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Validating Windows CEIP Registry Settings\nDESCRIPTION: Registry checks to ensure the Windows Customer Experience Improvement Program is disabled per CIS benchmark 18.8.20.1.13. Validates that the CEIPEnable key is set to 0 or exists in the SQMClient Windows policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_149\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Parsing Alphanumeric String with parse_alphanumeric Function\nDESCRIPTION: Demonstrates the parse_alphanumeric function which checks if an input matches an alphanumeric string and extracts the data. The function evaluates to true for valid alphanumeric strings and false otherwise.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_96\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_alphanumeric($field_to_parse)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"field_to_parse\": \"Hello2024\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"field_to_parse\": \"Hello2024\",\n  \"target_field\": \"Hello2024\"\n}\n```\n\n----------------------------------------\n\nTITLE: Building Router Implementation Library\nDESCRIPTION: Defines the main router implementation library with source files and dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(router_router STATIC\n    ${SRC_DIR}/table.cpp\n    ${SRC_DIR}/environment.cpp\n    ${SRC_DIR}/router.cpp\n    ${SRC_DIR}/tester.cpp\n    ${SRC_DIR}/worker.cpp\n    ${SRC_DIR}/entryConverter.cpp\n    ${SRC_DIR}/orchestrator.cpp\n)\n```\n\n----------------------------------------\n\nTITLE: Detecting Empty Password Accounts\nDESCRIPTION: Identifies accounts with empty passwords in /etc/shadow file by looking for entries with empty password fields.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_14\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Initializing Test Environment\nDESCRIPTION: Command to load configurations and geo-as databases for testing\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/health_test/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-health-test dynamic -e health_test/environment init -b build/main -r engine/ruleset -t test/health_test/\n```\n\n----------------------------------------\n\nTITLE: Displaying Root Permission Error Message\nDESCRIPTION: Error message output indicating that root privileges are required to execute the script. Shows both an error code (0x2) and a descriptive message.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/errors/0x2-beroot.txt#2025-04-17_snippet_0\n\nLANGUAGE: text\nCODE:\n```\nError 0x2.\nYou must be root to use this script.\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Store Access Settings\nDESCRIPTION: Registry check to verify that 'Turn off access to the Store' is enabled. Checks if the NoUseStoreOpenWith key exists and is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_120\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Defining Wargbot Backdoor Detection Rules\nDESCRIPTION: Rules to detect the Wargbot Backdoor by checking for specific files and registry entries. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: text\nCODE:\n```\n[Wargbot Backdoor {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\wgareg.exe;\nf:%WINDIR%\\Sysnative\\wgareg.exe;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\wgareg;\n```\n\n----------------------------------------\n\nTITLE: Displaying Wazuh Modules Directory Structure in Markdown\nDESCRIPTION: This code snippet shows the directory structure of the Wazuh modules, including subdirectories for agent, logcollector, and other components. It provides a hierarchical view of the module organization within the Wazuh project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/README.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Modules\n\n```\nmodules/\n├── agent\n│   ├── src\n│   │   └── ...\n│   └── ...\n├── logcollector\n│   ├── src\n│   │   └── ...\n│   └── ...\n├── ...\n└── wmodules\n    ├── agent_upgrade\n    │   ├── agent\n    │   │   └── ...\n    │   ├── manager\n    │   │   └── ...\n    │   └── ...\n    ├── ...\n    └── task_manager\n        ├── agent\n        │   └── ...\n        ├── manager\n        │   └── ...\n        └── ...\n```\n```\n\n----------------------------------------\n\nTITLE: Installing Pre-commit Configuration\nDESCRIPTION: Command to install pre-commit hooks using the project's configuration file located in the apis/tools/ci directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/tools/ci/README.md#2025-04-17_snippet_2\n\nLANGUAGE: console\nCODE:\n```\npre-commit install --config ./apis/tools/ci/.pre-commit-config.yaml\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Registry Settings\nDESCRIPTION: Verifies that Internet Connection Wizard is disabled for Microsoft.com references by checking registry values. The check ensures ExitOnMSICW is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_25\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode for All Administrators in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Run all administrators in Admin Approval Mode' is enabled. Checks if EnableLUA registry value is set to 1 to enforce UAC prompts for all administrator accounts.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_33\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableLUA -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Store Access Settings in Windows Registry\nDESCRIPTION: This snippet checks if access to the Store is disabled by verifying the 'NoUseStoreOpenWith' key in the Explorer registry path. It ensures the value is set to 1 or the key doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_190\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Defining Additional Part 3.5 Server/Local Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring remote syslog settings for server or local installations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_10\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.5/server/local\nsyslog=\"Do you want to enable remote syslog (port 514 udp)?\"\nnosyslog=\"Remote syslog disabled\"\nyessyslog=\"Remote syslog enabled\"\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for HTTP Printing\nDESCRIPTION: Registry check to ensure 'Turn off printing over HTTP' is set to 'Enabled'. Validates the DisableHTTPPrinting registry value equals 1 or exists in the Windows NT Printers policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_235\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging for Dropped Packets\nDESCRIPTION: Verifies that Windows Firewall Private Profile is configured to log dropped packets by checking registry keys. The check fails if LogDroppedPackets is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_26\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off the \"Order Prints\" picture task'\nDESCRIPTION: Verifies that the NoOnlinePrintsWizard registry value is set to 1, which disables the \"Order Prints Online\" wizard in Windows Explorer.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_177\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive Boot Configuration\nDESCRIPTION: Validates that interactive boot is disabled by checking PROMPT=no setting in /etc/sysconfig/init\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/sysconfig/init -> !r:^# && r:PROMPT=no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Dropped Packets Logging\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to log dropped packets according to CIS benchmark 9.3.9. Examines registry settings in both policy and system locations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_64\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Order Prints Feature Registry Settings\nDESCRIPTION: Verifies that the \"Order Prints\" picture task is disabled by checking registry values. The check ensures NoOnlinePrintsWizard is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_30\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off printing over HTTP' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off printing over HTTP' is properly enabled in Windows Server 2012 R2. The check validates that DisableHTTPPrinting registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_227\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off handwriting recognition error reporting' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off handwriting recognition error reporting' setting is enabled in the Windows registry. It verifies the PreventHandwritingErrorReports value in the HandwritingErrorReports key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_162\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Deleting Array Fields with delete() Function in Wazuh\nDESCRIPTION: Shows how the delete() function can be used to remove an array field from an event.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_80\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: delete()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring API KVDB Unit Tests in CMake\nDESCRIPTION: Sets up the unit tests for the API KVDB library when ENGINE_BUILD_TEST is enabled. It defines the test executable, its source files, include directories, and links necessary dependencies including GTest.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/kvdb/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n    set(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n    set(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\n\n    add_executable(api_kvdb_utest\n        ${UNIT_SRC_DIR}/handlers_test.cpp\n    )\n    target_include_directories(api_kvdb_utest\n        PRIVATE\n        ${UNIT_SRC_DIR}\n    )\n    target_link_libraries(api_kvdb_utest\n        PRIVATE\n        api::kvdb\n        GTest::gtest_main\n        kvdb::mocks\n        api::adapter::test\n    )\n    gtest_discover_tests(api_kvdb_utest)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Installing from WPK Repository\nDESCRIPTION: Command to upgrade agent using packages from a custom WPK repository\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_13\n\nLANGUAGE: bash\nCODE:\n```\n/var/ossec/bin/agent_upgrade -a 001 -r https://example.com/repo\n```\n\n----------------------------------------\n\nTITLE: Using setupEnvironment.py Script for Wazuh-Engine Test Environment\nDESCRIPTION: Command syntax for using the setupEnvironment.py script to set up the test environment for Wazuh-Engine. It includes optional arguments for specifying the environment directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n./setupEnvironment.py [-h] [-e ENVIRONMENT]\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.4/3.5 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for setting up log analysis configuration in parts 3.4 and 3.5 of the installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_11\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.4/3.5\nreadlogs=\"Setting the configuration to analyze the following logs:\"\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Registration for Microsoft.com' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Registration if URL connection is referring to Microsoft.com' setting is enabled in the Windows registry. It verifies the NoRegistration value in the Registration Wizard Control key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_166\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Directory Structure of Engine Suite\nDESCRIPTION: Displays the directory structure of the engine-suite package, showing the different modules and shared components.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/README.md#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n├── engine-suite/\n│   └── src\n│       └── engine_clear\n│       └── engine_catalog\n│       └── engine_decoder\n│       └── engine_diff\n│       └── engine_integration\n│       └── engine_policy\n│       └── engine_router\n│       └── engine_schema\n│       └── engine_test\n│       └── shared\n```\n\n----------------------------------------\n\nTITLE: Defining Looked.BK Worm Detection Rules\nDESCRIPTION: Rules to detect the Looked.BK Worm by checking for specific files and registry entries. Includes PCI DSS compliance reference.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/win_malware_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: text\nCODE:\n```\n[Looked.BK Worm {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\uninstall\\rundl132.exe;\nf:%WINDIR%\\Logo1_.exe;\nf:%Windir%\\RichDll.dll;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run -> load -> r:rundl132.exe;\n```\n\n----------------------------------------\n\nTITLE: Serving Wazuh Server Documentation Locally with bash\nDESCRIPTION: Command to serve the Wazuh Server documentation locally for preview purposes. The documentation will be accessible through a web browser at http://127.0.0.1:3000.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n./server.sh\n```\n\n----------------------------------------\n\nTITLE: Generate Documentation Command Help\nDESCRIPTION: Help output for the generate-doc subcommand which creates README.md based on manifest and documentation.yml\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_3\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration generate-doc -h\nusage: engine-integration generate-doc [-h]\n\noptions:\n  -h, --help  show this help message and exit\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet download for Web publishing and online ordering wizards' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off Internet download for Web publishing and online ordering wizards' setting is enabled in the Windows registry. This check ensures that Internet downloads for Web publishing and online ordering wizards are disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_209\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.1 Agent Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings specific to agent installation configuration, including server address and agent profile settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_5\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.1/agent\nserveraddr=\"What's the IP Address or hostname of the Wazuh server?\"\naddingip=\"Adding Server IP\"\naddingname=\"Adding Hostname\"\nconfigprofile=\"Enter the agent's config profile name (default: blank)\"\naddingcfg=\"Setting agent's config profile name\"\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Store Access\nDESCRIPTION: Registry check to ensure 'Turn off access to the Store' is set to 'Enabled'. Validates the NoUseStoreOpenWith registry value equals 1 or exists in the Explorer policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_243\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Server Using Binary\nDESCRIPTION: Executes the Wazuh Server directly using the binary located in the /usr/share/wazuh-server/bin directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/run-server.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n/usr/share/wazuh-server/bin/wazuh-server\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off handwriting recognition error reporting' Setting\nDESCRIPTION: Registry checks to verify if the 'PreventHandwritingErrorReports' key is set to 1, which disables handwriting recognition error reporting. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_62\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging for Dropped Packets\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to log dropped packets by checking registry keys. The check fails if LogDroppedPackets is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_36\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Search Companion content file updates'\nDESCRIPTION: Registry check rule that verifies if 'Turn off Search Companion content file updates' is properly configured by ensuring DisableContentFileUpdates registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_245\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.2 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring the integrity check daemon (syscheck) during installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_6\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.2\nrunsyscheck=\"Do you want to run the integrity check daemon?\"\nnosyscheck=\"Not running syscheck (integrity check daemon)\"\nyessyscheck=\"Running syscheck (integrity check daemon)\"\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Complexity Settings\nDESCRIPTION: Registry check to verify that 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters' per CIS benchmark 18.2.4. The check confirms that PasswordComplexity is set to 4.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_71\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordComplexity -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Publish to Web Feature Registry Settings\nDESCRIPTION: Verifies that the \"Publish to Web\" task for files and folders is disabled by checking registry values. The check ensures NoPublishingWizard is set to 1 or completely missing from the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_31\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Handwriting Error Reporting\nDESCRIPTION: Registry check to ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled'. Validates the PreventHandwritingErrorReports registry value equals 1 or exists in the HandwritingErrorReports policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_232\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off access to the Store' Registry Setting\nDESCRIPTION: Verifies if the 'NoUseStoreOpenWith' registry key is set to 1 to disable access to the Store.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_173\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: String Conversion Function in Wazuh\nDESCRIPTION: Transforms a numeric value into its string representation. Commonly used in the map stage of normalization pipelines.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_63\n\nLANGUAGE: yaml\nCODE:\n```\nfield: to_string(any_number)\n```\n\n----------------------------------------\n\nTITLE: Initializing Database Feed Project and Schemas in CMake\nDESCRIPTION: Sets up the project, enables testing, and defines a list of schemas to be compiled. It also checks for the presence of the flatc compiler.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/feedmanager/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nproject(database_feed)\n\nenable_testing()\n\nlist(APPEND Schemas\n            cve5\n            vulnerabilityCandidate\n            vulnerabilityDescription\n            vulnerabilityRemediations\n            packageTranslation\n)\n\nfind_program(FLATC flatc)\nif(NOT FLATC)\n    message(FATAL_ERROR \"flatc not found\")\nendif()\n```\n\n----------------------------------------\n\nTITLE: Copying Module Resources\nDESCRIPTION: Copies required module resources including _meta, alerts, archives, and module configuration files to the wazuh directory\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n# cp -r _meta wazuh/\n# cp -r alerts wazuh/\n# cp -r archives wazuh/\n# cp -r module.yml wazuh/\n```\n\n----------------------------------------\n\nTITLE: RC Scripts Directory Declaration\nDESCRIPTION: Defines the location of runlevel RC script directories for system service management\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: conf\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: System Epoch Function Implementation in Wazuh\nDESCRIPTION: Gets the unix epoch time in seconds from the system clock. The result is mapped to the specified field, overwriting it if it already exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_61\n\nLANGUAGE: yaml\nCODE:\n```\nfield: system_epoch()\n```\n\n----------------------------------------\n\nTITLE: Fixing Prelude Output SHA-256 Algorithm Name in Python\nDESCRIPTION: This code change uses the proper algorithm name 'SHA-256' instead of an incorrect name for SHA-256 inside Prelude output.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_5\n\nLANGUAGE: python\nCODE:\n```\n# Use the proper algorithm name for SHA-256 inside Prelude output\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off the Windows Messenger CEIP'\nDESCRIPTION: Verifies that the CEIP registry value is set to 0, which disables the Customer Experience Improvement Program for Windows Messenger.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_179\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Using string_less Function in Wazuh\nDESCRIPTION: Demonstrates how to use the string_less function for lexicographical comparison. The function returns true if the target field is lexicographically less than the provided string.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_36\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_less('wazuh')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Specifying pytest Dependency Version\nDESCRIPTION: Defines the specific version of pytest (7.2.2) required for running Python tests in this project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/keystore/qa/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\npytest==7.2.2\n```\n\n----------------------------------------\n\nTITLE: Generate Graph Command Help\nDESCRIPTION: Help output for the generate-graph subcommand which creates dot format graphs for different asset types\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_4\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration generate-graph -h\nusage: engine-integration generate-graph [-h] {decoders,rules,outputs}\n\npositional arguments:\n  {decoders,rules,outputs}\n                        Component type to generate the graph\n\noptions:\n  -h, --help            show this help message and exit\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Print Drivers over HTTP\nDESCRIPTION: Registry check to ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'. Validates the DisableWebPnPDownload registry value equals 1 or exists in the Windows NT Printers policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_230\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Length Settings\nDESCRIPTION: Registry check to verify that 'Password Settings: Password Length' is set to 'Enabled: 15 or more' per CIS benchmark 18.2.5. The check confirms that PasswordLength is set to a value of 15 or greater.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_72\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:a;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:b;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:c;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:e;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PasswordLength;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off access to the Store' Registry Setting\nDESCRIPTION: Verifies the NoUseStoreOpenWith registry key is set to 1 in Explorer policies, which disables access to the Windows Store. This prevents users from installing applications from the Microsoft Store.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_81\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Validating HTTP Print Driver Download Registry Settings\nDESCRIPTION: Registry checks to ensure downloading of print drivers over HTTP is disabled per CIS benchmark 18.8.20.1.2. Validates that the DisableWebPnPDownload key is set to 1 or exists in the Windows NT Printers policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_152\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Log Maximum Size Settings in Registry\nDESCRIPTION: Registry checks to ensure the Security Event Log maximum size is set to at least 196,608 KB as required by CIS benchmark 18.9.26.2.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_73\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:0\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:1\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:2\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: HTTP Print Driver Download Control Registry Check\nDESCRIPTION: Checks registry settings to ensure downloading print drivers over HTTP is disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Defining CA Store Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for managing X509 certificates in the CA store during installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_17\n\nLANGUAGE: Bash\nCODE:\n```\n# CA store\naddcastore=\"Do you want to add more certificates?\"\ncastore=\"Enter the path to a X509 certificate or a certificate folder: \"\n```\n\n----------------------------------------\n\nTITLE: Verifying IPv6 Disable Setting in Windows Registry\nDESCRIPTION: This snippet checks if IPv6 is disabled by verifying the DisabledComponents value in the Windows registry is set to 0xff (255).\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_7\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> DisabledComponents -> !ff;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !DisabledComponents;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for HTTP Printing\nDESCRIPTION: Checks if 'Turn off printing over HTTP' is properly enabled by verifying the DisableHTTPPrinting registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_35\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the \"Publish to Web\" task for files and folders'\nDESCRIPTION: Registry check rule that verifies if 'Turn off the \"Publish to Web\" task for files and folders' is properly configured by ensuring NoPublishingWizard registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_247\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off access to the Store'\nDESCRIPTION: Verifies that the NoUseStoreOpenWith registry value is set to 1, which disables access to the Windows Store.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_182\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Division of Two Integers using int_calculate in Wazuh\nDESCRIPTION: Shows integer division using int_calculate. The operation is performed successfully and the result is stored in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_55\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('div', -45, 2)\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": -22\n}\n```\n\n----------------------------------------\n\nTITLE: Documentation Generation Commands in Bash\nDESCRIPTION: Commands for generating helper function documentation at different scopes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\nengine-helper-test -e /tmp/environment generate-doc --input-file test/helper_tests/helpers_description/map/int_calculate.yml -o test/helper_tests/documentation\n```\n\nLANGUAGE: bash\nCODE:\n```\nengine-helper-test -e /tmp/environment generate-doc --input-dir test/helper_tests/helpers_description/map -o test/helper_tests/documentation\n```\n\nLANGUAGE: bash\nCODE:\n```\nengine-helper-test -e /tmp/environment generate-doc --input-dir test/helper_tests/helpers_description/ -o docs/helpers/\n```\n\n----------------------------------------\n\nTITLE: Compiling Wazuh Agent\nDESCRIPTION: Compiles Wazuh agent from source code\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nmake -C wazuh-3.0/src TARGET=agent\n```\n\n----------------------------------------\n\nTITLE: Checking Enabled System Services\nDESCRIPTION: Detects various enabled system services that should be disabled for security, including Kudzu, PostgreSQL, MySQL, DNS, and NetFS.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dkudzu$;\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\nd:$rc_dirs -> ^S\\d\\dmysqld$;\nd:$rc_dirs -> ^S\\d\\dnamed$;\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off handwriting recognition error reporting'\nDESCRIPTION: Verifies that the PreventHandwritingErrorReports registry value is set to 1, which disables sending handwriting recognition errors to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_185\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Parsed JSON Output from Wazuh Parser\nDESCRIPTION: The resulting JSON structure after parsing the sample log entry with the parser expression. Shows how the IP addresses and port are extracted into their respective fields.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_23\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"client.ip\": \"192.168.1.10\",\n  \"server.ip\": \"10.0.0.5\",\n  \"server.port\": \"443\"\n}\n```\n\n----------------------------------------\n\nTITLE: Sample Test Mapping Output for agent.py\nDESCRIPTION: Example output showing the test files mapped to the agent.py file, including both standard CRUD operation tests and RBAC-specific tests.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/mapping/README.md#2025-04-17_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\ntest_agent_GET_endpoints.tavern.yaml\ntest_agent_DELETE_endpoints.tavern.yaml\ntest_agent_PUT_endpoints.tavern.yaml\ntest_agent_POST_endpoints.tavern.yaml\ntest_rbac_black_agent_endpoints.tavern.yaml\ntest_rbac_white_agent_endpoints.tavern.yaml\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Windows Messenger Customer Experience Improvement Program is disabled according to CIS benchmark 18.8.20.1.12. The rules verify if the CEIP registry key is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_270\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Autoplay Disable Settings in Registry\nDESCRIPTION: Registry checks to ensure that 'Turn off Autoplay' is enabled for all drives as required by CIS benchmark 18.9.8.3.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_67\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> NoDriveTypeAutoRun -> !ff;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> !NoDriveTypeAutoRun;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Store Access\nDESCRIPTION: Verifies that 'Turn off access to the Store' is set to 'Enabled' by checking if the NoUseStoreOpenWith registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_276\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off the Windows Messenger Customer Experience Improvement Program\nDESCRIPTION: Validates registry settings to ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled' by checking the CEIP value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_312\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Default Consent Configuration\nDESCRIPTION: Verifies that 'Configure Default consent' is set to 'Enabled: Always ask before sending data' by checking if DefaultConsent registry value is not set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_82\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\Consent -> DefaultConsent -> !1;\n```\n\n----------------------------------------\n\nTITLE: Store Access Control Registry Check\nDESCRIPTION: Verifies registry settings to ensure access to the Windows Store is disabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Delete Integration Command Help\nDESCRIPTION: Help output for the delete subcommand which removes integration assets from the Engine catalog\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_integration/README.md#2025-04-17_snippet_6\n\nLANGUAGE: console\nCODE:\n```\n$ engine-integration delete -h\nusage: engine-integration delete [-h] [-a API_SOCK] [--dry-run] [-n NAMESPACE]\n                                 integration-name\n\npositional arguments:\n  integration-name      Integration name to be deleted\n\noptions:\n  -h, --help            show this help message and exit\n  -a API_SOCK, --api-sock API_SOCK\n                        [default=\"/run/wazuh-server/engine-api.socket\"] Engine\n                        instance API socket path\n  --dry-run             default False, When True will print all the steps to\n                        apply without affecting the store\n  -n NAMESPACE, --namespace NAMESPACE\n                        [default=\"user\"] Namespace of the integration\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Windows Messenger CEIP\nDESCRIPTION: Checks if 'Turn off the Windows Messenger Customer Experience Improvement Program' is properly enabled by verifying the CEIP registry value is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_40\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for HTTP Print Driver Downloads\nDESCRIPTION: Checks if 'Turn off downloading of print drivers over HTTP' is properly enabled by verifying the DisableWebPnPDownload registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_44\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off printing over HTTP'\nDESCRIPTION: Registry check rule that verifies if 'Turn off printing over HTTP' is properly configured by ensuring DisableHTTPPrinting registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_257\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for Handwriting Data Sharing\nDESCRIPTION: Registry check to ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'. Validates the PreventHandwritingDataSharing registry value equals 1 or exists in the TabletPC policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_231\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Using string_less with Equal Values in Wazuh\nDESCRIPTION: Shows that string_less returns false when the strings are equal. The function only returns true when the target is strictly less than the comparison value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_38\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_less('hello world!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Installing Root CA Certificate\nDESCRIPTION: Copies custom root CA certificate to Wazuh configuration directory\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\ncp path/to/wpk_root.pem etc/wpk_root.pem\n```\n\n----------------------------------------\n\nTITLE: Detecting NFS Services in RHEL7\nDESCRIPTION: Checks for the presence of NFS and NFS lock services in runlevel directories. NFS should be disabled if not needed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel7_linux_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off printing over HTTP' Registry Setting\nDESCRIPTION: Ensures 'Turn off printing over HTTP' is set to 'Enabled' by checking the DisableHTTPPrinting value in the Printers registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Configuring Defs Interface Definitions Library in CMake\nDESCRIPTION: Sets up the interface library 'defs_idefinitions' with include directories and dependencies. This library serves as the interface for the main 'defs' library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/defs/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(defs_idefinitions INTERFACE)\ntarget_include_directories(defs_idefinitions INTERFACE\n  ${CMAKE_CURRENT_LIST_DIR}/interface\n)\ntarget_link_libraries(defs_idefinitions INTERFACE base)\nadd_library(defs::idefinitions ALIAS defs_idefinitions)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Settings for 'Turn off Internet download for Web publishing and online ordering wizards'\nDESCRIPTION: Verifies that the NoWebServices registry value is set to 1, which prevents Windows from downloading web content for publishing wizards and online ordering forms.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_187\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off Internet download for Web publishing and online ordering wizards' Registry Setting\nDESCRIPTION: Checks if the NoWebServices registry key is set to 1 in Explorer policies, which prevents Windows from downloading templates for Web publishing and online ordering wizards. This reduces external connections and potential data exposure.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_86\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Registration for Microsoft.com' Setting\nDESCRIPTION: Registry checks to verify if the 'NoRegistration' key is set to 1, which disables Registration Wizard when URLs refer to Microsoft.com. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_66\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Order Prints\" picture task' Registry Setting\nDESCRIPTION: Verifies that 'Turn off the \"Order Prints\" picture task' is set to 'Enabled' by checking the NoOnlinePrintsWizard value in the Explorer registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Publish to Web Task Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that the 'Publish to Web' task for files and folders is turned off by ensuring the NoPublishingWizard value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_108\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Wazuh Cluster Node Resources and Actions Table in Markdown\nDESCRIPTION: A markdown table structure defining node resources and their corresponding access control permissions. Shows allowed and denied actions for different node IDs in a cluster setup with master and worker nodes.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/env/configurations/rbac/cluster/white_config.txt#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n| Resource    | List                                                                                                  |\n|-------------|-------------------------------------------------------------------------------------------------------|\n| node:id     | master-node,worker1,worker2                                                                           |\n\n\n| Actions                  | Resources         | Allow                                                                                                             | Deny                |\n|--------------------------|-------------------|-------------------------------------------------------------------------------------------------------------------|---------------------|\n| cluster:read             | node:id           | master-node,worker2                                                                                               | worker1             |\n| cluster:restart          | node:id           | worker2                                                                                                           | master-node,worker1 |\n| cluster:status           | *:*               | *                                                                                                                 |                     |\n| cluster:update_config    | node:id           | master-node,worker2                                                                                               | worker1             |\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Registry Settings\nDESCRIPTION: Registry checks to verify that the Windows Messenger Customer Experience Improvement Program is disabled per CIS benchmark 18.8.20.1.12. The check ensures CEIP is set to 0 in the Messenger client policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_48\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Internet Connection Wizard for Microsoft.com' Setting\nDESCRIPTION: Registry checks to verify if the 'ExitOnMSICW' key is set to 1, which disables the Internet Connection Wizard when URLs refer to Microsoft.com. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_63\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off access to the Store' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off access to the Store' setting is enabled in the Windows registry. It verifies the NoUseStoreOpenWith value in the Explorer policy key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_306\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Sign-in After System Restart Configuration\nDESCRIPTION: Verifies that 'Sign-in last interactive user automatically after a system-initiated restart' is disabled by checking if DisableAutomaticRestartSignOn is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_86\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableAutomaticRestartSignOn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableAutomaticRestartSignOn;\n```\n\n----------------------------------------\n\nTITLE: Using string_greater with Equal Values in Wazuh\nDESCRIPTION: Shows that string_greater returns false when the strings are equal. The function only returns true when the target is strictly greater than the comparison value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_35\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_greater('hello world!')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"hello world!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Generate Schema Example\nDESCRIPTION: Example of generating schema files using the integration subcommand with specific output directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_schema/README.md#2025-04-17_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\n$ engine-schema generate --output-dir /tmp/schema_update integration engine/ruleset/wazuh-core/\nUsing target ECS version: v8.8.0\nLoading resources...\nDownloading https://raw.githubusercontent.com/elastic/ecs/v8.8.0/generated/ecs/ecs_flat.yml...\nLoading schema template...\nLoading mappings template...\nLoading logpar overrides template...\nBuilding field tree from ecs definition...\nSuccess.\nGenerating engine schema...\nAdding module engine/ruleset/wazuh-core/...\nLoading resources...\nGenerating field tree...\nAdding logpar overrides...\nMerging module...\nAdding to engine schema...\nSuccess.\nGenerating fields schema properties...\nSuccess.\nGenerating indexer mappings...\nSuccess.\nGenerating logpar configuration...\nSuccess.\nSaving files to \"/tmp/schema_update\"...\nSuccess.\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Firewall Domain Profile Log Dropped Packets\nDESCRIPTION: Registry check to verify that 'Windows Firewall: Domain: Logging: Log dropped packets' is set to 'Yes' in compliance with CIS benchmark 9.1.9.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_16\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Paths After Decompression - JSON Structure\nDESCRIPTION: Example of file paths structure after the gzip decompression stage completes. Shows decompressed files in the contents directory with .gz extensions removed.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/GZIP_DECOMPRESSOR.md#2025-04-17_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n\"paths\": [\n    \"/tmp/outputFolder/contents/file1.json\",\n    \"/tmp/outputFolder/contents/file2.xml\"\n]\n```\n\n----------------------------------------\n\nTITLE: Publishing Content Data Structure in JSON\nDESCRIPTION: Defines the JSON structure used for publishing content data, including file paths and stage statuses. The paths array contains the locations of downloaded content files, while stageStatus array tracks the execution status of different stages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/PUB_SUB_PUBLISHER.md#2025-04-17_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"paths\": [\n        \"<file_1_path>\",\n        \"<file_2_path>\",\n        ...\n        \"<file_N_path>\"\n    ],\n    \"stageStatus\": [\n        {\n            \"stage\": \"<stage_A_name>\",\n            \"status\": \"<stage_A_status>\"\n        },\n        {\n            \"stage\": \"<stage_B_name>\",\n            \"status\": \"<stage_B_status>\"\n        },\n        ...\n        {\n            \"stage\": \"<stage_N_name>\",\n            \"status\": \"<stage_N_status>\"\n        }\n    ]\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring API Event Library in CMake\nDESCRIPTION: Sets up the API event library, specifying source files, include directories, and dependencies. It creates a static library named 'api_event' and an alias 'api::event'.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/event/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(api_event STATIC\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_event\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_event\n    PUBLIC\n    api::adapter\n\n    PRIVATE\n    router::irouter\n)\nadd_library(api::event ALIAS api_event)\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off Search Companion content file updates\nDESCRIPTION: Validates registry settings to ensure 'Turn off Search Companion content file updates' is set to 'Enabled' by checking the DisableContentFileUpdates value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_309\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Publish to Web\" task for files and folders' Registry Setting\nDESCRIPTION: Ensures 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled' by checking the NoPublishingWizard value in the Explorer registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_10\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Registry Settings\nDESCRIPTION: Registry checks to verify that Search Companion content file updates are disabled per CIS benchmark 18.8.20.1.9. The check ensures DisableContentFileUpdates is set to 1 in the SearchCompanion policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_59\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the \"Order Prints\" picture task' Setting\nDESCRIPTION: Registry checks to verify if the 'NoOnlinePrintsWizard' key is set to 1, which disables the 'Order Prints' picture task. Performs checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_68\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Bridge Installation Settings in Windows Registry\nDESCRIPTION: Verifies that the installation and configuration of Network Bridge on the DNS domain network is prohibited in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_48\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Array Type Validation Check in YAML\nDESCRIPTION: Shows how to validate that a field is not an object using YAML configuration\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_21\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: is_not_object()\n```\n\n----------------------------------------\n\nTITLE: Configuring Number Type Generator in YAML\nDESCRIPTION: Example of correct type and generator configuration for number type.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/helper_tests/README.md#2025-04-17_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\ntype: number\ngenerate: integer\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Notification Settings\nDESCRIPTION: Verifies that Windows Firewall Public Profile is configured to display notifications by checking registry keys. The check fails if DisableNotifications is set to 0 in either policy location.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_31\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Object Type Validation in JSON\nDESCRIPTION: Example of validating an object type field with nested key-value pairs\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_22\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": {\n    \"key\": \"value\"\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off the \"Order Prints\" picture task\nDESCRIPTION: Validates registry settings to ensure 'Turn off the \"Order Prints\" picture task' is set to 'Enabled' by checking the NoOnlinePrintsWizard value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_310\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the Windows Messenger Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: Verifies that 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled' by checking the CEIP value in the Messenger\\Client registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_11\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off access to the Store' Setting\nDESCRIPTION: Registry checks to verify if the 'NoUseStoreOpenWith' key is set to 1, which disables access to the Windows Store. Performs checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_73\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Validating 'Turn off handwriting recognition error reporting' Registry Setting\nDESCRIPTION: Checks if the PreventHandwritingErrorReports registry key is set to 1 in the HandwritingErrorReports path, which disables the automatic reporting of handwriting recognition errors. This prevents sending handwriting samples to Microsoft.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_84\n\nLANGUAGE: oscap\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Administrator Account Enumeration Settings in Registry\nDESCRIPTION: Registry check to ensure that 'Enumerate administrator accounts on elevation' is disabled as required by CIS benchmark 18.9.15.2.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_69\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI -> EnumerateAdministrators -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine Schema Installation\nDESCRIPTION: Command to verify the engine-schema tool installation by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_schema/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nengine-schema --version\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.7 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring the Auth daemon during installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_12\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.7\nrunauthd=\"Do you want to run the Auth daemon?\"\nnorunauthd=\"Not running Auth daemon\"\nyesrunauthd=\"Running Auth daemon\"\n```\n\n----------------------------------------\n\nTITLE: Checking EventLog Setup Maximum Size Configuration\nDESCRIPTION: Registry check to verify Setup EventLog maximum size is set to 32,768 KB or greater. Ensures proper event logging capacity for system setup events.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_75\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Subtraction of Two Integers using int_calculate in Wazuh\nDESCRIPTION: Shows how to use int_calculate to subtract one integer from another. The operation is performed successfully and the result is stored in the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_53\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: int_calculate('sub', -1, -1)\n```\n\nLANGUAGE: json\nCODE:\n```\n{}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": 0\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Parsec Test Suite\nDESCRIPTION: Sets up the test configuration for Parsec when ENGINE_BUILD_TEST is enabled. Creates test executable, links it with GTest and Parsec library, and configures test discovery.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/parsec/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\n\nadd_executable(parsec_test\n    ${TEST_SRC_DIR}/parsec_test.cpp\n)\ntarget_link_libraries(parsec_test parsec GTest::gtest_main)\ngtest_discover_tests(parsec_test)\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Engine Test Add Command Usage\nDESCRIPTION: Command options for adding new integrations with support for different formats and configurations.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nusage: engine-test add [-h] [-i INTEGRATION_NAME | --from-file FROM_FILE]\n                       [-f {audit,command,eventchannel,full-command,json,macos,multi-line,syslog,remote-syslog}] [-o ORIGIN] [-l LINES]\n\noptions:\n  -h, --help            show this help message and exit\n  -i INTEGRATION_NAME, --integration-name INTEGRATION_NAME\n                        Integration to test name\n  --from-file FROM_FILE\n                        Add all integrations from the file to current configuration\n  -f {audit,command,eventchannel,full-command,json,macos,multi-line,syslog,remote-syslog}, --format {audit,command,eventchannel,full-command,json,macos,multi-line,syslog,remote-syslog}\n                        Format of integration.\n  -o ORIGIN, --origin ORIGIN\n                        Origin of integration.\n  -l LINES, --lines LINES\n                        Number of lines. Only for multi-line format.\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off Internet download for Web publishing wizards\nDESCRIPTION: Validates registry settings to ensure 'Turn off Internet download for Web publishing and online ordering wizards' is set to 'Enabled' by checking the NoWebServices value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_320\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Single Session Registry Settings\nDESCRIPTION: Verifies that Remote Desktop Services users are restricted to a single session by checking specific registry values under Terminal Services.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_22\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fSingleSessionPerUser -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fSingleSessionPerUser;\n```\n\n----------------------------------------\n\nTITLE: Verifying Internet Connection Wizard Configuration in Registry\nDESCRIPTION: This snippet checks if the Internet Connection Wizard is disabled for Microsoft.com URLs in the registry as recommended by CIS benchmark 18.8.20.1.5. It verifies if the 'ExitOnMSICW' key is set to 1 under the Internet Connection Wizard registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_93\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Order Prints Task Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure the \"Order Prints\" picture task is disabled according to CIS benchmark 18.8.20.1.10. The rules verify if the NoOnlinePrintsWizard registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_268\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Configuring KVDB Interface Library in CMake\nDESCRIPTION: Creates an interface library for KVDB, setting up include directories and linking with the base library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/kvdb/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(kvdb_ikvdb INTERFACE)\ntarget_include_directories(kvdb_ikvdb INTERFACE ${IFACE_DIR})\ntarget_link_libraries(kvdb_ikvdb INTERFACE base)\nadd_library(kvdb::ikvdb ALIAS kvdb_ikvdb)\n```\n\n----------------------------------------\n\nTITLE: Running Wazuh Benchmark Tool in Go\nDESCRIPTION: Command to display help information for the Go-based benchmark tool used to send events during testing\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/acceptance_test/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ngo run utils/benchmark_tool.go -h\n```\n\n----------------------------------------\n\nTITLE: Verifying System EventLog Maximum Size Settings\nDESCRIPTION: Registry check to confirm System EventLog maximum size is properly configured to 32,768 KB or greater. Validates event log retention settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_76\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Microsoft Account Blocking Check\nDESCRIPTION: Verifies that Microsoft accounts are blocked from being added or used for login. Checks NoConnectedUser registry value under Windows Policies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> [0-1]\n```\n\n----------------------------------------\n\nTITLE: Installing CMake 3.30\nDESCRIPTION: Commands to download and install CMake 3.30, which is required for building the Wazuh engine. The script downloads the installer, sets execution permissions, creates installation directory, and sets up symbolic links.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/build-sources.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nsudo su\n# Install CMake 3.30\ncd $HOME\nwget https://github.com/Kitware/CMake/releases/download/v3.30.4/cmake-3.30.4-linux-x86_64.sh\nchmod +x cmake-3.30.4-linux-x86_64.sh\nmkdir -p /opt/cmake\n/tmp/cmake-3.30.4-linux-x86_64.sh --prefix=/opt/cmake --skip-license\nln -s /opt/cmake/bin/cmake /usr/local/bin/cmake\nln -s /opt/cmake/bin/ctest /usr/local/bin/ctest\n```\n\n----------------------------------------\n\nTITLE: Checking Registration Wizard Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that Registration Wizard is turned off when URL connection refers to Microsoft.com by ensuring the NoRegistration value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_105\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Windows CEIP Setting\nDESCRIPTION: Verifies that 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled' by checking if the CEIPEnable registry value is set to 0 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_274\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Configuring Router Unit Tests\nDESCRIPTION: Sets up unit test executable with test files and required dependencies.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/router/CMakeLists.txt#2025-04-17_snippet_6\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(router_utest\n    ${UNIT_SRC_DIR}/entryConverter_test.cpp\n    ${UNIT_SRC_DIR}/environment_test.cpp\n    ${UNIT_SRC_DIR}/environmentBuilder_test.cpp\n    ${UNIT_SRC_DIR}/router_test.cpp\n    ${UNIT_SRC_DIR}/tester_test.cpp\n    ${UNIT_SRC_DIR}/table_test.cpp\n    ${UNIT_SRC_DIR}/orchestrator_test.cpp\n    ${UNIT_SRC_DIR}/epsCounter_test.cpp\n)\ntarget_include_directories(router_utest PRIVATE ${SRC_DIR})\ntarget_link_libraries(router_utest\n    GTest::gtest_main\n    base\n    router::router\n    builder::mocks\n    store::mocks\n    bk::mocks\n    bk::rx\n    queue::mocks\n)\ngtest_discover_tests(router_utest router_ctest)\n```\n\n----------------------------------------\n\nTITLE: Creating Module Archive\nDESCRIPTION: Creates a compressed tar.gz archive of the wazuh module directory\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\n# tar -czvf wazuh-filebeat-0.4.tar.gz wazuh\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile State Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Firewall state' is set to 'On' by checking registry keys. This check ensures the Windows Firewall is enabled for the private profile, providing network protection.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_46\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Array Elements with array_not_contains in YAML\nDESCRIPTION: Determines if one or more elements are absent from a given array. Supports multiple data types and accepts multiple search arguments. The check passes if none of the provided elements exist in the target array.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: array_not_contains('dracut', 'vz-start', 'thin-provisioning-tools')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": [\n    \"mkinitramfs\",\n    \"cryptroot\",\n    \"framebuffer\",\n    \"dracut\",\n    \"thin-provisioning-tools\",\n    \"lvm2\",\n    \"vz-start\"\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Validating Windows Error Reporting Registry Settings\nDESCRIPTION: Registry checks to ensure Windows Error Reporting is disabled per CIS benchmark 18.8.20.1.14. Validates that the Disabled key is set to 1 or exists in the Windows Error Reporting policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_150\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Windows Error Reporting\nDESCRIPTION: Verifies that 'Turn off Windows Error Reporting' is set to 'Enabled' by checking if the Disabled registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_275\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Configuring Test Environment for Metrics in CMake\nDESCRIPTION: Sets up test directories and creates a mock library for metrics testing when ENGINE_BUILD_TEST is enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/metrics/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\nif(ENGINE_BUILD_TEST)\n\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\nset(UNIT_SRC_DIR ${TEST_SRC_DIR}/unit)\nset(COMPONENT_SRC_DIR ${TEST_SRC_DIR}/component)\n\nadd_library(metrics_mocks INTERFACE)\ntarget_include_directories(metrics_mocks INTERFACE ${TEST_MOCK_DIR})\ntarget_link_libraries(metrics_mocks INTERFACE metrics::imetrics)\nadd_library(metrics::mocks ALIAS metrics_mocks)\n```\n\n----------------------------------------\n\nTITLE: Changing to Base Directory\nDESCRIPTION: Changes current directory to Wazuh base directory\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\ncd wazuh-3.0\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Outbound Connections Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Outbound connections' is set to 'Allow' by checking registry keys. This check ensures the Windows Firewall allows outbound connections by default in the private profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_48\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Removing Custom Fields with erase_custom_fields() in Wazuh\nDESCRIPTION: Demonstrates using erase_custom_fields() to remove fields that don't belong to the schema, in this case a string field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_81\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: erase_custom_fields()\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"-- Hi wazuh! --\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"target_field\": \"\"\n}\n```\n\n----------------------------------------\n\nTITLE: Validating Handwriting Data Sharing Registry Settings\nDESCRIPTION: Registry checks to ensure handwriting personalization data sharing is disabled per CIS benchmark 18.8.20.1.3. Validates that the PreventHandwritingDataSharing key is set to 1 or exists in the Windows TabletPC policy path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_153\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Internet Connection Wizard\nDESCRIPTION: Verifies that 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled' by checking if the ExitOnMSICW registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_280\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Source File Grouping Configuration\nDESCRIPTION: Defines source file groups for different platforms (Windows, Linux, Common) using glob patterns to collect test implementation files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/utils/tests/CMakeLists.txt#2025-04-17_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nfile(GLOB UTIL_CXX_UNITTEST_WINDOWS_SRC\n    \"windowsHelper_test.cpp\"\n    \"registryHelper_test.cpp\"\n    \"encodingWindows_test.cpp\"\n)\n\nfile(GLOB UTIL_CXX_UNITTEST_COMMON_SRC\n    \"archiveHelper_test.cpp\"\n    \"cmdHelper_test.cpp\"\n    \"filesystemHelper_test.cpp\"\n    \"byteArrayHelper_test.cpp\"\n    \"cmdHelper_test.cpp\"\n    \"cacheLRU_test.cpp\"\n    \"hashHelper_test.cpp\"\n    \"mapWrapperSafe_test.cpp\"\n    \"msgDispatcher_test.cpp\"\n    \"pipelineNodes_test.cpp\"\n    \"stringHelper_test.cpp\"\n    \"numericHelper_test.cpp\"\n    \"threadDispatcher_test.cpp\"\n    \"threadSafeQueue_test.cpp\"\n    \"threadSafeMultiQueue_test.cpp\"\n    \"timeHelper_test.cpp\"\n    \"filterMsgDispatcher_test.cpp\"\n    \"loggerHelper_test.cpp\"\n    \"globHelper_test.cpp\"\n    \"socketDBWrapper_test.cpp\"\n    \"wazuhDBQueryBuilder_test.cpp\"\n    \"main.cpp\"\n)\n\nfile(GLOB UTIL_CXX_UNITTEST_LINUX_SRC\n    \"linuxInfoHelper_test.cpp\"\n    \"socketWrapper_test.cpp\"\n    \"socket_test.cpp\"\n    \"rocksDBSafeQueue_test.cpp\"\n    \"rocksDBSafeQueuePrefix_test.cpp\"\n    \"rocksDBWrapper_test.cpp\"\n    \"threadEventDispatcher_test.cpp\"\n    \"xzHelper_test.cpp\"\n    \"jsonArrayParser_test.cpp\"\n    \"zlibHelper_test.cpp\"\n    \"rsaHelper_test.cpp\"\n    \"evpHelper_test.cpp\"\n)\n```\n\n----------------------------------------\n\nTITLE: Downloading Wazuh Source Code\nDESCRIPTION: Downloads and extracts Wazuh 3.0 source code from GitHub\nSOURCE: https://github.com/wazuh/wazuh/blob/main/tools/agent-upgrade/README.md#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\ncurl -Lo wazuh-3.0.zip https://github.com/wazuh/wazuh/archive/3.0.zip\nunzip wazuh-3.0.zip\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Path Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' by checking registry keys. This ensures firewall logs are stored in the specified standard location for the private profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_52\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Verifying File Structure\nDESCRIPTION: Displays the complete file structure with permissions, user, and group information\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\n# tree -pug wazuh\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet download for Web publishing and online ordering wizards' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Internet download for Web publishing and online ordering wizards' setting is enabled in the Windows registry. It verifies the NoWebServices value is set to 1 in the specified registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_195\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Specifying pytest Dependency for Wazuh Project\nDESCRIPTION: This line defines the specific version of pytest required for the Wazuh project. It ensures that version 7.2.2 of pytest is used, which is important for maintaining consistent test results across different environments.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/elasticsearch/7.x/qa/requirements.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\npytest==7.2.2\n```\n\n----------------------------------------\n\nTITLE: Displaying Wazuh Services Status in Plaintext\nDESCRIPTION: This output shows the running status of various Wazuh daemon services. Several core services like clusterd, modulesd, monitord, and analysisd are running, while some optional services like maild, agentlessd, integratord, dbd, and csyslogd are not running.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/apis/server_management/test/integration/env/configurations/base/manager/healthcheck/daemons_check.txt#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nwazuh-clusterd is running...\nwazuh-modulesd is running...\nwazuh-monitord is running...\nwazuh-logcollector is running...\nwazuh-remoted is running...\nwazuh-syscheckd is running...\nwazuh-analysisd is running...\nwazuh-maild not running...\nwazuh-execd is running...\nwazuh-db is running...\nwazuh-authd is running...\nwazuh-agentlessd not running...\nwazuh-integratord not running...\nwazuh-dbd not running...\nwazuh-csyslogd not running...\nwazuh-apid is running...\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Log Size Setting\nDESCRIPTION: Ensures that Windows Firewall Public Profile log size is set to at least 16384 KB according to CIS benchmark 9.3.8. Checks both policy and system registry paths for various value formats.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_63\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Engine KVDB CLI Usage Help\nDESCRIPTION: Complete command-line interface help output showing all available commands and options for the engine-kvdb tool\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_kvdb/README.md#2025-04-17_snippet_3\n\nLANGUAGE: console\nCODE:\n```\nusage: engine-kvdb [-h] [--version] [--api-socket API_SOCKET] {list,create,delete,dump,get,search,remove,upsert} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --version             show program's version number and exit\n  --api-socket API_SOCKET\n                        Path to the Wazuh API socket\n\nsubcommands:\n  {list,create,delete,dump,get,search,remove,upsert}\n    list                List all key-value databases\n    create              Create a new key-value database\n    delete              Remove a key-value database\n    dump                Dump all key-value databases\n    get                 Get a key-value pair from the database\n    search              Get filtered key-value pairs from the database\n    remove              Remove a pair key-value in the database\n    upsert              Insert or update a key-value in the database\n```\n\n----------------------------------------\n\nTITLE: Adding Subdirectories in CMake for Wazuh Project\nDESCRIPTION: These CMake commands add the 'scanner' and 'rocksdb' subdirectories to the build process. This ensures that the build system includes and compiles the contents of these directories as part of the Wazuh project.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/vdscanner/tools/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nadd_subdirectory(scanner)\nadd_subdirectory(rocksdb)\n```\n\n----------------------------------------\n\nTITLE: Updating agent to report macOS 14 name\nDESCRIPTION: The agent was updated to report the name of macOS 14 (Sonoma).\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_2\n\nLANGUAGE: C\nCODE:\n```\n// Update to report macOS 14 (Sonoma) name\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off downloading of print drivers over HTTP'\nDESCRIPTION: Registry check rule that verifies if 'Turn off downloading of print drivers over HTTP' is properly configured by ensuring DisableWebPnPDownload registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_252\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Defining Global Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines global message strings used in the installation script, including startup messages, system information, and initialization notifications.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_1\n\nLANGUAGE: Bash\nCODE:\n```\n# Global\nmoreinfo=\"More information at: \"\nstarting=\"Starting Wazuh\"\nsystemis=\"System is\"\nmodifiedinit=\"Init script modified to start Wazuh during boot.\"\nnoboot=\"Unknown system. No init script added.\"\n```\n\n----------------------------------------\n\nTITLE: Defining Portuguese Language Strings for Wazuh Installation Script\nDESCRIPTION: Collection of Portuguese language strings for the Wazuh installation script. The file contains various translation strings organized by installation phases, including configuration options, user prompts, and system messages.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/br/messages.txt#2025-04-17_snippet_0\n\nLANGUAGE: Bash/Shell\nCODE:\n```\n# Configuração\nyes=\"s\"\nno=\"n\"\nyesmatch=\"s\"\nnomatch=\"n\"\nserver=\"servidor\"\nagent=\"cliente\"\nlocal=\"local\"\nhelp=\"ajuda\"\n\n\n# Global\nmoreinfo=\"Maiores informações em: \"\nstarting=\"Iniciando Wazuh\"\nsystemis=\"O Sistema é\"\nmodifiedinit=\"O script de inicialização foi modificado para executar Wazuh durante o boot.\"\nnoboot=\"Sistema desconhecido. Nenhum script de incialização foi adicionado.\"\n\n# Parte 1\ninstallscript=\"Script de instalação\"\nsystem=\"Sistema\"\nuser=\"Usuário\"\nhost=\"Host\"\nhitanyorabort=\"Aperte ENTER para continuar ou Ctrl+C para abortar.\"\nwhattoinstall=\"Que tipo de instalação você deseja (manager, cliente, local ou ajuda)?\"\nserverchose=\"Escolhida instalação manager\"\nclientchose=\"Escolhida instalação cliente\"\nlocalchose=\"Escolhida instalação local\"\n\n# Parte 2\nsettingupenv=\"Configurando o ambiente de instalação\"\nwheretoinstall=\"Escolha onde instalar Wazuh\"\ninstallat=\"A instalação será feita no diretório\"\ndeletedir=\"O diretório de instalação já existe. Deseja removê-lo?\"\n\n# Parte 3\nconfiguring=\"Configurando o\"\nmailnotify=\"Deseja receber notificações por e-mail?\"\nnomail=\"Notificação por e-mail desabilitada\"\nwhatsemail=\"Qual é o seu endereço de e-mail?\"\nyoursmtp=\"Seu servidor SMTP foi encontrado como\"\nusesmtp=\"Deseja usá-lo?\"\nusingsmtp=\"Usando servidor SMTP: \"\nwhatsmtp=\"Qual é o ip/host de seu servidor SMTP?\"\n\n# Parte 3.1/agente\nserverip=\"Qual é o endereço de IP do servidor Wazuh?\"\nserveraddr=\"Qual é o endereço de IP/hostname do servidor Wazuh?\"\naddingip=\"Adicionando IP do servidor\"\naddingname=\"Adicionando hostname do servidor\"\n\n\n# Parte 3.2\nrunsyscheck=\"Deseja habilitar o sistema de verificação de integridade?\"\nnosyscheck=\"Syscheck (Sistema de verificação de integridade) desabilitado\"\nyessyscheck=\"Syscheck (Sistema de verificação de integridade) habilitado\"\n\n# Parte 3.3\nrunrootcheck=\"Deseja habilitar o sistema de detecção de rootkis?\"\nnorootcheck=\"Rootcheck (Sistema de detecção de rootkits) desabilitado\"\nyesrootcheck=\"Rootcheck (Sistema de detecção de rootkits) habilitado\"\n\n# Part 3.4\nrunopenscap=\"Deseja habilitar OpenSCAP?\"\nnorunopenscap=\"OpenSCAP desabilitado\"\nyesrunopenscap=\"OpenSCAP desabilitado\"\n\n# Parte 3.5/servidor/local\nenable_ar=\"Deseja habilitar o sistema de respostas automáticas?\"\nnoactive=\"Sistema de respostas automáticas desabilitado\"\nnohosts=\"host-deny desabilitado\"\nyeshosts=\"host-deny habilitado (local) para niveis >= 6\"\nfirewallar=\"Deseja habilitar o firewall-drop?\"\nnofirewall=\"firewall-drop desabilitado.\"\nyesfirewall=\"firewall-drop habilitado (local) para níveis >= 6\"\ndefaultwhitelist=\"Lista de endereços que não serão bloqueados pela resposta automática:\"\naddwhite=\"Deseja adicionar mais algum endereço a essa lista?\"\nipswhite=\"Endereços de IP (separados por espaço): \"\n\n\n# Parte 3.5/servidor/local\nsyslog=\"Deseja habilitar o syslog remoto (514 udp)?\"\nnosyslog=\"Syslog desabilitado\"\nyessyslog=\"Syslog habilitado\"\n\n# Parte 3.4/3.5\nreadlogs=\"Ajustando a configuração para analisar os seguintes logs:\"\n\n# Part 3.7\nrunauthd=\"Deseja habilitar Authd?\"\nnorunauthd=\"Auth desabilitado\"\nyesrunauthd=\"Auth habilitado\"\n\n# Parte 4\ninstalling=\"Instalando o sistema\"\nstartwazuh=\"Deseja iniciar o Wazuh após a instalação?\"\nnowazuhstart=\"Wazuh não iniciará no final da instalação.\"\nyeswazuhstart=\"Wazuh começará no final da instalação.\"\nrunningmake=\"Executando o Makefile\"\n\n# Final\nconfigurationdone=\"Configuração finalizada corretamente\"\ntostart=\"Para iniciar Wazuh\"\ntostop=\"Para parar Wazuh\"\nconfigat=\"A configuração pode ser vista ou modificada em\"\naddserveragent=\"Você precisa adicionar cada um dos clientes antes que estejam autorizados a acessar o servidor.\"\npresskey=\"Pressione ENTER para continuar.\"\n\n# Update\nwanttoupdate=\"Wazuh ja esta instalado. Deseja atualiza-lo?\"\nmustuninstall=\"A instalação não pode prosseguir sem desinstalar as versões antigas. Saindo.\"\nunabletoupdate=\"Error na atualizacao. Sera necessario reinstala-lo.\"\nupdatecompleted=\"Atualizacao completada.\"\nupdatefailed=\"Erro na atualizacao.\"\nupdaterules=\"Voce deseja atualizar as regras?\"\nupdatingrules=\"Atualizando as regras.\"\nnotupdatingrules=\"Nao atualizando as regras.\"\nupdate_rev_newconf1=\"O backup do seu ossec.conf foi criado no $INSTALLDIR/etc/ossec.conf.orig.\"\nupdate_rev_newconf2=\"Verifique a configuração ossec.conf em $INSTALLDIR/etc/ossec.conf.\"\n\n# Pf support\npfenable=\"Deseja utilizar o firewall PF nas respostas automaticas?\"\nnopf=\"Respostas automaticas com o PF desabilitadas.\"\npftablename=\"Qual o nome da tabela no PF que deseja utilizar?\"\npfmessage=\"Adicione as seguintes linhas na configuracao do seu firewall\"\n\n# CA store\naddcastore=\"Deseja adicionar mais certificados?\"\ncastore=\"Digite o caminho para um certificado X509 ou uma pasta de certificado: \"\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Age Settings\nDESCRIPTION: Registry check to verify that 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer' per CIS benchmark 18.2.6. The check confirms that PasswordAgeDays is set to a value of 30 or less.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_73\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> 1F;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 1 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for the initial part of the installation script, including installation type selection and basic user prompts.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_2\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 1\ninstallscript=\"Installation Script\"\nsystem=\"System\"\nuser=\"User\"\nhost=\"Host\"\nhitanyorabort=\"Press ENTER to continue or Ctrl-C to abort.\"\nwhattoinstall=\"What kind of installation do you want (manager, agent, local, hybrid or help)?\"\nserverchose=\"Manager (server) installation chosen\"\nclientchose=\"Agent (client) installation chosen\"\nlocalchose=\"Local installation chosen\"\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Internet Connection Wizard is disabled when URL connection refers to Microsoft.com according to CIS benchmark 18.8.20.1.5. The rules verify if the ExitOnMSICW registry key is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_263\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Failed Text Extraction with parse_between Function\nDESCRIPTION: Shows a case where parse_between fails because the input string doesn't properly end with the specified end delimiter, resulting in no change to the target field.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_99\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: parse_between($input_field, '(', ')')\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"(Start) Middle End\",\n  \"target_field\": \"any_value\"\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"input_field\": \"(Start) Middle End\",\n  \"target_field\": \"any_value\"\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Event Log Warning Threshold in Windows Registry\nDESCRIPTION: Checks if the 'WarningLevel' registry key for the security event log is set to 90% or less. This ensures the system generates a warning when the security event log approaches capacity.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_81\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP Registry Settings for CIS Compliance\nDESCRIPTION: Registry checks to ensure Windows Customer Experience Improvement Program is disabled according to CIS benchmark 18.8.20.1.13. The rules verify if the CEIPEnable registry key is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_271\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Bridge Configuration in Windows Registry\nDESCRIPTION: Verifies that installation and configuration of Network Bridge on DNS domain network is prohibited by checking if 'NC_AllowNetBridge_NLA' is set to 1 or missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_82\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the \"Publish to Web\" task for files and folders' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off the \"Publish to Web\" task for files and folders' setting is enabled in the Windows registry. It verifies the NoPublishingWizard value in the Explorer policy key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_302\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Registration Wizard Control\nDESCRIPTION: Checks if 'Turn off Registration if URL connection is referring to Microsoft.com' is properly enabled by verifying the NoRegistration registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_36\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Customer Experience Improvement Program' Registry Setting\nDESCRIPTION: Ensures 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled' by checking the CEIPEnable value in the SQMClient\\Windows registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Publish to Web Feature\nDESCRIPTION: Checks if 'Turn off the \"Publish to Web\" task for files and folders' is properly enabled by verifying the NoPublishingWizard registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_39\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Engine Test Directory Structure\nDESCRIPTION: Shows the folder and file organization of the engine-test tool, including command modules, format handlers, and core functionality files.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_test/README.md#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n├── engine-suite/\n│   └── cmd/\n│   └── formats/\n│   └── __init__.py\n│   └── __main__.py\n│   └── api_connector.py\n│   └── command.py\n│   └── config.py\n│   └── crud_integration.py\n│   └── event_format.py\n│   └── events_collector.py\n│   └── integration.py\n│   └── parse.py\n```\n\n----------------------------------------\n\nTITLE: Setting Up File Driver Unit Tests for Wazuh Store in CMake\nDESCRIPTION: Configures the executable for file driver unit tests, linking with Google Test and the file driver library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/store/CMakeLists.txt#2025-04-17_snippet_6\n\nLANGUAGE: CMake\nCODE:\n```\n## File driver tests\nadd_executable(store_fileDriver_unit_test\n    ${UNIT_SRC_DIR}/fileDriver_test.cpp\n)\ntarget_link_libraries(store_fileDriver_unit_test GTest::gtest_main store::fileDriver)\ngtest_discover_tests(store_fileDriver_unit_test)\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Windows Error Reporting' Registry Setting\nDESCRIPTION: Verifies that 'Turn off Windows Error Reporting' is set to 'Enabled' by checking the Disabled value in the Windows Error Reporting registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_13\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Access Registry Settings\nDESCRIPTION: Registry checks to verify that access to the Windows Store is disabled per CIS benchmark 18.8.20.1.1. The check ensures NoUseStoreOpenWith is set to 1 in the Explorer policy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_51\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off printing over HTTP' Setting\nDESCRIPTION: Registry checks to verify if the 'DisableHTTPPrinting' key is set to 1, which disables printing over HTTP. Performs checks for both incorrect value and missing key in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_65\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off the \"Publish to Web\" task' Setting\nDESCRIPTION: Registry checks to verify if the 'NoPublishingWizard' key is set to 1, which disables the 'Publish to Web' task for files and folders. Checks for both incorrect value and missing key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_69\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Error Reporting' Setting\nDESCRIPTION: Registry checks to verify if the 'Disabled' key is set to 1, which turns off Windows Error Reporting. Performs checks for both incorrect value and missing key in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_72\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Keys for Internet Download Settings in Windows Server 2012\nDESCRIPTION: A collection of registry checks to verify security-related settings for Internet downloads and wizards in Windows Server 2012 R2 according to CIS benchmark section 18.8.20.1. Each check verifies if a registry key exists and is properly set to the required value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_94\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Settings\nDESCRIPTION: Registry check to verify that 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled' per CIS benchmark 18.3.4. The check confirms that EnableICMPRedirect is not set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_77\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> EnableICMPRedirect -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !EnableICMPRedirect;\n```\n\n----------------------------------------\n\nTITLE: Integrate Command Help\nDESCRIPTION: Displays help information for the integrate subcommand, showing configuration options and paths.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_schema/README.md#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\n$ engine-schema integrate --help\nusage: engine-schema integrate [-h] [--ecs-version ECS_VERSION] [--api-sock API_SOCK]\n                               [--indexer-dir INDEXER_DIR] [--schema-dir SCHEMA_DIR]\n                               {integration} ...\n\noptions:\n  -h, --help            show this help message and exit\n  --ecs-version ECS_VERSION\n                        [default=\"v8.8.0\"] ECS version to use for the schema generation\n  --api-sock API_SOCK   [default=\"/run/wazuh-server/engine-api.socket\"] Engine instance API socket path\n  --indexer-dir INDEXER_DIR\n                        [default=\"/etc/filebeat/\"] Path to directory where the wazuh-template.json indexer\n                        file is located\n  --schema-dir SCHEMA_DIR\n                        [default=\"/home/vagrant/engine/wazuh/src/engine/ruleset/schemas/\"] Path to the\n                        director where the fields.json schema file is located\n\nsubcommands:\n  {integration}\n    integration         Add schema integration fields\n```\n\n----------------------------------------\n\nTITLE: Displaying Directory Structure for Engine Router Tool\nDESCRIPTION: Shows the directory structure of the engine-router tool within the engine-suite package. It includes the main script, README, and command modules.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_router/README.md#2025-04-17_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nengine_router/\n├── README.md\n├── cmds # Command modules\n│   ├── __init__.py\n│   ├── ...\n|   └── ...\n├── __main__.py # Main script\n```\n\n----------------------------------------\n\nTITLE: Building Conf Static Library with CMake\nDESCRIPTION: Configures the conf static library build with source files and dependencies. Sets up include directories and links required libraries including base and urlrequest.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/conf/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(conf STATIC\n    src/conf.cpp\n    src/apiLoader.cpp\n)\ntarget_include_directories(conf\n    PUBLIC\n    ${CMAKE_CURRENT_LIST_DIR}/include\n)\ntarget_link_libraries(conf\n    PUBLIC\n    base\n    PRIVATE\n    urlrequest\n)\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that downloading of print drivers over HTTP is turned off by ensuring the DisableWebPnPDownload value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_99\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Defining Part 3.3 Messages for Wazuh Installation Script in Bash\nDESCRIPTION: Defines strings for configuring the rootkit detection engine (rootcheck) during installation.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/etc/templates/en/messages.txt#2025-04-17_snippet_7\n\nLANGUAGE: Bash\nCODE:\n```\n# Part 3.3\nrunrootcheck=\"Do you want to run the rootkit detection engine?\"\nnorootcheck=\"Not running rootcheck (rootkit detection)\"\nyesrootcheck=\"Running rootcheck (rootkit detection)\"\n```\n\n----------------------------------------\n\nTITLE: Installing VCPKG\nDESCRIPTION: Commands to clone, install, and configure VCPKG, a C++ package manager required for managing dependencies of the Wazuh engine. The setup includes adding VCPKG to the PATH environment variable.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/dev/build-sources.md#2025-04-17_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n# Install VCPKG\ngit clone https://github.com/microsoft/vcpkg.git\ncd vcpkg\n./bootstrap-vcpkg.sh\nexport VCPKG_ROOT=$(pwd)\nexport PATH=$VCPKG_ROOT:$PATH\necho \"export VCPKG_ROOT=$(pwd)\" >> ~/.bashrc\necho \"export PATH=$VCPKG_ROOT:$PATH\" >> ~/.bashrc\n```\n\n----------------------------------------\n\nTITLE: Creating and Configuring Logpar Library Target in CMake\nDESCRIPTION: Defines the Logpar library as a static library, sets its include directories, and specifies its link dependencies. This configuration ensures that the library is properly built with all necessary headers and linked libraries.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/logpar/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(logpar STATIC src/logpar.cpp)\ntarget_include_directories(logpar\nPUBLIC\n  include\nPRIVATE\n  include/logpar\n)\ntarget_link_libraries(logpar PUBLIC hlp base schemf::ischema parsec)\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Build for Wazuh Keystore Tool\nDESCRIPTION: Sets up CMake project configuration for building the wazuh-keystore_tool executable. Links against keystore, OpenSSL (SSL and Crypto components), and base libraries. Requires CMake version 3.12.4 or higher.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/keystore/tools/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.12.4)\n\nproject(wazuh-keystore_tool)\n\nadd_executable(${PROJECT_NAME} main.cpp)\ntarget_link_libraries(${PROJECT_NAME} PRIVATE keystore OpenSSL::SSL OpenSSL::Crypto base)\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com'\nDESCRIPTION: Registry check rule that verifies if 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is properly configured by ensuring ExitOnMSICW registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_255\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Drive Redirection Prevention\nDESCRIPTION: Verifies that drive redirection in Terminal Services is not allowed as required by CIS benchmark 18.9.52.3.3.2. Checks that the fDisableCdm registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_113\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCdm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCdm;\n```\n\n----------------------------------------\n\nTITLE: Checking OneDrive File Storage Usage Prevention on Windows 8.1\nDESCRIPTION: Verifies that OneDrive usage for file storage on Windows 8.1 is prevented as required by CIS benchmark 18.9.47.2. Checks that the DisableFileSync registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_111\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Skydrive -> DisableFileSync -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Skydrive -> !DisableFileSync;\n```\n\n----------------------------------------\n\nTITLE: Setting timeout on cluster component requests\nDESCRIPTION: A timeout was set on requests between components through the cluster to prevent hanging connections.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_0\n\nLANGUAGE: Python\nCODE:\n```\n# Timeout added to cluster component requests\n```\n\n----------------------------------------\n\nTITLE: Defining Source Directories in CMake\nDESCRIPTION: Sets up variables for various source directories used in the project, including source, include, interface, and test directories.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/queue/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\n# Defs\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\nset(IFACE_DIR ${CMAKE_CURRENT_LIST_DIR}/interface)\nset(TEST_DIR ${CMAKE_CURRENT_LIST_DIR}/test)\n```\n\n----------------------------------------\n\nTITLE: PHP Security Configuration Checks\nDESCRIPTION: Rules to detect potentially dangerous PHP configurations including register_globals, expose_php, allow_url_fopen, and display_errors being enabled.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_rcl.txt#2025-04-17_snippet_1\n\nLANGUAGE: ini\nCODE:\n```\n[PHP - Register globals are enabled] [any] []\nf:$php.ini -> r:^register_globals = On;\n\n[PHP - Expose PHP is enabled] [any] []\nf:$php.ini -> r:^expose_php = On;\n\n[PHP - Allow URL fopen is enabled] [any] []\nf:$php.ini -> r:^allow_url_fopen = On;\n\n[PHP - Displaying of errors is enabled] [any] []\nf:$php.ini -> r:^display_errors = On;\n```\n\n----------------------------------------\n\nTITLE: Registry Check: Turn off printing over HTTP\nDESCRIPTION: Validates registry settings to ensure 'Turn off printing over HTTP' is set to 'Enabled' by checking the DisableHTTPPrinting value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_321\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Enable/Disable PerfTrack' Registry Setting\nDESCRIPTION: Ensures 'Enable/Disable PerfTrack' is set to 'Disabled' by checking the ScenarioExecutionEnabled value in the WDI registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_18\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> !ScenarioExecutionEnabled;\n```\n\n----------------------------------------\n\nTITLE: Negative string_less_or_equal Example with Reference in Wazuh\nDESCRIPTION: Shows a case where string_less_or_equal returns false because the target field is lexicographically greater than the referenced value. This demonstrates lexicographical comparison with equality.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_40\n\nLANGUAGE: yaml\nCODE:\n```\ncheck:\n  - target_field: string_less_or_equal($any_string)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_string\": \"hello world!\",\n  \"target_field\": \"wazuh\"\n}\n```\n\n----------------------------------------\n\nTITLE: Helper Function Usage in YAML Conditions\nDESCRIPTION: Demonstrates syntax for using helper functions in condition checks and mapping operations. Shows how to format arguments including quoted strings, references, and JSON values.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/README.md#2025-04-17_snippet_17\n\nLANGUAGE: yaml\nCODE:\n```\ntarget.field: helper_name('string', $reference, 123, {\"key\": \"value\"})\n```\n\n----------------------------------------\n\nTITLE: Configuring KVDB Benchmark Build in CMake\nDESCRIPTION: Creates an executable named kvdb_bench from kvdb_bench.cpp source file and links it with required libraries including engine_bench_main and kvdb::ikvdb.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/benchmark/kvdb/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\nadd_executable(kvdb_bench kvdb_bench.cpp)\n\ntarget_link_libraries(kvdb_bench\n    engine_bench_main\n    kvdb::ikvdb\n    )\n```\n\n----------------------------------------\n\nTITLE: Handling Duplicates with array_append_unique_any in Wazuh\nDESCRIPTION: Shows how array_append_unique_any handles variable references when they contain values that already exist in the array, resulting in an error.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/docs/ref/modules/engine/ref-helper-functions.md#2025-04-17_snippet_76\n\nLANGUAGE: yaml\nCODE:\n```\nnormalize:\n  - map:\n      - target_field: array_append_unique_any($any_object, $any_object_2)\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": null,\n  \"any_object_2\": 6,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    6\n  ]\n}\n```\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"any_object\": null,\n  \"any_object_2\": 6,\n  \"target_field\": [\n    1,\n    2,\n    3,\n    4,\n    6\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Using Bash Explicitly for Pagerduty Integration Script\nDESCRIPTION: This change explicitly specifies Bash as the interpreter for the Pagerduty integration script, improving compatibility across different systems.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/CHANGELOG.md#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\n#!/bin/bash\n# Pagerduty integration script\n```\n\n----------------------------------------\n\nTITLE: Configuring API KVDB Library in CMake\nDESCRIPTION: Sets up the API KVDB library as a static library, defines its source files, include directories, and links necessary dependencies. It also creates an alias target for the library.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/api/kvdb/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nset(SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/src)\nset(INC_DIR ${CMAKE_CURRENT_LIST_DIR}/include)\n\nadd_library(api_kvdb STATIC\n  ${SRC_DIR}/handlers.cpp\n)\ntarget_include_directories(api_kvdb\n  PUBLIC\n  ${INC_DIR}\n  PRIVATE\n  ${SRC_DIR}\n)\ntarget_link_libraries(api_kvdb\n    PUBLIC\n    base\n    api::adapter\n    kvdb::ikvdb\n)\nadd_library(api::kvdb ALIAS api_kvdb)\n```\n\n----------------------------------------\n\nTITLE: Output Paths Configuration in JSON\nDESCRIPTION: Example of file paths after XZ decompression stage execution, showing the decompressed files in the contents directory with their original extensions.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/XZ_DECOMPRESSOR.md#2025-04-17_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n\"paths\": [\n    \"/tmp/outputFolder/contents/file1.json\",\n    \"/tmp/outputFolder/contents/file2.xml\"\n]\n```\n\n----------------------------------------\n\nTITLE: Paths Before Decompression - JSON Structure\nDESCRIPTION: Example of file paths structure before the gzip decompression stage executes. Shows compressed files with .gz extensions in the downloads directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/GZIP_DECOMPRESSOR.md#2025-04-17_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n\"paths\": [\n    \"/tmp/outputFolder/downloads/file1.json.gz\",\n    \"/tmp/outputFolder/downloads/file2.xml.gz\"\n]\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Turn on PowerShell Transcription' Registry Setting\nDESCRIPTION: Checks if 'EnableTranscripting' is set to 0 (Disabled) to disable PowerShell transcription functionality.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_129\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription -> EnableTranscripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Input Paths Configuration in JSON\nDESCRIPTION: Example of file paths before XZ decompression stage execution, showing the source .xz files in the downloads directory.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/content_manager/doc/components/XZ_DECOMPRESSOR.md#2025-04-17_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n\"paths\": [\n    \"/tmp/outputFolder/downloads/file1.json.xz\",\n    \"/tmp/outputFolder/downloads/file2.xml.xz\"\n]\n```\n\n----------------------------------------\n\nTITLE: Copyright Notice and License Declaration\nDESCRIPTION: Copyright notice and license information for Wazuh software, indicating GPLv2 licensing terms.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/architecture/centralized_configuration/Readme.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n<!---\nCopyright (C) 2015, Wazuh Inc.\nCreated by Wazuh, Inc. <info@wazuh.com>.\nThis program is free software; you can redistribute it and/or modify it under the terms of GPLv2\n-->\n```\n\n----------------------------------------\n\nTITLE: Windows Error Reporting Registry Check\nDESCRIPTION: Registry check to ensure Windows Error Reporting is disabled per CIS benchmark 18.8.20.1.14\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_322\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: RC Scripts Directory Definition\nDESCRIPTION: Defines the location of runlevel RC script directories for system services.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel5_linux_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: conf\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Directory Structure of Engine KVDB\nDESCRIPTION: Shows the file and directory organization of the engine-kvdb tool within the engine-suite package\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_kvdb/README.md#2025-04-17_snippet_0\n\nLANGUAGE: text\nCODE:\n```\nengine_kvdb/\n├── README.md\n├── cmds # Command modules\n│   ├── __init__.py\n│   ├── ...\n|   └── ...\n├── __main__.py # Main script\n```\n\n----------------------------------------\n\nTITLE: Displaying Command Line Help\nDESCRIPTION: Shows available command-line options and usage information for the engine-it command.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/test/integration_tests/README.md#2025-04-17_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nengine-it run -h\n```\n\n----------------------------------------\n\nTITLE: Running Docker Container for Version Validation\nDESCRIPTION: Docker command to run the version validation container with mounted Reports folder. The command mounts the local Reports folder to the container and executes the validation process automatically.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/wazuh_modules/vulnerability_scanner/testtool/versionMatcher/README.md#2025-04-17_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndocker run --rm -v PATH/TO/REPORT/FOLDER:/usr/local/bin/version_verifier/Reports version_verifier_xxx\n```\n\n----------------------------------------\n\nTITLE: Checking Password Authentication Settings in SSH\nDESCRIPTION: Verifies that password authentication is disabled in favor of public key authentication.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/system_audit_ssh.txt#2025-04-17_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\n[SSH Hardening - 5: Password Authentication {PCI_DSS: 2.2.4}] [any] [5]\nf:$sshd_file -> !r:^\\s*PasswordAuthentication\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Configuring Logic Expression Test Suite in CMake\nDESCRIPTION: Sets up the test suite for the logicexpr library when ENGINE_BUILD_TEST is enabled. It defines test source and mock directories, creates a test executable, links necessary libraries, and discovers tests using GTest.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/logicexpr/CMakeLists.txt#2025-04-17_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\n# Tests\nif(ENGINE_BUILD_TEST)\nset(TEST_SRC_DIR ${CMAKE_CURRENT_LIST_DIR}/test/src)\nset(TEST_MOCK_DIR ${CMAKE_CURRENT_LIST_DIR}/test/mocks)\n\nadd_executable(logicexpr_test\n    ${TEST_SRC_DIR}/tokenizer_test.cpp\n    ${TEST_SRC_DIR}/token_test.cpp\n    ${TEST_SRC_DIR}/parser_test.cpp\n    ${TEST_SRC_DIR}/evaluator_test.cpp\n    ${TEST_SRC_DIR}/logicexpr_test.cpp\n)\ntarget_link_libraries(logicexpr_test logicexpr GTest::gtest_main)\ngtest_discover_tests(logicexpr_test)\n\n\n\nendif(ENGINE_BUILD_TEST)\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine Clear Tool Installation in Bash\nDESCRIPTION: Shows how to verify the successful installation of the Engine Clear Tool by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_clear/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-clear --version\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake Project for Indexer Connector Tests\nDESCRIPTION: This CMake snippet sets up the project for indexer connector tests. It defines the project name, gathers source files, creates an executable, links required libraries, and configures test discovery using Google Test.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/source/indexerconnector/test/component/CMakeLists.txt#2025-04-17_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\nproject(indexerconnector_ctest)\n\nfile(GLOB SOURCES\n        *.cpp\n)\n\nadd_executable(${PROJECT_NAME} ${SOURCES})\n\ntarget_link_libraries(${PROJECT_NAME}\n        urlrequest\n        GTest::gtest_main\n        indexerconnector\n        pthread\n        base\n)\n\ntarget_link_options(${PROJECT_NAME} PRIVATE -Wl,--wrap=getpwnam,--wrap=getgrnam,--wrap=chown)\n\ngtest_discover_tests(${PROJECT_NAME})\n```\n\n----------------------------------------\n\nTITLE: Verifying Engine Catalog Installation\nDESCRIPTION: Command to verify the successful installation of engine-catalog by checking its version.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/engine/tools/engine-suite/src/engine_catalog/README.md#2025-04-17_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nengine-catalog --version\n```\n\n----------------------------------------\n\nTITLE: Creating Wazuh Directory\nDESCRIPTION: Creates a new directory named 'wazuh' for organizing module files\nSOURCE: https://github.com/wazuh/wazuh/blob/main/extensions/filebeat/7.x/wazuh-module/README.md#2025-04-17_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n# mkdir wazuh\n```\n\n----------------------------------------\n\nTITLE: Configuring Source and Module Paths\nDESCRIPTION: Sets up source folder and shared modules paths with fallback absolute path resolution.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/src/shared_modules/keystore/CMakeLists.txt#2025-04-17_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nif (NOT SRC_FOLDER)\n    get_filename_component(SRC_FOLDER     ${CMAKE_SOURCE_DIR}/../../ ABSOLUTE)\nendif()\n\nif (NOT SHARED_MODULES)\n    get_filename_component(SHARED_MODULES ${CMAKE_SOURCE_DIR}/../ ABSOLUTE)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Wazuh Azure Module Copyright Header\nDESCRIPTION: License and copyright header for the Wazuh Azure module documentation, indicating GPLv2 licensing and Wazuh Inc. ownership.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/architecture/wm_azure/Readme.md#2025-04-17_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n<!---\nCopyright (C) 2015, Wazuh Inc.\nCreated by Wazuh, Inc. <info@wazuh.com>.\nThis program is free software; you can redistribute it and/or modify it under the terms of GPLv2\n-->\n```\n\n----------------------------------------\n\nTITLE: Validating Web Services Registry Settings\nDESCRIPTION: Registry checks to ensure web services and internet downloads are disabled via NoWebServices key\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_144\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Registry Check - Microsoft Network Server Digital Signing\nDESCRIPTION: Verifies that Microsoft network server digital signing is enabled when clients agree. Checks EnableSecuritySignature registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !EnableSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Notification Setting in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Private: Settings: Display a notification' is set to 'No' by checking registry keys. This check ensures Windows Firewall doesn't display notifications when blocking applications in the private profile.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_49\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Registry for Windows CEIP Settings\nDESCRIPTION: Registry check to verify that 'Turn off Windows Customer Experience Improvement Program' is enabled. Checks if the CEIPEnable key exists and is set to 0.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_118\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Settings in Windows Registry\nDESCRIPTION: This snippet checks if Windows Error Reporting is disabled by verifying the 'Disabled' key in the Windows Error Reporting registry path. It ensures the value is set to 1 or the key doesn't exist.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_189\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off handwriting personalization data sharing Registry Settings\nDESCRIPTION: Checks if 'Turn off handwriting personalization data sharing' is enabled by verifying that PreventHandwritingDataSharing is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_300\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Print Driver Download Configuration in Registry\nDESCRIPTION: This snippet checks if downloading of print drivers over HTTP is disabled in the registry as recommended by CIS benchmark 18.8.20.1.2. It verifies if the 'DisableWebPnPDownload' key is set to 1 under the Windows NT Printers registry path.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_90\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off access to the Store' registry setting\nDESCRIPTION: Verifies that the NoUseStoreOpenWith registry value is set to 1 to disable access to the Store as recommended by CIS benchmark 18.8.20.1.1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_137\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Registry Settings in Windows Server 2012 R2\nDESCRIPTION: Registry check to verify that Search Companion content file updates are turned off by ensuring the DisableContentFileUpdates value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_106\n\nLANGUAGE: wazuh\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Parameters - Martians Logging\nDESCRIPTION: Checks if logging of martian packets is disabled in IPv4 network configuration. Part of CIS benchmark 4.2.4 for RHEL6.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel6_linux_rcl.txt#2025-04-17_snippet_9\n\nLANGUAGE: sysconfig\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/log_martians -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Registration if URL connection is referring to Microsoft.com' Registry Setting\nDESCRIPTION: This snippet checks if the 'Turn off Registration if URL connection is referring to Microsoft.com' setting is enabled in the Windows registry. It verifies the NoRegistration value is set to 1 in the specified registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_197\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off downloading of print drivers over HTTP' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off downloading of print drivers over HTTP' is properly enabled in Windows Server 2012 R2. The check validates that DisableWebPnPDownload registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_222\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off handwriting recognition error reporting' Registry Setting\nDESCRIPTION: Verifies if the 'Turn off handwriting recognition error reporting' setting is enabled in the Windows registry. This check ensures that handwriting recognition error reporting is disabled for enhanced privacy.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_207\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Internet Connection Wizard Registry Settings\nDESCRIPTION: Checks if 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is enabled by verifying that ExitOnMSICW is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_288\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Internet Connection Wizard' Registry Setting\nDESCRIPTION: Ensures 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled' by checking the ExitOnMSICW value in the Internet Connection Wizard registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL2_rcl.txt#2025-04-17_snippet_4\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Password Age Policy Registry Check\nDESCRIPTION: Checks the Maximum Password Age setting in Windows Registry to ensure it's set to 60 or fewer days but not 0. Verifies the MaximumPasswordAge parameter in Netlogon service settings.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_0\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:[0-9A-F]\\w\n```\n\n----------------------------------------\n\nTITLE: Checking Bootloader Password Configuration\nDESCRIPTION: Rules to verify password protection is enabled for LILO and GRUB bootloaders according to CIS Debian Linux benchmark 8.8.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_debian_linux_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/lilo.conf -> !r:^# && !r:restricted;\nf:/etc/lilo.conf -> !r:^# && !r:password=;\nf:/boot/grub/menu.lst -> !r:^# && !r:password;\n```\n\n----------------------------------------\n\nTITLE: Verifying VMware ESX Security Settings\nDESCRIPTION: Checks various security settings specific to VMware ESX environments, including VM isolation, logging, and disk persistence.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_12\n\nLANGUAGE: text\nCODE:\n```\nf:/etc/vmware-release -> r:^VMware ESX;\nd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.copy.disable;\nd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.copy.disable && r:false;\nd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.paste.disable;\nd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.paste.disable && r:false;\nd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.setGUIOptions.enable && r:true;\nd:/vmfs/volumes -> .vmx$ -> !r:^log.rotateSize;\nd:/vmfs/volumes -> .vmx$ -> r:^log.rotateSize && !r:\"100000\";\nd:/vmfs/volumes -> .vmx$ -> !r:^log.keepOld;\nd:/vmfs/volumes -> .vmx$ -> r:^log.keepOld && r:\"10\";\nd:/vmfs/volumes -> .vmx$ -> !r:^isolation.tools.setinfo.disable;\nd:/vmfs/volumes -> .vmx$ -> r:^isolation.tools.setinfo.disable && r:false;\nd:/vmfs/volumes -> .vmx$ -> r:^scsi\\d:\\d.mode && r:!independent-nonpersistent;\n```\n\n----------------------------------------\n\nTITLE: Checking Solicited Remote Assistance Configuration\nDESCRIPTION: Verifies that Solicited Remote Assistance is disabled by checking if 'fAllowToGetHelp' is not set to 0 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_98\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Selection UI Display Settings\nDESCRIPTION: Verifies that network selection UI is not displayed by checking if 'DontDisplayNetworkSelectionUI' is not set to 1 or is missing.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_92\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Personalization Data Sharing Registry Setting\nDESCRIPTION: Verifies if 'Turn off handwriting personalization data sharing' is set to 'Enabled' by checking the PreventHandwritingDataSharing registry value.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_206\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Search Companion content file updates Registry Settings\nDESCRIPTION: Checks if 'Turn off Search Companion content file updates' is enabled by verifying that DisableContentFileUpdates is set to 1 in the registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_292\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Verifying LAPS AdmPwd GPO Extension Installation\nDESCRIPTION: Registry check to verify that the Local Administrator Password Solution (LAPS) AdmPwd GPO Extension/CSE is installed per CIS benchmark 18.2.1. The check confirms the existence of the DllName value in the appropriate GPExtensions registry key.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL1_rcl.txt#2025-04-17_snippet_68\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions\\{D76B9641-3288-4f75-942D-087DE603E3EA} -> !DllName;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Keys for Windows Error Reporting\nDESCRIPTION: Checks if 'Turn off Windows Error Reporting' is properly enabled by verifying the Disabled registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_42\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Detecting GUI Login Enabled in Red Hat Linux\nDESCRIPTION: Checks if the GUI login is enabled by looking for 'id:5' in the /etc/inittab file.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_rhel_linux_rcl.txt#2025-04-17_snippet_6\n\nLANGUAGE: text\nCODE:\n```\nf:/etc/inittab -> !r:^# && r:id:5;\n```\n\n----------------------------------------\n\nTITLE: Registry Check for Registration Wizard\nDESCRIPTION: Verifies that 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled' by checking if the NoRegistration registry value is set to 1 or exists.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_283\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for 'Turn off Windows Error Reporting' setting\nDESCRIPTION: Registry checks to verify if the 'Turn off Windows Error Reporting' is properly enabled in Windows Server 2012 R2. The check validates that Disabled registry value is set to 1.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_memberL2_rcl.txt#2025-04-17_snippet_220\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying Security Event Log Warning Threshold in Windows Registry\nDESCRIPTION: Checks if the warning threshold for the security event log is set to 90% or less in the Windows registry.\nSOURCE: https://github.com/wazuh/wazuh/blob/main/ruleset/rootcheck/db/cis_win2012r2_domainL1_rcl.txt#2025-04-17_snippet_47\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```"
  }
]