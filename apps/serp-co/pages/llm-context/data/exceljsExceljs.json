[
  {
    "owner": "exceljs",
    "repo": "exceljs",
    "content": "TITLE: Managing Rows in ExcelJS\nDESCRIPTION: Detailed example of row operations including accessing rows, setting properties, manipulating cell values, and row iteration.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_15\n\nLANGUAGE: javascript\nCODE:\n```\nconst row = worksheet.getRow(5);\nconst rows = worksheet.getRows(5, 2);\nconst row = worksheet.lastRow;\n\nrow.height = 42.5;\nrow.hidden = true;\n\nworksheet.getRow(4).outlineLevel = 0;\nworksheet.getRow(5).outlineLevel = 1;\n\nexpect(worksheet.getRow(4).collapsed).to.equal(false);\nexpect(worksheet.getRow(5).collapsed).to.equal(true);\n\nrow.getCell(1).value = 5;\nrow.getCell('name').value = 'Zeb';\nrow.getCell('C').value = new Date();\n\nrow = worksheet.getRow(4).values;\nexpect(row[5]).toEqual('Kyle');\n\nrow.values = [1,2,3];\nexpect(row.getCell(1).value).toEqual(1);\nexpect(row.getCell(2).value).toEqual(2);\nexpect(row.getCell(3).value).toEqual(3);\n\nconst values = []\nvalues[5] = 7;\nvalues[10] = 'Hello, World!';\nrow.values = values;\nexpect(row.getCell(1).value).toBeNull();\nexpect(row.getCell(5).value).toEqual(7);\nexpect(row.getCell(10).value).toEqual('Hello, World!');\n\nrow.values = {\n  id: 13,\n  name: 'Thing 1',\n  dob: new Date()\n};\n\nrow.addPageBreak();\n\nworksheet.eachRow(function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\nworksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\nrow.eachCell(function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\nrow.eachCell({ includeEmpty: true }, function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\nrow.commit();\n\nconst rowSize = row.cellCount;\nconst numValues = row.actualCellCount;\n```\n\n----------------------------------------\n\nTITLE: Handling Individual Cells in ExcelJS\nDESCRIPTION: Shows how to access, modify, and query individual cells in an ExcelJS worksheet. Demonstrates getting cell values, changing cell content, and accessing different cell property formats.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_17\n\nLANGUAGE: javascript\nCODE:\n```\nconst cell = worksheet.getCell('C3');\n\n// Modify/Add individual cell\ncell.value = new Date(1968, 5, 1);\n\n// query a cell's type\nexpect(cell.type).toEqual(Excel.ValueType.Date);\n\n// use string value of cell\nmyInput.value = cell.text;\n\n// use html-safe string for rendering...\nconst html = '<div>' + cell.html + '</div>';\n```\n\n----------------------------------------\n\nTITLE: Reading XLSX Files with ExcelJS in JavaScript\nDESCRIPTION: Demonstrates different ways to read XLSX files using ExcelJS: from a file, from a stream, from a buffer, or with additional options like ignoring specific nodes for performance optimization.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_56\n\nLANGUAGE: javascript\nCODE:\n```\n// read from a file\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.readFile(filename);\n// ... use workbook\n\n\n// read from a stream\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.read(stream);\n// ... use workbook\n\n\n// load from buffer\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.load(data);\n// ... use workbook\n\n\n// using additional options\nconst workbook = new Excel.Workbook();\nawait workbook.xlsx.load(data, {\n  ignoreNodes: [\n    'dataValidations' // ignores the workbook's Data Validations\n  ],\n});\n// ... use workbook\n```\n\n----------------------------------------\n\nTITLE: Reading Excel Files with Streaming Interface in ExcelJS\nDESCRIPTION: Example of using ExcelJS streaming interface to read Excel files. This demonstrates how to create a workbook reader with options and handle various events like worksheet, row, shared-strings, hyperlinks, end, and error events.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_62\n\nLANGUAGE: javascript\nCODE:\n```\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nworkbookReader.read();\n\nworkbookReader.on('worksheet', worksheet => {\n  worksheet.on('row', row => {\n  });\n});\n\nworkbookReader.on('shared-strings', sharedString => {\n  // ...\n});\n\nworkbookReader.on('hyperlinks', hyperlinksReader => {\n  // ...\n});\n\nworkbookReader.on('end', () => {\n  // ...\n});\nworkbookReader.on('error', (err) => {\n  // ...\n});\n```\n\n----------------------------------------\n\nTITLE: Streaming XLSX Reader with ExcelJS in JavaScript\nDESCRIPTION: Demonstrates how to use the streaming XLSX workbook reader to efficiently read large Excel files. It includes examples of iterating over worksheets and rows.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_61\n\nLANGUAGE: javascript\nCODE:\n```\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx');\nfor await (const worksheetReader of workbookReader) {\n  for await (const row of worksheetReader) {\n    // ...\n  }\n}\n\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nfor await (const {eventType, value} of workbook.parse()) {\n  switch (eventType) {\n    case 'shared-strings':\n      // value is the shared string\n    case 'worksheet':\n      // value is the worksheetReader\n    case 'hyperlinks':\n      // value is the hyperlinksReader\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Working with Rows in ExcelJS\nDESCRIPTION: Examples of row manipulation in ExcelJS including getting rows, setting properties, assigning values, and iterating through rows. Shows how to work with row height, visibility, outline levels, and how to access cells within a row.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_5\n\nLANGUAGE: javascript\nCODE:\n```\n// 获取一个行对象。如果尚不存在，则将返回一个新的空对象\nconst row = worksheet.getRow(5);\n\n// Get multiple row objects. If it doesn't already exist, new empty ones will be returned\nconst rows = worksheet.getRows(5, 2); // start, length (>0, else undefined is returned)\n\n// 获取工作表中的最后一个可编辑行（如果没有，则为 `undefined`）\nconst row = worksheet.lastRow;\n\n// 设置特定的行高\nrow.height = 42.5;\n\n// 隐藏行\nrow.hidden = true;\n\n// 为行设置大纲级别\nworksheet.getRow(4).outlineLevel = 0;\nworksheet.getRow(5).outlineLevel = 1;\n\n// 行支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态\nexpect(worksheet.getRow(4).collapsed).to.equal(false);\nexpect(worksheet.getRow(5).collapsed).to.equal(true);\n\n\nrow.getCell(1).value = 5; // A5 的值设置为5\nrow.getCell('name').value = 'Zeb'; // B5 的值设置为 \"Zeb\" - 假设第2列仍按名称键入\nrow.getCell('C').value = new Date(); // C5 的值设置为当前时间\n\n// 获取行并作为稀疏数组返回\n// 注意：接口更改：worksheet.getRow(4) ==> worksheet.getRow(4).values\nrow = worksheet.getRow(4).values;\nexpect(row[5]).toEqual('Kyle');\n\n// 通过连续数组分配行值（其中数组元素 0 具有值）\nrow.values = [1,2,3];\nexpect(row.getCell(1).value).toEqual(1);\nexpect(row.getCell(2).value).toEqual(2);\nexpect(row.getCell(3).value).toEqual(3);\n\n// 通过稀疏数组分配行值（其中数组元素 0 为 `undefined`）\nconst values = []\nvalues[5] = 7;\nvalues[10] = 'Hello, World!';\nrow.values = values;\nexpect(row.getCell(1).value).toBeNull();\nexpect(row.getCell(5).value).toEqual(7);\nexpect(row.getCell(10).value).toEqual('Hello, World!');\n\n// 使用列键按对象分配行值\nrow.values = {\n  id: 13,\n  name: 'Thing 1',\n  dob: new Date()\n};\n\n// 在该行下方插入一个分页符\nrow.addPageBreak();\n\n// 遍历工作表中具有值的所有行\nworksheet.eachRow(function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\n// 遍历工作表中的所有行（包括空行）\nworksheet.eachRow({ includeEmpty: true }, function(row, rowNumber) {\n  console.log('Row ' + rowNumber + ' = ' + JSON.stringify(row.values));\n});\n\n// 连续遍历所有非空单元格\nrow.eachCell(function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\n// 遍历一行中的所有单元格（包括空单元格）\nrow.eachCell({ includeEmpty: true }, function(cell, colNumber) {\n  console.log('Cell ' + colNumber + ' = ' + cell.value);\n});\n\n// 提交给流一个完成的行\nrow.commit();\n\n// 行尺寸\nconst rowSize = row.cellCount;\nconst numValues = row.actualCellCount;\n```\n\n----------------------------------------\n\nTITLE: Managing Columns in ExcelJS\nDESCRIPTION: Comprehensive example of column operations including defining headers, accessing columns, setting properties, and manipulating column data.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_14\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n\nconst idCol = worksheet.getColumn('id');\nconst nameCol = worksheet.getColumn('B');\nconst dobCol = worksheet.getColumn(3);\n\ndobCol.header = 'Date of Birth';\ndobCol.header = ['Date of Birth', 'A.K.A. D.O.B.'];\ndobCol.key = 'dob';\ndobCol.width = 15;\ndobCol.hidden = true;\n\nworksheet.getColumn(4).outlineLevel = 0;\nworksheet.getColumn(5).outlineLevel = 1;\n\nexpect(worksheet.getColumn(4).collapsed).to.equal(false);\nexpect(worksheet.getColumn(5).collapsed).to.equal(true);\n\ndobCol.eachCell(function(cell, rowNumber) {\n});\n\ndobCol.eachCell({ includeEmpty: true }, function(cell, rowNumber) {\n});\n\nworksheet.getColumn(6).values = [1,2,3,4,5];\nworksheet.getColumn(7).values = [,,2,3,,5,,7,,,,11];\n\nworksheet.spliceColumns(3,2);\n\nconst newCol3Values = [1,2,3,4,5];\nconst newCol4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceColumns(3, 1, newCol3Values, newCol4Values);\n```\n\n----------------------------------------\n\nTITLE: Applying Conditional Formatting in ExcelJS\nDESCRIPTION: Demonstrates how to add conditional formatting to a worksheet with custom rules. Shows an example of expression-based conditional formatting that applies a checkerboard pattern based on cell position using MOD function with row and column.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_42\n\nLANGUAGE: javascript\nCODE:\n```\n// add a checkerboard pattern to A1:E7 based on row + col being even or odd\nworksheet.addConditionalFormatting({\n  ref: 'A1:E7',\n  rules: [\n    {\n      type: 'expression',\n      formulae: ['MOD(ROW()+COLUMN(),2)=0'],\n      style: {fill: {type: 'pattern', pattern: 'solid', bgColor: {argb: 'FF00FF00'}}},\n    }\n  ]\n})\n```\n\n----------------------------------------\n\nTITLE: Applying Styles to Cells, Columns, and Rows in ExcelJS\nDESCRIPTION: Shows how to apply various styles, including number formats, fonts, and alignments to cells, columns, and rows in ExcelJS. Demonstrates the use of style objects and inheritance.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_34\n\nLANGUAGE: javascript\nCODE:\n```\n// assign a style to a cell\nws.getCell('A1').numFmt = '0.00%';\n\n// Apply styles to worksheet columns\nws.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32, style: { font: { name: 'Arial Black' } } },\n  { header: 'D.O.B.', key: 'DOB', width: 10, style: { numFmt: 'dd/mm/yyyy' } }\n];\n\n// Set Column 3 to Currency Format\nws.getColumn(3).numFmt = '\"£\"#,##0.00;[Red]\\-\"£\"#,##0.00';\n\n// Set Row 2 to Comic Sans.\nws.getRow(2).font = { name: 'Comic Sans MS', family: 4, size: 16, underline: 'double', bold: true };\n```\n\n----------------------------------------\n\nTITLE: Adding Rows to Worksheets in ExcelJS\nDESCRIPTION: Demonstrates different ways to add rows to an ExcelJS worksheet, including adding by key-value pairs, arrays, and with inherited styles. The method accepts values and an optional style parameter.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_16\n\nLANGUAGE: javascript\nCODE:\n```\n// Add a couple of Rows by key-value, after the last current row, using the column keys\nworksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Add a row by contiguous Array (assign to columns A, B & C)\nworksheet.addRow([3, 'Sam', new Date()]);\n\n// Add a row by sparse Array (assign to columns A, E & I)\nconst rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\nworksheet.addRow(rowValues);\n\n// Add a row with inherited style\n// This new row will have same style as last row\n// And return as row object\nconst newRow = worksheet.addRow(rowValues, 'i');\n\n// Add an array of rows\nconst rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// add new rows and return them as array of row objects\nconst newRows = worksheet.addRows(rows);\n\n// Add an array of rows with inherited style\n// These new rows will have same styles as last row\n// and return them as array of row objects\nconst newRowsStyled = worksheet.addRows(rows, 'i');\n```\n\n----------------------------------------\n\nTITLE: Implementing Various Data Validation Types in ExcelJS\nDESCRIPTION: Examples of how to implement different types of data validations in ExcelJS, including list validations, whole number validations, decimal validations, text length validations, and date validations with various validation operators.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_23\n\nLANGUAGE: javascript\nCODE:\n```\n// Specify list of valid values (One, Two, Three, Four).\n// Excel will provide a dropdown with these values.\nworksheet.getCell('A1').dataValidation = {\n  type: 'list',\n  allowBlank: true,\n  formulae: ['\"One,Two,Three,Four\"']\n};\n\n// Specify list of valid values from a range.\n// Excel will provide a dropdown with these values.\nworksheet.getCell('A1').dataValidation = {\n  type: 'list',\n  allowBlank: true,\n  formulae: ['$D$5:$F$5']\n};\n\n// Specify Cell must be a whole number that is not 5.\n// Show the user an appropriate error message if they get it wrong\nworksheet.getCell('A1').dataValidation = {\n  type: 'whole',\n  operator: 'notEqual',\n  showErrorMessage: true,\n  formulae: [5],\n  errorStyle: 'error',\n  errorTitle: 'Five',\n  error: 'The value must not be Five'\n};\n\n// Specify Cell must be a decimal number between 1.5 and 7.\n// Add 'tooltip' to help guid the user\nworksheet.getCell('A1').dataValidation = {\n  type: 'decimal',\n  operator: 'between',\n  allowBlank: true,\n  showInputMessage: true,\n  formulae: [1.5, 7],\n  promptTitle: 'Decimal',\n  prompt: 'The value must between 1.5 and 7'\n};\n\n// Specify Cell must be have a text length less than 15\nworksheet.getCell('A1').dataValidation = {\n  type: 'textLength',\n  operator: 'lessThan',\n  showErrorMessage: true,\n  allowBlank: true,\n  formulae: [15]\n};\n\n// Specify Cell must be have be a date before 1st Jan 2016\nworksheet.getCell('A1').dataValidation = {\n  type: 'date',\n  operator: 'lessThan',\n  showErrorMessage: true,\n  allowBlank: true,\n  formulae: [new Date(2016,0,1)]\n};\n```\n\n----------------------------------------\n\nTITLE: Creating Tables in ExcelJS Worksheets\nDESCRIPTION: Demonstrates how to add a table to a worksheet in ExcelJS, including defining table name, reference, headers, totals row, styling options, columns with functions, and data rows. Tables facilitate in-sheet manipulation of tabular data.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_28\n\nLANGUAGE: javascript\nCODE:\n```\n// add a table to a sheet\nws.addTable({\n  name: 'MyTable',\n  ref: 'A1',\n  headerRow: true,\n  totalsRow: true,\n  style: {\n    theme: 'TableStyleDark3',\n    showRowStripes: true,\n  },\n  columns: [\n    {name: 'Date', totalsRowLabel: 'Totals:', filterButton: true},\n    {name: 'Amount', totalsRowFunction: 'sum', filterButton: false},\n  ],\n  rows: [\n    [new Date('2019-07-20'), 70.10],\n    [new Date('2019-07-21'), 70.60],\n    [new Date('2019-07-22'), 70.10],\n  ],\n});\n```\n\n----------------------------------------\n\nTITLE: Writing XLSX Files with ExcelJS in JavaScript\nDESCRIPTION: Shows different methods for writing Excel workbooks to XLSX format: writing to a file, writing to a stream, or creating a new buffer containing the workbook data.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_57\n\nLANGUAGE: javascript\nCODE:\n```\n// write to a file\nconst workbook = createAndFillWorkbook();\nawait workbook.xlsx.writeFile(filename);\n\n// write to a stream\nawait workbook.xlsx.write(stream);\n\n// write to a new buffer\nconst buffer = await workbook.xlsx.writeBuffer();\n```\n\n----------------------------------------\n\nTITLE: Using fillFormula Method in ExcelJS\nDESCRIPTION: Examples of using the fillFormula method to fill a range of cells with a formula in ExcelJS, providing both static values and a callback function for results.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_73\n\nLANGUAGE: javascript\nCODE:\n```\n// set A1 to starting number\nworksheet.getCell('A1').value = 1;\n\n// fill A2 to A10 with ascending count starting from A1\nworksheet.fillFormula('A2:A10', 'A1+1', [2,3,4,5,6,7,8,9,10]);\n```\n\n----------------------------------------\n\nTITLE: Adding Rows in ExcelJS\nDESCRIPTION: Demonstrates various methods of adding rows to a worksheet in ExcelJS. Examples include adding rows with key-value pairs, contiguous arrays, sparse arrays, and with inherited styles.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_6\n\nLANGUAGE: javascript\nCODE:\n```\n// Add a couple of Rows by key-value, after the last current row, using the column keys\nworksheet.addRow({id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.addRow({id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Add a row by contiguous Array (assign to columns A, B & C)\nworksheet.addRow([3, 'Sam', new Date()]);\n\n// Add a row by sparse Array (assign to columns A, E & I)\nconst rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\nworksheet.addRow(rowValues);\n\n// Add a row with inherited style\n// This new row will have same style as last row\n// And return as row object\nconst newRow = worksheet.addRow(rowValues, 'i');\n\n// Add an array of rows\nconst rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// add new rows and return them as array of row objects\nconst newRows = worksheet.addRows(rows);\n\n// Add an array of rows with inherited style\n// These new rows will have same styles as last row\n// and return them as array of row objects\nconst newRowsStyled = worksheet.addRows(rows, 'i');\n```\n\n----------------------------------------\n\nTITLE: Reading CSV Files with ExcelJS in JavaScript\nDESCRIPTION: Demonstrates various ways to read CSV files using ExcelJS, including from a file or stream, with custom date formats, and with custom value parsing. Uses the fast-csv module internally.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_58\n\nLANGUAGE: javascript\nCODE:\n```\n// read from a file\nconst workbook = new Excel.Workbook();\nconst worksheet = await workbook.csv.readFile(filename);\n// ... use workbook or worksheet\n\n\n// read from a stream\nconst workbook = new Excel.Workbook();\nconst worksheet = await workbook.csv.read(stream);\n// ... use workbook or worksheet\n\n\n// read from a file with European Dates\nconst workbook = new Excel.Workbook();\nconst options = {\n  dateFormats: ['DD/MM/YYYY']\n};\nconst worksheet = await workbook.csv.readFile(filename, options);\n// ... use workbook or worksheet\n\n\n// read from a file with custom value parsing\nconst workbook = new Excel.Workbook();\nconst options = {\n  map(value, index) {\n    switch(index) {\n      case 0:\n        // column 1 is string\n        return value;\n      case 1:\n        // column 2 is a date\n        return new Date(value);\n      case 2:\n        // column 3 is JSON of a formula value\n        return JSON.parse(value);\n      default:\n        // the rest are numbers\n        return parseFloat(value);\n    }\n  },\n  // https://c2fo.github.io/fast-csv/docs/parsing/options\n  parserOptions: {\n    delimiter: '\\t',\n    quote: false,\n  },\n};\nconst worksheet = await workbook.csv.readFile(filename, options);\n// ... use workbook or worksheet\n```\n\n----------------------------------------\n\nTITLE: Using Rich Text Formatting in ExcelJS\nDESCRIPTION: Shows how to create rich text in a cell with different font properties for different parts of the text. Demonstrates setting font properties such as size, color, italic, and bold for specific portions of text within a single cell.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_40\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('A1').value = {\n  'richText': [\n    {'font': {'size': 12,'color': {'theme': 0},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'This is '},\n    {'font': {'italic': true,'size': 12,'color': {'theme': 0},'name': 'Calibri','scheme': 'minor'},'text': 'a'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' '},\n    {'font': {'size': 12,'color': {'argb': 'FFFF6600'},'name': 'Calibri','scheme': 'minor'},'text': 'colorful'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' text '},\n    {'font': {'size': 12,'color': {'argb': 'FFCCFFCC'},'name': 'Calibri','scheme': 'minor'},'text': 'with'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' in-cell '},\n    {'font': {'bold': true,'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'format'}\n  ]\n};\n\nexpect(ws.getCell('A1').text).to.equal('This is a colorful text with in-cell format');\nexpect(ws.getCell('A1').type).to.equal(Excel.ValueType.RichText);\n```\n\n----------------------------------------\n\nTITLE: Working with Formula Values in ExcelJS\nDESCRIPTION: Examples of using formula values in ExcelJS, including simple arithmetic formulas and Excel functions. Demonstrates setting formulas with results and accessing formula and result via getters.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_68\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A3').value = { formula: 'A1+A2', result: 7 };\nworksheet.getCell('A3').value = { formula: 'SUM(A1,A2)', result: 7 };\n```\n\n----------------------------------------\n\nTITLE: Worksheet Management Operations\nDESCRIPTION: Examples of adding, accessing, and removing worksheets with various configuration options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_6\n\nLANGUAGE: javascript\nCODE:\n```\nconst sheet = workbook.addWorksheet('My Sheet');\n\nconst sheet1 = workbook.addWorksheet('My Sheet', {properties:{tabColor:{argb:'FFC0000'}}});\n\nconst sheet2 = workbook.addWorksheet('My Sheet', {views: [{showGridLines: false}]});\n\nconst sheet3 = workbook.addWorksheet('My Sheet', {views:[{state: 'frozen', xSplit: 1, ySplit:1}]});\n\nconst sheet4 = workbook.addWorksheet('My Sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n\nconst worksheet = workbook.addWorksheet('My Sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n```\n\nLANGUAGE: javascript\nCODE:\n```\nworkbook.eachSheet(function(worksheet, sheetId) {\n  // ...\n});\n\nconst worksheet1 = workbook.getWorksheet('My Sheet');\n\nconst worksheet2 = workbook.getWorksheet(1);\n\nworkbook.worksheets[0];\n```\n\n----------------------------------------\n\nTITLE: Configuring Page Setup for Printing in ExcelJS\nDESCRIPTION: Shows how to configure page setup properties for printing worksheets, including paper size, orientation, margins, and print areas. Examples demonstrate both setting during worksheet creation and adjusting afterwards.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_9\n\nLANGUAGE: javascript\nCODE:\n```\n// create new sheet with pageSetup settings for A4 - landscape\nconst worksheet =  workbook.addWorksheet('sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n\n// create a new sheet writer with pageSetup settings for fit-to-page\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  pageSetup:{fitToPage: true, fitToHeight: 5, fitToWidth: 7}\n});\n\n// adjust pageSetup settings afterwards\nworksheet.pageSetup.margins = {\n  left: 0.7, right: 0.7,\n  top: 0.75, bottom: 0.75,\n  header: 0.3, footer: 0.3\n};\n\n// Set Print Area for a sheet\nworksheet.pageSetup.printArea = 'A1:G20';\n\n// Set multiple Print Areas by separating print areas with '&&'\nworksheet.pageSetup.printArea = 'A1:G10&&A11:G20';\n\n// Repeat specific rows on every printed page\nworksheet.pageSetup.printTitlesRow = '1:3';\n\n// Repeat specific columns on every printed page\nworksheet.pageSetup.printTitlesColumn = 'A:C';\n```\n\n----------------------------------------\n\nTITLE: Adding and Removing Table Rows in ExcelJS\nDESCRIPTION: Demonstrates how to remove rows, insert new rows at a specific index, and append rows to a table in ExcelJS. Changes must be committed to take effect.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_31\n\nLANGUAGE: javascript\nCODE:\n```\nconst table = ws.getTable('MyTable');\n\n// remove first two rows\ntable.removeRows(0, 2);\n\n// insert new rows at index 5\ntable.addRow([new Date('2019-08-05'), 5, 'Mid'], 5);\n\n// append new row to bottom of table\ntable.addRow([new Date('2019-08-10'), 10, 'End']);\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n----------------------------------------\n\nTITLE: Workbook Creation and Properties\nDESCRIPTION: Creating a new workbook and setting its properties including dates and calculation options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_5\n\nLANGUAGE: javascript\nCODE:\n```\nconst workbook = new ExcelJS.Workbook();\n\nworkbook.creator = 'Me';\nworkbook.lastModifiedBy = 'Her';\nworkbook.created = new Date(1985, 8, 30);\nworkbook.modified = new Date();\nworkbook.lastPrinted = new Date(2016, 9, 27);\n```\n\nLANGUAGE: javascript\nCODE:\n```\nworkbook.properties.date1904 = true;\n```\n\nLANGUAGE: javascript\nCODE:\n```\nworkbook.calcProperties.fullCalcOnLoad = true;\n```\n\n----------------------------------------\n\nTITLE: Applying Font Styles to Cells in ExcelJS\nDESCRIPTION: Shows how to apply various font styles to cells in ExcelJS, including font name, size, color, and text effects. Also demonstrates the shared reference behavior of font objects.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_36\n\nLANGUAGE: javascript\nCODE:\n```\n// for the wannabe graphic designers out there\nws.getCell('A1').font = {\n  name: 'Comic Sans MS',\n  family: 4,\n  size: 16,\n  underline: true,\n  bold: true\n};\n\n// for the graduate graphic designers...\nws.getCell('A2').font = {\n  name: 'Arial Black',\n  color: { argb: 'FF00FF00' },\n  family: 2,\n  size: 14,\n  italic: true\n};\n\n// for the vertical align\nws.getCell('A3').font = {\n  vertAlign: 'superscript'\n};\n\n// note: the cell will store a reference to the font object assigned.\n// If the font object is changed afterwards, the cell font will change also...\nconst font = { name: 'Arial', size: 12 };\nws.getCell('A3').font = font;\nfont.size = 20; // Cell A3 now has font size 20!\n```\n\n----------------------------------------\n\nTITLE: Creating Cell Fills in ExcelJS\nDESCRIPTION: Demonstrates how to apply different fill types to cells including pattern fills and gradient fills. Shows examples of pattern fills with foreground/background colors, solid fills, and both angle and path gradient fills with multiple color stops.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_39\n\nLANGUAGE: javascript\nCODE:\n```\n// fill A1 with red darkVertical stripes\nws.getCell('A1').fill = {\n  type: 'pattern',\n  pattern:'darkVertical',\n  fgColor:{argb:'FFFF0000'}\n};\n\n// fill A2 with yellow dark trellis and blue behind\nws.getCell('A2').fill = {\n  type: 'pattern',\n  pattern:'darkTrellis',\n  fgColor:{argb:'FFFFFF00'},\n  bgColor:{argb:'FF0000FF'}\n};\n\n// fill A3 with solid coral\nws.getCell('A3').fill = {\n  type: 'pattern',\n  pattern:'solid',\n  fgColor:{argb:'F08080'},\n};\n\n// fill A4 with blue-white-blue gradient from left to right\nws.getCell('A4').fill = {\n  type: 'gradient',\n  gradient: 'angle',\n  degree: 0,\n  stops: [\n    {position:0, color:{argb:'FF0000FF'}},\n    {position:0.5, color:{argb:'FFFFFFFF'}},\n    {position:1, color:{argb:'FF0000FF'}}\n  ]\n};\n\n\n// fill A5 with red-green gradient from center\nws.getCell('A5').fill = {\n  type: 'gradient',\n  gradient: 'path',\n  center:{left:0.5,top:0.5},\n  stops: [\n    {position:0, color:{argb:'FFFF0000'}},\n    {position:1, color:{argb:'FF00FF00'}}\n  ]\n};\n```\n\n----------------------------------------\n\nTITLE: Configuring Worksheet Properties in ExcelJS\nDESCRIPTION: Demonstrates how to set worksheet properties during creation or adjust them afterwards. Properties include tab color, outline levels, and row/column dimensions. Note that worksheet-writer doesn't support property adjustment after creation.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_8\n\nLANGUAGE: javascript\nCODE:\n```\n// create new sheet with properties\nconst worksheet = workbook.addWorksheet('sheet', {properties:{tabColor:{argb:'FF00FF00'}}});\n\n// create a new sheet writer with properties\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {properties:{outlineLevelCol:1}});\n\n// adjust properties afterwards (not supported by worksheet-writer)\nworksheet.properties.outlineLevelCol = 2;\nworksheet.properties.defaultRowHeight = 15;\n```\n\n----------------------------------------\n\nTITLE: Adding Images to Excel Workbook Using Various Sources in JavaScript\nDESCRIPTION: Demonstrates how to add images to an Excel workbook from different sources: a file path, a buffer, or a base64 string. The function returns an imageId that can be used to place the image in worksheets.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_48\n\nLANGUAGE: javascript\nCODE:\n```\n// add image to workbook by filename\nconst imageId1 = workbook.addImage({\n  filename: 'path/to/image.jpg',\n  extension: 'jpeg',\n});\n\n// add image to workbook by buffer\nconst imageId2 = workbook.addImage({\n  buffer: fs.readFileSync('path/to.image.png'),\n  extension: 'png',\n});\n\n// add image to workbook by base64\nconst myBase64Image = \"data:image/png;base64,iVBORw0KG...\";\nconst imageId2 = workbook.addImage({\n  base64: myBase64Image,\n  extension: 'png',\n});\n```\n\n----------------------------------------\n\nTITLE: Applying Basic Styles in ExcelJS\nDESCRIPTION: This snippet demonstrates how to apply various styles to cells, columns, and rows including number formats, fonts, and styles. It shows how styles are applied and inherited in the worksheet.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_13\n\nLANGUAGE: javascript\nCODE:\n```\n// 为单元格分配样式\nws.getCell('A1').numFmt = '0.00%';\n\n// 将样式应用于工作表列\nws.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32, style: { font: { name: 'Arial Black' } } },\n  { header: 'D.O.B.', key: 'DOB', width: 10, style: { numFmt: 'dd/mm/yyyy' } }\n];\n\n// 将第3列设置为\"货币格式\"\nws.getColumn(3).numFmt = '\"£\"#,##0.00;[Red]\\-\"£\"#,##0.00';\n\n// 将第2行设置为 Comic Sans。\nws.getRow(2).font = { name: 'Comic Sans MS', family: 4, size: 16, underline: 'double', bold: true };\n```\n\n----------------------------------------\n\nTITLE: Managing Merged Cells in ExcelJS\nDESCRIPTION: Explains how to merge and unmerge cells in an ExcelJS worksheet. Shows how merged cells are linked, share styles, and can be manipulated using different methods for specifying cell ranges.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_18\n\nLANGUAGE: javascript\nCODE:\n```\n// merge a range of cells\nworksheet.mergeCells('A4:B5');\n\n// ... merged cells are linked\nworksheet.getCell('B5').value = 'Hello, World!';\nexpect(worksheet.getCell('B5').value).toBe(worksheet.getCell('A4').value);\nexpect(worksheet.getCell('B5').master).toBe(worksheet.getCell('A4'));\n\n// ... merged cells share the same style object\nexpect(worksheet.getCell('B5').style).toBe(worksheet.getCell('A4').style);\nworksheet.getCell('B5').style.font = myFonts.arial;\nexpect(worksheet.getCell('A4').style.font).toBe(myFonts.arial);\n\n// unmerging the cells breaks the style links\nworksheet.unMergeCells('A4');\nexpect(worksheet.getCell('B5').style).not.toBe(worksheet.getCell('A4').style);\nexpect(worksheet.getCell('B5').style.font).not.toBe(myFonts.arial);\n\n// merge by top-left, bottom-right\nworksheet.mergeCells('K10', 'M12');\n\n// merge by start row, start column, end row, end column (equivalent to K10:M12)\nworksheet.mergeCells(10,11,12,13);\n```\n\n----------------------------------------\n\nTITLE: Creating Hyperlinks in ExcelJS Cells\nDESCRIPTION: Examples of creating hyperlinks in ExcelJS cells, demonstrating both external web links and internal worksheet links with text and tooltip properties.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_67\n\nLANGUAGE: javascript\nCODE:\n```\n// link to web\nworksheet.getCell('A1').value = {\n  text: 'www.mylink.com',\n  hyperlink: 'http://www.mylink.com',\n  tooltip: 'www.mylink.com'\n};\n\n// internal link\nworksheet.getCell('A1').value = { text: 'Sheet2', hyperlink: '#\\'Sheet2\\'!A1' };\n```\n\n----------------------------------------\n\nTITLE: Applying Number Formats to Cells in ExcelJS\nDESCRIPTION: Demonstrates how to apply different number formats to cells in ExcelJS, including fractions and percentages.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_35\n\nLANGUAGE: javascript\nCODE:\n```\n// display value as '1 3/5'\nws.getCell('A1').value = 1.6;\nws.getCell('A1').numFmt = '# ?/?';\n\n// display value as '1.60%'\nws.getCell('B1').value = 0.016;\nws.getCell('B1').numFmt = '0.00%';\n```\n\n----------------------------------------\n\nTITLE: Splicing Rows and Cells in ExcelJS\nDESCRIPTION: Shows how to splice (cut and insert) rows and cells in an ExcelJS worksheet. Includes examples of removing rows, shifting up remaining rows, removing cells, and inserting new values.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_20\n\nLANGUAGE: javascript\nCODE:\n```\n// Cut one or more rows (rows below are shifted up)\n// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\nworksheet.spliceRows(4, 3);\n\n// remove one row and insert two more.\n// Note: rows 4 and below will be shifted down by 1 row.\nconst newRow3Values = [1, 2, 3, 4, 5];\nconst newRow4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceRows(3, 1, newRow3Values, newRow4Values);\n\n// Cut one or more cells (cells to the right are shifted left)\n// Note: this operation will not affect other rows\nrow.splice(3, 2);\n\n// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)\nrow.splice(4, 1, 'new value 1', 'new value 2');\n```\n\n----------------------------------------\n\nTITLE: Working with Defined Names in ExcelJS\nDESCRIPTION: Demonstrates how to assign and manage named cells in ExcelJS, which can be used in formulas and data validation. Shows adding single names, multiple names, and removing names from cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_22\n\nLANGUAGE: javascript\nCODE:\n```\n// assign (or get) a name for a cell (will overwrite any other names that cell had)\nworksheet.getCell('A1').name = 'PI';\nexpect(worksheet.getCell('A1').name).to.equal('PI');\n\n// assign (or get) an array of names for a cell (cells can have more than one name)\nworksheet.getCell('A1').names = ['thing1', 'thing2'];\nexpect(worksheet.getCell('A1').names).to.have.members(['thing1', 'thing2']);\n\n// remove a name from a cell\nworksheet.getCell('A1').removeName('thing1');\nexpect(worksheet.getCell('A1').names).to.have.members(['thing2']);\n```\n\n----------------------------------------\n\nTITLE: Applying Cell Borders in ExcelJS\nDESCRIPTION: Shows how to apply different types of borders to cells including thin borders, double borders with color, and diagonal crosses. Demonstrates setting border styles and colors for all sides of a cell and diagonal borders.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_38\n\nLANGUAGE: javascript\nCODE:\n```\n// set single thin border around A1\nws.getCell('A1').border = {\n  top: {style:'thin'},\n  left: {style:'thin'},\n  bottom: {style:'thin'},\n  right: {style:'thin'}\n};\n\n// set double thin green border around A3\nws.getCell('A3').border = {\n  top: {style:'double', color: {argb:'FF00FF00'}},\n  left: {style:'double', color: {argb:'FF00FF00'}},\n  bottom: {style:'double', color: {argb:'FF00FF00'}},\n  right: {style:'double', color: {argb:'FF00FF00'}}\n};\n\n// set thick red cross in A5\nws.getCell('A5').border = {\n  diagonal: {up: true, down: true, style:'thick', color: {argb:'FFFF0000'}}\n};\n```\n\n----------------------------------------\n\nTITLE: Setting Cell Alignment in ExcelJS\nDESCRIPTION: Demonstrates how to configure different cell alignment options including vertical/horizontal alignment, text wrapping, indentation, and text rotation. Shows examples for top-left, middle-center, bottom-right alignment, as well as text wrapping, indentation, and various text rotation options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_37\n\nLANGUAGE: javascript\nCODE:\n```\n// set cell alignment to top-left, middle-center, bottom-right\nws.getCell('A1').alignment = { vertical: 'top', horizontal: 'left' };\nws.getCell('B1').alignment = { vertical: 'middle', horizontal: 'center' };\nws.getCell('C1').alignment = { vertical: 'bottom', horizontal: 'right' };\n\n// set cell to wrap-text\nws.getCell('D1').alignment = { wrapText: true };\n\n// set cell indent to 1\nws.getCell('E1').alignment = { indent: 1 };\n\n// set cell text rotation to 30deg upwards, 45deg downwards and vertical text\nws.getCell('F1').alignment = { textRotation: 30 };\nws.getCell('G1').alignment = { textRotation: -45 };\nws.getCell('H1').alignment = { textRotation: 'vertical' };\n```\n\n----------------------------------------\n\nTITLE: Configuring Headers and Footers in ExcelJS Worksheets\nDESCRIPTION: Demonstrates how to add customized headers and footers to worksheets. Includes examples of setting different content for first page and even pages, and using text formatting commands to control appearance.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_10\n\nLANGUAGE: javascript\nCODE:\n```\n// Create worksheets with headers and footers\nvar sheet = workbook.addWorksheet('sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n// Create worksheets with headers and footers\nvar worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n// Set footer (default centered), result: \"Page 2 of 16\"\nworksheet.headerFooter.oddFooter = \"Page &P of &N\";\n\n// Set the footer (default centered) to bold, resulting in: \"Page 2 of 16\"\nworksheet.headerFooter.oddFooter = \"Page &P of &N\";\n\n// Set the left footer to 18px and italicize. Result: \"Page 2 of 16\"\nworksheet.headerFooter.oddFooter = \"&LPage &P of &N\";\n\n// Set the middle header to gray Aril, the result: \"52 exceljs\"\nworksheet.headerFooter.oddHeader = \"&C&KCCCCCC&\\\"Aril\\\"52 exceljs\";\n\n// Set the left, center, and right text of the footer. Result: \"Exceljs\" in the footer left. \"demo.xlsx\" in the footer center. \"Page 2\" in the footer right\nworksheet.headerFooter.oddFooter = \"&Lexceljs&C&F&RPage &P\";\n\n// Add different header & footer for the first page\nworksheet.headerFooter.differentFirst = true;\nworksheet.headerFooter.firstHeader = \"Hello Exceljs\";\nworksheet.headerFooter.firstFooter = \"Hello World\"\n```\n\n----------------------------------------\n\nTITLE: Applying Font Styles in ExcelJS\nDESCRIPTION: This snippet demonstrates how to apply different font styles to cells including font family, size, color, and formatting options such as bold, italic, and underline.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_15\n\nLANGUAGE: javascript\nCODE:\n```\n// for the wannabe graphic designers out there\nws.getCell('A1').font = {\n  name: 'Comic Sans MS',\n  family: 4,\n  size: 16,\n  underline: true,\n  bold: true\n};\n\n// for the graduate graphic designers...\nws.getCell('A2').font = {\n  name: 'Arial Black',\n  color: { argb: 'FF00FF00' },\n  family: 2,\n  size: 14,\n  italic: true\n};\n\n// 垂直对齐\nws.getCell('A3').font = {\n  vertAlign: 'superscript'\n};\n\n// 注意：该单元格将存储对分配的字体对象的引用。\n// 如果之后更改了字体对象，则单元字体也将更改。\nconst font = { name: 'Arial', size: 12 };\nws.getCell('A3').font = font;\nfont.size = 20; // 单元格 A3 现在具有20号字体！\n\n// 从文件或流中读取工作簿后，共享相似字体的单元格可能引用相同的字体对象\n```\n\n----------------------------------------\n\nTITLE: Inserting Rows into Worksheets in ExcelJS\nDESCRIPTION: Demonstrates how to insert rows at a specific position in an ExcelJS worksheet, shifting down existing rows. Shows different methods for inserting rows with various value formats and style options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_19\n\nLANGUAGE: javascript\nCODE:\n```\ninsertRow(pos, value, style = 'n')\ninsertRows(pos, values, style = 'n')\n\n// Insert a couple of Rows by key-value, shifting down rows every time\nworksheet.insertRow(1, {id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.insertRow(1, {id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Insert a row by contiguous Array (assign to columns A, B & C)\nworksheet.insertRow(1, [3, 'Sam', new Date()]);\n\n// Insert a row by sparse Array (assign to columns A, E & I)\nvar rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\n// insert new row and return as row object\nconst insertedRow = worksheet.insertRow(1, rowValues);\n\n// Insert a row, with inherited style\n// This new row will have same style as row on top of it\n// And return as row object\nconst insertedRowInherited = worksheet.insertRow(1, rowValues, 'i');\n\n// Insert a row, keeping original style\n// This new row will have same style as it was previously\n// And return as row object\nconst insertedRowOriginal = worksheet.insertRow(1, rowValues, 'o');\n\n// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rows\nvar rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// insert new rows and return them as array of row objects\nconst insertedRows = worksheet.insertRows(1, rows);\n\n// Insert an array of rows, with inherited style\n// These new rows will have same style as row on top of it\n// And return them as array of row objects\nconst insertedRowsInherited = worksheet.insertRows(1, rows, 'i');\n\n// Insert an array of rows, keeping original style\n// These new rows will have same style as it was previously in 'pos' position\nconst insertedRowsOriginal = worksheet.insertRows(1, rows, 'o');\n```\n\n----------------------------------------\n\nTITLE: Protecting and Unprotecting Excel Worksheets with JavaScript\nDESCRIPTION: Shows how to add password protection to a worksheet with optional configuration settings, and how to remove protection. Note that the protect() function is async but runs on the main thread.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_55\n\nLANGUAGE: javascript\nCODE:\n```\nawait worksheet.protect('the-password', options);\n```\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.unprotect();\n```\n\n----------------------------------------\n\nTITLE: Configuring Cell Alignment in ExcelJS\nDESCRIPTION: This code demonstrates different cell alignment options including vertical and horizontal alignment, text wrapping, indentation, and text rotation. It shows how to apply these settings to individual cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_16\n\nLANGUAGE: javascript\nCODE:\n```\n// 将单元格对齐方式设置为左上，中间居中，右下\nws.getCell('A1').alignment = { vertical: 'top', horizontal: 'left' };\nws.getCell('B1').alignment = { vertical: 'middle', horizontal: 'center' };\nws.getCell('C1').alignment = { vertical: 'bottom', horizontal: 'right' };\n\n// 将单元格设置为自动换行\nws.getCell('D1').alignment = { wrapText: true };\n\n// 将单元格缩进设置为1\nws.getCell('E1').alignment = { indent: 1 };\n\n// 将单元格文本旋转设置为向上30deg，向下45deg和垂直文本\nws.getCell('F1').alignment = { textRotation: 30 };\nws.getCell('G1').alignment = { textRotation: -45 };\nws.getCell('H1').alignment = { textRotation: 'vertical' };\n```\n\n----------------------------------------\n\nTITLE: Configuring Page Setup in ExcelJS with JavaScript\nDESCRIPTION: Shows how to create worksheets with custom page setup options including paper size, orientation, margins, print areas, and title rows/columns for printing. Demonstrates both initial configuration and subsequent modification.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_0\n\nLANGUAGE: javascript\nCODE:\n```\n// 使用 A4 横向的页面设置创建新工作表\nconst worksheet =  workbook.addWorksheet('sheet', {\n  pageSetup:{paperSize: 9, orientation:'landscape'}\n});\n\n// 使用适合页面的pageSetup设置创建一个新的工作表编写器\nconst worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  pageSetup:{fitToPage: true, fitToHeight: 5, fitToWidth: 7}\n});\n\n// 之后调整页面设置配置\nworksheet.pageSetup.margins = {\n  left: 0.7, right: 0.7,\n  top: 0.75, bottom: 0.75,\n  header: 0.3, footer: 0.3\n};\n\n// 设置工作表的打印区域\nworksheet.pageSetup.printArea = 'A1:G20';\n\n// 通过使用 `&&` 分隔打印区域来设置多个打印区域\nworksheet.pageSetup.printArea = 'A1:G10&&A11:G20';\n\n// 在每个打印页面上重复特定的行\nworksheet.pageSetup.printTitlesRow = '1:3';\n\n// 在每个打印页面上重复特定列\nworksheet.pageSetup.printTitlesColumn = 'A:C';\n```\n\n----------------------------------------\n\nTITLE: Managing Columns in ExcelJS Worksheets\nDESCRIPTION: Comprehensive guide to column operations in ExcelJS including defining columns with headers and properties, accessing columns, setting properties, iterating through cells, and manipulating column data with splicing operations.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_4\n\nLANGUAGE: javascript\nCODE:\n```\n// 添加列标题并定义列键和宽度\n// 注意：这些列结构仅是构建工作簿的方便之处，除了列宽之外，它们不会完全保留。\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n\n// 通过键，字母和基于1的列号访问单个列\nconst idCol = worksheet.getColumn('id');\nconst nameCol = worksheet.getColumn('B');\nconst dobCol = worksheet.getColumn(3);\n\n// 设置列属性\n\n// 注意：将覆盖 C1 单元格值\ndobCol.header = 'Date of Birth';\n\n// 注意：这将覆盖 C1:C2 单元格值\ndobCol.header = ['Date of Birth', 'A.K.A. D.O.B.'];\n\n// 从现在开始，此列将以 \"dob\" 而不是 \"DOB\" 建立索引\ndobCol.key = 'dob';\n\ndobCol.width = 15;\n\n// 如果需要，隐藏列\ndobCol.hidden = true;\n\n// 为列设置大纲级别\nworksheet.getColumn(4).outlineLevel = 0;\nworksheet.getColumn(5).outlineLevel = 1;\n\n// 列支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态\nexpect(worksheet.getColumn(4).collapsed).to.equal(false);\nexpect(worksheet.getColumn(5).collapsed).to.equal(true);\n\n// 遍历此列中的所有当前单元格\ndobCol.eachCell(function(cell, rowNumber) {\n  // ...\n});\n\n// 遍历此列中的所有当前单元格，包括空单元格\ndobCol.eachCell({ includeEmpty: true }, function(cell, rowNumber) {\n  // ...\n});\n\n// 添加一列新值\nworksheet.getColumn(6).values = [1,2,3,4,5];\n\n// 添加稀疏列值\nworksheet.getColumn(7).values = [,,2,3,,5,,7,,,,11];\n\n// 剪切一列或多列（右边的列向左移动）\n// 如果定义了列属性，则会相应地对其进行切割或移动\n// 已知问题：如果拼接导致任何合并的单元格移动，结果可能是不可预测的\nworksheet.spliceColumns(3,2);\n\n// 删除一列，再插入两列。\n// 注意：第4列及以上的列将右移1列。\n// 另外：如果工作表中的行数多于列插入项中的值，则行将仍然被插入，就好像值存在一样。\nconst newCol3Values = [1,2,3,4,5];\nconst newCol4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceColumns(3, 1, newCol3Values, newCol4Values);\n```\n\n----------------------------------------\n\nTITLE: Adding Cell Comments in ExcelJS\nDESCRIPTION: Demonstrates how to add comments to cells in ExcelJS, including both simple plain text notes and complex formatted comments with custom styling, margins, protection settings, and anchoring options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_24\n\nLANGUAGE: javascript\nCODE:\n```\n// plain text note\nworksheet.getCell('A1').note = 'Hello, ExcelJS!';\n\n// colourful formatted note\nws.getCell('B1').note = {\n  texts: [\n    {'font': {'size': 12, 'color': {'theme': 0}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': 'This is '},\n    {'font': {'italic': true, 'size': 12, 'color': {'theme': 0}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'a'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' '},\n    {'font': {'size': 12, 'color': {'argb': 'FFFF6600'}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'colorful'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' text '},\n    {'font': {'size': 12, 'color': {'argb': 'FFCCFFCC'}, 'name': 'Calibri', 'scheme': 'minor'}, 'text': 'with'},\n    {'font': {'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': ' in-cell '},\n    {'font': {'bold': true, 'size': 12, 'color': {'theme': 1}, 'name': 'Calibri', 'family': 2, 'scheme': 'minor'}, 'text': 'format'},\n  ],\n  margins: {\n    insetmode: 'custom',\n    inset: [0.25, 0.25, 0.35, 0.35]\n  },\n  protection: {\n    locked: True,\n    lockText: False\n  },\n  editAs: 'twoCells',\n};\n```\n\n----------------------------------------\n\nTITLE: Adding Headers and Footers to ExcelJS Worksheets\nDESCRIPTION: Demonstrates how to add and format headers and footers in ExcelJS worksheets with various formatting options including position, font style, page numbers, and different content for first/even pages.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\n// 创建一个带有页眉和页脚的工作表\nvar sheet = workbook.addWorksheet('My Sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n\n// 创建一个带有页眉和页脚可写的工作表\nvar worksheetWriter = workbookWriter.addWorksheet('sheet', {\n  headerFooter:{firstHeader: \"Hello Exceljs\", firstFooter: \"Hello World\"}\n});\n// 代码中出现的&开头字符对应变量，相关信息可查阅下文的变量表\n// 设置页脚(默认居中),结果：\"第 2 页，共 16 页\"\nworksheet.headerFooter.oddFooter = \"第 &P 页，共 &N 页\";\n\n// 将页脚（默认居中）设置为粗体，结果是：\"第2页，共16页\"\nworksheet.headerFooter.oddFooter = \"Page &P of &N\";\n\n// 将左页脚设置为 18px 并以斜体显示。 结果：\"第2页，共16页\"\nworksheet.headerFooter.oddFooter = \"&LPage &P of &N\";\n\n// 将中间标题设置为灰色Aril，结果为：\" 52 exceljs\"\nworksheet.headerFooter.oddHeader = \"&C&KCCCCCC&\\\"Aril\\\"52 exceljs\";\n\n// 设置页脚的左，中和右文本。 结果：页脚左侧为\" Exceljs\"。 页脚中心的\" demo.xlsx\"。 页脚右侧的\"第2页\"\nworksheet.headerFooter.oddFooter = \"&Lexceljs&C&F&RPage &P\";\n\n// 在首页添加不同的页眉和页脚\nworksheet.headerFooter.differentFirst = true;\nworksheet.headerFooter.firstHeader = \"Hello Exceljs\";\nworksheet.headerFooter.firstFooter = \"Hello World\"\n```\n\n----------------------------------------\n\nTITLE: Setting Cell Borders in ExcelJS\nDESCRIPTION: This snippet shows how to apply different border styles to cells including thin borders, double borders with color, and diagonal cross borders. It demonstrates the various border style options available.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_17\n\nLANGUAGE: javascript\nCODE:\n```\n// 在A1周围设置单个细边框\nws.getCell('A1').border = {\n  top: {style:'thin'},\n  left: {style:'thin'},\n  bottom: {style:'thin'},\n  right: {style:'thin'}\n};\n\n// 在A3周围设置双细绿色边框\nws.getCell('A3').border = {\n  top: {style:'double', color: {argb:'FF00FF00'}},\n  left: {style:'double', color: {argb:'FF00FF00'}},\n  bottom: {style:'double', color: {argb:'FF00FF00'}},\n  right: {style:'double', color: {argb:'FF00FF00'}}\n};\n\n// 在A5中设置厚红十字边框\nws.getCell('A5').border = {\n  diagonal: {up: true, down: true, style:'thick', color: {argb:'FFFF0000'}}\n};\n```\n\n----------------------------------------\n\nTITLE: Changing Table Column Properties in ExcelJS\nDESCRIPTION: Demonstrates how to modify various properties of a table column, including name, filter button, style, and totals row settings in ExcelJS. Changes must be committed to take effect.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_33\n\nLANGUAGE: javascript\nCODE:\n```\nconst table = ws.getTable('MyTable');\n\n// Get Column Wrapper for second column\nconst column = table.getColumn(1);\n\n// set some properties\ncolumn.name = 'Code';\ncolumn.filterButton = true;\ncolumn.style = {font:{bold: true, name: 'Comic Sans MS'}};\ncolumn.totalsRowLabel = 'Totals';\ncolumn.totalsRowFunction = 'custom';\ncolumn.totalsRowFormula = 'ROW()';\ncolumn.totalsRowResult = 10;\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n----------------------------------------\n\nTITLE: Configuring Worksheet Views in ExcelJS\nDESCRIPTION: Shows how to set up different worksheet views including frozen panes and split views. Demonstrates setting properties like scroll position, active cell, and zoom scale for optimizing worksheet display.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.views = [\n  {state: 'frozen', xSplit: 2, ySplit: 3, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.views = [\n  {state: 'split', xSplit: 2000, ySplit: 3000, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n----------------------------------------\n\nTITLE: Using Rich Text Formatting in ExcelJS\nDESCRIPTION: This snippet shows how to apply rich text formatting to a cell, allowing different parts of a cell's text to have different font properties such as size, color, and style.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_19\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('A1').value = {\n  'richText': [\n    {'font': {'size': 12,'color': {'theme': 0},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'This is '},\n    {'font': {'italic': true,'size': 12,'color': {'theme': 0},'name': 'Calibri','scheme': 'minor'},'text': 'a'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' '},\n    {'font': {'size': 12,'color': {'argb': 'FFFF6600'},'name': 'Calibri','scheme': 'minor'},'text': 'colorful'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' text '},\n    {'font': {'size': 12,'color': {'argb': 'FFCCFFCC'},'name': 'Calibri','scheme': 'minor'},'text': 'with'},\n    {'font': {'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': ' in-cell '},\n    {'font': {'bold': true,'size': 12,'color': {'theme': 1},'name': 'Calibri','family': 2,'scheme': 'minor'},'text': 'format'}\n  ]\n};\n\nexpect(ws.getCell('A1').text).to.equal('This is a colorful text with in-cell format');\nexpect(ws.getCell('A1').type).to.equal(Excel.ValueType.RichText);\n```\n\n----------------------------------------\n\nTITLE: Setting Auto Filters in ExcelJS\nDESCRIPTION: Multiple examples of applying auto filters to worksheets using different notation styles including string ranges and object coordinates.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_13\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.autoFilter = 'A1:C1';\n\nworksheet.autoFilter = {\n  from: 'A1',\n  to: 'C1',\n}\n\nworksheet.autoFilter = {\n  from: {\n    row: 3,\n    column: 1\n  },\n  to: {\n    row: 5,\n    column: 12\n  }\n}\n\nworksheet.autoFilter = {\n  from: 'D3',\n  to: {\n    row: 7,\n    column: 5\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Setting Auto Filters in ExcelJS Worksheets\nDESCRIPTION: Demonstrates different ways to apply auto filters to worksheets using string ranges or object notation with row/column specifications for filtering data.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_3\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.autoFilter = 'A1:C1';\n```\n\nLANGUAGE: javascript\nCODE:\n```\n// 将自动筛选器设置为从 A1 到 C1\nworksheet.autoFilter = {\n  from: 'A1',\n  to: 'C1',\n}\n\n// 将自动筛选器设置为从第3行第1列的单元格到第5行第12列的单元格\nworksheet.autoFilter = {\n  from: {\n    row: 3,\n    column: 1\n  },\n  to: {\n    row: 5,\n    column: 12\n  }\n}\n\n// 将自动筛选器设置为从D3到第7行第5列中的单元格\nworksheet.autoFilter = {\n  from: 'D3',\n  to: {\n    row: 7,\n    column: 5\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Column Outline Levels in ExcelJS\nDESCRIPTION: Example showing how to define outline levels for columns during column setup. Outline levels allow for collapsible grouping of data in Excel worksheets.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_43\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.columns = [\n  { header: 'Id', key: 'id', width: 10 },\n  { header: 'Name', key: 'name', width: 32 },\n  { header: 'D.O.B.', key: 'DOB', width: 10, outlineLevel: 1 }\n];\n```\n\n----------------------------------------\n\nTITLE: Iterating Over All Rows in All Sheets with ExcelJS v4 Stream Reading\nDESCRIPTION: This snippet demonstrates how to use the new stream reading feature in ExcelJS v4 to iterate over all rows in all sheets of an Excel file. It offers improved performance and flow control.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md#2025-04-11_snippet_0\n\nLANGUAGE: javascript\nCODE:\n```\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx');\nfor await (const worksheetReader of workbookReader) {\n  for await (const row of worksheetReader) {\n    // ...\n\n    // continue, break, return\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Streaming XLSX Writer with ExcelJS in JavaScript\nDESCRIPTION: Shows how to create a streaming XLSX workbook writer, add rows, merge cells, and commit the workbook. This method is more memory-efficient for large workbooks.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_60\n\nLANGUAGE: javascript\nCODE:\n```\n// construct a streaming XLSX workbook writer with styles and shared strings\nconst options = {\n  filename: './streamed-workbook.xlsx',\n  useStyles: true,\n  useSharedStrings: true\n};\nconst workbook = new Excel.stream.xlsx.WorkbookWriter(options);\n\nworksheet.addRow({\n   id: i,\n   name: theName,\n   etc: someOtherDetail\n}).commit();\n\nworksheet.mergeCells('A1:B2');\nworksheet.getCell('A1').value = 'I am merged';\nworksheet.getCell('C1').value = 'I am not';\nworksheet.getCell('C2').value = 'Neither am I';\nworksheet.getRow(2).commit(); // now rows 1 and two are committed.\n\n// Finished adding data. Commit the worksheet\nworksheet.commit();\n\n// Finished the workbook.\nawait workbook.commit();\n// ... the stream has been written\n```\n\n----------------------------------------\n\nTITLE: Setting Background Image in Excel Worksheet with JavaScript\nDESCRIPTION: Shows how to add a background image to an Excel worksheet using an imageId obtained from the workbook.addImage() function.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_49\n\nLANGUAGE: javascript\nCODE:\n```\n// set background\nworksheet.addBackgroundImage(imageId1);\n```\n\n----------------------------------------\n\nTITLE: Adding Image to a Cell Range in Excel Worksheet with JavaScript\nDESCRIPTION: Demonstrates how to add an image to cover a specific cell range in an Excel worksheet using the imageId from workbook.addImage().\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_50\n\nLANGUAGE: javascript\nCODE:\n```\n// insert an image over B2:D6\nworksheet.addImage(imageId2, 'B2:D6');\n```\n\n----------------------------------------\n\nTITLE: Writing CSV File with ExcelJS in JavaScript\nDESCRIPTION: Demonstrates how to write a CSV file using ExcelJS, including options for date formatting, custom value mapping, and formatter options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_59\n\nLANGUAGE: javascript\nCODE:\n```\n// write to a file\nconst workbook = createAndFillWorkbook();\nawait workbook.csv.writeFile(filename);\n\n// write to a stream\n// Be careful that you need to provide sheetName or\n// sheetId for correct import to csv.\nawait workbook.csv.write(stream, { sheetName: 'Page name' });\n\n// write to a file with European Date-Times\nconst workbook = new Excel.Workbook();\nconst options = {\n  dateFormat: 'DD/MM/YYYY HH:mm:ss',\n  dateUTC: true, // use utc when rendering dates\n};\nawait workbook.csv.writeFile(filename, options);\n\n\n// write to a file with custom value formatting\nconst workbook = new Excel.Workbook();\nconst options = {\n  map(value, index) {\n    switch(index) {\n      case 0:\n        // column 1 is string\n        return value;\n      case 1:\n        // column 2 is a date\n        return dayjs(value).format('YYYY-MM-DD');\n      case 2:\n        // column 3 is a formula, write just the result\n        return value.result;\n      default:\n        // the rest are numbers\n        return value;\n    }\n  },\n  // https://c2fo.github.io/fast-csv/docs/formatting/options\n  formatterOptions: {\n    delimiter: '\\t',\n    quote: false,\n  },\n};\nawait workbook.csv.writeFile(filename, options);\n\n// write to a new buffer\nconst buffer = await workbook.csv.writeBuffer();\n```\n\n----------------------------------------\n\nTITLE: Adding Conditional Formatting in ExcelJS\nDESCRIPTION: This code shows how to add conditional formatting to a range of cells. It applies a checkerboard pattern based on the row and column numbers using an expression rule.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_21\n\nLANGUAGE: javascript\nCODE:\n```\n// 根据行和列为偶数或奇数向 A1:E7 添加一个棋盘图案\nworksheet.addConditionalFormatting({\n  ref: 'A1:E7',\n  rules: [\n    {\n      type: 'expression',\n      formulae: ['MOD(ROW()+COLUMN(),2)=0'],\n      style: {fill: {type: 'pattern', pattern: 'solid', bgColor: {argb: 'FF00FF00'}}},\n    }\n  ]\n})\n```\n\n----------------------------------------\n\nTITLE: Adding Image with Hyperlinks in Excel with JavaScript\nDESCRIPTION: Demonstrates how to add an image with embedded hyperlinks to a cell, including options for the hyperlink URL and tooltip text.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_54\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.addImage(imageId2, {\n  tl: { col: 0, row: 0 },\n  ext: { width: 500, height: 200 },\n  hyperlinks: {\n    hyperlink: 'http://www.somewhere.com',\n    tooltip: 'http://www.somewhere.com'\n  }\n});\n```\n\n----------------------------------------\n\nTITLE: Duplicating Rows in ExcelJS\nDESCRIPTION: Explains how to duplicate rows in an ExcelJS worksheet. The duplicateRow method allows duplicating a row multiple times, with options to insert new rows or replace existing ones.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_21\n\nLANGUAGE: javascript\nCODE:\n```\nduplicateRow(start, amount = 1, insert = true)\n\nconst wb = new ExcelJS.Workbook();\nconst ws = wb.addWorksheet('duplicateTest');\nws.getCell('A1').value = 'One';\nws.getCell('A2').value = 'Two';\nws.getCell('A3').value = 'Three';\nws.getCell('A4').value = 'Four';\n\n// This line will duplicate the row 'One' twice but it will replace rows 'Two' and 'Three'\n// if third param was true so it would insert 2 new rows with the values and styles of row 'One'\nws.duplicateRow(1,2,false);\n```\n\n----------------------------------------\n\nTITLE: Working with Individual Cells in ExcelJS\nDESCRIPTION: Shows how to work with individual cells in ExcelJS including accessing cells, setting values, and querying cell properties like type and text representation.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_7\n\nLANGUAGE: javascript\nCODE:\n```\nconst cell = worksheet.getCell('C3');\n\n// 修改/添加单个单元格\ncell.value = new Date(1968, 5, 1);\n\n// 查询单元格的类型\nexpect(cell.type).toEqual(Excel.ValueType.Date);\n\n// 使用单元格的字符串值\nmyInput.value = cell.text;\n\n// 使用 html 安全的字符串进行渲染...\nconst html = '<div>' + cell.html + '</div>';\n```\n\n----------------------------------------\n\nTITLE: Adding Image with Specific Dimensions to an Excel Cell with JavaScript\nDESCRIPTION: Shows how to add an image to a cell with explicitly defined width and height in pixels at 96dpi, rather than spanning across multiple cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_53\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.addImage(imageId2, {\n  tl: { col: 0, row: 0 },\n  ext: { width: 500, height: 200 }\n});\n```\n\n----------------------------------------\n\nTITLE: Adding and Removing Table Columns in ExcelJS\nDESCRIPTION: Shows how to remove columns and insert new columns with data at a specific index in ExcelJS. Changes must be committed to take effect.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_32\n\nLANGUAGE: javascript\nCODE:\n```\nconst table = ws.getTable('MyTable');\n\n// remove second column\ntable.removeColumns(1, 1);\n\n// insert new column (with data) at index 1\ntable.addColumn(\n  {name: 'Letter', totalsRowFunction: 'custom', totalsRowFormula: 'ROW()', totalsRowResult: 6, filterButton: true},\n  ['a', 'b', 'c', 'd'],\n  2\n);\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n----------------------------------------\n\nTITLE: Working with Numeric Values in ExcelJS\nDESCRIPTION: Example of assigning numeric values to worksheet cells in ExcelJS, showing both integer and floating point number handling.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_64\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = 5;\nworksheet.getCell('A2').value = 3.14159;\n```\n\n----------------------------------------\n\nTITLE: Setting Outline Levels Directly on Rows and Columns in ExcelJS\nDESCRIPTION: Example showing how to set outline levels directly on existing rows or columns. This allows for creating collapsible groups after the worksheet structure is already defined.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_44\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getColumn(3).outlineLevel = 1;\nworksheet.getRow(3).outlineLevel = 1;\n```\n\n----------------------------------------\n\nTITLE: Defining Named Cells in ExcelJS\nDESCRIPTION: Shows how to assign names to cells in ExcelJS, which can be used in formulas and data validation. Demonstrates assigning single names, multiple names, and removing names from cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_12\n\nLANGUAGE: javascript\nCODE:\n```\n// 为单元格分配（或获取）名称（将覆盖该单元具有的其他任何名称）\nworksheet.getCell('A1').name = 'PI';\nexpect(worksheet.getCell('A1').name).to.equal('PI');\n\n// 为单元格分配（或获取）一组名称（单元可以具有多个名称）\nworksheet.getCell('A1').names = ['thing1', 'thing2'];\nexpect(worksheet.getCell('A1').names).to.have.members(['thing1', 'thing2']);\n\n// 从单元格中删除名称\nworksheet.getCell('A1').removeName('thing1');\nexpect(worksheet.getCell('A1').names).to.have.members(['thing2']);\n```\n\n----------------------------------------\n\nTITLE: Setting Date Values in ExcelJS\nDESCRIPTION: Example of setting a JavaScript Date object as a value in an ExcelJS worksheet cell.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_66\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = new Date(2017, 2, 15);\n```\n\n----------------------------------------\n\nTITLE: Setting Boolean Values in ExcelJS\nDESCRIPTION: Example of setting boolean values (true/false) in ExcelJS worksheet cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_79\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = true;\nworksheet.getCell('A2').value = false;\n```\n\n----------------------------------------\n\nTITLE: Applying Cell Fills in ExcelJS\nDESCRIPTION: This code demonstrates how to apply different fill styles to cells including pattern fills with different colors and gradient fills with multiple color stops and directions.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_18\n\nLANGUAGE: javascript\nCODE:\n```\n// 用红色深色垂直条纹填充A1\nws.getCell('A1').fill = {\n  type: 'pattern',\n  pattern:'darkVertical',\n  fgColor:{argb:'FFFF0000'}\n};\n\n// 在A2中填充深黄色格子和蓝色背景\nws.getCell('A2').fill = {\n  type: 'pattern',\n  pattern:'darkTrellis',\n  fgColor:{argb:'FFFFFF00'},\n  bgColor:{argb:'FF0000FF'}\n};\n\n// 从左到右用蓝白蓝渐变填充A3\nws.getCell('A3').fill = {\n  type: 'gradient',\n  gradient: 'angle',\n  degree: 0,\n  stops: [\n    {position:0, color:{argb:'FF0000FF'}},\n    {position:0.5, color:{argb:'FFFFFFFF'}},\n    {position:1, color:{argb:'FF0000FF'}}\n  ]\n};\n\n\n// 从中心开始用红绿色渐变填充A4\nws.getCell('A4').fill = {\n  type: 'gradient',\n  gradient: 'path',\n  center:{left:0.5,top:0.5},\n  stops: [\n    {position:0, color:{argb:'FFFF0000'}},\n    {position:1, color:{argb:'FF00FF00'}}\n  ]\n};\n```\n\n----------------------------------------\n\nTITLE: Creating Rich Text Values in ExcelJS\nDESCRIPTION: Example of creating rich text with styled segments in an ExcelJS cell, combining regular and italic text in this case.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_78\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = {\n  richText: [\n    { text: 'This is '},\n    {font: {italic: true}, text: 'italic'},\n  ]\n};\n```\n\n----------------------------------------\n\nTITLE: Configuring Cell Protection in ExcelJS\nDESCRIPTION: Shows how to set cell-level protection options to control whether cells are locked or have hidden formulas when the worksheet is protected. Demonstrates setting locked and hidden protection properties.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_41\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('A1').protection = {\n  locked: false,\n  hidden: true,\n};\n```\n\n----------------------------------------\n\nTITLE: Configuring Frozen Worksheet View in ExcelJS\nDESCRIPTION: Example of setting up a frozen worksheet view with specified columns and rows frozen. Includes configuration for split position and active cell.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_11\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.views = [\n  {state: 'frozen', xSplit: 2, ySplit: 3, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n----------------------------------------\n\nTITLE: Setting Error Values in ExcelJS\nDESCRIPTION: Example of setting Excel error values in worksheet cells using ExcelJS, showing different error types like #N/A and #VALUE!.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_80\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = { error: '#N/A' };\nworksheet.getCell('A2').value = { error: '#VALUE!' };\n```\n\n----------------------------------------\n\nTITLE: Setting Worksheet Outline Levels in ExcelJS\nDESCRIPTION: Example showing how to set the overall outline levels for rows and columns at the worksheet level, which affects how the outline grouping is displayed.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_45\n\nLANGUAGE: javascript\nCODE:\n```\n// set column outline level\nworksheet.properties.outlineLevelCol = 1;\n\n// set row outline level\nworksheet.properties.outlineLevelRow = 1;\n```\n\n----------------------------------------\n\nTITLE: Configuring Split Worksheet View in ExcelJS\nDESCRIPTION: Example of creating a split worksheet view with specified split points and active pane settings.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_12\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.views = [\n  {state: 'split', xSplit: 2000, ySplit: 3000, topLeftCell: 'G10', activeCell: 'A1'}\n];\n```\n\n----------------------------------------\n\nTITLE: Formatting Numbers in ExcelJS\nDESCRIPTION: This code snippet demonstrates how to apply different number formats to cells. It shows how to display a value as a fraction and as a percentage.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_14\n\nLANGUAGE: javascript\nCODE:\n```\n// 将值显示为\" 1 3/5\"\nws.getCell('A1').value = 1.6;\nws.getCell('A1').numFmt = '# ?/?';\n\n// 显示为\" 1.60％\"\nws.getCell('B1').value = 0.016;\nws.getCell('B1').numFmt = '0.00%';\n```\n\n----------------------------------------\n\nTITLE: Setting Outline Properties in ExcelJS\nDESCRIPTION: Example showing how to configure outline properties on a worksheet, including summary positioning options that control where summary rows and columns appear relative to detail data.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_47\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.properties.outlineProperties = {\n  summaryBelow: false,\n  summaryRight: false,\n};\n```\n\n----------------------------------------\n\nTITLE: Using fillFormula with Callback Function in ExcelJS\nDESCRIPTION: Example of using the fillFormula method with a callback function to calculate values for cells in ExcelJS.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_74\n\nLANGUAGE: javascript\nCODE:\n```\n// fill A2 to A100 with ascending count starting from A1\nworksheet.fillFormula('A2:A100', 'A1+1', (row, col) => row);\n```\n\n----------------------------------------\n\nTITLE: Accessing Formula and Result with Getters in ExcelJS\nDESCRIPTION: Example of using convenience getters to access formula and result values from cells in ExcelJS.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_69\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A3').formula === 'A1+A2';\nworksheet.getCell('A3').result === 7;\n```\n\n----------------------------------------\n\nTITLE: Using ExcelJS v4 as a Readable Stream for Excel File Processing\nDESCRIPTION: This example illustrates how to use ExcelJS v4 as a readable stream to process an Excel file. It sets up event listeners for worksheets, shared strings, hyperlinks, and error handling.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md#2025-04-11_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbookReader = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nworkbookReader.read();\nworkbookReader.on('worksheet', worksheet => {\n  worksheet.on('row', row => {\n  });\n});\nworkbookReader.on('shared-strings', sharedString => {\n  // ...\n});\nworkbookReader.on('hyperlinks', hyperlinksReader => {\n  // ...\n});\nworkbookReader.on('end', () => {\n  // ...\n});\nworkbookReader.on('error', (err) => {\n  // ...\n});\n```\n\n----------------------------------------\n\nTITLE: Creating Array Formula in ExcelJS\nDESCRIPTION: Example of creating an array formula in ExcelJS, which is an alternative way to express shared formulae where only the master cell contains formula information.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_76\n\nLANGUAGE: javascript\nCODE:\n```\n// assign array formula to A2:B3\nworksheet.getCell('A2').value = {\n  formula: 'A1',\n  result: 10,\n  shareType: 'array',\n  ref: 'A2:B3'\n};\n\n// it may not be necessary to fill the rest of the values in the sheet\n```\n\n----------------------------------------\n\nTITLE: Creating Slave Shared Formula in ExcelJS\nDESCRIPTION: Example of assigning a shared formula to a slave cell in ExcelJS by referencing a master cell's formula.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_71\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('B2').value = { sharedFormula: 'A2', result: 10 };\n```\n\n----------------------------------------\n\nTITLE: Creating Master Shared Formula in ExcelJS\nDESCRIPTION: Example of assigning a master shared formula to a cell in ExcelJS, specifying the formula, result, share type, and reference range for slave cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_70\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A2').value = {\n  formula: 'A1',\n  result: 10,\n  shareType: 'shared',\n  ref: 'A2:B3'\n};\n```\n\n----------------------------------------\n\nTITLE: Using fillFormula for Array Formulas in ExcelJS\nDESCRIPTION: Example of using the fillFormula method to create an array formula across a range of cells in ExcelJS.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_77\n\nLANGUAGE: javascript\nCODE:\n```\n// fill A2:B3 with array formula \"A1\"\nworksheet.fillFormula('A2:B3', 'A1', [1,1,1,1], 'array');\n```\n\n----------------------------------------\n\nTITLE: Checking Formula Types in ExcelJS\nDESCRIPTION: Example of checking the formula type (master or shared) of cells in ExcelJS using the formulaType getter.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_75\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A3').formulaType === Enums.FormulaType.Master;\nworksheet.getCell('B3').formulaType === Enums.FormulaType.Shared;\n```\n\n----------------------------------------\n\nTITLE: Conditional Formatting Object Structure in ExcelJS\nDESCRIPTION: Defines the JavaScript object structure for conditional formatting rules in ExcelJS. Includes multiple formatting types such as expressions, cell conditions, data bars, color scales, icon sets, and text conditions with their respective properties.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_14\n\nLANGUAGE: javascript\nCODE:\n```\ncell.conditionalFormatting: {\n  ref: cell-range\n  rules: [\n    {\n      type: expression | cellIs | top10 | aboveAverage | dataBar | colorScale | iconSet | containsText | timePeriod | etc\n      dxfId: styleId\n      priority: a number - typically last first (and unique within sheet)\n\n      // expression\n      formula: 'the-formula'\n\n      // cellIs\n      operator: ''\n      formulae: [formula, ...]\n\n      // top10\n      percent: true | false(*)\n      bottom: true | false(*)\n      rank: 10 (or other number)\n\n      // aboveAverage (why is this not top10 50% ?)\n      aboveAverage: true(*) | false\n\n      // dataBar\n      cfvo: [CFVO, ...]\n      color: Colour\n      showValue: true(*) | false\n      gradient: true(*) | false\n      border: true | false(*)\n      borderColour: Colour\n      axisColor: Colour\n      negativeFillColor: Colour\n      negativeBorderColor: Colour\n      negativeBarColorSameAsPositive: true | false(*)\n      negativeBarBorderColorSameAsPositive: true | false(*)\n      minLength: 0(*)..maxLength\n      maxLength: minLength..100(*)\n      axisPosition: middle | none | undefined (auto)\n      direction: rightToLeft | undefined (lToR)\n\n      // colorScale\n      cfvo: [CFVO, ...] # 2 or 3\n      color: [Colour]\n\n      // iconSet\n      iconSet: IconSetEnum\n      cfvo: [CFVO, ...] # 2..5\n      reverse: true | false(*)\n      showValue: true(*) | false\n      custom: true | false(*)\n      cfIcon: [{iconSet: IconSetEnum, iconId: 0..N}, ...]\n\n      // containsText\n      operator: 'containsText'\n      text: 'the text'\n      formulae: [<an actual formula>]\n    }\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Adding Image with Custom Positioning in Excel Worksheet with JavaScript\nDESCRIPTION: Shows how to precisely position an image in an Excel worksheet using coordinates. This allows for partial cell coverage using a zero-based coordinate system.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_51\n\nLANGUAGE: javascript\nCODE:\n```\n// insert an image over part of B2:D6\nworksheet.addImage(imageId2, {\n  tl: { col: 1.5, row: 1.5 },\n  br: { col: 3.5, row: 5.5 }\n});\n```\n\n----------------------------------------\n\nTITLE: Merging Cells in ExcelJS\nDESCRIPTION: Demonstrates how to merge and unmerge cells in ExcelJS. Shows different ways to specify cell ranges and how merged cells share values and styles.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_8\n\nLANGUAGE: javascript\nCODE:\n```\n// 合并一系列单元格\nworksheet.mergeCells('A4:B5');\n\n// ...合并的单元格被链接起来了\nworksheet.getCell('B5').value = 'Hello, World!';\nexpect(worksheet.getCell('B5').value).toBe(worksheet.getCell('A4').value);\nexpect(worksheet.getCell('B5').master).toBe(worksheet.getCell('A4'));\n\n// ...合并的单元格共享相同的样式对象\nexpect(worksheet.getCell('B5').style).toBe(worksheet.getCell('A4').style);\nworksheet.getCell('B5').style.font = myFonts.arial;\nexpect(worksheet.getCell('A4').style.font).toBe(myFonts.arial);\n\n// 取消单元格合并将打破链接的样式\nworksheet.unMergeCells('A4');\nexpect(worksheet.getCell('B5').style).not.toBe(worksheet.getCell('A4').style);\nexpect(worksheet.getCell('B5').style.font).not.toBe(myFonts.arial);\n\n// 按左上，右下合并\nworksheet.mergeCells('K10', 'M12');\n\n// 按开始行，开始列，结束行，结束列合并（相当于 K10:M12）\nworksheet.mergeCells(10,11,12,13);\n```\n\n----------------------------------------\n\nTITLE: Parsing Shared Strings in ExcelJS\nDESCRIPTION: A JavaScript function that parses the shared strings XML stream from an Excel file. It handles text nodes and properly skips 'rPh' phonetic elements used for Japanese text pronunciation.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nparseSharedStrings: function (stream) {\n  return new Bluebird(function(resolve, reject) {\n    var parser = Sax.createStream(true, {});\n    var t = null;\n    var sharedStrings = [];\n    var rph = false;\n    parser.on('opentag', function (node) {\n      if (!rph && node.name === 't') {\n        t = '';\n      }\n      if (node.name === 'rPh') {\n        rph = true;\n      }\n    });\n    parser.on('closetag', function (name) {\n      if ((t !== null) && (name === 't')) {\n        sharedStrings.push(t);\n        t = null;\n      }\n      if (name === 'rPh') {\n        rph = false;\n      }\n    });\n    parser.on('text', function (text) {\n      if (t !== null) {\n        t += text;\n      }\n    });\n\n    parser.on('end', function () {\n      resolve(sharedStrings);\n    });\n    parser.on('error', function (error) {\n      reject(error);\n    });\n```\n\n----------------------------------------\n\nTITLE: Controlling Image Anchoring in Excel Worksheet with JavaScript\nDESCRIPTION: Demonstrates how to set the 'editAs' property when adding an image, which controls how the image is anchored to cells when they are moved or resized.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_52\n\nLANGUAGE: javascript\nCODE:\n```\nws.addImage(imageId, {\n  tl: { col: 0.1125, row: 0.4 },\n  br: { col: 2.101046875, row: 3.4 },\n  editAs: 'oneCell'\n});\n```\n\n----------------------------------------\n\nTITLE: Inserting Rows in ExcelJS\nDESCRIPTION: Shows how to insert rows at specific positions in an ExcelJS worksheet, including examples with different data formats and style inheritance options.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_9\n\nLANGUAGE: javascript\nCODE:\n```\ninsertRow(pos, value, style = 'n')\ninsertRows(pos, values, style = 'n')\n\n// Insert a couple of Rows by key-value, shifting down rows every time\nworksheet.insertRow(1, {id: 1, name: 'John Doe', dob: new Date(1970,1,1)});\nworksheet.insertRow(1, {id: 2, name: 'Jane Doe', dob: new Date(1965,1,7)});\n\n// Insert a row by contiguous Array (assign to columns A, B & C)\nworksheet.insertRow(1, [3, 'Sam', new Date()]);\n\n// Insert a row by sparse Array (assign to columns A, E & I)\nvar rowValues = [];\nrowValues[1] = 4;\nrowValues[5] = 'Kyle';\nrowValues[9] = new Date();\n// insert new row and return as row object\nconst insertedRow = worksheet.insertRow(1, rowValues);\n\n// Insert a row, with inherited style\n// This new row will have same style as row on top of it\n// And return as row object\nconst insertedRowInherited = worksheet.insertRow(1, rowValues, 'i');\n\n// Insert a row, keeping original style\n// This new row will have same style as it was previously\n// And return as row object\nconst insertedRowOriginal = worksheet.insertRow(1, rowValues, 'o');\n\n// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rows\nvar rows = [\n  [5,'Bob',new Date()], // row by array\n  {id:6, name: 'Barbara', dob: new Date()}\n];\n// insert new rows and return them as array of row objects\nconst insertedRows = worksheet.insertRows(1, rows);\n\n// Insert an array of rows, with inherited style\n// These new rows will have same style as row on top of it\n// And return them as array of row objects\nconst insertedRowsInherited = worksheet.insertRows(1, rows, 'i');\n\n// Insert an array of rows, keeping original style\n// These new rows will have same style as it was previously in 'pos' position\nconst insertedRowsOriginal = worksheet.insertRows(1, rows, 'o');\n```\n\n----------------------------------------\n\nTITLE: Configuring Cell Comment Anchoring in ExcelJS\nDESCRIPTION: Shows how to control how cell comments are anchored to cells using the 'editAs' property, which determines how the comment position and size behaves when cells are moved or resized.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_27\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('B1').note.editAs = 'twoCells';\n```\n\n----------------------------------------\n\nTITLE: Splicing Rows and Cells in ExcelJS\nDESCRIPTION: Demonstrates how to splice (cut and insert) rows and cells in ExcelJS. Shows how to remove rows or cells and optionally insert new ones in their place.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_10\n\nLANGUAGE: javascript\nCODE:\n```\n// Cut one or more rows (rows below are shifted up)\n// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable\nworksheet.spliceRows(4, 3);\n\n// remove one row and insert two more.\n// Note: rows 4 and below will be shifted down by 1 row.\nconst newRow3Values = [1, 2, 3, 4, 5];\nconst newRow4Values = ['one', 'two', 'three', 'four', 'five'];\nworksheet.spliceRows(3, 1, newRow3Values, newRow4Values);\n\n// Cut one or more cells (cells to the right are shifted left)\n// Note: this operation will not affect other rows\nrow.splice(3, 2);\n\n// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)\nrow.splice(4, 1, 'new value 1', 'new value 2');\n```\n\n----------------------------------------\n\nTITLE: Excel XML Print Options Examples\nDESCRIPTION: XML examples of print options settings in Excel's Open XML format. These examples show how to configure settings like displaying row/column headings, gridlines, and page centering.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_5\n\nLANGUAGE: xml\nCODE:\n```\n<printOptions headings=\"1\" gridLines=\"1\"/>\n<printOptions horizontalCentered=\"1\" verticalCentered=\"1\"/>\n```\n\n----------------------------------------\n\nTITLE: Setting Worksheet Visibility State in ExcelJS\nDESCRIPTION: Controls the visibility of worksheets with three possible states: 'visible' (default display), 'hidden' (can be unhidden by user), and 'veryHidden' (hidden from hide/unhide dialog).\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_7\n\nLANGUAGE: javascript\nCODE:\n```\n// make worksheet visible\nworksheet.state = 'visible';\n\n// make worksheet hidden\nworksheet.state = 'hidden';\n\n// make worksheet hidden from 'hide/unhide' dialog\nworksheet.state = 'veryHidden';\n```\n\n----------------------------------------\n\nTITLE: Duplicating Rows in ExcelJS\nDESCRIPTION: Shows how to duplicate rows in ExcelJS worksheets. The example demonstrates duplicating a row and specifying whether to insert new rows or replace existing ones.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_11\n\nLANGUAGE: javascript\nCODE:\n```\nduplicateRow(start, amount = 1, insert = true)\n\nconst wb = new ExcelJS.Workbook();\nconst ws = wb.addWorksheet('duplicateTest');\nws.getCell('A1').value = 'One';\nws.getCell('A2').value = 'Two';\nws.getCell('A3').value = 'Three';\nws.getCell('A4').value = 'Four';\n\n// 该行将重复复制第一行两次，但将替换第二行和第三行\n// 如果第三个参数为 true，则它将插入2个新行，其中包含行 \"One\" 的值和样式\nws.duplicateRow(1,2,false);\n```\n\n----------------------------------------\n\nTITLE: Excel XML Page Break Definitions\nDESCRIPTION: XML example showing how manual page breaks are defined in Excel's sheet XML. These breaks can be applied to both rows and columns, with attributes specifying their positions.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_7\n\nLANGUAGE: xml\nCODE:\n```\n<rowBreaks count=\"2\" manualBreakCount=\"2\">\n\t<brk id=\"5\" max=\"16383\" man=\"1\"/>  // id=\"5\" means underneath row 5 max & man??? is that a spelling error?\n\t<brk id=\"7\" max=\"16383\" man=\"1\"/>\n</rowBreaks>\n<colBreaks count=\"3\" manualBreakCount=\"3\">\n\t<brk id=\"3\" max=\"1048575\" man=\"1\"/>\n\t<brk id=\"6\" max=\"1048575\" man=\"1\"/>\n\t<brk id=\"9\" max=\"1048575\" man=\"1\"/>\n</colBreaks>\n```\n\n----------------------------------------\n\nTITLE: Configuring Cell Protection in ExcelJS\nDESCRIPTION: This snippet demonstrates how to set cell-level protection properties to control whether cells can be locked or have their formulas hidden when a worksheet is protected.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README_zh.md#2025-04-11_snippet_20\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('A1').protection = {\n  locked: false,\n  hidden: true,\n};\n```\n\n----------------------------------------\n\nTITLE: Configuring Cell Comment Margins in ExcelJS\nDESCRIPTION: Shows how to configure custom margins for cell comments in ExcelJS by specifying the inset mode and margin values in centimeters for left, top, right, and bottom edges.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_25\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('B1').note.margins = {\n  insetmode: 'custom',\n  inset: [0.25, 0.25, 0.35, 0.35]\n}\n```\n\n----------------------------------------\n\nTITLE: Browserify Bundle Integration\nDESCRIPTION: HTML script tags for including ExcelJS browserified bundles with and without polyfills.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_4\n\nLANGUAGE: html\nCODE:\n```\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js\"></script>\n<script src=\"exceljs.js\"></script>\n```\n\nLANGUAGE: html\nCODE:\n```\n<script src=\"--your-project's-pollyfills-here--\"></script>\n<script src=\"exceljs.bare.js\"></script>\n```\n\n----------------------------------------\n\nTITLE: Accessing Translated Shared Formula in ExcelJS\nDESCRIPTION: Example showing how to access the translated formula from a shared formula cell in ExcelJS.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_72\n\nLANGUAGE: javascript\nCODE:\n```\nexpect(worksheet.getCell('B2').formula).to.equal('B1');\n```\n\n----------------------------------------\n\nTITLE: Setting Cell Comment Protection in ExcelJS\nDESCRIPTION: Demonstrates how to configure protection settings for cell comments in ExcelJS, controlling whether objects and object text are locked when worksheet protection is enabled.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_26\n\nLANGUAGE: javascript\nCODE:\n```\nws.getCell('B1').note.protection = {\n  locked: 'False',\n  lockText: 'False',\n};\n```\n\n----------------------------------------\n\nTITLE: Setting String Values in ExcelJS Cells\nDESCRIPTION: Example of setting a simple text string value to a worksheet cell in ExcelJS.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_65\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = 'Hello, World!';\n```\n\n----------------------------------------\n\nTITLE: Modifying Table Headers and Totals in ExcelJS\nDESCRIPTION: Demonstrates how to turn on the header row and turn off the totals row for a table in ExcelJS. Changes must be committed to take effect.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_29\n\nLANGUAGE: javascript\nCODE:\n```\nconst table = ws.getTable('MyTable');\n\n// turn header row on\ntable.headerRow = true;\n\n// turn totals row off\ntable.totalsRow = false;\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n----------------------------------------\n\nTITLE: Installing Dependencies for Browser Testing with Puppeteer\nDESCRIPTION: Terminal command to install libfontconfig, which is required for browser testing with Puppeteer in Linux environments.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_82\n\nLANGUAGE: bash\nCODE:\n```\nsudo apt-get install libfontconfig\n```\n\n----------------------------------------\n\nTITLE: Workbook Model Structure in ExcelJS\nDESCRIPTION: Basic structure of a workbook object containing an array of worksheet models.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_0\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    worksheets: [\n        // array of worksheet models\n    ]\n}\n```\n\n----------------------------------------\n\nTITLE: Relocating a Table in ExcelJS\nDESCRIPTION: Shows how to move a table to a new position on the worksheet in ExcelJS. The change must be committed to take effect.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_30\n\nLANGUAGE: javascript\nCODE:\n```\nconst table = ws.getTable('MyTable');\n\n// table top-left move to D4\ntable.ref = 'D4';\n\n// commit the table changes into the sheet\ntable.commit();\n```\n\n----------------------------------------\n\nTITLE: Worksheet Model Structure in ExcelJS\nDESCRIPTION: Detailed model of a worksheet including properties for identification, content organization, merge ranges, dimensions, and page setup configurations.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    // worksheet id (integer>=1)\n    id: 1,\n\n    // worksheet name\n    name: \"blort\",\n\n    // rows\n    rows: [\n        // array of row models\n    ],\n\n    // merge ranges\n    \"merges\": [\n        \"A2:B3\"\n    ],\n    \"dimensions\": {\n        \"top\": 1,\n        \"left\": 1,\n        \"bottom\": 3,\n        \"right\": 6\n    },\n\n    // setting for enable fit to page (default: false)\n    fitToPage: false,\n\n    // setting for page\n    pageSetup: {\n        paperSize: 9,\n        scale: 100,\n        firstPageNumber: 0,\n        fitToWidth: 1,\n        fitToHeight: 1,\n        pageOrder: \"downThenOver\",\n        orientation: \"portrait\", // (portrait | landscape)\n        usePrinterDefaults: \"false\",\n        blackAndWhite: \"false\",\n        draft: \"false\",\n        cellComments: \"none\",\n        useFirstPageNumber: \"false\",\n        horizontalDpi: 300,\n        verticalDpi: 300,\n        copies: 1\n    },\n\n    // setting for margins\n    pageMargins: {\n        left: 0.7,\n        right:0.7,\n        top: 0.75,\n        bottom: 0.75,\n        header: 0.3,\n        footer: 0.3\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Outline Level Side Effects on Column Collapse State in ExcelJS\nDESCRIPTION: Example demonstrating the side effect of modifying outline levels, which also changes the collapsed property of affected rows or columns. Shows how changing worksheet outline levels affects column collapse state.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_46\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.properties.outlineLevelCol = 1;\n\nworksheet.getColumn(3).outlineLevel = 1;\nexpect(worksheet.getColumn(3).collapsed).to.be.true;\n\nworksheet.properties.outlineLevelCol = 2;\nexpect(worksheet.getColumn(3).collapsed).to.be.false;\n```\n\n----------------------------------------\n\nTITLE: Row Model Structure in ExcelJS\nDESCRIPTION: Model representing a row in a worksheet, containing row number, cell array, and column range information.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    // row number\n    number: 1,\n    cells: [\n        // array of cell models\n    ],\n\n    // min column number\n    min: 1,\n\n    // maximum column number\n    max: 6\n}\n```\n\n----------------------------------------\n\nTITLE: Setting Cell Values to Null in ExcelJS\nDESCRIPTION: Example of setting a cell value to null in ExcelJS, which indicates the absence of a value and typically won't be stored when written to file except for merged cells.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_63\n\nLANGUAGE: javascript\nCODE:\n```\nworksheet.getCell('A1').value = null;\n```\n\n----------------------------------------\n\nTITLE: Number Cell Model in ExcelJS\nDESCRIPTION: Model for a cell containing a numeric value.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_5\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    address: \"B1\",\n    type: 2,\n    value: 5\n}\n```\n\n----------------------------------------\n\nTITLE: Conditional Formatting Types and Properties in ExcelJS\nDESCRIPTION: Detailed explanation of different conditional formatting types available in ExcelJS. Documents the type-specific properties, options and structure for implementing various formatting rules.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_15\n\nLANGUAGE: plaintext\nCODE:\n```\nNotes:\n* Formulae based on cell values use the top-left addr as this gets translated\n* Some iconSet types are 'natively' supported: (assumed)\n* Some iconSet types require extLst:\n  * 3Triangles | 3Stars | 5Boxes\n* extLst XML appears similar to native except that attributes are often shifted to element texts\n\n// Conditional Formatting Value Object\ntype CFVO {\n  type: min | max | percentile | num | percent | formula | autoMin | autoMax\n  val: N\n}\n\nTypes:\n  expression: the formula returns true or false\n  cellIs:\n    operator: greaterThan | lessThan | equal | between\n    formulae: [compare value(s)]\n  top10:\n    percent: 1 | undefined (false)\n    bottom: 1 | undefined (false)\n    rank: N\n  aboveAverage:\n    aboveAverage: 0 | undefined (true)\n  dataBar:\n    dataBar:\n      cfvo: [CFVO]\n      color: rgb=\"argb\" | theme=\"n\"\n      showValue: 0 | undefined (true)\n      borderColor: Colour\n      negativeFillColor: Colour\n      negativeBorderColor?: Colour\n      negativeBarColorSameAsPositive: 0 | undefined (true)\n      negativeBarBorderColorSameAsPositive: 0 | undefined (true)\n      axisColor: Colour\n      gradient: 0 | undefined (true)\n      border: 1 | undefined (false)\n      minLength: 0\n      maxLength: 100\n      axisPosition: middle | none | undefined (auto)\n      direction: rightToLeft | undefined (lToR)\n      # solid fill requires the exeLst bit\n  colorScale:\n    cfvo: [CFVO] # 2 or 3\n    color: [rgb=\"argb\"]\n  iconSet:\n    iconSet\n      iconSet:\n        3Arrows | 4Arrows | 5Arrows | 3ArrowsGray | 4ArrowsGray | 5ArrowsGray | 3Triangles |\n        3TrafficLights (*) | 3Signs | 4RedToBlack | 3TrafficLights2 | 4TrafficLights\n        3Symbols3 | 3Flags | Symbols2 |\n        5Quarters | 4Rating | 5Rating | 3Stars | 5Boxes\n      cfvo: [CFVO] # 2, 3, 4, 5 cfvo points\n      reverse: 1 | undefined (false)\n      showValue: 0 | undefined (true)\n      custom: 1 | undefined (false) # meaning mixed icons\n      cfIcon: [{iconSet: \"name\", iconId: 0..N}]\n    # 3Stars is only in extLst because the stars are proportionately filled?\n  containsText:\n    type: containsText | containsBlanks | notContainsBlanks | containsErrors | notContainsErrors\n    operator: containsText\n    text: \"the text\"\n    formulae: An actual true/false formula\n  timePeriod:\n    timePeriod: thisWeek | lastWeek | nextWeek | yesterday | today | tomorrow | last7Days | lastMonth | nextMonth\n    formulae: An actual true/false formula\n```\n\n----------------------------------------\n\nTITLE: Date Cell Model in ExcelJS\nDESCRIPTION: Model for a cell containing a date value.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_7\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    address: \"C1\",\n    type: 3,\n    value: new Date()\n}\n```\n\n----------------------------------------\n\nTITLE: Excel XML Page Margins Example\nDESCRIPTION: XML snippet showing how page margins are defined in Excel's Open XML format. These margins are specified in inches and include left, right, top, bottom, header, and footer margins.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_2\n\nLANGUAGE: xml\nCODE:\n```\n<pageMargins left=\"0.25\" right=\"0.25\" top=\"0.75\" bottom=\"0.75\" header=\"0.3\" footer=\"0.3\"/>\n```\n\n----------------------------------------\n\nTITLE: Formula Cell Model in ExcelJS\nDESCRIPTION: Model for a cell containing a formula and its calculated result.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_8\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    address: \"D1\",\n    type: 4,\n    formula: \"A1+A2\",\n    result: 7\n}\n```\n\n----------------------------------------\n\nTITLE: Excel XML Fit-to-Page Setup Example\nDESCRIPTION: XML snippet showing how the fit-to-page setting is configured in Excel's sheet properties. This setting determines whether the worksheet should be scaled to fit a specific number of pages.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_4\n\nLANGUAGE: xml\nCODE:\n```\n<sheetPr>\n\t<pageSetUpPr fitToPage=\"1\"/>\n</sheetPr>\n```\n\n----------------------------------------\n\nTITLE: Defining Page Setup Properties in JavaScript\nDESCRIPTION: A JavaScript object structure for configuring Excel worksheet page setup properties including margins, orientation, paper size, and print options. This serves as a proposed API design for the ExcelJS library.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_0\n\nLANGUAGE: javascript\nCODE:\n```\nsheet.pageSetup = {\n    // in sheet\n    margins: {\n        left: 0.25, right: 0.25, top: 0.75, bottom: 0.75, header: 0.3, footer: 0.3\n    },\n    orientation: ['portrait(*)', 'landscape'],\n    pageOrder: ['overThenDown', 'downThenOver(*)'],\n    blackAndWhite: [true,  false(*)],\n    draft: [true,  false(*)],\n    cellComments: ['atEnd', 'asDisplayed', 'None(*)'',\n    errors: ['dash', 'blank', 'NA', 'displayed(*)''],\n    scale: 90(*),\n    fitToWidth: 2,\n    fitToHeight: 3,\n    paperSize: 9,\n    showRowColHeaders: [true, false(*)],\n    showGridLines: [true, false(*)],\n    horizontalCentered: [true, false(*)],\n    verticalCentered: [true, false(*)],\n\n    rowBreaks: [5,7],\n    colBreaks: [3,6,9],\n\n    // phase 2\n    header: {\n        odd: {\n            left: '',\n            center: '&[Page] of &[Pages]',\n            right: '',\n            raw: '&C&P of &N' // raw supercedes the others\n        },\n        even: {},  first: {}\n    },\n    footer: {}, // as per header\n\n    // defined names - phase 3\n    printArea: 'A1:D11',\n    printTitles: {\n        rows: '1:2' || '$1:$2' || 1 || '$1',\n        columns: 'B:C' || '$B:$C' | 'A' || '$A'\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Excel XML Background Image Configuration\nDESCRIPTION: XML examples showing how background images are referenced in Excel's sheet XML and relationship files. These images are used as the background for worksheets.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_8\n\nLANGUAGE: xml\nCODE:\n```\n<picture r:id=\"rId2\"/>\n```\n\nLANGUAGE: xml\nCODE:\n```\n<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\" Target=\"../media/image2.png\"/>\n```\n\n----------------------------------------\n\nTITLE: Excel XML Page Setup Examples\nDESCRIPTION: A collection of XML examples showing different page setup configurations in Excel's Open XML format. These examples demonstrate various options including paper size, orientation, print quality, and scaling settings.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_3\n\nLANGUAGE: xml\nCODE:\n```\n<pageSetup paperSize=\"9\" orientation=\"portrait\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n<pageSetup paperSize=\"119\" pageOrder=\"overThenDown\" orientation=\"portrait\" blackAndWhite=\"1\"\n    draft=\"1\" cellComments=\"atEnd\" errors=\"dash\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n<pageSetup paperSize=\"119\" orientation=\"portrait\" blackAndWhite=\"1\" draft=\"1\" cellComments=\"asDisplayed\"\n    errors=\"blank\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n<pageSetup paperSize=\"119\" orientation=\"portrait\" errors=\"NA\" horizontalDpi=\"4294967295\" verticalDpi=\"4294967295\" r:id=\"rId1\"/>\n<pageSetup paperSize=\"119\" scale=\"95\" fitToWidth=\"2\" fitToHeight=\"3\" orientation=\"landscape\" r:id=\"rId1\"/>\n```\n\n----------------------------------------\n\nTITLE: Excel XML Print Titles Definition\nDESCRIPTION: XML example showing how print titles (rows and columns repeated on each page) are defined in Excel's workbook XML. These settings specify which rows and columns should be repeated on each printed page.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_9\n\nLANGUAGE: xml\nCODE:\n```\n<definedName name=\"_xlnm.Print_Titles\" localSheetId=\"0\">Sheet1!$A:$B,Sheet1!$1:$2</definedName>\n```\n\n----------------------------------------\n\nTITLE: Excel XML Print Area Definition\nDESCRIPTION: XML examples showing how print areas are defined in Excel's workbook and application XML files. Print areas define which cells should be included when the worksheet is printed.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_6\n\nLANGUAGE: xml\nCODE:\n```\n<definedNames>\n\t<definedName name=\"_xlnm.Print_Area\" localSheetId=\"0\">Sheet1!$A$1:$C$11</definedName>\n</definedNames>\n```\n\nLANGUAGE: xml\nCODE:\n```\n<TitlesOfParts>\n\t<vt:vector size=\"2\" baseType=\"lpstr\">\n\t\t<vt:lpstr>Sheet1</vt:lpstr>\n\t\t<vt:lpstr>Sheet1!Print_Area</vt:lpstr>\n\t</vt:vector>\n</TitlesOfParts>\n```\n\n----------------------------------------\n\nTITLE: Excel XML Headers and Footers Examples\nDESCRIPTION: XML examples showing various header and footer configurations in Excel's sheet XML. These examples demonstrate the use of formatting codes and placeholders for dynamic content.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_10\n\nLANGUAGE: xml\nCODE:\n```\n<headerFooter>\n\t<oddHeader>Page &amp;P</oddHeader>\n\t<oddFooter>Page &amp;P</oddFooter>\n</headerFooter>\n<headerFooter>\n\t<oddHeader>Page &amp;P of &amp;N</oddHeader>\n\t<oddFooter>&amp;A</oddFooter>\n</headerFooter>\n<headerFooter differentOddEven=\"1\" differentFirst=\"1\">\n\t<oddHeader>&amp;L&amp;B Confidential&amp;B&amp;C&amp;D&amp;RPage &amp;P</oddHeader>\n\t<oddFooter>&amp;F</oddFooter>\n</headerFooter>\n<headerFooter>\n\t<oddHeader>&amp;Z&amp;F</oddHeader>\n\t<oddFooter>Prepared by Guyon Roche &amp;D&amp;RPage &amp;P</oddFooter>\n</headerFooter>\n<headerFooter differentOddEven=\"1\" differentFirst=\"1\">\n\t<oddHeader>&amp;L&amp;\"Algerian,Italic\"&amp;14&amp;S&amp;U&amp;X&amp;K05+000Formatted&amp;C&amp;Z&amp;F</oddHeader>\n\t<oddFooter>Prepared by Guyon Roche &amp;D&amp;RPage &amp;P</oddFooter>\n\t<evenHeader>&amp;C&amp;T</evenHeader>\n\t<firstHeader>&amp;L&amp;P of &amp;N&amp;C&amp;D &amp;T\n&amp;Z&amp;F\n&amp;F\n&amp;A</firstHeader>\n</headerFooter>\n<headerFooter differentOddEven=\"1\" differentFirst=\"1\">\n\t<oddHeader>&amp;L&amp;\"Algerian,Italic\"&amp;14&amp;S&amp;U&amp;X&amp;K05+000Formatted&amp;C&amp;K008000Colour Wheel</oddHeader>\n\t<oddFooter>Prepared by Guyon Roche &amp;D&amp;RPage &amp;P</oddFooter>\n\t<evenHeader>&amp;C&amp;T</evenHeader>\n\t<firstHeader>&amp;L&amp;KAFD680RGB&amp;C&amp;KFF0000Std Colour&amp;R&amp;K09+059Purple Accent 6 60%</firstHeader>\n</headerFooter>\n```\n\n----------------------------------------\n\nTITLE: Excel XML Japanese Text with Phonetic Guides\nDESCRIPTION: XML examples showing how Japanese text with phonetic guides (furigana) is stored in Excel's shared strings XML. This demonstrates the use of rPh elements for pronunciation guides in Katakana.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_11\n\nLANGUAGE: xml\nCODE:\n```\n<si>\n <t>(a japanese text in KANJI)</t>\n <rPh sb=\"0\" eb=\"1\">\n  <t>(its pronounciation in KATAKANA)</t>\n </rPh>\n</si>\n<si>\n   <t>役割</t>  <!-- role  in English -->\n   <rPh sb=\"0\" eb=\"2\">\n      <t>ヤクワリ</t> <!-- Japanese phonic symbol called Katakana of role -->\n   </rPh>\n   <phoneticPr fontId=\"1\" />\n</si>\n```\n\n----------------------------------------\n\nTITLE: Chart Sheet Structure References in ExcelJS\nDESCRIPTION: Describes the file paths and XML structures needed for implementing chart sheets in Excel. References where chart data should be stored in the Excel file structure.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_13\n\nLANGUAGE: plaintext\nCODE:\n```\nChart as sheet\n\n[Content_Types].xml\n  chartsheets, charts, drawings, etc\n\napp.xml\n  HeadingPairs\n    Charts: 1\n  TitleOfParts\n    Chart sheet\n\n/xl/charts/*\n/xl/chartsheets/*\n/xl/drawings/\n```\n\n----------------------------------------\n\nTITLE: XML Structure for Comments in ExcelJS\nDESCRIPTION: Defines the XML structure for cell comments in Excel worksheets. The structure includes author information and comment text with formatting details like font, size, and color.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/TODO.txt#2025-04-11_snippet_12\n\nLANGUAGE: xml\nCODE:\n```\n<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n<comments xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\">\n\t<authors>\n\t\t<author>Author</author>\n\t</authors>\n\t<commentList>\n\t\t<comment ref=\"A1\" authorId=\"0\" shapeId=\"0\">\n\t\t\t<text>\n\t\t\t\t<r>\n\t\t\t\t\t<rPr>\n\t\t\t\t\t\t<b/>\n\t\t\t\t\t\t<sz val=\"9\"/>\n\t\t\t\t\t\t<color indexed=\"81\"/>\n\t\t\t\t\t\t<rFont val=\"Tahoma\"/>\n\t\t\t\t\t\t<charset val=\"1\"/>\n\t\t\t\t\t</rPr><t>Author:</t>\n\t\t\t\t</r><r>\n\t\t\t\t\t<rPr>\n\t\t\t\t\t\t<sz val=\"9\"/>\n\t\t\t\t\t\t<color indexed=\"81\"/>\n\t\t\t\t\t\t<rFont val=\"Tahoma\"/>\n\t\t\t\t\t\t<charset val=\"1\"/>\n\t\t\t\t\t</rPr><t xml:space=\"preserve\">\nIs it me you're looking for</t>\n\t\t\t\t</r>\n\t\t\t</text>\n\t\t</comment>\n\t</commentList>\n</comments>\n```\n\n----------------------------------------\n\nTITLE: Null Cell Model in ExcelJS\nDESCRIPTION: Model for an empty cell with only address and type information.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_3\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    address: \"A1\",\n    type: 0\n}\n```\n\n----------------------------------------\n\nTITLE: Injecting Custom Promise Library in ExcelJS\nDESCRIPTION: Code snippet demonstrating how to restore Bluebird promises in ExcelJS using the dependency injection feature. This allows for replacing the native Promise implementation with Bluebird which has additional features.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_81\n\nLANGUAGE: javascript\nCODE:\n```\nExcelJS.config.setValue('promise', require('bluebird'));\n```\n\n----------------------------------------\n\nTITLE: Merge Cell Model in ExcelJS\nDESCRIPTION: Model for a merged cell referencing its master cell.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_4\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    address: \"B1\",\n    type: 1,\n    master: \"A1\"\n}\n```\n\n----------------------------------------\n\nTITLE: Installing ExcelJS via npm\nDESCRIPTION: Command to install the ExcelJS library using npm package manager. This is the primary method to add the library to your project dependencies.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\nnpm install exceljs\n```\n\n----------------------------------------\n\nTITLE: String Cell Model in ExcelJS\nDESCRIPTION: Model for a cell containing a text value.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_6\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    address: \"B1\",\n    type: 2,\n    value: \"Hello, World!\"\n}\n```\n\n----------------------------------------\n\nTITLE: Importing ES5 Version with Polyfills\nDESCRIPTION: Importing ES5-compatible version of ExcelJS with required polyfills for older Node.js versions.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\nrequire('core-js/modules/es.promise');\nrequire('core-js/modules/es.string.includes');\nrequire('core-js/modules/es.object.assign');\nrequire('core-js/modules/es.object.keys');\nrequire('core-js/modules/es.symbol');\nrequire('core-js/modules/es.symbol.async-iterator');\nrequire('regenerator-runtime/runtime');\n\nconst ExcelJS = require('exceljs/dist/es5');\n```\n\n----------------------------------------\n\nTITLE: Hyperlink Cell Model in ExcelJS\nDESCRIPTION: Model for a cell containing a hyperlink with display text and URL.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/MODEL.md#2025-04-11_snippet_9\n\nLANGUAGE: javascript\nCODE:\n```\n{\n    \"address\": \"F1\",\n    \"type\": 5,\n    \"text\": \"www.link.com\",\n    \"hyperlink\": \"http://www.link.com\"\n}\n```\n\n----------------------------------------\n\nTITLE: IE11 Unicode Regex Polyfill\nDESCRIPTION: Polyfill implementation for supporting unicode regex patterns in IE11.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_3\n\nLANGUAGE: javascript\nCODE:\n```\nconst rewritePattern = require('regexpu-core');\nconst {generateRegexpuOptions} = require('@babel/helper-create-regexp-features-plugin/lib/util');\n\nconst {RegExp} = global;\ntry {\n  new RegExp('a', 'u');\n} catch (err) {\n  global.RegExp = function(pattern, flags) {\n    if (flags && flags.includes('u')) {\n      return new RegExp(rewritePattern(pattern, flags, generateRegexpuOptions({flags, pattern})));\n    }\n    return new RegExp(pattern, flags);\n  };\n  global.RegExp.prototype = RegExp.prototype;\n}\n```\n\n----------------------------------------\n\nTITLE: Importing ExcelJS Module\nDESCRIPTION: Basic import of the ExcelJS library in Node.js environment.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/README.md#2025-04-11_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nconst ExcelJS = require('exceljs');\n```\n\n----------------------------------------\n\nTITLE: Iterating Over All Events in ExcelJS v4 Stream Reading\nDESCRIPTION: This code shows how to iterate over all events during stream reading of an Excel file using ExcelJS v4. It allows processing of shared strings, worksheets, and hyperlinks separately.\nSOURCE: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md#2025-04-11_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nconst options = {\n  sharedStrings: 'emit',\n  hyperlinks: 'emit',\n  worksheets: 'emit',\n};\nconst workbook = new ExcelJS.stream.xlsx.WorkbookReader('./file.xlsx', options);\nfor await (const {eventType, value} of workbook.parse()) {\n  switch (eventType) {\n    case 'shared-strings':\n      // value is the shared string\n    case 'worksheet':\n      // value is the worksheetReader\n    case 'hyperlinks':\n      // value is the hyperlinksReader\n  }\n}\n```"
  }
]