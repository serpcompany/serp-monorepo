[
  {
    "owner": "datadog",
    "repo": "datadog-agent",
    "content": "TITLE: Defining Component Dependencies in Go\nDESCRIPTION: Shows how to define the Requires struct for a component, specifying dependencies on other components like config and log. This structure is used by Fx for dependency injection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_3\n\nLANGUAGE: go\nCODE:\n```\npackage zstdimpl\n\nimport (\n    \"fmt\"\n\n    config \"github.com/DataDog/datadog-agent/comp/core/config/def\"\n    log \"github.com/DataDog/datadog-agent/comp/core/log/def\"\n)\n\n// Here, list all components and other types known by Fx that you need.\n// To be used in `fx` folders, type and field need to be public.\n//\n// In this example, you need config and log components.\ntype Requires struct {\n    Conf config.Component\n    Log  log.Component\n}\n```\n\n----------------------------------------\n\nTITLE: Viewing Kubelet Volume and Process Metrics in Prometheus Format\nDESCRIPTION: A comprehensive sample of Prometheus-formatted metrics from Kubelet, including volume statistics (capacity, usage, inodes), Kubernetes build information, and process metrics (CPU, memory, file descriptors). The metrics show data for persistent volume claims in the unit-test namespace and provide system resource utilization information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_30\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_volume_stats_available_bytes gauge\nkubelet_volume_stats_available_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 9.785049088e+10\nkubelet_volume_stats_available_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 9.8636845056e+10\n# HELP kubelet_volume_stats_capacity_bytes Capacity in bytes of the volume\n# TYPE kubelet_volume_stats_capacity_bytes gauge\nkubelet_volume_stats_capacity_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 1.05555197952e+11\nkubelet_volume_stats_capacity_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 1.05555197952e+11\n# HELP kubelet_volume_stats_inodes Maximum number of inodes in the volume\n# TYPE kubelet_volume_stats_inodes gauge\nkubelet_volume_stats_inodes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 6.5536e+06\nkubelet_volume_stats_inodes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 6.5536e+06\n# HELP kubelet_volume_stats_inodes_free Number of free inodes in the volume\n# TYPE kubelet_volume_stats_inodes_free gauge\nkubelet_volume_stats_inodes_free{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 6.538687e+06\nkubelet_volume_stats_inodes_free{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 6.535645e+06\n# HELP kubelet_volume_stats_inodes_used Number of used inodes in the volume\n# TYPE kubelet_volume_stats_inodes_used gauge\nkubelet_volume_stats_inodes_used{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 14913\nkubelet_volume_stats_inodes_used{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 17955\n# HELP kubelet_volume_stats_used_bytes Number of used bytes in the volume\n# TYPE kubelet_volume_stats_used_bytes gauge\nkubelet_volume_stats_used_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 2.319220736e+09\nkubelet_volume_stats_used_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 1.53286656e+09\n# HELP kubernetes_build_info A metric with a constant '1' value labeled by major, minor, git version, git commit, git tree state, build date, Go version, and compiler from which Kubernetes was built, and platform on which it is running.\n# TYPE kubernetes_build_info gauge\nkubernetes_build_info{buildDate=\"2019-12-11T12:38:25Z\",compiler=\"gc\",gitCommit=\"575467a0eaf3ca1f20eb86215b3bde40a5ae617a\",gitTreeState=\"clean\",gitVersion=\"v1.14.10\",goVersion=\"go1.12.12\",major=\"1\",minor=\"14\",platform=\"linux/amd64\"} 1\n# HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.\n# TYPE process_cpu_seconds_total counter\nprocess_cpu_seconds_total 2239.79\n# HELP process_max_fds Maximum number of open file descriptors.\n# TYPE process_max_fds gauge\nprocess_max_fds 1e+06\n# HELP process_open_fds Number of open file descriptors.\n# TYPE process_open_fds gauge\nprocess_open_fds 44\n# HELP process_resident_memory_bytes Resident memory size in bytes.\n# TYPE process_resident_memory_bytes gauge\nprocess_resident_memory_bytes 9.8013184e+07\n# HELP process_start_time_seconds Start time of the process since unix epoch in seconds.\n# TYPE process_start_time_seconds gauge\nprocess_start_time_seconds 1.57767514228e+09\n# HELP process_virtual_memory_bytes Virtual memory size in bytes.\n# TYPE process_virtual_memory_bytes gauge\nprocess_virtual_memory_bytes 1.405288448e+09\n# HELP process_virtual_memory_max_bytes Maximum amount of virtual memory available in bytes.\n# TYPE process_virtual_memory_max_bytes gauge\nprocess_virtual_memory_max_bytes -1\n# HELP rest_client_request_duration_seconds Request latency in seconds. Broken down by verb and URL.\n```\n\n----------------------------------------\n\nTITLE: Example SECL Rule for Linux File Access in JavaScript\nDESCRIPTION: Provides a specific example of a SECL rule for a Linux system. This rule checks for access to the /etc/shadow file while excluding a specific process.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/agent_expressions.md#2025-04-22_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/etc/shadow\" && process.file.path not in [\"/usr/sbin/vipw\"]\n```\n\n----------------------------------------\n\nTITLE: Collecting Configurations from Multiple Providers in Go\nDESCRIPTION: This snippet demonstrates how to iterate through a list of config providers, collect configurations from each, and append them to a slice of CheckConfig objects. It showcases the usage of the ConfigProvider interface.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/providers/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\nvar configs []loader.CheckConfig\nfor _, provider := range configProviders {\n  c, _ := provider.Collect(ctx)\n  configs = append(configs, c...)\n}\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Cluster Agent with API Key in Bash\nDESCRIPTION: This snippet demonstrates how to start the Datadog Cluster Agent using an environment variable to set the API key. It's essential for authenticating the agent with Datadog's services.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/clusteragent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nDD_API_KEY=12345678990 ./bin/datadog-cluster-agent/datadog-cluster-agent\n```\n\n----------------------------------------\n\nTITLE: Testing Component Interface in Go\nDESCRIPTION: Creates an instance of the compression component and tests its Compress method using the initialized dependencies.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/testing.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\npackage implzstd\n\nimport (\n  \"testing\"\n\n  configmock \"github.com/DataDog/datadog-agent/comp/core/config/mock\"\n  logmock \"github.com/DataDog/datadog-agent/comp/core/log/mock\"\n)\n\nfunc TestCompress(t *testing.T) {\n  logComponent := configmock.New(t)\n  configComponent := logmock.New(t)\n  \n  requires := Requires{\n    Conf: configComponent,\n    Log: logComponent,\n  }\n  \n  provides := NewComponent(requires)\n  component := provides.Comp\n  \n  result, err := component.Compress([]byte(\"Hello World\"))\n  assert.Nil(t, err)\n\n  assert.Equal(t, ..., result)\n}\n```\n\n----------------------------------------\n\nTITLE: JSON Schema for Datadog Agent Event Structure\nDESCRIPTION: This JSON schema defines the structure for events processed by the Datadog Agent, including definitions for various contexts and event types such as processes, files, registry events, and containers. It specifies required properties and provides detailed descriptions for each field.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"agent\": {\n            \"$ref\": \"#/$defs/AgentContext\"\n        },\n        \"title\": {\n            \"type\": \"string\"\n        },\n        \"evt\": {\n            \"$ref\": \"#/$defs/EventContext\"\n        },\n        \"date\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\"\n        },\n        \"file\": {\n            \"$ref\": \"#/$defs/FileEvent\"\n        },\n        \"exit\": {\n            \"$ref\": \"#/$defs/ExitEvent\"\n        },\n        \"process\": {\n            \"$ref\": \"#/$defs/ProcessContext\"\n        },\n        \"container\": {\n            \"$ref\": \"#/$defs/ContainerContext\"\n        },\n        \"registry\": {\n            \"$ref\": \"#/$defs/RegistryEvent\"\n        },\n        \"usr\": {\n            \"$ref\": \"#/$defs/UserContext\"\n        },\n        \"permission_change\": {\n            \"$ref\": \"#/$defs/ChangePermissionEvent\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"agent\",\n        \"title\"\n    ]\n}\n```\n\n----------------------------------------\n\nTITLE: Service Listeners Auto-discovery Support Matrix\nDESCRIPTION: Markdown table showing template variable support across different listener types, including Docker, Containerd, Podman, ECS, Kubelet, KubeService, and KubeEndpoints. Indicates support for various features like AD identifiers, Host, Port, Tag, Pid, Env, and Hostname.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/listeners/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n| Listener | AD identifiers | Host | Port | Tag | Pid | Env | Hostname\n|---|---|---|---|---|---|---|---|\n| Docker | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n| Containerd | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ✅ |\n| Podman | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |\n| ECS | ✅ | ✅ | ❌ | ✅ | ❌ | ✅ | ❌ |\n| Kubelet | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ❌ |\n| KubeService | ✅ | ✅ | ✅ | ❌ | ❌ | ✅ | ❌ |\n| KubeEndpoints | ✅ | ✅ | ✅ | ✅ | ❌ | ✅ | ❌ |\n```\n\n----------------------------------------\n\nTITLE: Implementing a Basic Python Custom Check\nDESCRIPTION: Basic structure of a Python custom check class inheriting from AgentCheck and implementing the check method.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/README.md#2025-04-22_snippet_1\n\nLANGUAGE: python\nCODE:\n```\nfrom datadog_checks.checks import AgentCheck\n\nclass MyCheck(AgentCheck):\n    def check(self, instance):\n        # Collect metrics, emit events, submit service checks,\n        # ...\n```\n\n----------------------------------------\n\nTITLE: Consuming Grouped Values from Fx in Go\nDESCRIPTION: Shows how to receive all values added to a named 'server' group as a slice using struct field tags. Demonstrates the pattern for collecting all values contributed to an Fx group.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/common-patterns.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\ntype Requires struct {\n    Endpoints []Endpoint `group:\"server\"`\n}\n```\n\n----------------------------------------\n\nTITLE: Implementing ZSTD Compression Component in Go\nDESCRIPTION: Provides a complete example of a ZSTD compression component implementation, including the Requires and Provides structs, the private compressor struct, and the NewComponent function. It also includes sample implementations of the Compress and Decompress methods.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_5\n\nLANGUAGE: go\nCODE:\n```\npackage zstdimpl\n\nimport (\n    \"fmt\"\n\n    compression \"github.com/DataDog/datadog-agent/comp/compression/def\"\n    config \"github.com/DataDog/datadog-agent/comp/core/config/def\"\n    log \"github.com/DataDog/datadog-agent/comp/core/log/def\"\n)\n\ntype Requires struct {\n    Conf config.Component\n    Log  log.Component\n}\n\ntype Provides struct {\n    Comp compression.Component\n}\n\n// The actual type implementing the 'Component' interface. This type MUST be private, you need the guarantee that\n// components can only be used through their respective interfaces.\ntype compressor struct {\n    // Keep a ref on the config and log components, so that you can use them in the 'compressor' methods\n    conf config.Component\n    log  log.Component\n\n    // any other field you might need\n}\n\n// NewComponent returns a new ZSTD implementation for the compression component\nfunc NewComponent(reqs Requires) Provides {\n    // Here, do whatever is needed to build a ZSTD compression comp.\n\n    // And create your component\n    comp := &compressor{\n        conf: reqs.Conf,\n        log:  reqs.Log,\n    }\n\n    return Provides{\n        comp: comp,\n    }\n}\n\n//\n// You then need to implement all methods from your 'compression.Component' interface\n//\n\n// Compress compresses the input data using ZSTD\nfunc (c *compressor) Compress(data []byte) ([]byte, error) {\n    c.log.Debug(\"compressing a buffer with ZSTD\")\n\n    // [...]\n    return compressData, nil\n}\n\n// Decompress decompresses the input data using ZSTD.\nfunc (c *compressor) Decompress(data []byte) ([]byte, error) {\n    c.log.Debug(\"decompressing a buffer with ZSTD\")\n\n    // [...]\n    return compressData, nil\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Compression Component Interface in Go\nDESCRIPTION: Demonstrates how to define a component interface in Go, using a compression component as an example. It shows the structure of the interface and includes necessary documentation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\n// Package compression contains all public type and interfaces for the compression component\npackage compression\n\n// team: <your team>\n\n// Component describes the interface implemented by all compression implementations.\ntype Component interface {\n    // Compress compresses the input data.\n    Compress([]byte) ([]byte, error)\n\n    // Decompress decompresses the input data.\n    Decompress([]byte) ([]byte, error)\n}\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for NetworkFlowMonitor in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing network flow monitor events in the Datadog Agent. It includes properties for the network device and a list of flows with network statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_13\n\nLANGUAGE: JSON\nCODE:\n```\n\"NetworkFlowMonitor\": {\n    \"properties\": {\n        \"device\": {\n            \"$ref\": \"#/$defs/NetworkDevice\",\n            \"description\": \"device is the network device on which the event was captured\"\n        },\n        \"flows\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/Flow\"\n            },\n            \"type\": \"array\",\n            \"description\": \"flows is the list of flows with network statistics that were captured\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"NetworkFlowMonitorSerializer defines a network monitor event serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Component File Hierarchy in Go\nDESCRIPTION: Illustrates the file hierarchy for components in the Datadog Agent project, showing the structure of folders and their purposes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\ncomp /\n  <bundle name> /        <-- Optional\n    <comp name> /\n      def /              <-- The folder containing the component interface and ALL its public types.\n      impl /             <-- The only or primary implementation of the component.\n      impl-<alternate> / <-- An alternate implementation.\n      impl-none /        <-- Optional. A noop implementation.\n      fx /               <-- All fx related logic for the primary implementation, if any.\n      fx-<alternate> /   <-- All fx related logic for a specific implementation.\n      mock /             <-- The mock implementation of the component to ease testing.\n```\n\n----------------------------------------\n\nTITLE: Initializing and Using the Forwarder in Go\nDESCRIPTION: Example showing how to initialize a forwarder with multiple domains and API keys, start it, submit payloads, and stop it. The forwarder sends each payload to every domain/API key pair asynchronously.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/forwarder/defaultforwarder/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\nKeysPerDomains := map[string][]string{\n\t\"http://api.datadog.com\": {\"my_secret_key_1\", \"my_secret_key_2\"},\n\t\"http://debug.api.com\":   {\"secret_api\"},\n}\n\nforwarder := forwarder.NewForwarder(KeysPerDomains)\nforwarder.NumberOfWorkers = 1 // default: config.GetInt(\"forwarder_num_workers\")\nforwarder.Start()\n\n// ...\n\npayload1 := []byte(\"some payload\")\npayload2 := []byte(\"another payload\")\nforwarder.SubmitSeries(Payloads{&payload1, &payload2}, ...)\n\n// ...\n\nforwarder.Stop()\n```\n\n----------------------------------------\n\nTITLE: Creating a Simple Fx App in Go\nDESCRIPTION: This code creates a basic Fx app that provides a scrubber component and invokes a function to use it. It demonstrates how to combine Fx options to create a functional application.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_3\n\nLANGUAGE: go\nCODE:\n```\nsomeValue = \"my password is hunter2\"\napp := fx.New(\n    fx.Provide(scrubber.NewScrubber),\n    fx.Invoke(func(sc scrubber.Component) {\n        fmt.Printf(\"scrubbed: %s\", sc.ScrubString(somevalue))\n    }))\napp.Run()\n// Output: scrubbed: my password is *******\n```\n\n----------------------------------------\n\nTITLE: Installing Python 3.12 Development Files on Ubuntu\nDESCRIPTION: apt-get command to install Python 3.12 development files on Ubuntu Linux.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nsudo apt-get install python3.12-dev\n```\n\n----------------------------------------\n\nTITLE: Configuring Custom Check Instances in YAML\nDESCRIPTION: Example YAML configuration for multiple instances of an HTTP check, demonstrating how to structure the 'instances' section with different endpoints and authentication methods.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ninstances:\n  - server_url: https://backend1\n    user: user1\n    password: password\n    interval: 60\n  - server_url: https://backend2\n    token: <SOME_AUTH_TOKEN>\n    timeout: 20\n```\n\n----------------------------------------\n\nTITLE: Defining Process JSON Schema\nDESCRIPTION: Comprehensive JSON schema that defines the structure for serializing process information in the Datadog Agent. Includes fields for process identification, user/group details, execution timing, credentials, and various process attributes. The schema enforces required fields (uid, gid) and defines specific data types for each property.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_39\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"Process ID\"\n        },\n        \"ppid\": {\n            \"type\": \"integer\",\n            \"description\": \"Parent Process ID\"\n        },\n        \"tid\": {\n            \"type\": \"integer\",\n            \"description\": \"Thread ID\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"Group ID\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"group\": {\n            \"type\": \"string\",\n            \"description\": \"Group name\"\n        },\n        \"path_resolution_error\": {\n            \"type\": \"string\",\n            \"description\": \"Description of an error in the path resolution\"\n        },\n        \"comm\": {\n            \"type\": \"string\",\n            \"description\": \"Command name\"\n        },\n        \"tty\": {\n            \"type\": \"string\",\n            \"description\": \"TTY associated with the process\"\n        },\n        \"fork_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Fork time of the process\"\n        },\n        \"exec_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exec time of the process\"\n        },\n        \"exit_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exit time of the process\"\n        },\n        \"credentials\": {\n            \"$ref\": \"#/$defs/ProcessCredentials\",\n            \"description\": \"Credentials associated with the process\"\n        },\n        \"user_session\": {\n            \"$ref\": \"#/$defs/UserSessionContext\",\n            \"description\": \"Context of the user session for this event\"\n        },\n        \"executable\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"File information of the executable\"\n        },\n        \"interpreter\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"File information of the interpreter\"\n        },\n        \"container\": {\n            \"$ref\": \"#/$defs/ContainerContext\",\n            \"description\": \"Container context\"\n        },\n        \"argv0\": {\n            \"type\": \"string\",\n            \"description\": \"First command line argument\"\n        },\n        \"args\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Command line arguments\"\n        },\n        \"args_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicator of arguments truncation\"\n        },\n        \"envs\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Environment variables of the process\"\n        },\n        \"envs_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicator of environments variable truncation\"\n        },\n        \"is_thread\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicates whether the process is considered a thread (that is, a child process that hasn't executed another program)\"\n        },\n        \"is_kworker\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicates whether the process is a kworker\"\n        },\n        \"is_exec_child\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicates whether the process is an exec following another exec\"\n        },\n        \"source\": {\n            \"type\": \"string\",\n            \"description\": \"Process source\"\n        },\n        \"syscalls\": {\n            \"$ref\": \"#/$defs/SyscallsEvent\",\n            \"description\": \"List of syscalls captured to generate the event\"\n        },\n        \"aws_security_credentials\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/AWSSecurityCredentials\"\n            },\n            \"type\": \"array\",\n            \"description\": \"List of AWS Security Credentials that the process had access to\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\"\n    ],\n    \"description\": \"ProcessSerializer serializes a process to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Implementing Optional Dependencies in Go Components\nDESCRIPTION: This code snippet demonstrates how to use the option.Option type to express optional dependencies in a component. It shows the structure definition and usage in a NewMetadata function, allowing interaction with optional components without forcing their inclusion in the binary.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/faq.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ntype Requires struct {\n    SysprobeConf optional.Option[sysprobeconfig.Component]\n    [...]\n}\n\nfunc NewMetadata(deps Requires) (metadata.Component) {\n    if sysprobeConf, found := deps.SysprobeConf.Get(); found {\n        // interact with sysprobeconfig\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Autodiscovery Architecture Diagram\nDESCRIPTION: ASCII diagram showing the high-level architecture of the autodiscovery package, illustrating data flow between components like Config Providers, Listeners, and the MetaScheduler. It demonstrates how templates and services are reconciled and how configuration is processed.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/README.md#2025-04-22_snippet_0\n\nLANGUAGE: text\nCODE:\n```\nKubernetes\n    API──────┐\n             │\nCluster      │ ┌────────────────┐\n  Agent────┐ │ │ Workload Meta  │\n           │ │ └──┬──────────┬──┘\n Static    │ │    │          │\n  Files──┐ │ │    │          │\n         │ │ │    │          │\n    ┌────▼─▼─▼────▼──┐    ┌──▼─────────────┐\n    │Config Providers│    │   Listeners    │\n    └──┬─────┬───────┘    └────────┬───────┘\n       │     │                     │\n       │     │                     │\n       │     │templates    services│\n       │     └────────► │ ◄────────┤\n       │                │          │\n       │            reconcile      │\n       │                │          │\n       │non-template    │          │\n       │configs         │          │\n       │                │          │\n       │                ▼          │\n       │         ┌─────────────┐   │\n       └────────►│metascheduler│◄──┘\n                 └─────────────┘\n```\n\n----------------------------------------\n\nTITLE: Configuring Single Step Instrumentation in YAML\nDESCRIPTION: Demonstrates how to configure Single Step Instrumentation using YAML to target specific workloads based on pod and namespace labels. It shows examples of installing Python and Java tracers with custom configurations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ninstrumentation:\n  enabled: true\n  targets:\n    - name: \"Python Services\"\n      podSelector:\n        matchLabels:\n          language: \"python\"\n      ddTraceVersions:\n        python: \"default\"\n    - name: \"Java Namespaces\"\n      namespaceSelector:\n        matchLabels:\n          language: \"java\"\n      ddTraceVersions:\n        python: \"default\"\n    - name: \"Python Apps\"\n      podSelector:\n        matchLabels:\n          language: \"python\"\n      ddTraceVersions:\n        python: \"v2\"\n      ddTraceConfigs:\n        - name: \"DD_PROFILING_ENABLED\"\n          value: \"true\"\n        - name: \"DD_DATA_JOBS_ENABLED\"\n          value: \"true\"\n```\n\n----------------------------------------\n\nTITLE: Example Security Agent Metadata Payload\nDESCRIPTION: Example of a complete inventory payload showing the security agent metadata structure. Includes agent version, various configuration sources, hostname, and timestamp. All sensitive information is scrubbed from the configuration fields.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/securityagent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"security_agent_metadata\": {\n        \"agent_version\": \"7.55.0\",\n        \"full_configuration\": \"<entire yaml configuration for security-agent>\",\n        \"provided_configuration\": \"runtime_security_config:\\n  socket: /opt/datadog-agent/run/runtime-security.sock\",\n        \"file_configuration\": \"runtime_security_config:\\n  socket: /opt/datadog-agent/run/runtime-security.sock\",\n        \"agent_runtime_configuration\": \"runtime_block_profile_rate: 5000\",\n        \"environment_variable_configuration\": \"{}\",\n        \"remote_configuration\": \"{}\",\n        \"cli_configuration\": \"{}\",\n        \"source_local_configuration\": \"{}\"\n    }\n    \"hostname\": \"my-host\",\n    \"timestamp\": 1631281754507358895\n}\n```\n\n----------------------------------------\n\nTITLE: Creating a Test Subcommand for Datadog Agent CLI\nDESCRIPTION: Shows how to create a new 'test' subcommand for the Datadog Agent CLI using Cobra and Fx. This example demonstrates the basic structure of a command and how to use fxutil.OneShot for dependency injection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/using-components.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\npackage test\n\nimport (\n// [...]\n)\n\n// Commands returns a slice of subcommands for the 'agent' command.\n//\n// The Agent uses \"cobra\" to create its CLI. The command method is your entrypoint. Here, you're going to create a single\n// command.\nfunc Commands(globalParams *command.GlobalParams) []*cobra.Command {\n    cmd := &cobra.Command{\n        Use:   \"test\",\n        Short: \"a test command for the Agent\",\n        Long:  ``,\n        RunE: func(_ *cobra.Command, _ []string) error {\n            return fxutil.OneShot(\n                <callback>,\n                <list of dependencies>.\n            )\n        },\n    }\n\n    return []*cobra.Command{cmd}\n}\n```\n\n----------------------------------------\n\nTITLE: Using fx.In and fx.Out for Complex Dependencies in Go\nDESCRIPTION: This code demonstrates the use of fx.In and fx.Out structs to manage complex dependencies and provided types. It shows how to define and use these structs in a component constructor.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_7\n\nLANGUAGE: go\nCODE:\n```\ntype dependencies struct {\n    fx.In\n\n    Config config.Component\n    Log log.Component\n    Status status.Component\n)\n\ntype provides struct {\n    fx.Out\n\n    Component\n    // ... (we'll see why this is useful below)\n}\n\nfunc newScrubber(deps dependencies) (provides, error) { // can return an fx.Out struct and other types, such as error\n    // ..\n    return provides {\n        Component: scrubber,\n        // ..\n    }, nil\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Header Provider Interface in Go\nDESCRIPTION: Defines the interface for header status providers, including methods for ordering, naming, and rendering output in JSON, Text, and HTML formats.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/status.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ntype HeaderProvider interface {\n\t// Index is used to choose the order in which the header information is displayed.\n\tIndex() int\n\t// When displaying the Text output the name is render as a header\n\tName() string\n\tJSON(verbose bool, stats map[string]interface{}) error\n\tText(verbose bool, buffer io.Writer) error\n\tHTML(verbose bool, buffer io.Writer) error\n}\n```\n\n----------------------------------------\n\nTITLE: Submitting Service Checks to Datadog Agent Aggregator in Python\nDESCRIPTION: This function allows submitting a service check to the Datadog Agent aggregator. It handles service status, tags, hostname, and additional message information. The function encodes unicode strings and raises exceptions for processing errors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/aggregator.md#2025-04-22_snippet_2\n\nLANGUAGE: python\nCODE:\n```\ndef submit_service_check(check, check_id, name, status, tags, hostname, message):\n    \"\"\"Submit a service check to the aggregator.\n\n    NOTE: If unicode is passed to any of the params accepting it, the\n    string is encoded using the default encoding for the system where the\n    Agent is running. If encoding fails, the function raises `UnicodeError`.\n\n    Args:\n        check (AgentCheck): the check instance calling the function.\n        check_id (string or unicode): unique identifier for the check instance.\n        name (string or unicode): name of the metric.\n        status (index): enumerated type representing the service status.\n        tags (list): list of string or unicode containing tags. Items with unsupported\n            types are silently ignored.\n        hostname (string or unicode): the hostname sending the metric.\n        message (string or unicode): a message to add more info about the status.\n\n    Returns:\n        None.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Implementing a Hello World Custom Check\nDESCRIPTION: Example implementation of a simple 'hello_world' custom check that submits a gauge metric.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/README.md#2025-04-22_snippet_3\n\nLANGUAGE: python\nCODE:\n```\nfrom datadog_checks.checks import AgentCheck\n\nclass MyCheck(AgentCheck):\n    def check(self, instance):\n        self.gauge('hello.world', 1.23, tags=['foo:bar'])\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent with YAML in Kubernetes\nDESCRIPTION: This YAML configuration specifies settings for the Datadog Agent in a Kubernetes environment. It enables event collection and the Cluster Agent with metrics provider, while disabling APM socket, process agent, and related features.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/cluster-agent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  collectEvents: true\n  apm:\n    socketEnabled: false\n  processAgent:\n    enabled: false\n    containerCollection: false\n    processDiscovery: false\nclusterAgent:\n  enabled: true\n  metricsProvider:\n    enabled: true\n```\n\n----------------------------------------\n\nTITLE: Defining File Serialization Schema in JSON\nDESCRIPTION: JSON schema definition for FileSerializer that handles basic file metadata serialization. Includes comprehensive file attributes like path, permissions, timestamps, and mount information. Requires uid and gid fields.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_28\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"path\": {\n            \"type\": \"string\",\n            \"description\": \"File path\"\n        },\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"File basename\"\n        },\n        \"path_resolution_error\": {\n            \"type\": \"string\",\n            \"description\": \"Error message from path resolution\"\n        },\n        \"inode\": {\n            \"type\": \"integer\",\n            \"description\": \"File inode number\"\n        },\n        \"mode\": {\n            \"type\": \"integer\",\n            \"description\": \"File mode\"\n        },\n        \"in_upper_layer\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicator of file OverlayFS layer\"\n        },\n        \"mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"File mount ID\"\n        },\n        \"filesystem\": {\n            \"type\": \"string\",\n            \"description\": \"File filesystem name\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"File User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"File Group ID\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"File user\"\n        },\n        \"group\": {\n            \"type\": \"string\",\n            \"description\": \"File group\"\n        },\n        \"attribute_name\": {\n            \"type\": \"string\",\n            \"description\": \"File extended attribute name\"\n        },\n        \"attribute_namespace\": {\n            \"type\": \"string\",\n            \"description\": \"File extended attribute namespace\"\n        },\n        \"flags\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"File flags\"\n        },\n        \"access_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"File access time\"\n        },\n        \"modification_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"File modified time\"\n        },\n        \"change_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"File change time\"\n        },\n        \"package_name\": {\n            \"type\": \"string\",\n            \"description\": \"System package name\"\n        },\n        \"package_version\": {\n            \"type\": \"string\",\n            \"description\": \"System package version\"\n        },\n        \"hashes\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"List of cryptographic hashes of the file\"\n        },\n        \"hash_state\": {\n            \"type\": \"string\",\n            \"description\": \"State of the hashes or reason why they weren't computed\"\n        },\n        \"mount_path\": {\n            \"type\": \"string\",\n            \"description\": \"MountPath path of the mount\"\n        },\n        \"mount_source\": {\n            \"type\": \"string\",\n            \"description\": \"MountSource source of the mount\"\n        },\n        \"mount_origin\": {\n            \"type\": \"string\",\n            \"description\": \"MountOrigin origin of the mount\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\"\n    ],\n    \"description\": \"FileSerializer serializes a file to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Importing and Using Core Bundle in Datadog Agent\nDESCRIPTION: Shows how to import and use the core bundle in a Datadog Agent command. This example demonstrates importing the core bundle and using the config component from it.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/using-components.md#2025-04-22_snippet_3\n\nLANGUAGE: go\nCODE:\n```\nimport (\n    // We import the core bundle\n    core \"github.com/DataDog/datadog-agent/comp/core\"\n\n    // Then the interfaces we want to use\n    config \"github.com/DataDog/datadog-agent/comp/core/config/def\"\n)\n\n// [...]\n    return fxutil.OneShot(\n        myTestCallback, // The function to call from fxutil.OneShot\n        core.Bundle(),  // This will tell FX how to create the all the components included in the bundle\n    )\n// [...]\n\nfunc myTestCallback(conf config.Component) {\n    api_key := conf.GetString(\"api_key\")\n\n    // [...]\n}\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent with Specific Components in Bash\nDESCRIPTION: Commands to build the Datadog Agent with included or excluded components using the dda inv command. This allows for customization of the final artifact by selecting specific features.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_build.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndda inv agent.build --build-include=zstd,etcd,python\n```\n\nLANGUAGE: bash\nCODE:\n```\ndda inv agent.build --build-exclude=systemd,python\n```\n\n----------------------------------------\n\nTITLE: Loading Checks from Configurations in Go\nDESCRIPTION: This snippet demonstrates how to use different loaders to instantiate check objects from a list of configurations. It iterates through configurations and loaders, attempting to load checks and appending successful results to a slice.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/check/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\n// given a list of configurations, try to load corresponding checks using different loaders\nchecks := []check.Check{}\nfor _, conf := range configs {\n  for _, loader := range loaders {\n    res, err := loader.Load(conf)\n    if err == nil {\n      checks = append(checks, res...)\n    }\n  }\n}\n// `checks` contains one check per configuration instance found.\n```\n\n----------------------------------------\n\nTITLE: Using fx.Invoke for Immediate Execution in Go\nDESCRIPTION: This snippet demonstrates how to use fx.Invoke to execute a function immediately when the Fx app is created. It shows how to require and use a component within an invoked function.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\nfx.Invoke(func(sc scrubber.Component) {\n    fmt.Printf(\"scrubbed: %s\", sc.ScrubString(somevalue))\n})\n```\n\n----------------------------------------\n\nTITLE: Basic Datadog Agent Configuration\nDESCRIPTION: Example of minimal Datadog Agent configuration with API key\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/README.md#2025-04-22_snippet_5\n\nLANGUAGE: yaml\nCODE:\n```\napi_key: <API_KEY>\n```\n\n----------------------------------------\n\nTITLE: Sending Custom Metrics via HTTP POST to Datadog Agent\nDESCRIPTION: Example of submitting custom metrics to the Datadog Agent's HTTP API endpoint. The payload includes a series of metrics with type, metric name, points (timestamp and value), host, and tags.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/common/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"series\": [\n    {\n      \"metric\": \"system.proc.count\",\n      \"points\": [[<TIMESTAMP>, <VALUE>]],\n      \"type\": \"gauge\",\n      \"host\": \"test.example.com\",\n      \"tags\": [\"environment:test\"]\n    }\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent Features in values.yaml for Kubernetes Manifests\nDESCRIPTION: This YAML configuration enables various Datadog monitoring features for Kubernetes deployments. It activates event collection, leader election, logs collection, APM (Application Performance Monitoring), process monitoring, network monitoring, and security agent features including compliance and runtime monitoring.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/all-containers/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  collectEvents: true\n  leaderElection: true\n  logs:\n    enabled: true\n  apm:\n    enabled: true\n  processAgent:\n    enabled: true\n  networkMonitoring:\n    enabled: true\n  securityAgent:\n    compliance:\n      enabled: true\n    runtime:\n      enabled: true\n```\n\n----------------------------------------\n\nTITLE: ChangePermissionEvent Schema Definition\nDESCRIPTION: Defines the structure for permission change events, including details about the user, object path, type, and security descriptors. This schema captures security permission modifications with before and after states.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_3\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"username\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"user_domain\": {\n            \"type\": \"string\",\n            \"description\": \"User domain\"\n        },\n        \"path\": {\n            \"type\": \"string\",\n            \"description\": \"Object name\"\n        },\n        \"type\": {\n            \"type\": \"string\",\n            \"description\": \"Object type\"\n        },\n        \"old_sd\": {\n            \"type\": \"string\",\n            \"description\": \"Original Security Descriptor\"\n        },\n        \"new_sd\": {\n            \"type\": \"string\",\n            \"description\": \"New Security Descriptor\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"ChangePermissionEventSerializer serializes a permission change event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Initializing and Using Dogstatsd Server in Go\nDESCRIPTION: Example showing how to initialize and use the Dogstatsd server with an aggregator instance. The server must be properly initialized before receiving metrics and should be stopped when no longer needed.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/dogstatsd/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\n// you must first initialize the aggregator, see aggregator.InitAggregator\n\n// This will return an already running statd server ready to receive metrics\nstatsd, err := dogstatsd.NewServer(aggregatorInstance.GetBufferedChannels())\n\n// ...\n\nstatsd.Stop()\n```\n\n----------------------------------------\n\nTITLE: Profiling Go Heap with pprof in Datadog Agent\nDESCRIPTION: This command uses the go tool pprof to profile the heap of the Datadog Agent via its pprof HTTP server.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/tools.md#2025-04-22_snippet_1\n\nLANGUAGE: sh\nCODE:\n```\ngo tool pprof http://localhost:5000/debug/pprof/heap\n```\n\n----------------------------------------\n\nTITLE: Defining Workload Protection Event Schema in JSON\nDESCRIPTION: Comprehensive JSON schema definition for Linux system events in Workload Protection. Includes definitions for AWS IMDS events, security credentials, accept events, agent context, BPF events, and other system-level event types.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"$id\": \"https://github.com/DataDog/datadog-agent/tree/main/pkg/security/serializers\",\n    \"$defs\": {\n        \"AWSIMDSEvent\": {\n            \"properties\": {\n                \"is_imds_v2\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"is_imds_v2 reports if the IMDS event follows IMDSv1 or IMDSv2 conventions\"\n                },\n                \"security_credentials\": {\n                    \"$ref\": \"#/$defs/AWSSecurityCredentials\",\n                    \"description\": \"SecurityCredentials holds the scrubbed data collected on the security credentials\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"is_imds_v2\"\n            ],\n            \"description\": \"AWSIMDSEventSerializer serializes an AWS IMDS event to JSON\"\n        },\n        \"AWSSecurityCredentials\": {\n            \"properties\": {\n                \"code\": {\n                    \"type\": \"string\",\n                    \"description\": \"code is the IMDS server code response\"\n                },\n                \"type\": {\n                    \"type\": \"string\",\n                    \"description\": \"type is the security credentials type\"\n                },\n                \"access_key_id\": {\n                    \"type\": \"string\",\n                    \"description\": \"access_key_id is the unique access key ID of the credentials\"\n                },\n                \"last_updated\": {\n                    \"type\": \"string\",\n                    \"description\": \"last_updated is the last time the credentials were updated\"\n                },\n                \"expiration\": {\n                    \"type\": \"string\",\n                    \"description\": \"expiration is the expiration date of the credentials\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"code\",\n                \"type\",\n                \"access_key_id\",\n                \"last_updated\",\n                \"expiration\"\n            ],\n            \"description\": \"AWSSecurityCredentialsSerializer serializes the security credentials from an AWS IMDS request\"\n        },\n        \"AcceptEvent\": {\n            \"properties\": {\n                \"addr\": {\n                    \"$ref\": \"#/$defs/IPPortFamily\",\n                    \"description\": \"Bound address (if any)\"\n                },\n                \"hostnames\": {\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"type\": \"array\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"addr\",\n                \"hostnames\"\n            ],\n            \"description\": \"AcceptEventSerializer serializes a bind event to JSON\"\n        },\n        \"AgentContext\": {\n            \"properties\": {\n                \"rule_id\": {\n                    \"type\": \"string\"\n                },\n                \"rule_version\": {\n                    \"type\": \"string\"\n                },\n                \"rule_actions\": {\n                    \"items\": true,\n                    \"type\": \"array\"\n                },\n                \"policy_name\": {\n                    \"type\": \"string\"\n                },\n                \"policy_version\": {\n                    \"type\": \"string\"\n                },\n                \"version\": {\n                    \"type\": \"string\"\n                },\n                \"os\": {\n                    \"type\": \"string\"\n                },\n                \"arch\": {\n                    \"type\": \"string\"\n                },\n                \"origin\": {\n                    \"type\": \"string\"\n                },\n                \"kernel_version\": {\n                    \"type\": \"string\"\n                },\n                \"distribution\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"rule_id\"\n            ]\n        },\n        \"BPFEvent\": {\n            \"properties\": {\n                \"cmd\": {\n                    \"type\": \"string\",\n                    \"description\": \"BPF command\"\n                },\n                \"map\": {\n                    \"$ref\": \"#/$defs/BPFMap\",\n                    \"description\": \"BPF map\"\n                },\n                \"program\": {\n                    \"$ref\": \"#/$defs/BPFProgram\",\n                    \"description\": \"BPF program\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"cmd\"\n            ],\n            \"description\": \"BPFEventSerializer serializes a BPF event to JSON\"\n        },\n        \"BPFMap\": {\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Name of the BPF map\"\n                },\n                \"map_type\": {\n                    \"type\": \"string\",\n                    \"description\": \"Type of the BPF map\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"BPFMapSerializer serializes a BPF map to JSON\"\n        },\n        \"BPFProgram\": {\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Name of the BPF program\"\n                },\n                \"tag\": {\n                    \"type\": \"string\",\n                    \"description\": \"Hash (sha1) of the BPF program\"\n                },\n                \"program_type\": {\n                    \"type\": \"string\",\n                    \"description\": \"Type of the BPF program\"\n                },\n                \"attach_type\": {\n                    \"type\": \"string\",\n                    \"description\": \"Attach type of the BPF program\"\n                },\n                \"helpers\": {\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"type\": \"array\",\n                    \"description\": \"List of helpers used by the BPF program\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"BPFProgramSerializer serializes a BPF map to JSON\"\n        },\n        \"BindEvent\": {\n            \"properties\": {\n                \"addr\": {\n                    \"$ref\": \"#/$defs/IPPortFamily\",\n                    \"description\": \"Bound address (if any)\"\n                },\n                \"protocol\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"addr\",\n                \"protocol\"\n            ],\n            \"description\": \"BindEventSerializer serializes a bind event to JSON\"\n        },\n        \"CGroupContext\": {\n            \"properties\": {\n                \"id\": {\n                    \"type\": \"string\",\n                    \"description\": \"CGroup ID\"\n                },\n                \"manager\": {\n                    \"type\": \"string\",\n                    \"description\": \"CGroup manager\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"CGroupContextSerializer serializes a cgroup context to JSON\"\n        },\n        \"ConnectEvent\": {\n            \"properties\": {\n                \"addr\": {\n                    \"$ref\": \"#/$defs/IPPortFamily\"\n                },\n                \"hostnames\": {\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"type\": \"array\"\n                },\n                \"protocol\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"addr\",\n                \"hostnames\",\n                \"protocol\"\n            ],\n            \"description\": \"ConnectEventSerializer serializes a connect event to JSON\"\n        },\n        \"ContainerContext\": {\n            \"properties\": {\n                \"id\": {\n                    \"type\": \"string\",\n                    \"description\": \"Container ID\"\n                },\n                \"created_at\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Creation time of the container\"\n                },\n                \"variables\": {\n                    \"$ref\": \"#/$defs/Variables\",\n                    \"description\": \"Variables values\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"ContainerContextSerializer serializes a container context to JSON\"\n        },\n        \"DDContext\": {\n            \"properties\": {\n                \"span_id\": {\n                    \"type\": \"string\",\n                    \"description\": \"Span ID used for APM correlation\"\n                },\n                \"trace_id\": {\n                    \"type\": \"string\",\n                    \"description\": \"Trace ID used for APM correlation\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"DDContextSerializer serializes a span context to JSON\"\n        },\n        \"DNSEvent\": {\n            \"properties\": {\n                \"id\": {\n                    \"type\": \"integer\",\n```\n\n----------------------------------------\n\nTITLE: Implementing Lifecycle Hooks for a Scrubber in Go\nDESCRIPTION: This snippet demonstrates how to add lifecycle hooks to a component using fx.Lifecycle. It shows how to define start and stop methods and register them with the Fx lifecycle.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_6\n\nLANGUAGE: go\nCODE:\n```\nfunc newScrubber(lc fx.Lifecycle) Component {\n    sc := &scrubber{..}\n    lc.Append(fx.Hook{OnStart: sc.start, OnStop: sc.stop})\n    return sc\n}\n\nfunc (sc *scrubber) start(ctx context.Context) error { .. }\nfunc (sc *scrubber) stop(ctx context.Context) error { .. }\n```\n\n----------------------------------------\n\nTITLE: Using a Scrubber Module in a Main App in Go\nDESCRIPTION: This code shows how to use a scrubber module in a main application. It demonstrates how to combine modules and invoked functions to create a more complex Fx app.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_5\n\nLANGUAGE: go\nCODE:\n```\nsomeValue = \"my password is hunter2\"\napp := fx.New(\n    scrubber.Module(),\n    fx.Invoke(func(sc scrubber.Component) {\n        fmt.Printf(\"scrubbed: %s\", sc.ScrubString(somevalue))\n    }))\napp.Run()\n// Output: scrubbed: my password is *******\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for Workload Protection Windows Events\nDESCRIPTION: This JSON schema defines the structure for Workload Protection events on Windows. It includes definitions for AgentContext, ChangePermissionEvent, ContainerContext, EventContext, ExitEvent, File, FileEvent, MatchedRule, Process, and ProcessContext.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"$id\": \"https://github.com/DataDog/datadog-agent/tree/main/pkg/security/serializers\",\n    \"$defs\": {\n        \"AgentContext\": {\n            \"properties\": {\n                \"rule_id\": {\n                    \"type\": \"string\"\n                },\n                \"rule_version\": {\n                    \"type\": \"string\"\n                },\n                \"rule_actions\": {\n                    \"items\": true,\n                    \"type\": \"array\"\n                },\n                \"policy_name\": {\n                    \"type\": \"string\"\n                },\n                \"policy_version\": {\n                    \"type\": \"string\"\n                },\n                \"version\": {\n                    \"type\": \"string\"\n                },\n                \"os\": {\n                    \"type\": \"string\"\n                },\n                \"arch\": {\n                    \"type\": \"string\"\n                },\n                \"origin\": {\n                    \"type\": \"string\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"rule_id\"\n            ]\n        },\n        \"ChangePermissionEvent\": {\n            \"properties\": {\n                \"username\": {\n                    \"type\": \"string\",\n                    \"description\": \"User name\"\n                },\n                \"user_domain\": {\n                    \"type\": \"string\",\n                    \"description\": \"User domain\"\n                },\n                \"path\": {\n                    \"type\": \"string\",\n                    \"description\": \"Object name\"\n                },\n                \"type\": {\n                    \"type\": \"string\",\n                    \"description\": \"Object type\"\n                },\n                \"old_sd\": {\n                    \"type\": \"string\",\n                    \"description\": \"Original Security Descriptor\"\n                },\n                \"new_sd\": {\n                    \"type\": \"string\",\n                    \"description\": \"New Security Descriptor\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"ChangePermissionEventSerializer serializes a permission change event to JSON\"\n        },\n        \"ContainerContext\": {\n            \"properties\": {\n                \"id\": {\n                    \"type\": \"string\",\n                    \"description\": \"Container ID\"\n                },\n                \"created_at\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Creation time of the container\"\n                },\n                \"variables\": {\n                    \"$ref\": \"#/$defs/Variables\",\n                    \"description\": \"Variables values\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"ContainerContextSerializer serializes a container context to JSON\"\n        },\n        \"EventContext\": {\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Event name\"\n                },\n                \"category\": {\n                    \"type\": \"string\",\n                    \"description\": \"Event category\"\n                },\n                \"outcome\": {\n                    \"type\": \"string\",\n                    \"description\": \"Event outcome\"\n                },\n                \"async\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True if the event was asynchronous\"\n                },\n                \"matched_rules\": {\n                    \"items\": {\n                        \"$ref\": \"#/$defs/MatchedRule\"\n                    },\n                    \"type\": \"array\",\n                    \"description\": \"The list of rules that the event matched (only valid in the context of an anomaly)\"\n                },\n                \"variables\": {\n                    \"$ref\": \"#/$defs/Variables\",\n                    \"description\": \"Variables values\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"EventContextSerializer serializes an event context to JSON\"\n        },\n        \"ExitEvent\": {\n            \"properties\": {\n                \"cause\": {\n                    \"type\": \"string\",\n                    \"description\": \"Cause of the process termination (one of EXITED, SIGNALED, COREDUMPED)\"\n                },\n                \"code\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Exit code of the process or number of the signal that caused the process to terminate\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"required\": [\n                \"cause\",\n                \"code\"\n            ],\n            \"description\": \"ExitEventSerializer serializes an exit event to JSON\"\n        },\n        \"File\": {\n            \"properties\": {\n                \"path\": {\n                    \"type\": \"string\",\n                    \"description\": \"File path\"\n                },\n                \"device_path\": {\n                    \"type\": \"string\",\n                    \"description\": \"File device path\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"File basename\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"FileSerializer serializes a file to JSON\"\n        },\n        \"FileEvent\": {\n            \"properties\": {\n                \"path\": {\n                    \"type\": \"string\",\n                    \"description\": \"File path\"\n                },\n                \"device_path\": {\n                    \"type\": \"string\",\n                    \"description\": \"File device path\"\n                },\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"File basename\"\n                },\n                \"destination\": {\n                    \"$ref\": \"#/$defs/File\",\n                    \"description\": \"Target file information\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"FileEventSerializer serializes a file event to JSON\"\n        },\n        \"MatchedRule\": {\n            \"properties\": {\n                \"id\": {\n                    \"type\": \"string\",\n                    \"description\": \"ID of the rule\"\n                },\n                \"version\": {\n                    \"type\": \"string\",\n                    \"description\": \"Version of the rule\"\n                },\n                \"tags\": {\n                    \"items\": {\n                        \"type\": \"string\"\n                    },\n                    \"type\": \"array\",\n                    \"description\": \"Tags of the rule\"\n                },\n                \"policy_name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Name of the policy that introduced the rule\"\n                },\n                \"policy_version\": {\n                    \"type\": \"string\",\n                    \"description\": \"Version of the policy that introduced the rule\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"MatchedRuleSerializer serializes a rule\"\n        },\n        \"Process\": {\n            \"properties\": {\n                \"pid\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Process ID\"\n                },\n                \"ppid\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Parent Process ID\"\n                },\n                \"exec_time\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Exec time of the process\"\n                },\n                \"exit_time\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Exit time of the process\"\n                },\n                \"executable\": {\n                    \"$ref\": \"#/$defs/File\",\n                    \"description\": \"File information of the executable\"\n                },\n                \"container\": {\n                    \"$ref\": \"#/$defs/ContainerContext\",\n                    \"description\": \"Container context\"\n                },\n                \"cmdline\": {\n                    \"type\": \"string\",\n                    \"description\": \"Command line arguments\"\n                },\n                \"user\": {\n                    \"type\": \"string\",\n                    \"description\": \"User name\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"ProcessSerializer serializes a process to JSON\"\n        },\n        \"ProcessContext\": {\n            \"properties\": {\n                \"pid\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Process ID\"\n                },\n                \"ppid\": {\n                    \"type\": \"integer\",\n                    \"description\": \"Parent Process ID\"\n                },\n                \"exec_time\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\",\n                    \"description\": \"Exec time of the process\"\n                },\n                \"exit_time\": {\n                    \"type\": \"string\",\n                    \"format\": \"date-time\"\n```\n\n----------------------------------------\n\nTITLE: Process and ProcessContext Schema Definition in JSON\nDESCRIPTION: Comprehensive JSON schema that defines the structure for process-related data in the Datadog Agent. It includes fields for process identification, user/group information, timing data, credentials, environment variables, and AWS security credentials. The schema enforces required fields and proper data types for each property.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_17\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"Process ID\"\n        },\n        \"ppid\": {\n            \"type\": \"integer\",\n            \"description\": \"Parent Process ID\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"Group ID\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"args\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Command line arguments\"\n        },\n        \"envs\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Environment variables of the process\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\"\n    ],\n    \"description\": \"ProcessSerializer serializes a process to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Consuming Value Group Endpoints in Go\nDESCRIPTION: This snippet demonstrates how to consume all endpoints from a value group using an fx.In struct. It shows how to receive a slice of all group members.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_9\n\nLANGUAGE: go\nCODE:\n```\ntype dependencies struct {\n    fx.In\n    Endpoints []Endpoint `group:\"server\"`\n}\n```\n\n----------------------------------------\n\nTITLE: Implementing Atomic Variables in Go Structs and Globals\nDESCRIPTION: Demonstrates proper declaration and initialization of atomic variables using go.uber.org/atomic package. Shows both global variable declaration and struct implementation with proper pointer usage for alignment.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/atomics.md#2025-04-22_snippet_0\n\nLANGUAGE: golang\nCODE:\n```\n//  global variable\nvar maxFooCount = atomic.NewUint64(42)\n\n// in a struct\ntype FooTracker struct {\n    maxCount *atomic.Uint64\n}\n\nfunc NewFooTracker() *FooTracker {\n    return &FooTracker {\n        maxCount: atomic.NewUint64(42),\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Using Go pprof Tool for Heap Analysis\nDESCRIPTION: Commands to analyze heap memory usage in Go using the pprof tool. Shows how to access the heap profile through HTTP endpoint or save it to disk.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\ngo tool pprof myheap.profile\n```\n\n----------------------------------------\n\nTITLE: Implementing Bundle Definition in Go\nDESCRIPTION: Example of a bundle implementation that aggregates multiple components. The bundle lives in comp/<bundleName>/ directory and imports related components from sub-folders. It provides a Bundle() function that returns fx options for the bundle configuration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-bundles.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\n// Package <bundleName> ...\npackage <bundleName>\n\nimport (\n    \"github.com/DataDog/datadog-agent/pkg/util/fxutil\"\n\n    // We import all the components that we want to aggregate. A bundle must only aggregate components within its\n    // sub-folders.\n    comp1fx \"github.com/DataDog/datadog-agent/comp/<bundleName>/comp1/fx\"\n    comp2fx \"github.com/DataDog/datadog-agent/comp/<bundleName>/comp2/fx\"\n    comp3fx \"github.com/DataDog/datadog-agent/comp/<bundleName>/comp3/fx\"\n    comp4fx \"github.com/DataDog/datadog-agent/comp/<bundleName>/comp4/fx\"\n)\n\n// A single team must own the bundle, even if they don't own all the sub-components\n// team: <the team owning the bundle>\n\n// Bundle defines the fx options for this bundle.\nfunc Bundle() fxutil.BundleOptions {\n    return fxutil.Bundle(\n        comp1fx.Module(),\n        comp2fx.Module(),\n        comp3fx.Module(),\n        comp4fx.Module(),\n}\n```\n\n----------------------------------------\n\nTITLE: Querying Memory Stats with expvar in Datadog Agent\nDESCRIPTION: These commands use curl and jq to fetch and parse specific memory statistics from the Datadog Agent's expvar endpoint.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/tools.md#2025-04-22_snippet_2\n\nLANGUAGE: sh\nCODE:\n```\n# Find total bytes of memory obtained from the OS by the go runtime\ncurl -s http://localhost:5000/debug/vars | jq '.memstats.Sys'\n# Get names of checks that the collector's check runner has run\ncurl -s http://localhost:5000/debug/vars | jq '.runner.Checks | keys'\n```\n\n----------------------------------------\n\nTITLE: Setting Up Python Virtual Environment for Datadog Agent Development\nDESCRIPTION: Commands to install virtualenv, create a virtual environment, and activate it for Datadog Agent development.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\npython3 -m pip install virtualenv\nvirtualenv $GOPATH/src/github.com/DataDog/datadog-agent/venv\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for Workload Protection Linux Events\nDESCRIPTION: This code block represents the full JSON schema for Workload Protection events on Linux systems. It defines the structure and types of data that these events contain.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/backend_linux.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{{ event_schema }}\n```\n\n----------------------------------------\n\nTITLE: Initializing Go Workspace for Datadog Agent E2E Tests\nDESCRIPTION: Commands to create a Go workspace file and add the test/new-e2e directory to workspaces. This is a workaround for VSCode issues with multiple go.mod files.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ngo work init\ngo work use . ./test/new-e2e\n```\n\n----------------------------------------\n\nTITLE: Setting Up Visual Studio Code Dev Container for Datadog Agent\nDESCRIPTION: Command to create a devcontainer configuration file for Visual Studio Code. This sets up a container-based development environment for the Datadog Agent project, specifying the Docker image to use.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_12\n\nLANGUAGE: sh\nCODE:\n```\ndeva vscode.setup-devcontainer --image \"<image name>\"\n```\n\n----------------------------------------\n\nTITLE: Documentation for the integration package in Datadog Agent\nDESCRIPTION: Markdown documentation explaining the purpose of the integration package, which defines types representing integrations that can be used by various components of the Datadog Agent to configure checks or logs collectors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/integration/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# package `integration`\n\nThis package is responsible of defining the types representing an integration which can be used by several components of the agent to configure checks or logs collectors for example.\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent\nDESCRIPTION: Commands to clone repository, build and configure the Datadog Agent with custom Python path\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/README.md#2025-04-22_snippet_2\n\nLANGUAGE: shell\nCODE:\n```\ngit clone https://github.com/DataDog/datadog-agent.git $GOPATH/src/github.com/DataDog/datadog-agent\ncd $GOPATH/src/github.com/DataDog/datadog-agent\ndda inv install-tools\ndda inv agent.build --build-exclude=systemd\n\ndda inv agent.build \\\n  --python-home-3=$GOPATH/src/github.com/DataDog/datadog-agent/venv3\n```\n\n----------------------------------------\n\nTITLE: Defining ProcessCredentials Schema in JSON\nDESCRIPTION: JSON schema specification for process credentials including user/group IDs, effective permissions, and capability sets. Defines comprehensive credential tracking with required fields for user and group identifiers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_41\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"User ID\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"Group ID\"\n        },\n        \"group\": {\n            \"type\": \"string\",\n            \"description\": \"Group name\"\n        },\n        \"euid\": {\n            \"type\": \"integer\",\n            \"description\": \"Effective User ID\"\n        },\n        \"euser\": {\n            \"type\": \"string\",\n            \"description\": \"Effective User name\"\n        },\n        \"egid\": {\n            \"type\": \"integer\",\n            \"description\": \"Effective Group ID\"\n        },\n        \"egroup\": {\n            \"type\": \"string\",\n            \"description\": \"Effective Group name\"\n        },\n        \"fsuid\": {\n            \"type\": \"integer\",\n            \"description\": \"Filesystem User ID\"\n        },\n        \"fsuser\": {\n            \"type\": \"string\",\n            \"description\": \"Filesystem User name\"\n        },\n        \"fsgid\": {\n            \"type\": \"integer\",\n            \"description\": \"Filesystem Group ID\"\n        },\n        \"fsgroup\": {\n            \"type\": \"string\",\n            \"description\": \"Filesystem Group name\"\n        },\n        \"auid\": {\n            \"type\": \"integer\",\n            \"description\": \"Login UID\"\n        },\n        \"cap_effective\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Effective Capability set\"\n        },\n        \"cap_permitted\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Permitted Capability set\"\n        },\n        \"destination\": {\n            \"description\": \"Credentials after the operation\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\",\n        \"euid\",\n        \"egid\",\n        \"fsuid\",\n        \"fsgid\",\n        \"auid\",\n        \"cap_effective\",\n        \"cap_permitted\"\n    ],\n    \"description\": \"ProcessCredentialsSerializer serializes the process credentials to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Accessing Prometheus-style Telemetry in Bash\nDESCRIPTION: This snippet demonstrates how to access Prometheus-style telemetry data. It uses curl to send a request to the localhost endpoint and displays the first few lines of the response.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_api.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n$ curl -s http://localhost:5000/telemetry | head\n```\n\n----------------------------------------\n\nTITLE: Matching Process Command Line Arguments in JavaScript\nDESCRIPTION: Demonstrates how to match process command line arguments using exact matching and pattern matching in JavaScript-like syntax. This is used for filtering events based on process execution details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\nexec.cmdline == \"-sV -p 22,53,110,143,4564 198.116.0-255.1-127\"\n```\n\nLANGUAGE: javascript\nCODE:\n```\nexec.cmdline =~ \"* -F * http*\"\n```\n\n----------------------------------------\n\nTITLE: Implementing Status Provider in Compression Component\nDESCRIPTION: Demonstrates how to implement a status provider for a compression component, including the necessary interface methods and helper functions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/status.md#2025-04-22_snippet_3\n\nLANGUAGE: go\nCODE:\n```\npackage impl\n\nimport (\n    \"fmt\"\n\n    compression \"github.com/DataDog/datadog-agent/comp/compression/def\"\n    \"github.com/DataDog/datadog-agent/comp/status\"\n)\n\ntype Requires struct {\n}\n\ntype Provides struct {\n    Comp compression.Component\n    Status status.InformationProvider\n}\n\ntype compressor struct {\n}\n\n// NewComponent returns an implementation for the compression component\nfunc NewComponent(reqs Requires) Provides {\n    comp := &compressor{}\n\n    return Provides{\n        Comp: comp,\n        Status: status.NewInformationProvider(&comp)\n    }\n}\n\n//\n// Since we are using the compressor as status provider we need to implement the status interface on our component\n//\n\n//go:embed status_templates\nvar templatesFS embed.FS\n\n// Name renders the name\nfunc (c *compressor) Name() string {\n  return \"Compression\"\n}\n\n// Index renders the index\nfunc (c *compressor) Section() int {\n  return \"Compression\"\n}\n\n// JSON populates the status map\nfunc (c *compressor) JSON(_ bool, stats map[string]interface{}) error {\n  c.populateStatus(stats)\n\n  return nil\n}\n\n// Text renders the text output\nfunc (c *compressor) Text(_ bool, buffer io.Writer) error {\n  return status.RenderText(templatesFS, \"compressor.tmpl\", buffer, c.getStatusInfo())\n}\n\n// HTML renders the html output\nfunc (c *compressor) HTML(_ bool, buffer io.Writer) error {\n  return status.RenderHTML(templatesFS, \"compressorHTML.tmpl\", buffer, c.getStatusInfo())\n}\n\nfunc (c *compressor) populateStatus(stats map[string]interface{}) {\n  // Here we populate whatever informatiohn we want to display for our component\n  stats[\"compressor\"] = ...\n}\n\nfunc (c *compressor) getStatusInfo() map[string]interface{} {\n  stats := make(map[string]interface{})\n\n  c.populateStatus(stats)\n\n  return stats\n}\n```\n\n----------------------------------------\n\nTITLE: Setting Python Debugger Breakpoint in Datadog Agent\nDESCRIPTION: This code snippet demonstrates how to add a breakpoint in Python code within the Datadog Agent for debugging purposes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/tools.md#2025-04-22_snippet_5\n\nLANGUAGE: python\nCODE:\n```\nimport pdb\npdb.set_trace()\n```\n\n----------------------------------------\n\nTITLE: ProcessContext Schema Definition\nDESCRIPTION: Extended JSON schema for process context including parent/ancestor processes and variables.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_15\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"Process ID\"\n        },\n        \"ppid\": {\n            \"type\": \"integer\",\n            \"description\": \"Parent Process ID\"\n        },\n        \"exec_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exec time of the process\"\n        },\n        \"exit_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exit time of the process\"\n        },\n        \"executable\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"File information of the executable\"\n        },\n        \"container\": {\n            \"$ref\": \"#/$defs/ContainerContext\",\n            \"description\": \"Container context\"\n        },\n        \"cmdline\": {\n            \"type\": \"string\",\n            \"description\": \"Command line arguments\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"parent\": {\n            \"$ref\": \"#/$defs/Process\",\n            \"description\": \"Parent process\"\n        },\n        \"ancestors\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/Process\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Ancestor processes\"\n        },\n        \"variables\": {\n            \"$ref\": \"#/$defs/Variables\",\n            \"description\": \"Variables values\"\n        },\n        \"truncated_ancestors\": {\n            \"type\": \"boolean\",\n            \"description\": \"True if the ancestors list was truncated because it was too big\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"ProcessContextSerializer serializes a process context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Listing Goroutines with pprof in Datadog Agent\nDESCRIPTION: This command uses curl to fetch and display all goroutines from the Datadog Agent's pprof HTTP server.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/tools.md#2025-04-22_snippet_0\n\nLANGUAGE: sh\nCODE:\n```\ncurl http://localhost:5000/debug/pprof/goroutine?debug=2\n```\n\n----------------------------------------\n\nTITLE: Testing Component Lifecycle Hooks in Go\nDESCRIPTION: Tests the lifecycle hooks of a component by creating a test lifecycle, initializing the component, and verifying that the start hook is called correctly.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/testing.md#2025-04-22_snippet_4\n\nLANGUAGE: go\nCODE:\n```\npackage impl\n\nimport (\n  \"context\"\n  \"testing\"\n\n  compdef \"github.com/DataDog/datadog-agent/comp/def\"\n  \"github.com/stretchr/testify/assert\"\n)\n\nfunc TestStartHook(t *testing.T) {\n  lc := compdef.NewTestLifecycle(t)\n\n  requires := Requires{\n    Lc:  lc,\n  }\n\n  provides, err := NewComponent(requires)\n\n  assert.NoError(t, err)\n\n  assert.NotNil(t, provides.Comp)\n  internalComponent := provides.Comp.(*component)\n\n  ctx := context.Background()\n  lc.AssertHooksNumber(1)\n  assert.NoError(t, lc.Start(ctx))\n\n  assert.True(t, internalComponent.started)\n}\n```\n\n----------------------------------------\n\nTITLE: Installing Development Environment with Powershell\nDESCRIPTION: Administrator Powershell command to bypass execution policy and run the environment setup script.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_0\n\nLANGUAGE: powershell\nCODE:\n```\nSet-ExecutionPolicy Bypass -Scope Process -Force; <path_to_ps1>\\Install-DevEnv.ps1\n```\n\n----------------------------------------\n\nTITLE: Running Deva Setup for Datadog Agent Development\nDESCRIPTION: Command to run the Deva setup task, which performs sanity checks and enables development tools for the Datadog Agent project.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_3\n\nLANGUAGE: shell\nCODE:\n```\ndeva setup\n```\n\n----------------------------------------\n\nTITLE: Referencing Workloadmeta Store Telemetry Metrics in Go\nDESCRIPTION: This snippet indicates the location of telemetry metric definitions for the Workloadmeta Store. These metrics measure the behavior of the component.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/workloadmeta/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Go\nCODE:\n```\ncomp/core/workloadmeta/telemetry/telemetry.go\n```\n\n----------------------------------------\n\nTITLE: Example Inventory Host Payload in JSON Format\nDESCRIPTION: A complete example of the inventory host payload sent by the DataDog Agent, showing all fields including host metadata, system information, cloud provider details, and hardware identification data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/inventoryhost/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"host_metadata\": {\n        \"cpu_architecture\": \"unknown\",\n        \"cpu_cache_size\": 9437184,\n        \"cpu_cores\": 6,\n        \"cpu_family\": \"6\",\n        \"cpu_frequency\": 2208.007,\n        \"cpu_logical_processors\": 6,\n        \"cpu_model\": \"Intel(R) Core(TM) i7-8750H CPU @ 2.20GHz\",\n        \"cpu_model_id\": \"158\",\n        \"cpu_stepping\": \"10\",\n        \"cpu_vendor\": \"GenuineIntel\",\n        \"kernel_name\": \"Linux\",\n        \"kernel_release\": \"5.16.0-6-amd64\",\n        \"kernel_version\": \"#1 SMP PREEMPT Debian 5.16.18-1 (2022-03-29)\",\n        \"os\": \"GNU/Linux\",\n        \"os_version\": \"debian bookworm/sid\",\n        \"memory_swap_total_kb\": 10237948,\n        \"memory_total_kb\": 12227556,\n        \"ip_address\": \"192.168.24.138\",\n        \"ipv6_address\": \"fe80::1ff:fe23:4567:890a\",\n        \"mac_address\": \"01:23:45:67:89:AB\",\n        \"agent_version\": \"7.37.0-devel+git.198.68a5b69\",\n        \"cloud_provider\": \"AWS\",\n        \"cloud_provider_source\": \"DMI\",\n        \"cloud_provider_account_id\": \"aws_account_id\",\n        \"cloud_provider_host_id\": \"i-abcedf\",\n        \"hypervisor_guest_uuid\": \"ec24ce06-9ac4-42df-9c10-14772aeb06d7\",\n        \"dmi_product_uuid\": \"ec24ce06-9ac4-42df-9c10-14772aeb06d7\",\n        \"dmi_board_asset_tag\": \"i-abcedf\",\n        \"dmi_board_vendor\": \"Amazon EC2\",\n        \"linux_package_signing_enabled\": true,\n        \"rpm_global_repo_gpg_check_enabled\": false\n    },\n    \"hostname\": \"my-host\",\n    \"timestamp\": 1631281754507358895\n}\n```\n\n----------------------------------------\n\nTITLE: Sending Multiple Custom Metrics in a Single Batch Request\nDESCRIPTION: Example of submitting multiple metrics in a single request to the Datadog Agent. This batch format allows efficient submission of several metrics with their respective attributes in one HTTP request.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/common/README.md#2025-04-22_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"series\": [\n    {\n      \"metric\": \"system.proc.count\",\n      \"points\": [[<TIMESTAMP>, <VALUE>]],\n      \"type\": \"gauge\",\n      \"host\": \"test.example.com\",\n      \"tags\": [\"environment:test\"]\n    },\n    {\n      \"metric\": \"system.memory.usage\",\n      \"points\": [[<TIMESTAMP>, <VALUE>]],\n      \"type\": \"gauge\",\n      \"host\": \"test.example.com\",\n      \"tags\": [\"environment:test\"]\n    }\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for File Event Serialization\nDESCRIPTION: This snippet defines the schema for serializing file events, including properties like uid, gid, filesystem metadata, and file attributes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_2\n\nLANGUAGE: JSON\nCODE:\n```\n\"File\": {\n    \"properties\": {\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"Group ID\"\n        },\n        // ... other properties ...\n        \"fstype\": {\n            \"type\": \"string\",\n            \"description\": \"Filesystem type\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\"\n    ],\n    \"description\": \"FileEventSerializer serializes a file event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Matching File Creation by Name in JavaScript\nDESCRIPTION: This snippet shows how to match the creation of a file named 'cmd.bat' using the 'create.file.name' attribute in a security rule.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_5\n\nLANGUAGE: javascript\nCODE:\n```\ncreate.file.name == \"cmd.bat\"\n```\n\n----------------------------------------\n\nTITLE: Defining Core Datadog Agent Functions in Python\nDESCRIPTION: This code block defines several core functions of the Datadog Agent, including version retrieval, configuration access, header generation, hostname and cluster name retrieval, logging, and setting external tags. These functions are intended for internal use by Datadog checks.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/datadog_agent.md#2025-04-22_snippet_0\n\nLANGUAGE: python\nCODE:\n```\ndef get_version():\n    \"\"\"Get the Agent version.\n\n    Returns:\n        A string containing the Agent version.\n    \"\"\"\n\n\ndef get_config(key):\n    \"\"\"Get an item from the Agent configuration store.\n\n    Args:\n        key (string or unicode): the key of the Agent config to retrieve.\n\n    Returns:\n        value (object): a Python object for the corresponding value, can be any type.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n\n\ndef headers(agentConfig, http_host=None):\n    \"\"\"Get standard set of HTTP headers to use to perform HTTP requests from an\n    integration.\n\n    NOTE: This function isn't used by any official integration provided by\n    Datadog but custom checks might still rely on it.\n\n    Args:\n        agentConfig (dict): ignored, can be None.\n        http_host: value for the `Host` header.\n\n    Returns:\n        A dictionary containing HTTP headers or None.\n    \"\"\"\n\n\ndef get_hostname():\n    \"\"\"Get the hostname computed by the Agent.\n\n    Returns:\n        A string containing the hostname or None.\n    \"\"\"\n\n\ndef get_clustername():\n    \"\"\"Get the cluster name where it's running the Agent.\n\n    Returns:\n        A string containing the cluster name or None.\n    \"\"\"\n\n\ndef log(message, log_level):\n    \"\"\"Log a message through the agent logger.\n\n    Args:\n        message (string or unicode): the log message.\n        log_level (int): the log level enumeration.\n\n    Returns:\n        None\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n\n\ndef set_external_tags(tags):\n    \"\"\"Send external host tags (internal feature, never ever use it).\n\n    Args:\n        tags (list): a list of external tags with a specific format, see source\n            code for details.\n\n    Returns:\n        None\n\n    Raises:\n        Appropriate exception if an error occurred.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Implementing FlareBuilder Callback in Golang\nDESCRIPTION: Example of creating a fillFlare method to add data to a flare using the FlareBuilder interface. It demonstrates adding a new file and copying an existing file into the flare.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/flares.md#2025-04-22_snippet_0\n\nLANGUAGE: golang\nCODE:\n```\nimport (\n\tyaml \"gopkg.in/yaml.v2\"\n\n\tflare \"github.com/DataDog/datadog-agent/comp/core/flare/def\"\n)\n\nfunc (c *myComponent) fillFlare(fb flare.FlareBuilder) error {\n\t// Creating a new file\n\tfb.AddFile( \n\t\t\"runtime_config_dump.yaml\",\n\t\t[]byte(\"content of my file\"),\n\t) //nolint:errcheck\t\n\n\t// Copying a file from the disk into the flare\n\tfb.CopyFile(\"/etc/datadog-agent/datadog.yaml\") //nolint:errcheck\n\treturn nil\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Container Exclusion in Python\nDESCRIPTION: This function determines whether a container should be excluded from metrics collection based on its name and image. It handles both string and unicode inputs, encoding unicode strings using the system's default encoding.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/containers.md#2025-04-22_snippet_0\n\nLANGUAGE: python\nCODE:\n```\ndef is_excluded(name, image):\n    \"\"\"Returns whether a container is excluded per name and image.\n\n    NOTE: If unicode is passed to any of the params accepting it, the\n    string is encoded using the default encoding for the system where the\n    Agent is running. If encoding fails, the function raises `UnicodeError`.\n\n    Args:\n        name (string or unicode): the name of the container.\n        image (string or unicode): Docker image name.\n\n    Returns:\n        True if the container is excluded, False otherwise.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Submitting Metrics to Datadog Agent Aggregator in Python\nDESCRIPTION: This function allows submitting a metric to the Datadog Agent aggregator. It handles various metric types and supports tags and hostname specification. The function encodes unicode strings and raises exceptions for processing errors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/aggregator.md#2025-04-22_snippet_1\n\nLANGUAGE: python\nCODE:\n```\ndef submit_metric(check, check_id, mtype, name, value, tags, hostname):\n    \"\"\"Submit a metric to the aggregator.\n\n    NOTE: If unicode is passed to any of the params accepting it, the\n    string is encoded using the default encoding for the system where the\n    Agent is running. If encoding fails, the function raises `UnicodeError`.\n\n    Args:\n        check (AgentCheck): the check instance calling the function.\n        check_id (string or unicode): unique identifier for the check instance.\n        mtype (int): constant describing metric type.\n        name (string or unicode): name of the metric.\n        value (float): value of the metric.\n        tags (list): list of string or unicode containing tags. Items with unsupported\n            types are silently ignored.\n        hostname (string or unicode): the hostname sending the metric.\n\n    Returns:\n        None.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Defining a Telemetry Struct with Atomic Stats in Go\nDESCRIPTION: Example of how to create a struct with atomic counter fields that can be tracked as statistics. Fields are tagged with `stats:\"\"` to indicate they should be included in the generated reports.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/util/atomicstats/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ntype telemetry struct {\n\tTracesReceived *atomic.Int64 `stats:\"\"`\n\tTracesFiltered *atomic.Int64 `stats:\"\"`\n}\n```\n\n----------------------------------------\n\nTITLE: Initializing Component Dependencies for Testing in Go\nDESCRIPTION: Creates a Requires struct with mock dependencies for config and log components to test a compression implementation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/testing.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\npackage implzstd\n\nimport (\n  \"testing\"\n\n  configmock \"github.com/DataDog/datadog-agent/comp/core/config/mock\"\n  logmock \"github.com/DataDog/datadog-agent/comp/core/log/mock\"\n)\n\nfunc TestCompress(t *testing.T) {\n  logComponent := configmock.New(t)\n  configComponent := logmock.New(t)\n  \n  requires := Requires{\n    Conf: configComponent,\n    Log: logComponent,\n  }\n  // [...]\n}\n```\n\n----------------------------------------\n\nTITLE: Installing DDA on Windows via Command Line\nDESCRIPTION: Commands to install the Datadog Agent development environment on Windows using msiexec for different architectures.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_3\n\nLANGUAGE: powershell\nCODE:\n```\nmsiexec /passive /i https://github.com/DataDog/datadog-agent-dev/releases/latest/download/dda-x64.msi\n```\n\nLANGUAGE: powershell\nCODE:\n```\nmsiexec /passive /i https://github.com/DataDog/datadog-agent-dev/releases/latest/download/dda-x86.msi\n```\n\n----------------------------------------\n\nTITLE: Executing Subprocess and Capturing Output in Python for Datadog Agent\nDESCRIPTION: Runs an external process and returns its output. Handles unicode encoding and provides options for error handling. Returns stdout, stderr, and exit code.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/_util.md#2025-04-22_snippet_0\n\nLANGUAGE: python\nCODE:\n```\ndef subprocess_output(args, raise_on_empty):\n    \"\"\"Run an external process and return the output.\n\n    NOTE: If unicode is passed to any of the params accepting it, the\n    string is encoded using the default encoding for the system where the\n    Agent is running. If encoding fails, the function raises `UnicodeError`.\n\n    Args:\n        args (list of string or unicode): the command arguments of the subprocess to run.\n        raise_on_empty (bool): whether this function should raise if subprocess output is empty.\n\n    Returns:\n        A tuple (string, string, int) containing standard output, standard error and exit code.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n\n\ndef get_subprocess_output():\n    \"\"\"Alias for subprocess_output()\"\"\"\n```\n\n----------------------------------------\n\nTITLE: Aggregator Architecture Diagram\nDESCRIPTION: ASCII diagram illustrating the flow of data through the aggregator package components, including DogStatsD, checks, Sender, Aggregator, Samplers, ContextMetrics, Metrics, and Serializer.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/aggregator/README.md#2025-04-22_snippet_0\n\nLANGUAGE: ascii\nCODE:\n```\n         +===========+                       +===============+\n         + DogStatsD +                       +    checks     +\n         +===========+                       | Python and Go |\n              ++                             +===============+\n              ||                                    ++\n              ||                                    vv\n              ||                                .+------+.\n              ||                                . Sender .\n              ||                                '+---+--+'\n              ||                                     |\n              vv                                     v\n           .+----------------------------------------+--+.\n           +                 Aggregator                  +\n           '+--+-------------------------------------+--+'\n               |                                     |\n               |                                     |\n               v                                     v\n        .+-----+-----+.                       .+-----+------+.\n        + TimeSampler +                       + CheckSampler +\n        '+-----+-----+'                       '+-----+------+'\n               |                                     |\n               |                                     |\n               +         .+---------------+.         +\n               '+------->+ ContextMetrics  +<-------+'\n                         '+-------+-------+'\n                                  |\n                                  v\n                         .+-------+-------+.\n                         +     Metrics     +\n                         | Gauge           |\n                         | Count           |\n                         | Histogram       |\n                         | Rate            |\n                         | Set             |\n                         + ...             +\n                         '+--------+------+'\n                                  ||               +=================+\n                                  ++==============>+  Serializer     |\n                                                   +=================+\n```\n\n----------------------------------------\n\nTITLE: Defining Regular Provider Interface in Go\nDESCRIPTION: Defines the interface for regular status providers, including methods for naming, sectioning, and rendering output in JSON, Text, and HTML formats.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/status.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\n// Provider interface\ntype Provider interface {\n\t// Name is used to sort the status providers alphabetically.\n\tName() string\n\t// Section is used to group the status providers.\n\t// When displaying the Text output the section is render as a header\n\tSection() string\n\tJSON(verbose bool, stats map[string]interface{}) error\n\tText(verbose bool, buffer io.Writer) error\n\tHTML(verbose bool, buffer io.Writer) error\n}\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent with Embedded Path in Bash\nDESCRIPTION: Command to run the invoke task with the proper embedded path for building the Agent in a containerized environment. This ensures the build artifacts are installed in the correct location.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_build.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e agent.build -e /opt/datadog-agent/embedded\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for NetworkContext in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing network context in the Datadog Agent. It includes properties for network device, protocols, source and destination IP/ports, size, and direction.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_11\n\nLANGUAGE: JSON\nCODE:\n```\n\"NetworkContext\": {\n    \"properties\": {\n        \"device\": {\n            \"$ref\": \"#/$defs/NetworkDevice\",\n            \"description\": \"device is the network device on which the event was captured\"\n        },\n        \"l3_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l3_protocol is the layer 3 protocol name\"\n        },\n        \"l4_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l4_protocol is the layer 4 protocol name\"\n        },\n        \"source\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"source is the emitter of the network event\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"destination is the receiver of the network event\"\n        },\n        \"size\": {\n            \"type\": \"integer\",\n            \"description\": \"size is the size in bytes of the network event\"\n        },\n        \"network_direction\": {\n            \"type\": \"string\",\n            \"description\": \"network_direction indicates if the packet was captured on ingress or egress\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"l3_protocol\",\n        \"l4_protocol\",\n        \"source\",\n        \"destination\",\n        \"size\",\n        \"network_direction\"\n    ],\n    \"description\": \"NetworkContextSerializer serializes the network context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for Network Flow Serialization\nDESCRIPTION: This snippet outlines the schema for serializing network flow events, including layer 3 and 4 protocols, source and destination information, and network statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_3\n\nLANGUAGE: JSON\nCODE:\n```\n\"Flow\": {\n    \"properties\": {\n        \"l3_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l3_protocol is the layer 3 protocol name\"\n        },\n        \"l4_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l4_protocol is the layer 4 protocol name\"\n        },\n        \"source\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"source is the emitter of the network event\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"destination is the receiver of the network event\"\n        },\n        \"ingress\": {\n            \"$ref\": \"#/$defs/NetworkStats\",\n            \"description\": \"ingress holds the network statistics for ingress traffic\"\n        },\n        \"egress\": {\n            \"$ref\": \"#/$defs/NetworkStats\",\n            \"description\": \"egress holds the network statistics for egress traffic\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"l3_protocol\",\n        \"l4_protocol\",\n        \"source\",\n        \"destination\"\n    ],\n    \"description\": \"FlowSerializer defines a new flow serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent with Custom Values in YAML\nDESCRIPTION: This YAML snippet shows the custom configuration used to generate the Kubernetes manifests for the Datadog Agent. It enables the security agent's compliance and runtime features while disabling APM socket.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/security-agent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  apm:\n    socketEnabled: false\n  securityAgent:\n    compliance:\n      enabled: true\n    runtime:\n      enabled: true\n```\n\n----------------------------------------\n\nTITLE: Defining ConnectEvent JSON Schema\nDESCRIPTION: JSON schema for serializing a connect event, including properties for the address, hostnames, and protocol.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_21\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"addr\": {\n            \"$ref\": \"#/$defs/IPPortFamily\"\n        },\n        \"hostnames\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\"\n        },\n        \"protocol\": {\n            \"type\": \"string\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"addr\",\n        \"hostnames\",\n        \"protocol\"\n    ],\n    \"description\": \"ConnectEventSerializer serializes a connect event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Using readsecret.sh Alternative for Docker Swarm\nDESCRIPTION: Alternative environment variables configuration using the Go-based readsecret.sh script for Docker Swarm Secrets integration, which is faster and recommended for Agent version 7.30.0+.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/secrets-helper/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nDD_SECRET_BACKEND_COMMAND=/readsecret.sh\nDD_SECRET_BACKEND_ARGUMENTS=/run/secrets\n```\n\n----------------------------------------\n\nTITLE: Creating a Scrubber Constructor with Dependencies in Go\nDESCRIPTION: This code shows how to create a constructor for a scrubber component that depends on a configuration component. It demonstrates how Fx uses reflection to inject dependencies into constructors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\nfunc NewScrubber(config config.Component) Component {\n    return &scrubber{\n        matchers: makeMatchersFromConfig(config),\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Multiple Implementation Component Folder Structure Example\nDESCRIPTION: An example folder structure for a compression component with multiple implementations (zip and zstd), demonstrating how to organize components with alternative implementations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_10\n\nLANGUAGE: plaintext\nCODE:\n```\ncomp/core/compression/\n├── def\n│   └── component.go\n├── fx-zip\n│   └── fx.go\n├── fx-zstd\n│   └── fx.go\n├── impl-zip\n│   └── component.go\n├── impl-zstd\n│   └── component.go\n└── mock\n    └── mock.go\n\n6 directories, 6 files\n```\n\n----------------------------------------\n\nTITLE: Matching File Creation Path in JavaScript\nDESCRIPTION: Shows how to match a specific file creation event based on the device path in JavaScript-like syntax. This can be used to monitor the creation of specific files in the system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_3\n\nLANGUAGE: javascript\nCODE:\n```\ncreate.file.device_path == \"\\device\\harddisk1\\cmd.bat\"\n```\n\n----------------------------------------\n\nTITLE: Configuring Fx Module for ZSTD Compression in Go\nDESCRIPTION: Shows how to set up the Fx module for the ZSTD compression component. This file is responsible for integrating the component with the Fx dependency injection system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_6\n\nLANGUAGE: go\nCODE:\n```\npackage fx\n\nimport (\n    \"github.com/DataDog/datadog-agent/pkg/util/fxutil\"\n\n    // You must import the implementation you are exposing through FX\n    compressionimpl \"github.com/DataDog/datadog-agent/comp/compression/impl-zstd\"\n)\n\n// Module specifies the compression module.\nfunc Module() fxutil.Module {\n    return fxutil.Component(\n        // ProvideComponentConstructor will automatically detect the 'Requires' and 'Provides' structs\n        // of your constructor function and map them to FX.\n        fxutil.ProvideComponentConstructor(\n            compressionimpl.NewComponent,\n        )\n    )\n}\n```\n\n----------------------------------------\n\nTITLE: Submitting Events to Datadog Agent Aggregator in Python\nDESCRIPTION: This function allows submitting an event to the Datadog Agent aggregator. It accepts a dictionary containing event details such as title, text, timestamp, priority, and tags. The function encodes unicode strings and raises exceptions for processing errors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/aggregator.md#2025-04-22_snippet_3\n\nLANGUAGE: python\nCODE:\n```\ndef submit_event(check, check_id, event):\n    \"\"\"Submit an event to the aggregator.\n\n    NOTE: If unicode is passed to any of the params accepting it, the\n    string is encoded using the default encoding for the system where the\n    Agent is running. If encoding fails, the function raises `UnicodeError`.\n\n    Args:\n        check (AgentCheck): the check instance calling the function.\n        check_id (string or unicode): unique identifier for the check instance.\n        event (dict): a dictionary containing the following keys:\n            msg_title (string or unicode)\n            msg_text (string or unicode)\n            timestamp (int)\n            priority (string or unicode)\n            host (string or unicode)\n            alert_type (string or unicode)\n            aggregation_key (string or unicode)\n            source_type_name (string or unicode)\n            event_type (string or unicode)\n            tags (list of string or unicode)\n\n    Returns:\n        None.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Running Unit Tests\nDESCRIPTION: Commands to run unit tests and linters for specific packages\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/README.md#2025-04-22_snippet_3\n\nLANGUAGE: shell\nCODE:\n```\ndda inv test --targets=./pkg/aggregator\ndda inv linter.go\ndda inv rtloader.make && dda inv rtloader.install\ndda inv test --targets=./pkg/collector/python\n```\n\n----------------------------------------\n\nTITLE: Running Subprocesses in Python Checks\nDESCRIPTION: Example of using the get_subprocess_output function to safely run subprocesses within a Python check.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/README.md#2025-04-22_snippet_2\n\nLANGUAGE: python\nCODE:\n```\nfrom datadog_checks.utils.subprocess_output import get_subprocess_output\n\nclass MyCheck(AgentCheck):\n    def check(self, instance):\n    # [...]\n    out, err, retcode = get_subprocess_output(cmd, self.log, raise_on_empty_output=True)\n```\n\n----------------------------------------\n\nTITLE: Retrieving Kubelet Connection Information in Python\nDESCRIPTION: This function retrieves connection information for the kubelet. It returns a dictionary containing connection details, which may be empty if no information is available.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/kubeutil.md#2025-04-22_snippet_0\n\nLANGUAGE: python\nCODE:\n```\ndef get_connection_info():\n    \"\"\"Get kubelet connection informations.\n\n    Returns:\n        A dictionary containing connection info, can be empty.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Defining ProcessContext Schema in JSON\nDESCRIPTION: JSON schema specification for process context data including process IDs, user information, execution times, and various process attributes. Defines required fields uid and gid along with optional properties for comprehensive process monitoring.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_40\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"Process ID\"\n        },\n        \"ppid\": {\n            \"type\": \"integer\",\n            \"description\": \"Parent Process ID\"\n        },\n        \"tid\": {\n            \"type\": \"integer\",\n            \"description\": \"Thread ID\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"Group ID\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"group\": {\n            \"type\": \"string\",\n            \"description\": \"Group name\"\n        },\n        \"path_resolution_error\": {\n            \"type\": \"string\",\n            \"description\": \"Description of an error in the path resolution\"\n        },\n        \"comm\": {\n            \"type\": \"string\",\n            \"description\": \"Command name\"\n        },\n        \"tty\": {\n            \"type\": \"string\",\n            \"description\": \"TTY associated with the process\"\n        },\n        \"fork_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Fork time of the process\"\n        },\n        \"exec_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exec time of the process\"\n        },\n        \"exit_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exit time of the process\"\n        },\n        \"credentials\": {\n            \"$ref\": \"#/$defs/ProcessCredentials\",\n            \"description\": \"Credentials associated with the process\"\n        },\n        \"user_session\": {\n            \"$ref\": \"#/$defs/UserSessionContext\",\n            \"description\": \"Context of the user session for this event\"\n        },\n        \"executable\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"File information of the executable\"\n        },\n        \"interpreter\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"File information of the interpreter\"\n        },\n        \"container\": {\n            \"$ref\": \"#/$defs/ContainerContext\",\n            \"description\": \"Container context\"\n        },\n        \"argv0\": {\n            \"type\": \"string\",\n            \"description\": \"First command line argument\"\n        },\n        \"args\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Command line arguments\"\n        },\n        \"args_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicator of arguments truncation\"\n        },\n        \"envs\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Environment variables of the process\"\n        },\n        \"envs_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicator of environments variable truncation\"\n        },\n        \"is_thread\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicates whether the process is considered a thread (that is, a child process that hasn't executed another program)\"\n        },\n        \"is_kworker\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicates whether the process is a kworker\"\n        },\n        \"is_exec_child\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicates whether the process is an exec following another exec\"\n        },\n        \"source\": {\n            \"type\": \"string\",\n            \"description\": \"Process source\"\n        },\n        \"syscalls\": {\n            \"$ref\": \"#/$defs/SyscallsEvent\",\n            \"description\": \"List of syscalls captured to generate the event\"\n        },\n        \"aws_security_credentials\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/AWSSecurityCredentials\"\n            },\n            \"type\": \"array\",\n            \"description\": \"List of AWS Security Credentials that the process had access to\"\n        },\n        \"parent\": {\n            \"$ref\": \"#/$defs/Process\",\n            \"description\": \"Parent process\"\n        },\n        \"ancestors\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/Process\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Ancestor processes\"\n        },\n        \"variables\": {\n            \"$ref\": \"#/$defs/Variables\",\n            \"description\": \"Variables values\"\n        },\n        \"truncated_ancestors\": {\n            \"type\": \"boolean\",\n            \"description\": \"True if the ancestors list was truncated because it was too big\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\"\n    ],\n    \"description\": \"ProcessContextSerializer serializes a process context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining MountEvent Schema in JSON\nDESCRIPTION: JSON schema for MountEvent that serializes mount events with detailed mount point information, identifiers, and path details. Required fields include mount_id, parent_mount_id, bind_src_mount_id, and device.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_33\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"mp\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"Mount point file information\"\n        },\n        \"root\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"Root file information\"\n        },\n        \"mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"Mount ID of the new mount\"\n        },\n        \"parent_mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"Mount ID of the parent mount\"\n        },\n        \"bind_src_mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"Mount ID of the source of a bind mount\"\n        },\n        \"device\": {\n            \"type\": \"integer\",\n            \"description\": \"Device associated with the file\"\n        },\n        \"fs_type\": {\n            \"type\": \"string\",\n            \"description\": \"Filesystem type\"\n        },\n        \"mountpoint.path\": {\n            \"type\": \"string\",\n            \"description\": \"Mount point path\"\n        },\n        \"source.path\": {\n            \"type\": \"string\",\n            \"description\": \"Mount source path\"\n        },\n        \"mountpoint.path_error\": {\n            \"type\": \"string\",\n            \"description\": \"Mount point path error\"\n        },\n        \"source.path_error\": {\n            \"type\": \"string\",\n            \"description\": \"Mount source path error\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"mount_id\",\n        \"parent_mount_id\",\n        \"bind_src_mount_id\",\n        \"device\"\n    ],\n    \"description\": \"MountEventSerializer serializes a mount event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining FileEvent Serialization Schema in JSON\nDESCRIPTION: JSON schema definition for FileEventSerializer that extends the File schema with additional event-specific fields. Includes all File properties plus destination file information, new mount ID, device details, and filesystem type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_29\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"path\": {\n            \"type\": \"string\",\n            \"description\": \"File path\"\n        },\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"File basename\"\n        },\n        \"path_resolution_error\": {\n            \"type\": \"string\",\n            \"description\": \"Error message from path resolution\"\n        },\n        \"inode\": {\n            \"type\": \"integer\",\n            \"description\": \"File inode number\"\n        },\n        \"mode\": {\n            \"type\": \"integer\",\n            \"description\": \"File mode\"\n        },\n        \"in_upper_layer\": {\n            \"type\": \"boolean\",\n            \"description\": \"Indicator of file OverlayFS layer\"\n        },\n        \"mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"File mount ID\"\n        },\n        \"filesystem\": {\n            \"type\": \"string\",\n            \"description\": \"File filesystem name\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"File User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"File Group ID\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"File user\"\n        },\n        \"group\": {\n            \"type\": \"string\",\n            \"description\": \"File group\"\n        },\n        \"attribute_name\": {\n            \"type\": \"string\",\n            \"description\": \"File extended attribute name\"\n        },\n        \"attribute_namespace\": {\n            \"type\": \"string\",\n            \"description\": \"File extended attribute namespace\"\n        },\n        \"flags\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"File flags\"\n        },\n        \"access_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"File access time\"\n        },\n        \"modification_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"File modified time\"\n        },\n        \"change_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"File change time\"\n        },\n        \"package_name\": {\n            \"type\": \"string\",\n            \"description\": \"System package name\"\n        },\n        \"package_version\": {\n            \"type\": \"string\",\n            \"description\": \"System package version\"\n        },\n        \"hashes\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"List of cryptographic hashes of the file\"\n        },\n        \"hash_state\": {\n            \"type\": \"string\",\n            \"description\": \"State of the hashes or reason why they weren't computed\"\n        },\n        \"mount_path\": {\n            \"type\": \"string\",\n            \"description\": \"MountPath path of the mount\"\n        },\n        \"mount_source\": {\n            \"type\": \"string\",\n            \"description\": \"MountSource source of the mount\"\n        },\n        \"mount_origin\": {\n            \"type\": \"string\",\n            \"description\": \"MountOrigin origin of the mount\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"Target file information\"\n        },\n        \"new_mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"New Mount ID\"\n        },\n        \"device\": {\n            \"type\": \"integer\",\n            \"description\": \"Device associated with the file\"\n        },\n        \"fstype\": {\n            \"type\": \"string\",\n            \"description\": \"Filesystem type\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"uid\",\n        \"gid\"\n    ],\n    \"description\": \"FileEventSerializer serializes a file event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining NetworkFlowMonitor Schema in JSON\nDESCRIPTION: JSON schema for NetworkFlowMonitor that tracks network flows with statistics across devices. References NetworkDevice for device information and Flow schema for capturing detailed flow metrics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_36\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"device\": {\n            \"$ref\": \"#/$defs/NetworkDevice\",\n            \"description\": \"device is the network device on which the event was captured\"\n        },\n        \"flows\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/Flow\"\n            },\n            \"type\": \"array\",\n            \"description\": \"flows is the list of flows with network statistics that were captured\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"NetworkFlowMonitorSerializer defines a network monitor event serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Explaining ConfigResolver Package Functionality in Markdown\nDESCRIPTION: This snippet describes the purpose of the 'configresolver' package, which provides a 'Resolve' function to substitute template variables in configuration files with actual service data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/configresolver/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# package `configresolver`\n\nThis package is providing the `Resolve` function that will resolve a given configuration template\nagainst a given service by replacing templates variables with corresponding data from the service\n```\n\n----------------------------------------\n\nTITLE: Providing Values to Fx Groups in Go\nDESCRIPTION: Demonstrates how to add a server.Endpoint type to a named 'server' group using struct field tags. Shows the pattern for contributing values to an Fx group that can be collected elsewhere.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/common-patterns.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ntype Provides struct {\n    comp     Component\n    Endpoint server.Endpoint `group:\"server\"`\n}\n```\n\n----------------------------------------\n\nTITLE: SECL Rule with Duration for File Access in JavaScript\nDESCRIPTION: Demonstrates a SECL rule that uses duration to trigger on events occurring within a specific time period. This example checks for access to a secret file more than 5 seconds after a Java process is created.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/agent_expressions.md#2025-04-22_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/etc/secret\" && process.file.name == \"java\" && process.created_at > 5s\n```\n\n----------------------------------------\n\nTITLE: Running RtLoader Tests with Make\nDESCRIPTION: Command to run the Golang-based test suite for RtLoader from the root folder, which uses cgo to test the C/C++ functionality.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/README.md#2025-04-22_snippet_5\n\nLANGUAGE: sh\nCODE:\n```\nmake -C test\n```\n\n----------------------------------------\n\nTITLE: Describing Collector Package Structure in Markdown\nDESCRIPTION: This markdown snippet outlines the purpose of the collector package and provides links to subpackage documentation. It explains that the package handles check creation, scheduling, and execution.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# package `collector`\n\nThis package is responsible for providing any resource and functionality needed in a check\nlife cycle: create a check instance, schedule a check, running\na check are all operations implemented in this package or one of the subpackages.\n\nFor further details, please refer to the specific READMEs:\n\n* [check](check/README.md)\n* [scheduler](scheduler/README.md)\n```\n\n----------------------------------------\n\nTITLE: Registering and Implementing Connectivity Diagnostics in Go\nDESCRIPTION: This code snippet demonstrates how to register a diagnose suite for connectivity checks and implement the diagnostic function. It checks connectivity to Datadog core endpoints and returns a list of diagnoses.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/diagnose/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Go\nCODE:\n```\npackage connectivity\n\nimport (\n    ...\n\t\"github.com/DataDog/datadog-agent/pkg/diagnose/diagnosis\"\n    ...\n)\n...\nfunc init() {\n\tdiagnosis.Register(\"connectivity-datadog-core-endpoints\", diagnose)\n}\n...\nfunc diagnose(diagCfg diagnosis.Config) []diagnosis.Diagnosis {\n    ...\n    var diagnoses []diagnosis.Diagnosis\n    ...\n\tfor _, domainResolver := range domainResolvers {\n        ...\n\t\tfor _, apiKey := range domainResolver.GetAPIKeys() {\n\t\t\tfor _, endpointInfo := range endpointsInfo {\n                ...\n\t\t\t\tname := \"Connectivity to \" + logURL\n\t\t\t\tif reportErr == nil {\n\t\t\t\t\tdiagnoses = append(diagnoses, diagnosis.Diagnosis{\n\t\t\t\t\t\tResult:    diagnosis.DiagnosisSuccess,\n\t\t\t\t\t\tName:      name,\n\t\t\t\t\t\tDiagnosis: fmt.Sprintf(\"Connectivity to `%s` is Ok\\n%s\", logURL, report),\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\tdiagnoses = append(diagnoses, diagnosis.Diagnosis{\n\t\t\t\t\t\tResult:      diagnosis.DiagnosisFail,\n\t\t\t\t\t\tName:        name,\n\t\t\t\t\t\tDiagnosis:   fmt.Sprintf(\"Connection to `%s` failed\\n%s\", logURL, report),\n\t\t\t\t\t\tRemediation: \"Please validate Agent configuration and firewall to access \" + logURL,\n\t\t\t\t\t\tRawError:    err,\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn diagnoses\n}\n```\n\n----------------------------------------\n\nTITLE: Defining SECL Expression Format in JavaScript\nDESCRIPTION: Demonstrates the standard format of a SECL expression for Datadog's Workload Protection rules. It shows the general structure of how event types, attributes, operators, and values are combined.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/agent_expressions.md#2025-04-22_snippet_0\n\nLANGUAGE: javascript\nCODE:\n```\n<event-type>.<event-attribute> <operator> <value> [<operator> <event-type>.<event-attribute>] ...\n```\n\n----------------------------------------\n\nTITLE: Creating a Dockerfile for Patching Datadog Agent Binary\nDESCRIPTION: Dockerfile instructions to quickly test changes or bug fixes in containerized environments by patching the Agent binary from an official Docker image.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_build.md#2025-04-22_snippet_2\n\nLANGUAGE: dockerfile\nCODE:\n```\nFROM datadog/agent:<AGENT_VERSION>\n\nCOPY agent /opt/datadog-agent/bin/agent/agent\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for MountEvent in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing a mount event in the Datadog Agent. It includes properties for mount point and root file information, mount IDs, device, filesystem type, and paths.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_10\n\nLANGUAGE: JSON\nCODE:\n```\n\"MountEvent\": {\n    \"properties\": {\n        \"mp\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"Mount point file information\"\n        },\n        \"root\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"Root file information\"\n        },\n        \"mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"Mount ID of the new mount\"\n        },\n        \"parent_mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"Mount ID of the parent mount\"\n        },\n        \"bind_src_mount_id\": {\n            \"type\": \"integer\",\n            \"description\": \"Mount ID of the source of a bind mount\"\n        },\n        \"device\": {\n            \"type\": \"integer\",\n            \"description\": \"Device associated with the file\"\n        },\n        \"fs_type\": {\n            \"type\": \"string\",\n            \"description\": \"Filesystem type\"\n        },\n        \"mountpoint.path\": {\n            \"type\": \"string\",\n            \"description\": \"Mount point path\"\n        },\n        \"source.path\": {\n            \"type\": \"string\",\n            \"description\": \"Mount source path\"\n        },\n        \"mountpoint.path_error\": {\n            \"type\": \"string\",\n            \"description\": \"Mount point path error\"\n        },\n        \"source.path_error\": {\n            \"type\": \"string\",\n            \"description\": \"Mount source path error\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"mount_id\",\n        \"parent_mount_id\",\n        \"bind_src_mount_id\",\n        \"device\"\n    ],\n    \"description\": \"MountEventSerializer serializes a mount event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Using Plain Data Types with Fx in Datadog Agent\nDESCRIPTION: Illustrates how to use plain data types with Fx in the Datadog Agent. This example shows how to use fx.Supply to provide a custom type to Fx and use it alongside components.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/using-components.md#2025-04-22_snippet_4\n\nLANGUAGE: go\nCODE:\n```\nimport (\n    logfx \"github.com/DataDog/datadog-agent/comp/core/log/fx\"\n    log \"github.com/DataDog/datadog-agent/comp/core/log/def\"\n)\n\n// plain custom type\ntype custom struct {}\n\n// [...]\n    return fxutil.OneShot(\n        myTestCallback,\n        logfx.Module(),\n\n        // fx.Supply populates values into Fx. \n        // Any time this is needed, Fx will use it.\n        fx.Supply(custom{})\n    )\n// [...]\n\n// Here our function uses component and non-component type, both provided by Fx.\nfunc myTestCallback(logger log.Component, c custom) {\n    logger.Info(\"Custom type: %v\", c)\n}\n```\n\n----------------------------------------\n\nTITLE: Standard Component Folder Structure in Datadog Agent\nDESCRIPTION: The recommended folder structure for a standard component in the Datadog Agent, showing the organization of definition, implementation, dependency injection, and mock files.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_9\n\nLANGUAGE: plaintext\nCODE:\n```\ncomp/<COMPONENT_NAME>/\n├── def\n│   └── component.go\n├── fx\n│   └── fx.go\n├── impl\n│   └── component.go\n└── mock\n    └── mock.go\n\n4 directories, 4 files\n```\n\n----------------------------------------\n\nTITLE: Querying RTLoader Expvars using cURL\nDESCRIPTION: Demonstrates how to query the RTLoader expvars using cURL and jq for easy inspection of memory usage statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\ncurl http://localhost:5000/debug/vars | jq .rtloader\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Extension in OpenTelemetry Collector\nDESCRIPTION: YAML configuration for adding the Datadog extension to the OpenTelemetry collector. The configuration specifies the port (7777) on which the extension will expose data for flare collection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddflareextension/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nextensions:\n datadog:\n   port: 7777\n```\n\n----------------------------------------\n\nTITLE: Storage Operation Duration Metrics - Prometheus Format\nDESCRIPTION: Prometheus histogram metrics measuring duration of various Kubernetes storage operations like volume mounting, controller attachment verification, and FSGroup operations. The metrics are broken down by operation name, status, volume plugin type and include buckets, sum and count values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_51\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"15\"} 31\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_fsgroup_recursive_apply\",status=\"fail-unknown\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.1\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.1\"} 130856\n```\n\n----------------------------------------\n\nTITLE: Defining SignalEvent JSON Schema for Process Signal Events\nDESCRIPTION: JSON schema definition for the SignalEvent structure which captures information about signals sent between processes. It includes the signal type, target process ID, and context of the target process.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_49\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"type\": {\n            \"type\": \"string\",\n            \"description\": \"signal type\"\n        },\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"signal target pid\"\n        },\n        \"target\": {\n            \"$ref\": \"#/$defs/ProcessContext\",\n            \"description\": \"process context of the signal target\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"type\",\n        \"pid\"\n    ],\n    \"description\": \"SignalEventSerializer serializes a signal event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Retrieving Tags for an Entity in Python\nDESCRIPTION: Defines a function 'tag' that retrieves tags for a given entity ID and cardinality level. It returns a list of tags or None, and may raise exceptions for processing errors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/tagger.md#2025-04-22_snippet_1\n\nLANGUAGE: python\nCODE:\n```\ndef tag(id, cardinality):\n    \"\"\"Get tags for an entity.\n\n    Args:\n        id (string): entity identifier.\n        cardinality (int): constant representing cardinality.\n\n    Returns:\n        List of tags or None.\n\n    Raises:\n        Appropriate exception if an error occurred while processing params.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Initializing ZSTD Compression Component in Go\nDESCRIPTION: Defines the NewComponent function for the ZSTD compression implementation. It demonstrates the basic structure of a component initialization function, including the Requires and Provides structs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\npackage zstdimpl\n\n// NewComponent returns a new ZSTD implementation for the compression component\nfunc NewComponent(reqs Requires) Provides {\n    ....\n}\n```\n\n----------------------------------------\n\nTITLE: Fetching Scheduler Information using ExpVar API in Bash\nDESCRIPTION: This example shows how to retrieve scheduler information from the ExpVar API. It uses curl to send a request to the localhost endpoint and jq to parse the JSON response.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_api.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n$ curl -s http://localhost:5000/debug/vars | jq '.scheduler'\n```\n\n----------------------------------------\n\nTITLE: Running Local Regression Experiment with SMP CLI\nDESCRIPTION: This command demonstrates how to run a regression experiment locally using the SMP CLI tool. It specifies the experiment directory, case name, and target Docker image for the Datadog Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/regression/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nsmp local-run --experiment-dir ~/dev/datadog-agent/test/regression/ --case uds_dogstatsd_to_api --target-image datadog/agent-dev:nightly-main-fe13dead-py3\n```\n\n----------------------------------------\n\nTITLE: Configuring Kubernetes Attributes in OpenTelemetry Collector\nDESCRIPTION: Comprehensive configuration for the OpenTelemetry collector running as a Kubernetes DaemonSet. This configuration shows how to set up resource detection, Kubernetes attributes processing, and Datadog exporting in a complete collector setup.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/otlp/components/processor/infraattributesprocessor/README.md#2025-04-22_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\nmode: daemonset\npresets:\n  kubernetesAttributes:\n    enabled: true\nextraEnvs:\n  - name: POD_IP\n    valueFrom:\n      fieldRef:\n        fieldPath: status.podIP\n  - name: OTEL_RESOURCE_ATTRIBUTES\n    value: \"k8s.pod.ip=$(POD_IP)\"\nconfig:\n  processors:\n    k8sattributes:\n      passthrough: false\n      auth_type: \"serviceAccount\"\n      pod_association:\n        - sources:\n            - from: resource_attribute\n              name: k8s.pod.ip\n      extract:\n        metadata:\n          - k8s.pod.name\n          - k8s.pod.uid\n          - k8s.deployment.name\n          - k8s.node.name\n          - k8s.namespace.name\n          - k8s.pod.start_time\n          - k8s.replicaset.name\n          - k8s.replicaset.uid\n          - k8s.daemonset.name\n          - k8s.daemonset.uid\n          - k8s.job.name\n          - k8s.job.uid\n          - k8s.cronjob.name\n          - k8s.statefulset.name\n          - k8s.statefulset.uid\n          - container.image.name\n          - container.image.tag\n          - container.id\n          - k8s.container.name\n          - container.image.name\n          - container.image.tag\n          - container.id\n        labels:\n          - tag_name: kube_app_name\n            key: app.kubernetes.io/name\n            from: pod\n          - tag_name: kube_app_instance\n            key: app.kubernetes.io/instance\n            from: pod\n          - tag_name: kube_app_version\n            key: app.kubernetes.io/version\n            from: pod\n          - tag_name: kube_app_component\n            key: app.kubernetes.io/component\n            from: pod\n          - tag_name: kube_app_part_of\n            key: app.kubernetes.io/part-of\n            from: pod\n          - tag_name: kube_app_managed_by\n            key: app.kubernetes.io/managed-by\n            from: pod\n    resourcedetection:\n      detectors: [env, eks, ec2, system]\n      timeout: 2s\n      override: false\n    batch:\n      send_batch_max_size: 1000\n      send_batch_size: 100\n      timeout: 10s\n  exporters:\n    datadog:\n      api:\n        site: ${env:DD_SITE}\n        key: ${env:DD_API_KEY}\n      traces:\n        trace_buffer: 500\n  service:\n    pipelines:\n      metrics:\n        receivers: [otlp]\n        processors: [batch, resourcedetection, k8sattributes]\n        exporters: [datadog]\n      traces:\n        receivers: [otlp]\n        processors: [batch, resourcedetection, k8sattributes]\n        exporters: [datadog]\n      logs:\n        receivers: [otlp]\n        processors: [batch, resourcedetection, k8sattributes]\n        exporters: [datadog]\n```\n\n----------------------------------------\n\nTITLE: Visualizing Logs Agent Pipeline and Processing Architecture\nDESCRIPTION: ASCII diagram illustrating the 'logging messages' portion of the logs agent, showing the flow from Tailers through Decoders, Processors, Strategies, Senders, and Destinations to finally reach the DataDog Intake.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/logs/README.md#2025-04-22_snippet_1\n\nLANGUAGE: text\nCODE:\n```\n  ┌───────────────────┐\n┌►│      Tailer       │  ─┐\n│ └─────────┬─────────┘   │\n│           │             │ input\n│           ▼             │ (many)\n│ ┌───────────────────┐   │\n│ │      Decoder      │  ─┘\n│ └─────────┬─────────┘\n│           │\n│           ▼\n│ ┌───────────────────┐\n│ │     Processor     │  ─┐\n│ └─────────┬─────────┘   │\n│           │             │\n│           ▼             │\n│ ┌───────────────────┐   │\n│ │     Strategy      │   │\n│ └─────────┬─────────┘   │\n│           │             │ pipeline\n│           ▼             │ (few)\n│ ┌───────────────────┐   │\n│ │      Sender       │   │\n│ └─────────┬─────────┘   │\n│           │             │\n│           ▼             │\n│ ┌───────────────────┐   │\n│ │    Destination    │  ─┘\n│ └─────────┬──────┬──┘\n│           │      └────►DataDog\n│           ▼            Intake\n│ ┌───────────────────┐\n│ │      Auditor      │\n│ └─────────┬─────────┘\n└───────────┘\n```\n\n----------------------------------------\n\nTITLE: Using Process PID Variable in SECL Rule\nDESCRIPTION: This example shows how to use the process.pid variable in a SECL rule. It checks if the open file path matches a specific process-related file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/linux_expressions.md#2025-04-22_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/proc/${process.pid}/maps\"\n\n```\n\n----------------------------------------\n\nTITLE: Defining RawPacket JSON Schema for Network Event Serialization\nDESCRIPTION: JSON schema definition for the RawPacket structure which captures network packet metadata. This schema defines required fields for layer 3 and layer 4 protocols, network endpoints, packet size, and direction.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_42\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"device\": {\n            \"$ref\": \"#/$defs/NetworkDevice\",\n            \"description\": \"device is the network device on which the event was captured\"\n        },\n        \"l3_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l3_protocol is the layer 3 protocol name\"\n        },\n        \"l4_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l4_protocol is the layer 4 protocol name\"\n        },\n        \"source\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"source is the emitter of the network event\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"destination is the receiver of the network event\"\n        },\n        \"size\": {\n            \"type\": \"integer\",\n            \"description\": \"size is the size in bytes of the network event\"\n        },\n        \"network_direction\": {\n            \"type\": \"string\",\n            \"description\": \"network_direction indicates if the packet was captured on ingress or egress\"\n        },\n        \"tls\": {\n            \"$ref\": \"#/$defs/TLSContext\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"l3_protocol\",\n        \"l4_protocol\",\n        \"source\",\n        \"destination\",\n        \"size\",\n        \"network_direction\"\n    ],\n    \"description\": \"RawPacketSerializer defines a raw packet serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Kubernetes Healthcheck Metrics in Prometheus\nDESCRIPTION: This snippet defines two Prometheus metrics for Kubernetes healthchecks. The 'kubernetes_healthcheck' metric records individual healthcheck results, while 'kubernetes_healthchecks_total' aggregates the results of all healthchecks. Both metrics use labels to distinguish between different healthcheck types and statuses.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/slis.txt#2025-04-22_snippet_0\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubernetes_healthcheck [ALPHA] This metric records the result of a single healthcheck.\n# TYPE kubernetes_healthcheck gauge\nkubernetes_healthcheck{name=\"log\",type=\"healthz\"} 1\nkubernetes_healthcheck{name=\"ping\",type=\"healthz\"} 1\nkubernetes_healthcheck{name=\"syncloop\",type=\"healthz\"} 1\n# HELP kubernetes_healthchecks_total [ALPHA] This metric records the results of all healthcheck.\n# TYPE kubernetes_healthchecks_total gauge\nkubernetes_healthchecks_total{name=\"log\",status=\"success\",type=\"healthz\"} 14319\nkubernetes_healthchecks_total{name=\"ping\",status=\"success\",type=\"healthz\"} 14321\nkubernetes_healthchecks_total{name=\"syncloop\",status=\"success\",type=\"healthz\"} 14319\n```\n\n----------------------------------------\n\nTITLE: Defining ExitEvent JSON Schema\nDESCRIPTION: JSON schema for serializing an exit event, including properties for the cause and code of process termination.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_27\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"cause\": {\n            \"type\": \"string\",\n            \"description\": \"Cause of the process termination (one of EXITED, SIGNALED, COREDUMPED)\"\n        },\n        \"code\": {\n            \"type\": \"integer\",\n            \"description\": \"Exit code of the process or number of the signal that caused the process to terminate\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"cause\",\n        \"code\"\n    ],\n    \"description\": \"ExitEventSerializer serializes an exit event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Process Schema Definition\nDESCRIPTION: JSON schema for process information including PID, execution details, and container context.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_14\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"Process ID\"\n        },\n        \"ppid\": {\n            \"type\": \"integer\",\n            \"description\": \"Parent Process ID\"\n        },\n        \"exec_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exec time of the process\"\n        },\n        \"exit_time\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Exit time of the process\"\n        },\n        \"executable\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"File information of the executable\"\n        },\n        \"container\": {\n            \"$ref\": \"#/$defs/ContainerContext\",\n            \"description\": \"Container context\"\n        },\n        \"cmdline\": {\n            \"type\": \"string\",\n            \"description\": \"Command line arguments\"\n        },\n        \"user\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"ProcessSerializer serializes a process to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Generating HTTP Headers for Datadog Agent Integration Requests in Python\nDESCRIPTION: This function creates a standard set of HTTP headers for integration HTTP requests. It's not used by official Datadog integrations but may be used by custom checks. The function takes an agent configuration and an optional HTTP host, returning a dictionary of headers or None.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/util.md#2025-04-22_snippet_0\n\nLANGUAGE: Python\nCODE:\n```\ndef headers(agentConfig, http_host=None):\n    \"\"\"Get standard set of HTTP headers to use to perform HTTP requests from an\n    integration.\n\n    NOTE: This function isn't used by any official integration provided by\n    Datadog but custom checks might still rely on it.\n\n    Args:\n        agentConfig (dict): ignored, can be None.\n        http_host: value for the `Host` header.\n\n    Returns:\n        A dictionary containing HTTP headers or None.\n    \"\"\"\n```\n\n----------------------------------------\n\nTITLE: Deploying DogStatsD6 as Kubernetes DaemonSet with Unix Domain Socket\nDESCRIPTION: This Kubernetes manifest deploys DogStatsD6 as a DaemonSet using the Unix Domain Socket protocol. It's configured to run alongside an existing agent5, with metadata collection disabled and the hostname set to the node name.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/dogstatsd/alpine/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: dogstatsd\nspec:\n  selector:\n    matchLabels:\n      app: dogstatsd\n  template:\n    metadata:\n      labels:\n        app: dogstatsd\n      name: dogstatsd\n    spec:\n      containers:\n      - image: datadog/dogstatsd:latest\n        imagePullPolicy: Always\n        name: dogstatsd\n        env:\n          - name: DD_API_KEY\n            value: ___value___\n          - name: DD_DOGSTATSD_SOCKET\n            value: \"/socket/statsd.socket\"\n          - name: DD_SEND_HOST_METADATA\n            # Legacy option name, keep as `false` when running alongside another Agent\n            value: \"false\"\n          - name: DD_ENABLE_METADATA_COLLECTION\n            value: \"false\"\n          - name: DD_HOSTNAME\n            valueFrom:\n              fieldRef:\n                fieldPath: spec.nodeName\n        volumeMounts:\n          - name: dsdsocket\n            mountPath: /socket\n      volumes:\n        - hostPath:\n            path: /var/run/dogstatsd\n          name: dsdsocket\n```\n\n----------------------------------------\n\nTITLE: Submitting Samples to MonotonicCount in Datadog Agent\nDESCRIPTION: Example demonstrating how MonotonicCount tracks increasing counter values. This metric type ignores samples with lower values than previous ones, calculating the difference between the current and initial value across flush periods.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/metrics/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\nSubmitting samples `2`, `3`, `6`, `7` returns `5` (i.e. `7`-`2`) on flush, then submitting\nsamples `10`, `11` on the same MonotonicCount returns `4` (i.e. `11`-`7`) on the second flush.\n```\n\n----------------------------------------\n\nTITLE: Describing Launchers in Datadog Agent\nDESCRIPTION: This snippet defines launchers in the context of the Datadog Agent. It explains that launchers translate log sources to tailers and manage their lifecycle. The logs agent maintains a set of launchers, starting and stopping them as needed.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/logs/launchers/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Launchers\n\nLaunchers are responsible for translating sources (sources.LogSource) to tailers, and managing their tailers' lifecycle.\n\nThe logs agent maintains a set of current launchers, starting and stopping them at startup and stopping them when the logs-agent stops.\n```\n\n----------------------------------------\n\nTITLE: Example GPU Inventory Host Payload in JSON\nDESCRIPTION: This snippet demonstrates the structure of a GPU inventory host payload, including host information and detailed GPU device metadata for multiple devices.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/hostgpu/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"host_gpu_metadata\": {\n        \"devices\": [\n            {\n                \"gpu_index\": 0,\n                \"gpu_vendor\": \"nvidia\",\n                \"gpu_device\": \"Tesla V100\",\n                \"gpu_driver_version\": \"460.32.03\",\n                \"gpu_uuid\": \"GPU-12345678-1234-5678-1234-567812345678\",\n                \"gpu_architecture\": \"volta\",\n                \"gpu_compute_version\": \"7.0\",\n                \"gpu_total_cores\": 4010,\n                \"device_total_memory\": 16384,\n                \"device_max_sm_clock_rate\": 1530,\n                \"device_max_memory_clock_rate\": \"877\",\n                \"device_memory_bus_width\": \"4096\"\n            },\n            {\n                \"gpu_index\": 1,\n                \"gpu_vendor\": \"nvidia\",\n                \"gpu_device\": \"Tesla T4\",\n                \"gpu_driver_version\": \"460.32.03\",\n                \"gpu_uuid\": \"GPU-87654321-4321-8765-4321-876543218765\",\n                \"gpu_architecture\": \"turing\",\n                \"gpu_compute_version\": \"7.5\",\n                \"gpu_total_cores\": 2040,\n                \"device_total_memory\": 16384,\n                \"device_max_sm_clock_rate\": 1590,\n                \"device_max_memory_clock_rate\": \"6251\",\n                \"device_memory_bus_width\": \"256\"\n            }\n        ]\n    },\n    \"hostname\": \"my-host\",\n    \"timestamp\": 1631281754507358895\n}\n```\n\n----------------------------------------\n\nTITLE: Documenting Kubernetes State Core Check in Markdown\nDESCRIPTION: This markdown snippet introduces the Kubernetes State Core Check, explains its relationship to kube-state-metrics, and provides links to documentation. It also includes important notes for maintaining the documentation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/cluster/ksm/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Kubernetes State Core Check\n\nThe Kubernetes State Core Check is an alternative to [Kubernetes State Python Check](https://github.com/DataDog/integrations-core/tree/master/kubernetes_state). It leverages the `kube-state-metrics` project and extends it to generate Datadog metrics.\n\n[Public documentation page.](https://docs.datadoghq.com/integrations/kubernetes_state_core)\n\n**Notes:**\n\n- The data collected by the checks is documented in `kubernetes_state.md`. The file shares the same format used for the public documentation to ease the synchronization.\n- If a code change updates/removes/adds metrics or service checks, please update `kubernetes_state.md` accordingly.\n- The public documentation page lives in the [DataDog/integrations-core repo](https://github.com/DataDog/integrations-core/blob/master/kubernetes_state_core/README.md). It needs to be synchronized with `kubernetes_state.md` on every new release of the Agent.\n```\n\n----------------------------------------\n\nTITLE: Importing and Using Log Component in Datadog Agent\nDESCRIPTION: Demonstrates how to import and use the log component in a Datadog Agent command. This example shows how to require the log component using Fx and use it in a callback function.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/using-components.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\nimport (\n    // First let's import the FX wrapper to require it\n    logfx \"github.com/DataDog/datadog-agent/comp/core/log/fx\"\n    // Then the logger interface to use it\n    log \"github.com/DataDog/datadog-agent/comp/core/log/def\"\n)\n\n// [...]\n    return fxutil.OneShot(\n        myTestCallback, // The function to call from fxutil.OneShot\n        logfx.Module(), // This will tell FX how to create the `log.Component`\n    )\n// [...]\n\nfunc myTestCallback(logger log.Component) {\n    logger.Info(\"some message\")\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring ddprofiling Extension for OSS Collector in YAML\nDESCRIPTION: Example configuration for the ddprofiling extension in the OSS collector. It specifies the API key and site using environment variables.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddprofilingextension/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nextensions:\n  ddprofiling: \n    api:\n      key: ${env:DD_API_KEY}\n      site: ${env:DD_SITE}\n```\n\n----------------------------------------\n\nTITLE: Installing Python 3.12 Development Files on Ubuntu\nDESCRIPTION: Command to install Python 3.12 development files on Ubuntu Linux. These files are required for building the Datadog Agent with Python support.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nsudo apt-get install python3.12-dev\n```\n\n----------------------------------------\n\nTITLE: Defining Container Last Seen Metric in Prometheus Format\nDESCRIPTION: This snippet defines the 'container_last_seen' metric type as a gauge and provides multiple instances of the metric with different label combinations. Each metric represents the last time a specific container or pod was seen, with timestamps in Unix epoch format.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_12\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_last_seen gauge\ncontainer_last_seen{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572450203e+09 1572450203042\ncontainer_last_seen{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572450203e+09 1572450203034\ncontainer_last_seen{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572450203e+09 1572450203033\n# ... (additional metrics omitted for brevity)\ncontainer_last_seen{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.572450203e+09 1572450203039\n```\n\n----------------------------------------\n\nTITLE: Defining NetworkStats Schema in JSON\nDESCRIPTION: JSON schema for NetworkStats that records data transfer statistics including total bytes transferred and packet counts. Used for monitoring network traffic volume.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_37\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"data_size\": {\n            \"type\": \"integer\",\n            \"description\": \"data_size is the total count of bytes sent or received\"\n        },\n        \"packet_count\": {\n            \"type\": \"integer\",\n            \"description\": \"packet_count is the total count of packets sent or received\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"NetworkStatsSerializer defines a new network stats serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema Field in Go\nDESCRIPTION: Shows how to define a field in Go that will be used in the JSON schema, including its JSON tag and description.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/README.md#2025-04-22_snippet_3\n\nLANGUAGE: go\nCODE:\n```\nPath string `json:\"path,omitempty\" jsonschema_description:\"File path\"`\n```\n\n----------------------------------------\n\nTITLE: BPF Commands Constants Table\nDESCRIPTION: A table defining BPF syscall commands supported across all architectures. These constants are used to specify different operations that can be performed through the BPF syscall interface.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_12\n\nLANGUAGE: text\nCODE:\n```\n| Name | Architectures |\n| ---- |---------------|\n| `BPF_MAP_CREATE` | all |\n| `BPF_MAP_LOOKUP_ELEM` | all |\n| `BPF_MAP_UPDATE_ELEM` | all |\n| `BPF_MAP_DELETE_ELEM` | all |\n| `BPF_MAP_GET_NEXT_KEY` | all |\n```\n\n----------------------------------------\n\nTITLE: Deploying DogStatsD Socat Proxy as a Kubernetes Sidecar Container\nDESCRIPTION: A Kubernetes deployment specification that demonstrates how to run the dogstatsd-socat-proxy as a sidecar container. The proxy forwards metrics from UDP port 8125 to the DogStatsD Unix Domain Socket. It requires mounting the socket directory to /socket in the container.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/dogstatsd/socat-proxy/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: test-producer\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: test-producer\n  template:\n    metadata:\n      labels:\n        app: test-producer\n    spec:\n      containers:\n        - **[insert producer container specs]**\n        - name: socat\n          image: datadog/dogstatsd-socat-proxy:beta\n          ports:\n            - containerPort: 8125\n              name: dogstatsdport\n              protocol: UDP\n          volumeMounts:\n            - name: dsdsocket\n              mountPath: /socket\n      volumes:\n        - hostPath:\n            path: /var/run/dogstatsd\n          name: dsdsocket\n```\n\n----------------------------------------\n\nTITLE: Running Ebpfless Security Agent Tests in Bash\nDESCRIPTION: Command to run all ebpfless functional tests for the security agent component. Uses the dda invoke command with the security-agent.ebpfless-functional-tests task instead of the standard functional tests.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/security/tests/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e security-agent.ebpfless-functional-tests --verbose --skip-linters --testflags \"-test.run '.*'\"\n```\n\n----------------------------------------\n\nTITLE: Defining a Scrubber Component Interface in Go\nDESCRIPTION: This snippet defines a Component interface for a scrubber, which includes a method for scrubbing strings. It demonstrates how interfaces are typically used to define component contracts in the Datadog Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ntype Component interface {\n    ScrubString(string) string\n}\n```\n\n----------------------------------------\n\nTITLE: Installing gRPC and Protobuf Dependencies for Datadog Agent\nDESCRIPTION: Sets up all required binaries for protobuf and gRPC code generation. This command installs protoc-gen-go, protoc-gen-grpc-gateway, and protoc-gen-swagger in your GOPATH/bin directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/proto/datadog/api/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndda inv setup\n```\n\n----------------------------------------\n\nTITLE: Configuring SNMP v3 Authentication and Privacy Options for Datadog Agent\nDESCRIPTION: This snippet provides multiple configuration options for SNMP v3 users in the Datadog Agent. It includes various combinations of authentication protocols (NoAuth, MD5, SHA) and privacy protocols (NoPriv, DES, AES, AES192, AES256) with their respective keys.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/ndm/snmp/compose/data/args_list.txt#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n--v3-user=datadogNoAuthNoPriv\n--v3-user=datadogMD5NoPriv --v3-auth-key=doggiepass --v3-auth-proto=MD5\n--v3-user=datadogMD5DES --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=MD5 --v3-priv-proto=DES\n--v3-user=datadogMD5AES --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=MD5 --v3-priv-proto=AES\n--v3-user=datadogSHADES --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=SHA --v3-priv-proto=DES\n--v3-user=datadogSHAAES --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=SHA --v3-priv-proto=AES\n--v3-user=datadogSHAAES192 --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=SHA --v3-priv-proto=AES192\n--v3-user=datadogSHAAES192BLMT --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=SHA --v3-priv-proto=AES192BLMT\n--v3-user=datadogSHAAES256 --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=SHA --v3-priv-proto=AES256\n--v3-user=datadogSHAAES256BLMT --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=SHA --v3-priv-proto=AES256BLMT\n--v3-user=datadogMD5AES192 --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=MD5 --v3-priv-proto=AES192\n--v3-user=datadogMD5AES192BLMT --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=MD5 --v3-priv-proto=AES192BLMT\n--v3-user=datadogMD5AES256 --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=MD5 --v3-priv-proto=AES256\n--v3-user=datadogMD5AES256BLMT --v3-auth-key=doggiepass --v3-priv-key=doggiePRIVkey --v3-auth-proto=MD5 --v3-priv-proto=AES256BLMT\n```\n\n----------------------------------------\n\nTITLE: Defining NetworkContext Schema in JSON\nDESCRIPTION: JSON schema for NetworkContext that captures network event details including protocols, source/destination IP addresses, size, and direction. References NetworkDevice and IPPort schemas for device and endpoint information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_34\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"device\": {\n            \"$ref\": \"#/$defs/NetworkDevice\",\n            \"description\": \"device is the network device on which the event was captured\"\n        },\n        \"l3_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l3_protocol is the layer 3 protocol name\"\n        },\n        \"l4_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l4_protocol is the layer 4 protocol name\"\n        },\n        \"source\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"source is the emitter of the network event\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"destination is the receiver of the network event\"\n        },\n        \"size\": {\n            \"type\": \"integer\",\n            \"description\": \"size is the size in bytes of the network event\"\n        },\n        \"network_direction\": {\n            \"type\": \"string\",\n            \"description\": \"network_direction indicates if the packet was captured on ingress or egress\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"l3_protocol\",\n        \"l4_protocol\",\n        \"source\",\n        \"destination\",\n        \"size\",\n        \"network_direction\"\n    ],\n    \"description\": \"NetworkContextSerializer serializes the network context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring ddprofiling Extension for OTel Agent in YAML\nDESCRIPTION: Example configuration for the ddprofiling extension in the OTel agent. It sets a custom endpoint port for the HTTP server that receives profiles.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddprofilingextension/README.md#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\nextensions:\n  ddprofiling: \n    endpoint: 1234\n```\n\n----------------------------------------\n\nTITLE: Configuring Extensions in YAML\nDESCRIPTION: Example configuration for manually setting up pprof, health_check, zpages, and datadog extensions when opting out of automatic configuration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/converter/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nextensions.yaml\n```\n\n----------------------------------------\n\nTITLE: UserContext Schema Definition\nDESCRIPTION: Defines the structure for user context information, including user name and SID (Security Identifier). This schema captures user identity details associated with events processed by the Datadog Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_9\n\nLANGUAGE: json\nCODE:\n```\n{\n            \"properties\": {\n                \"name\": {\n                    \"type\": \"string\",\n                    \"description\": \"User name\"\n                },\n                \"sid\": {\n                    \"type\": \"string\",\n                    \"description\": \"Owner Sid\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"UserContextSerializer serializes a user context to JSON\"\n        }\n```\n\n----------------------------------------\n\nTITLE: Filtering Process Arguments by IP Address\nDESCRIPTION: Example demonstrating how to match processes that have a specific IP address in their arguments using the argv field. Matches any process containing 127.0.0.1 as an argument.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_6\n\nLANGUAGE: javascript\nCODE:\n```\nexec.argv in [\"127.0.0.1\"]\n```\n\n----------------------------------------\n\nTITLE: Setting Up Pipelines for Infra Attributes Processor\nDESCRIPTION: Pipeline configuration for integrating the infra attributes processor with OpenTelemetry collectors. This configuration shows how to include the processor in traces, metrics, and logs pipelines.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/otlp/components/processor/infraattributesprocessor/README.md#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\nservice:\n  pipelines:\n    traces:\n      receivers: [otlp]\n      processors: [infraattributes]\n      exporters: [datadog/connector, datadog]\n    metrics:\n      receivers: [otlp, datadog/connector]\n      processors: [infraattributes]\n      exporters: [datadog]\n    logs:\n      receivers: [otlp]\n      processors: [infraattributes]\n      exporters: [datadog]\n```\n\n----------------------------------------\n\nTITLE: Referencing Kernel Struct in eBPF\nDESCRIPTION: This code snippet shows a reference to the kernel struct sock, which is used by the tracer-bpf package to discover parameter storage locations. The struct's field offsets vary depending on kernel version and configuration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/ebpf/README.md#2025-04-22_snippet_0\n\nLANGUAGE: C\nCODE:\n```\n#include <net/sock.h>\n\nstruct sock { ... };\n```\n\n----------------------------------------\n\nTITLE: Example Dogstatsd Protocol 1.1 Payload Format\nDESCRIPTION: Example of the experimental Dogstatsd protocol 1.1 format that allows sending multiple values in a single datagram using the ':' delimiter. The example contains 3 values for a single metric.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/dogstatsd/README.md#2025-04-22_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\nmy_metric:1.5:20:30|h|#tag1,tag2\n```\n\n----------------------------------------\n\nTITLE: Visualizing Logs Agent Scheduler and Launcher Architecture\nDESCRIPTION: ASCII diagram illustrating the architecture of the 'what to log' portion of the logs agent, showing how Autodiscovery feeds into Schedulers, which populate Sources and Services, which are then processed by various Launchers to create tailers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/logs/README.md#2025-04-22_snippet_0\n\nLANGUAGE: text\nCODE:\n```\n                                  Autodiscovery\n                                        │\n                                        │integration.Config\n                                        │\n             ┌ -Schedulers - - - - - - -▼- - - - - - ┐\n               ┌──────────────┐   ┌──────────────┐\n             | │   Scheduler  │   │ ad.Scheduler │ … |\n               └──────────────┘   └──────────────┘\n             └ - - - - - - - - - - - - - - - - - - - ┘\n             sources.LogSource│    │service.Service\n                              │    │\n                              ▼    ▼\n                     ┌─────────┐  ┌──────────┐\n            ┌────────┤ Sources │  │ Services │\n            ▼        └┬──┬─────┘  └─┬──────┬─┘\n      ┌───────────┐   │  │   ▲ ▲    │      │\n   ┌──┤ Launchers │   │  │   │ │    │      │\n   │  └───────────┘   │  │ ┌────────┘      │\n   │                  ▼  │ │ │ │           │\n   │  ┌────────────────┐ │ │ │ │           │\n   ├──┤ file.Launcher  │ │ │ │ │           │\n   │  └────────────────┘ │ │ │ │           │\n   │                     ▼ ▼ │ │           ▼\n   │  ┌────────────────────┐ │ │ ┌─────────────────────┐\n   ├──┤ docker.Launcher    ├─┘ └─┤ kubernetes.Launcher │\n   │  └────────────────────┘     └─────────────────────┘\n   │    ▲                          ▲\n   │    └──container labels        └──pod annotations\n   ▼\ntailers\n```\n\n----------------------------------------\n\nTITLE: Implementing Clock-Based Testing in Go\nDESCRIPTION: Demonstrates a pattern for testing time-dependent functionality using a mock clock. Shows how to structure code to allow injection of a mock clock for testing while using a real clock in production. This approach helps avoid flaky tests and reduces test execution time.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/testing.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\nfunc NewThing(arg1, arg2) *Thing {\n    return newThingWithClock(arg1, arg2, clock.New())\n}\n\nfunc newThingWithClock(arg1, arg2, clock clock.Clock) *Thing {\n    return &Thing{\n        ...,\n        clock: clock,\n    }\n}\n\nfunc TestThingFunctionality(t *testing.T) {\n    clk := clock.NewMock()\n    thing := newThingWithClock(..., clk)\n\n    // ...\n\n    clk.Add(100 * time.Millisecond)\n\n    // ...\n}\n```\n\n----------------------------------------\n\nTITLE: Defining EventContext JSON Schema\nDESCRIPTION: JSON schema for serializing an event context, including properties for event details, matched rules, variables, and rule context.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_26\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"Event name\"\n        },\n        \"category\": {\n            \"type\": \"string\",\n            \"description\": \"Event category\"\n        },\n        \"outcome\": {\n            \"type\": \"string\",\n            \"description\": \"Event outcome\"\n        },\n        \"async\": {\n            \"type\": \"boolean\",\n            \"description\": \"True if the event was asynchronous\"\n        },\n        \"matched_rules\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/MatchedRule\"\n            },\n            \"type\": \"array\",\n            \"description\": \"The list of rules that the event matched (only valid in the context of an anomaly)\"\n        },\n        \"variables\": {\n            \"$ref\": \"#/$defs/Variables\",\n            \"description\": \"Variables values\"\n        },\n        \"rule_context\": {\n            \"$ref\": \"#/$defs/RuleContext\",\n            \"description\": \"RuleContext rule context\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"EventContextSerializer serializes an event context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Displaying Datadog Agent Inventory Payload in YAML\nDESCRIPTION: This snippet shows an example of an inventory payload for the Datadog Agent. It includes agent metadata, configuration settings, feature flags, and various configuration sources. The payload is represented in YAML format and demonstrates how different configuration options are structured and prioritized.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/inventoryagent/README.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\n{\n    \"agent_metadata\": {\n        \"agent_version\": \"7.37.0-devel+git.198.68a5b69\",\n        \"config_apm_dd_url\": \"\",\n        \"config_dd_url\": \"\",\n        \"config_logs_dd_url\": \"\",\n        \"config_logs_socks5_proxy_address\": \"\",\n        \"config_no_proxy\": [\n            \"http://some-no-proxy\"\n        ],\n        \"config_process_dd_url\": \"\",\n        \"config_proxy_http\": \"\",\n        \"config_proxy_https\": \"http://localhost:9999\",\n        \"config_site\": \"\",\n        \"feature_imdsv2_enabled\": false,\n        \"feature_apm_enabled\": true,\n        \"feature_cspm_enabled\": false,\n        \"feature_cws_enabled\": false,\n        \"feature_logs_enabled\": true,\n        \"feature_networks_enabled\": false,\n        \"feature_process_enabled\": false,\n        \"feature_remote_configuration_enabled\": false,\n        \"flavor\": \"agent\",\n        \"hostname_source\": \"os\",\n        \"install_method_installer_version\": \"\",\n        \"install_method_tool\": \"undefined\",\n        \"install_method_tool_version\": \"\",\n        \"logs_transport\": \"HTTP\",\n        \"full_configuration\": \"<entire yaml configuration for the agent>\",\n        \"provided_configuration\": \"api_key: \\\"***************************aaaaa\\\"\\ncheck_runners: 4\\ncontainerd_namespace: []\\ncontainerd_namespaces: []\\npython_version: \\\"3\\\"\\ntracemalloc_debug: false\\nlog_level: \\\"warn\\\"\",\n        \"file_configuration\": \"check_runners: 4\\ncontainerd_namespace: []\\ncontainerd_namespaces: []\\npython_version: \\\"3\\\"\\ntracemalloc_debug: false\",\n        \"agent_runtime_configuration\": \"runtime_block_profile_rate: 5000\",\n        \"environment_variable_configuration\": \"api_key: \\\"***************************aaaaa\\\"\",\n        \"remote_configuration\": \"log_level: \\\"debug\\\"\",\n        \"cli_configuration\": \"log_level: \\\"warn\\\"\",\n        \"source_local_configuration\": \"\",\n        \"config_id\": \"my-config\"\n    }\n    \"hostname\": \"my-host\",\n    \"timestamp\": 1631281754507358895\n}\n```\n\n----------------------------------------\n\nTITLE: Defining OS Rule Filter for Linux in YAML\nDESCRIPTION: This snippet demonstrates how to include an OS rule filter field for Linux in a YAML configuration. It's required for rules using Linux attributes and helpers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/linux_expressions.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nid: [...]\nexpression: [...]\nfilters:\n  - os == \"linux\"\n\n```\n\n----------------------------------------\n\nTITLE: Defining SecurityProfileContext JSON Schema for Security Profiles\nDESCRIPTION: JSON schema definition for the SecurityProfileContext structure which contains information about security profiles applied to events. It includes the profile name, version, associated tags, and event relevance information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_48\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"Name of the security profile\"\n        },\n        \"version\": {\n            \"type\": \"string\",\n            \"description\": \"Version of the profile in use\"\n        },\n        \"tags\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"List of tags associated to this profile\"\n        },\n        \"event_in_profile\": {\n            \"type\": \"boolean\",\n            \"description\": \"True if the corresponding event is part of this profile\"\n        },\n        \"event_type_state\": {\n            \"type\": \"string\",\n            \"description\": \"State of the event type in this profile\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"name\",\n        \"version\",\n        \"tags\",\n        \"event_in_profile\",\n        \"event_type_state\"\n    ],\n    \"description\": \"SecurityProfileContextSerializer serializes the security profile context in an event\"\n}\n```\n\n----------------------------------------\n\nTITLE: Registering FlareBuilder Callback in Golang\nDESCRIPTION: Example of registering a FlareBuilder callback in a component constructor. It shows how to create a new Provider using the NewProvider function and include it in the component's Provides struct.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/flares.md#2025-04-22_snippet_1\n\nLANGUAGE: golang\nCODE:\n```\nimport (\n\tflare \"github.com/DataDog/datadog-agent/comp/core/flare/def\"\n)\n\ntype Provides struct {\n\t// [...]\n\n\t// Declare that your component will return a flare provider\n\tFlareProvider flare.Provider\n}\n\nfunc newComponent(deps Requires) Provides {\n\t// [...]\n\n\treturn Provides{\n\t\t// [...]\n\n\t\t// NewProvider will wrap your callback in order to be use as a 'Provider'\n\t\tFlareProvider: flare.NewProvider(myComponent.fillFlare),\n\t}, nil\n}\n```\n\n----------------------------------------\n\nTITLE: Example HA Agent Inventory Payload Structure in JSON\nDESCRIPTION: Example JSON payload demonstrating the structure of an HA Agent inventory report. Contains hostname, HA agent metadata including enabled status and state, and a timestamp in nanoseconds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/haagent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"hostname\": \"COMP-GQ7WQN6HYC\",\n    \"ha_agent_metadata\": {\n        \"enabled\": true,\n        \"state\": \"active\"\n    },\n    \"timestamp\": 1716985696922603000\n}\n```\n\n----------------------------------------\n\nTITLE: Enabling Tracemalloc in Datadog Agent Configuration\nDESCRIPTION: Enables Tracemalloc debugging in the Datadog Agent by setting a flag in the agent config. This reduces the number of check runners to 1 for better debugging output.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\ntracemalloc_debug: true\n```\n\n----------------------------------------\n\nTITLE: Ptrace Tracee Field Reference Table in Markdown\nDESCRIPTION: A markdown table listing ptrace tracee fields and their descriptions, including process attributes, file system details, credentials, and container metadata. Each field is documented with its purpose and data type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_4\n\nLANGUAGE: markdown\nCODE:\n```\n| [`ptrace.tracee.args`](#common-process-args-doc) | Arguments of the process (as a string, excluding argv0) |\n| [`ptrace.tracee.args_flags`](#common-process-args_flags-doc) | Flags in the process arguments |\n| [`ptrace.tracee.args_options`](#common-process-args_options-doc) | Argument of the process as options |\n...\n```\n\n----------------------------------------\n\nTITLE: Markdown Table - Ptrace Event Properties\nDESCRIPTION: A markdown table defining the properties and definitions of the ptrace event, including detailed tracee ancestor information, process attributes, file information, and user credentials.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_3\n\nLANGUAGE: markdown\nCODE:\n```\n| Property | Definition |\n| -------- | ------------- |\n| [`ptrace.request`](#ptrace-request-doc) | ptrace request |\n| [`ptrace.retval`](#common-syscallevent-retval-doc) | Return value of the syscall |\n```\n\n----------------------------------------\n\nTITLE: Defining Tailer Message Channel in Datadog Agent\nDESCRIPTION: Shows that tailers in the Datadog Agent communicate by sending log messages through a channel of message.Message objects. This is the core mechanism for passing collected log data to other components in the logs agent pipeline.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/logs/tailers/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\nA tailer sends log messages via a `chan *message.Message`.\n```\n\n----------------------------------------\n\nTITLE: Creating Visual Studio Code Settings for Datadog Agent\nDESCRIPTION: Command to generate a Visual Studio Code settings file for the Datadog Agent repository. This configures the IDE to work with the specific build tags required for the project.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_11\n\nLANGUAGE: sh\nCODE:\n```\ninv setup.vscode-settings\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubelet Runtime Operations Duration in Prometheus Format\nDESCRIPTION: Prometheus histogram metrics tracking the duration of various kubelet runtime operations in Kubernetes. The metrics are organized in buckets with increasing duration thresholds (in seconds) for different operation types, along with sum and count values for each operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_33\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.1953125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.48828125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"1.220703125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"3.0517578125\"} 27\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"7.62939453125\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"19.073486328125\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"47.6837158203125\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"119.20928955078125\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"298.0232238769531\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"745.0580596923828\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"+Inf\"} 30\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"run_podsandbox\"} 74.479636131\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"run_podsandbox\"} 30\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.0125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.03125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.078125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.1953125\"} 62\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.48828125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"1.220703125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"3.0517578125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"7.62939453125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"19.073486328125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"47.6837158203125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"119.20928955078125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"298.0232238769531\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"745.0580596923828\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"+Inf\"} 67\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"start_container\"} 9.140925580000001\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"start_container\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.005\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.0125\"} 265140\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.03125\"} 333850\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.078125\"} 340703\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.1953125\"} 340927\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.48828125\"} 340927\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"1.220703125\"} 340927\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"3.0517578125\"} 340927\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"7.62939453125\"} 340927\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"19.073486328125\"} 340927\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"47.6837158203125\"} 340928\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"119.20928955078125\"} 340928\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"298.0232238769531\"} 340928\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"745.0580596923828\"} 340928\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"+Inf\"} 340928\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"status\"} 3784.8395157630125\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"status\"} 340928\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.0125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.03125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.078125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.1953125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.48828125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"1.220703125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"3.0517578125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"7.62939453125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"19.073486328125\"} 5\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"47.6837158203125\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"119.20928955078125\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"298.0232238769531\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"745.0580596923828\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"+Inf\"} 6\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"stop_container\"} 65.6431574\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"stop_container\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.005\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.0125\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.03125\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.078125\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.1953125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.48828125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"1.220703125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"3.0517578125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"7.62939453125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"19.073486328125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"47.6837158203125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"119.20928955078125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"298.0232238769531\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"745.0580596923828\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"+Inf\"} 3\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"stop_podsandbox\"} 0.149110471\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"stop_podsandbox\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.005\"} 3938\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.0125\"} 136781\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.03125\"} 166768\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.078125\"} 169973\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.1953125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.48828125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"1.220703125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"3.0517578125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"7.62939453125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"19.073486328125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"47.6837158203125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"119.20928955078125\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"298.0232238769531\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"745.0580596923828\"} 170037\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"+Inf\"} 170037\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"version\"} 1682.3791630920343\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"version\"} 170037\n```\n\n----------------------------------------\n\nTITLE: Reporting Container Tasks State Metrics in Prometheus Format\nDESCRIPTION: This code snippet defines the container_tasks_state metric in Prometheus format. It includes labels for container, id, image, name, namespace, pod, and state. The metric is of type gauge and provides values for different task states at specific timestamps.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_55\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_tasks_state gauge\ncontainer_tasks_state{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",state=\"iowaiting\"} 0 1572450197572\ncontainer_tasks_state{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",state=\"running\"} 0 1572450197572\ncontainer_tasks_state{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",state=\"sleeping\"} 0 1572450197572\ncontainer_tasks_state{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",state=\"stopped\"} 0 1572450197572\ncontainer_tasks_state{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",state=\"uninterruptible\"} 0 1572450197572\n```\n\n----------------------------------------\n\nTITLE: Internal Package Structure Example in Go\nDESCRIPTION: Example showing the refactored struct moved to an internal package to hide implementation details while maintaining functionality.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/internal.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\n// a/internal/b/examplestruct.go\npackage b\n\ntype ExampleStruct struct {\n    // some fields\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Component Outputs in Go\nDESCRIPTION: Demonstrates how to define the Provides struct for a component, specifying the types that the component will return. This structure is used by Fx to make the component available to other parts of the system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_4\n\nLANGUAGE: go\nCODE:\n```\npackage zstdimpl\n\nimport (\n    // Always import the component def folder, so that you can return a 'compression.Component' type.\n    compression \"github.com/DataDog/datadog-agent/comp/compression/def\"\n)\n\n// Here, list all the types your component is going to return. You can return as many types as you want; all of them are available through Fx in other components.\n// To be used in `fx` folders, type and field need to be public.\n//\n// In this example, only the compression component is returned.\ntype Provides struct {\n    Comp compression.Component\n}\n```\n\n----------------------------------------\n\nTITLE: Advanced Test Case with Install Log Analysis\nDESCRIPTION: Expands on the simple test case by adding log analysis. It installs the Datadog Agent and then searches the install logs for instances of running CustomActions, providing context around each occurrence.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/windows/DatadogAgentInstaller/QA/README.md#2025-04-22_snippet_4\n\nLANGUAGE: powershell\nCODE:\n```\nSuite \"My new test suite\" {\n    Case \"test case 1\" {\n        Require @(\n            \"datadog-agent-7.49.0-1.x86_64.msi\"\n        )\n        Test {\n            $installResult = Install-MSI -installerName datadog-agent-7.49.0-1.x86_64.msi\n            Assert_InstallSuccess $installResult\n            $installResult.InstallLogs | Selec-String -Pattern \"Running CustomAction\" -Context 3 | Write-Host\n        }\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Setting Cluster Check Rebalance Period in Python\nDESCRIPTION: Python configuration to set the rebalance period for cluster checks when advanced dispatching is enabled in the Datadog Cluster Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_3\n\nLANGUAGE: python\nCODE:\n```\ncluster_checks.rebalance_period = 600  # 10 minutes\n```\n\n----------------------------------------\n\nTITLE: ProcessContext Schema Partial Definition\nDESCRIPTION: Partial definition of the ProcessContext schema showing process properties such as exit time, executable details, container context, command line arguments, user information, parent process, and ancestors. This schema is used to represent process-related events.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_7\n\nLANGUAGE: json\nCODE:\n```\n\"description\": \"Exit time of the process\"\n                },\n                \"executable\": {\n                    \"$ref\": \"#/$defs/File\",\n                    \"description\": \"File information of the executable\"\n                },\n                \"container\": {\n                    \"$ref\": \"#/$defs/ContainerContext\",\n                    \"description\": \"Container context\"\n                },\n                \"cmdline\": {\n                    \"type\": \"string\",\n                    \"description\": \"Command line arguments\"\n                },\n                \"user\": {\n                    \"type\": \"string\",\n                    \"description\": \"User name\"\n                },\n                \"parent\": {\n                    \"$ref\": \"#/$defs/Process\",\n                    \"description\": \"Parent process\"\n                },\n                \"ancestors\": {\n                    \"items\": {\n                        \"$ref\": \"#/$defs/Process\"\n                    },\n                    \"type\": \"array\",\n                    \"description\": \"Ancestor processes\"\n                },\n                \"variables\": {\n                    \"$ref\": \"#/$defs/Variables\",\n                    \"description\": \"Variables values\"\n                },\n                \"truncated_ancestors\": {\n                    \"type\": \"boolean\",\n                    \"description\": \"True if the ancestors list was truncated because it was too big\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"ProcessContextSerializer serializes a process context to JSON\"\n```\n\n----------------------------------------\n\nTITLE: Setting Up Python Virtual Environment for Agent Development\nDESCRIPTION: Commands to set up a Python virtual environment for Datadog Agent development, including installing virtualenv and creating the environment.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\npython3 -m pip install virtualenv\nvirtualenv $GOPATH/src/github.com/DataDog/datadog-agent/venv\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubelet Network Plugin Operation Durations in Prometheus Format\nDESCRIPTION: Prometheus metrics showing the duration of network plugin operations performed by kubelet. Metrics are organized by operation type (get_pod_network_status, set_up_pod, tear_down_pod) and duration buckets.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_20\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_network_plugin_operations_duration_seconds [ALPHA] Latency in seconds of network plugin operations. Broken down by operation type.\n# TYPE kubelet_network_plugin_operations_duration_seconds histogram\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.005\"} 14\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.01\"} 84\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.025\"} 99\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.05\"} 107\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.1\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.25\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.5\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"1\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"2.5\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"5\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"10\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"+Inf\"} 108\nkubelet_network_plugin_operations_duration_seconds_sum{operation_type=\"get_pod_network_status\"} 1.1268392169999992\nkubelet_network_plugin_operations_duration_seconds_count{operation_type=\"get_pod_network_status\"} 108\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.005\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.01\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.025\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.05\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.1\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.25\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.5\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"1\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"2.5\"} 28\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"5\"} 28\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"10\"} 28\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"+Inf\"} 28\nkubelet_network_plugin_operations_duration_seconds_sum{operation_type=\"set_up_pod\"} 52.724215415\nkubelet_network_plugin_operations_duration_seconds_count{operation_type=\"set_up_pod\"} 28\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.005\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.01\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.025\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.05\"} 0\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.1\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.25\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.5\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"1\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"2.5\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"5\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"10\"} 1\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"+Inf\"} 1\nkubelet_network_plugin_operations_duration_seconds_sum{operation_type=\"tear_down_pod\"} 0.073327311\nkubelet_network_plugin_operations_duration_seconds_count{operation_type=\"tear_down_pod\"} 1\n```\n\n----------------------------------------\n\nTITLE: Using Process PID Variable in SECL Rule\nDESCRIPTION: This snippet demonstrates how to use the process.pid variable in a SECL rule. It checks if the open file path matches a specific pattern that includes the process PID.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/proc/${process.pid}/maps\"\n\n```\n\n----------------------------------------\n\nTITLE: Measuring Kubernetes API Request Durations with Prometheus Metrics\nDESCRIPTION: Prometheus histogram metrics capturing REST client request durations for Kubernetes API operations. Includes bucket distributions from milliseconds to seconds, along with sum and count values for different API endpoints and HTTP verbs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_39\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.128\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.256\"} 1\n# Additional metric entries...\n```\n\n----------------------------------------\n\nTITLE: Configuring RtLoader CMake Project with Build Options\nDESCRIPTION: This CMake configuration sets up the RtLoader project with C++11 requirements, conditional flags for Windows and i386 architecture, and includes various subprojects. It defines build options for demo apps and integrates development tools like clang-format.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/CMakeLists.txt#2025-04-22_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.15)\n\n## Project name\nproject(RtLoader)\n\n## Require C++11 with no extensions\nset(CMAKE_CXX_STANDARD 11)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\nset(CMAKE_CXX_EXTENSIONS OFF)\n\n# Favor finding Python by location rather than by version\nif (POLICY CMP0094)\n    cmake_policy(SET CMP0094 NEW)\nendif()\n\nif(WIN32)\n    set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_SOURCE_DIR}/bin )\n    SET(CMAKE_CXX_FLAGS  \"${CMAKE_CXX_FLAGS} -mwin32\")\nendif()\n\nif(ARCH_I386)\n    set(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -m32\")\n    set(CMAKE_C_FLAGS \"${CMAKE_C_FLAGS} -m32\")\nendif()\n\n## Config options\noption(BUILD_DEMO \"Build the demo app\" ON)\n\n## Add Build Targets\nadd_subdirectory(three)\nadd_subdirectory(rtloader)\nadd_subdirectory(test)\nif (BUILD_DEMO)\n    add_subdirectory(demo)\nendif()\n\n## Dev tools\ninclude(cmake/clang-format.cmake)\n```\n\n----------------------------------------\n\nTITLE: Setting External Metrics Provider Port in YAML\nDESCRIPTION: YAML configuration to change the default external metrics provider port from 443 to 8443, allowing the cluster agent to run with a non-root user for improved security.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_9\n\nLANGUAGE: yaml\nCODE:\n```\nexternal_metrics_provider:\n  port: 8443\n```\n\n----------------------------------------\n\nTITLE: Configuring Profiler Options for ddprofiling Extension in YAML\nDESCRIPTION: Example configuration for profiler options in the ddprofiling extension. It sets service, version, environment, profiling period, and specific profile types to collect.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddprofilingextension/README.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nextensions:\n  ddprofiling:\n    profiler_options:\n      service: svc\n      version: v0.1\n      env: env\n      period: 30\n      profile_types: [blockprofile, mutexprofile, goroutineprofile]\n```\n\n----------------------------------------\n\nTITLE: Creating a None Option for Optional Component in Go\nDESCRIPTION: Demonstrates how to create a 'none' option for an optional component using Fx. This is used when a component might not be available in certain configurations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_7\n\nLANGUAGE: go\nCODE:\n```\nimport (\n    compression \"github.com/DataDog/datadog-agent/comp/compression/def\"\n)\n\nfunc Module() fxutil.Module {\n    return fxutil.Component(\n        fx.Provide(func() optional.Option[compression.Component] {\n            return optional.NewNoneOption[compression.Component]()\n        }))\n}\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for Process in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing process information in the Datadog Agent. It includes properties for process ID, parent process ID, thread ID, user and group IDs, and username.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_16\n\nLANGUAGE: JSON\nCODE:\n```\n\"Process\": {\n    \"properties\": {\n        \"pid\": {\n            \"type\": \"integer\",\n            \"description\": \"Process ID\"\n        },\n        \"ppid\": {\n            \"type\": \"integer\",\n            \"description\": \"Parent Process ID\"\n        },\n        \"tid\": {\n            \"type\": \"integer\",\n            \"description\": \"Thread ID\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"User ID\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"Group ID\"\n        },\n        \"user\": {\n            \"type\": \"string\"\n```\n\n----------------------------------------\n\nTITLE: Setting External Metrics Provider Chunk Size in YAML\nDESCRIPTION: YAML configuration to set the chunk size for external metrics provider queries, reducing the number of queries batched and sent together to Datadog to mitigate timeout issues.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_11\n\nLANGUAGE: yaml\nCODE:\n```\nexternal_metrics_provider:\n  chunk_size: 5\n```\n\n----------------------------------------\n\nTITLE: Defining OS Rule Filter for Linux in YAML\nDESCRIPTION: Demonstrates how to include an OS rule filter field for Linux in a YAML configuration. This is required for rules using Linux attributes and helpers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nid: [...]\nexpression: [...]\nfilters:\n  - os == \"linux\"\n\n```\n\n----------------------------------------\n\nTITLE: Inventory Agent Payload Documentation in Markdown\nDESCRIPTION: Technical documentation explaining the inventory agent payload structure, configuration options, and update intervals for the Datadog Agent. Describes how sensitive information is handled and configuration can be disabled.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/inventoryagent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Inventory Agent Payload\n\nThis package populates some of the agent-related fields in the `inventories` product in DataDog. More specifically the\n`datadog-agent` table.\n\nThis is enabled by default but can be turned off using `inventories_enabled` config.\n\nThe payload is sent every 10min (see `inventories_max_interval` in the config) or whenever it's updated with at most 1\nupdate every minute (see `inventories_min_interval`).\n\n# Content\n\nThe `Set` method from the component allow the rest of the codebase to add any information to the payload.\n\n## Agent Configuration\n\nThe agent configurations are scrubbed from any sensitive information (same logic than for the flare). The `Format`\nsection goes into more default about what configuration is sent.\n\nSending Agent configuration can be disabled using `inventories_configuration_enabled`.\n```\n\n----------------------------------------\n\nTITLE: Running Agent with Custom Python Path\nDESCRIPTION: Command to run the built Agent with a custom PYTHONPATH to use the virtual environment's Python packages.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\nPYTHONPATH=\"./venv/lib/python3.12/site-packages:$PYTHONPATH\" ./agent run ...\n```\n\n----------------------------------------\n\nTITLE: Using file name matching in Datadog runtime security\nDESCRIPTION: Example of matching execution of files by name using the exec.file.name field. This snippet demonstrates how to create a rule to match when any file named 'apt' is executed.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_7\n\nLANGUAGE: javascript\nCODE:\n```\nexec.file.name == \"apt\"\n```\n\n----------------------------------------\n\nTITLE: Reporting Container CPU Throttled Time in Prometheus Format\nDESCRIPTION: This snippet defines and reports the 'container_cpu_cfs_throttled_seconds_total' metric, which measures the total time duration containers have been throttled. It includes labels for container, pod, namespace, and image details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_3\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_cpu_cfs_throttled_seconds_total Total time duration the container has been throttled.\n# TYPE container_cpu_cfs_throttled_seconds_total counter\ncontainer_cpu_cfs_throttled_seconds_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 139.487613534 1572450195286\ncontainer_cpu_cfs_throttled_seconds_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 3221.646731104 1572450190276\ncontainer_cpu_cfs_throttled_seconds_total{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 3246.16371844 1572450197849\ncontainer_cpu_cfs_throttled_seconds_total{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 146.108523211 1572450196671\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Memory Usage with Prometheus in Kubernetes\nDESCRIPTION: Prometheus metrics data showing container memory usage in bytes across various containers in a Kubernetes cluster. The metrics include container identification, namespace information, pod names, and precise memory measurements with timestamps.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_26\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_usage_bytes gauge\ncontainer_memory_usage_bytes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 2.00450048e+09 1572450197572\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 4.89791488e+08 1572450197668\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 7.1090176e+07 1572450196297\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 6.148096e+07 1572450199385\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 237568 1572450186377\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 9.609216e+06 1572450198309\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 225280 1572450196497\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.388416e+08 1572450196733\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 7.626752e+06 1572450196475\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 233472 1572450195152\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2.76013056e+08 1572450186468\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 229376 1572450199201\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 7.696384e+06 1572450195355\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 225280 1572450197313\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 3.5188736e+07 1572450190363\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 253952 1572450200713\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.2316672e+07 1572450201420\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 241664 1572450188256\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 5.566464e+06 1572450195286\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 217088 1572450196642\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 7.364608e+07 1572450190276\ncontainer_memory_usage_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 237568 1572450189944\ncontainer_memory_usage_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 7.39328e+06 1572450198917\ncontainer_memory_usage_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 7.471104e+06 1572450196388\ncontainer_memory_usage_bytes{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 7.4059776e+07 1572450197849\ncontainer_memory_usage_bytes{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 6.1247488e+07 1572450202927\ncontainer_memory_usage_bytes{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 5.349376e+06 1572450196671\ncontainer_memory_usage_bytes{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2.7578368e+08 1572450188597\ncontainer_memory_usage_bytes{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 3.4934784e+07 1572450192433\ncontainer_memory_usage_bytes{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 9.383936e+06 1572450197292\ncontainer_memory_usage_bytes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.2075008e+07 1572450195713\n# HELP container_memory_working_set_bytes Current working set in bytes.\n```\n\n----------------------------------------\n\nTITLE: Generating api.pb.go for Datadog Agent Security Module\nDESCRIPTION: This command generates the 'api.pb.go' file for the security agent's Cloud Workload Security (CWS) module. It should be executed from the repository root directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/security/proto/README.md#2025-04-22_snippet_1\n\nLANGUAGE: shell\nCODE:\n```\ndda inv -e security-agent.generate-cws-proto\n```\n\n----------------------------------------\n\nTITLE: Managing Local VM Stack Configuration and Launch\nDESCRIPTION: Example showing how to configure and launch a stack with local Ubuntu and Amazon Linux VMs, including initialization, adding VMs, and reconfiguration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\n# Setup configuration file to launch jammy and focal locally. Initialize a new stack corresponding to the current branch\ndda inv -e kmt.gen-config  --vms=jammy-local-distro,focal-local-distro --init-stack\n# Launch this stack. Since we are launching local VMs, there is no need to specify ssh key.\ndda inv -e kmt.launch-stack\n# Add amazon linux VMs to be launched locally\ndda inv -e kmt.gen-config  --vms=amazon4.14-local-distro,distro-local-amazon5.15,distro-local-amazon5.10\n# Launch the new VMs added. The previous VMs will keep running\ndda inv -e kmt.launch-stack\n# Remove all VMs except amazon linux 2 4.14 locally\ndda inv -e kmt.gen-config  --new --vms=amazon4.14-local-distro\n# Apply this configuration\ndda inv -e kmt.launch-stack\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for MatchedRuleSerializer in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing a matched rule in the Datadog Agent. It includes properties for rule ID, name, version, tags, policy name, and policy version.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_7\n\nLANGUAGE: JSON\nCODE:\n```\n{\n    \"properties\": {\n        \"type\": \"string\",\n        \"description\": \"Version of the rule\"\n    },\n    \"tags\": {\n        \"items\": {\n            \"type\": \"string\"\n        },\n        \"type\": \"array\",\n        \"description\": \"Tags of the rule\"\n    },\n    \"policy_name\": {\n        \"type\": \"string\",\n        \"description\": \"Name of the policy that introduced the rule\"\n    },\n    \"policy_version\": {\n        \"type\": \"string\",\n        \"description\": \"Version of the policy that introduced the rule\"\n    }\n},\n\"additionalProperties\": false,\n\"type\": \"object\",\n\"description\": \"MatchedRuleSerializer serializes a rule\"\n```\n\n----------------------------------------\n\nTITLE: Creating a Simple Test Case for Datadog Agent Installation\nDESCRIPTION: Demonstrates a basic test case that installs the Datadog Agent MSI and checks for successful installation. It uses the Require keyword to specify necessary artifacts and the Test block to define the test logic.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/windows/DatadogAgentInstaller/QA/README.md#2025-04-22_snippet_3\n\nLANGUAGE: powershell\nCODE:\n```\nSuite \"My new test suite\" {\n    Case \"test case 1\" {\n        Require @(\n            \"datadog-agent-7.49.0-1.x86_64.msi\"\n        )\n        Test {\n            $installResult = Install-MSI -installerName datadog-agent-7.49.0-1.x86_64.msi\n            Assert_InstallSuccess $installResult\n        }\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Network Transmit Errors in Prometheus Metrics Format\nDESCRIPTION: A collection of Prometheus metrics tracking network transmission errors for containers. Each metric includes detailed labels for container identification, network interface, and Kubernetes metadata with timestamps for monitoring purposes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_39\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_transmit_errors_total counter\ncontainer_network_transmit_errors_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_errors_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_errors_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n```\n\n----------------------------------------\n\nTITLE: Using pprof Tool to Analyze Heap Profile\nDESCRIPTION: Command for using the Google pprof tool to analyze heap profile data collected by the flare, demonstrating how to view the profiling information in a web interface.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddflareextension/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ngo tool pprof -http=: otel/otel-flare/pprof/dd-autoconfigured_debug_pprof_heap.dat\n```\n\n----------------------------------------\n\nTITLE: Implementing Mock Compression Component in Go\nDESCRIPTION: Shows how to create a mock implementation of the compression component for testing purposes. The mock implements the Component interface and provides simple, predictable behavior.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/creating-components.md#2025-04-22_snippet_8\n\nLANGUAGE: go\nCODE:\n```\n//go:build test\n\npackage mock\n\nimport (\n    \"testing\"\n\n    compression \"github.com/DataDog/datadog-agent/comp/compression/def\"\n)\n\ntype Provides struct {\n    Comp compression.Component\n}\n\ntype mock struct {}\n\n// New returns a mock compressor\nfunc New(*testing.T) Provides {\n    return Provides{\n        comp: &mock{},\n    }\n}\n\n// Compress compresses the input data using ZSTD\nfunc (c *mock) Compress(data []byte) ([]byte, error) {\n    return []byte(\"compressed\"), nil\n}\n\n// Decompress decompresses the input data using ZSTD.\nfunc (c *compressor) Decompress(data []byte) ([]byte, error) {\n    return []byte(\"decompressed\"), nil\n}\n```\n\n----------------------------------------\n\nTITLE: Matching File Execution by Name in JavaScript\nDESCRIPTION: This snippet demonstrates how to match the execution of a file named 'cmd.bat' using the 'exec.file.name' attribute in a security rule.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_4\n\nLANGUAGE: javascript\nCODE:\n```\nexec.file.name == \"cmd.bat\"\n```\n\n----------------------------------------\n\nTITLE: Proper Expvar Implementation in Go Structs\nDESCRIPTION: Shows correct usage of expvar types in struct definitions, emphasizing the importance of using pointers for proper alignment and avoiding direct embedding.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/atomics.md#2025-04-22_snippet_1\n\nLANGUAGE: golang\nCODE:\n```\ntype SomeStuff struct {\n    good *expvar.Int{}\n    bad expvar.Int{} // don't do this!\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent Systemd Service\nDESCRIPTION: This systemd unit file defines the service configuration for the Datadog Agent. It specifies the executable path, runtime directory, and various service properties to ensure proper execution and management of the agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/required_files/iot-agent-deb.txt#2025-04-22_snippet_0\n\nLANGUAGE: systemd\nCODE:\n```\n[Unit]\nDescription=Datadog Agent\nAfter=network.target nss-lookup.target\n\n[Service]\nType=simple\nPIDFile=/var/run/datadog/agent.pid\nUser=dd-agent\nPermissionsStartOnly=true\nExecStartPre=/opt/datadog-agent/bin/agent/agent check-runtime\nExecStart=/opt/datadog-agent/bin/agent/agent run -p /var/run/datadog/agent.pid\nExecStop=/opt/datadog-agent/bin/agent/agent stop\nStartLimitInterval=10\nStartLimitBurst=5\nRestart=on-failure\nRestartSec=1\n\n[Install]\nWantedBy=multi-user.target\n\n```\n\n----------------------------------------\n\nTITLE: Enabling C/C++ Memory Tracking in Datadog Agent\nDESCRIPTION: Enables memory tracking for C/C++ code in the Datadog Agent by setting a flag in the datadog.yaml configuration file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_5\n\nLANGUAGE: yaml\nCODE:\n```\nmemtrack_enabled: true\n```\n\n----------------------------------------\n\nTITLE: Disabling Go Linter Example\nDESCRIPTION: Example of using the nolint directive to disable specific linter warnings in Go code\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/linters.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\n//nolint:linter_name\n```\n\n----------------------------------------\n\nTITLE: Defining ContainerContext JSON Schema\nDESCRIPTION: JSON schema for serializing a container context, including properties for the container ID, creation time, and variables.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_22\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"string\",\n            \"description\": \"Container ID\"\n        },\n        \"created_at\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Creation time of the container\"\n        },\n        \"variables\": {\n            \"$ref\": \"#/$defs/Variables\",\n            \"description\": \"Variables values\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"ContainerContextSerializer serializes a container context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Initializing KMT Environment with VM Images\nDESCRIPTION: Commands to initialize the KMT environment by downloading required resources and installing system dependencies. Supports initialization with specific VM images, all available images, or in lite mode without images.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n# Initialize with specific VM images\ndda inv -e kmt.init --images=ubuntu_22.04,debian_10\n\n# Initialize with all available VM images\ndda inv -e kmt.init --all-images\n\n# Or initialize without downloading any images (lite mode)\ndda inv -e kmt.init --lite\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubernetes API Request Durations with Prometheus Metrics\nDESCRIPTION: Prometheus time-series metrics tracking the duration of Kubernetes REST API requests. The data is structured as histogram buckets with various time thresholds (from 0.001s to +Inf), along with sum and count values to enable calculation of percentiles and averages. These metrics monitor API calls to node, pod, service endpoints and token review operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_42\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.725510447\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.004\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.008\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.016\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.032\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.001874187\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.004\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.008\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.016\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.032\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.720501401\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.004\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.008\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.016\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.032\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.001464406\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/services?resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/authentication.k8s.io/v1/tokenreviews\",verb=\"POST\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/authentication.k8s.io/v1/tokenreviews\",verb=\"POST\",le=\"0.002\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/authentication.k8s.io/v1/tokenreviews\",verb=\"POST\",le=\"0.004\"} 1\n```\n\n----------------------------------------\n\nTITLE: Building GDB Agent Docker Image\nDESCRIPTION: Command to build a Docker image for analyzing Agent core dumps. It includes the Agent version as a build argument and optional arguments for custom APT repositories.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/gdb/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Shell\nCODE:\n```\ndocker build -t gdb-agent:7.18.0 --build-arg AGENT_VERSION=7.18.0 .\n```\n\n----------------------------------------\n\nTITLE: Matching File Open Operation in JavaScript\nDESCRIPTION: This code example shows how to match any process opening a specific file using the 'open.file.path' attribute in a JavaScript-like syntax.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_9\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/etc/passwd\"\n```\n\n----------------------------------------\n\nTITLE: Running Built Datadog Agent with Custom Python Path\nDESCRIPTION: Command to run the built Datadog Agent with a custom PYTHONPATH, allowing the use of a virtual environment for Python check packages.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nPYTHONPATH=\"./venv/lib/python3.12/site-packages:$PYTHONPATH\" ./agent run ...\n```\n\n----------------------------------------\n\nTITLE: AgentContext Schema Definition\nDESCRIPTION: Defines the structure for the agent context in Datadog events, specifying properties like rule_id, rule_version, policy details, and agent information. The rule_id field is required for all agent contexts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_2\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"rule_id\": {\n            \"type\": \"string\"\n        },\n        \"rule_version\": {\n            \"type\": \"string\"\n        },\n        \"rule_actions\": {\n            \"items\": true,\n            \"type\": \"array\"\n        },\n        \"policy_name\": {\n            \"type\": \"string\"\n        },\n        \"policy_version\": {\n            \"type\": \"string\"\n        },\n        \"version\": {\n            \"type\": \"string\"\n        },\n        \"os\": {\n            \"type\": \"string\"\n        },\n        \"arch\": {\n            \"type\": \"string\"\n        },\n        \"origin\": {\n            \"type\": \"string\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"rule_id\"\n    ]\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Reno Release Note Sections in YAML\nDESCRIPTION: This snippet provides examples of how to structure different sections in a Reno release note file. It includes examples for features, enhancements, issues, upgrades, deprecations, security, fixes, and other sections.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/guidelines/contributing.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nfeatures:\n  - |\n    Introducing the Datadog Process Agent for Windows.\n\nenhancements:\n  - |\n    Windows: Add PDH data to flare.\n\nissues:\n  - |\n    Kubernetes 1.3 & OpenShift 3.3 are currently not fully supported: docker\n    and kubelet integrations work OK, but apiserver communication (event\n    collection, `kube_service` tagging) is not implemented\n\nupgrade:\n  - |\n    If you run a Nomad agent older than 0.6.0, the `nomad_group`\n    tag will be absent until you upgrade your orchestrator.\n\ndeprecations:\n- |\n  Changed the attribute name to enable log collection from YAML configuration\n  file from \"log_enabled\" to \"logs_enabled\", \"log_enabled\" is still\n  supported.\n\nsecurity:\n  - |\n    The /agent/check-config endpoint has been patched to enforce\n    authentication of the caller via a bearer session token.\n\nfixes:\n  - |\n    Fix EC2 tags collection when multiple marketplaces are set.\n\nother:\n  - |\n    Only enable the ``resources`` metadata collector on Linux by default, to match\n    Agent 5's behavior.\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Payload Structure for Datadog Agent\nDESCRIPTION: Schema definition for the Datadog Agent payload format, including core fields for agent identification and timestamps. The payload contains hostname, UUID, timestamp and extensive agent metadata covering configuration settings and feature flags.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/inventoryagent/README.md#2025-04-22_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"hostname\": \"string\",\n  \"uuid\": \"string\",\n  \"timestamp\": \"int\",\n  \"agent_metadata\": {\n    \"hostname_source\": \"string\",\n    \"agent_version\": \"string\",\n    \"agent_startup_time_ms\": \"int\",\n    \"flavor\": \"string\",\n    \"fips_mode\": \"bool\"\n    // Additional metadata fields as documented\n  }\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Systemd Service for Datadog DogStatsD in INI format\nDESCRIPTION: This systemd service unit configuration defines the parameters for running the Datadog DogStatsD agent as a system service. It specifies the command to start the service, its dependencies, restart behavior, and user/group settings.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/required_files/dogstatsd-rpm.txt#2025-04-22_snippet_0\n\nLANGUAGE: ini\nCODE:\n```\n[Unit]\nDescription=Datadog DogStatsD Agent\nDocumentation=https://docs.datadoghq.com/\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nType=simple\nExecStart=/opt/datadog-agent/bin/dogstatsd start\nUser=dd-agent\nGroup=dd-agent\nRestart=on-failure\nRestartSec=2\nStartLimitBurst=3\nStartLimitInterval=60s\n\n[Install]\nWantedBy=multi-user.target\n```\n\n----------------------------------------\n\nTITLE: Building Nettop for eBPF Testing in Datadog Agent (Bash)\nDESCRIPTION: This snippet shows the commands to build the Nettop tool. It first generates the necessary eBPF object files and then compiles the Go package with specific tags for Linux and eBPF support.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/nettop/readme.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e system-probe.object-files\ngo build -tags linux_bpf,linux ./pkg/network/nettop\n```\n\n----------------------------------------\n\nTITLE: CIDR and IP Range Matching in DNS Query Rule\nDESCRIPTION: Illustrates how to use CIDR and IP range matching in a SECL rule. This example combines a DNS query check with network destination IP matching using the 'in' operator.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\ndns.question.name == \"example.com\" && network.destination.ip in [192.168.1.25, 10.0.0.0/24]\n\n```\n\n----------------------------------------\n\nTITLE: Matching Process User in JavaScript\nDESCRIPTION: This snippet illustrates how to constrain an event to be triggered by a process running as the root user using the 'process.user' attribute in a JavaScript-like syntax.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_10\n\nLANGUAGE: javascript\nCODE:\n```\nprocess.user == \"root\"\n```\n\n----------------------------------------\n\nTITLE: Matching File Execution by Path in JavaScript\nDESCRIPTION: This snippet demonstrates how to match the execution of a file located at 'c:\\cmd.bat' using the 'exec.file.path' attribute in a security rule.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_6\n\nLANGUAGE: javascript\nCODE:\n```\nexec.file.path == \"c:\\\\cmd.bat\"\n```\n\n----------------------------------------\n\nTITLE: Measuring Storage Operation Duration in Kubernetes\nDESCRIPTION: These metrics measure the duration of volume unmount operations for different Kubernetes volume plugins. They use histogram buckets to track operation durations across various time ranges.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_37\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"10\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"15\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"25\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"50\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"+Inf\"} 1\nstorage_operation_duration_seconds_sum{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\"} 0.001635273\nstorage_operation_duration_seconds_count{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\"} 1\n```\n\n----------------------------------------\n\nTITLE: Managing Stack and SSH Configuration\nDESCRIPTION: Commands for launching stack, generating SSH configurations, and connecting to VMs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.launch-stack --stack=demo-stack\n\ndda inv -e kmt.ssh-config > ~/.ssh/kmt_ssh_config\n\nssh -i /home/kernel-version-testing/ddvm_rsa -o StrictHostKeyChecking=no root@<ip>\n```\n\n----------------------------------------\n\nTITLE: Implementing Component with Lifecycle Hooks in Go\nDESCRIPTION: Defines a component that implements start and stop methods, and adds them as lifecycle hooks using Fx.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/testing.md#2025-04-22_snippet_3\n\nLANGUAGE: go\nCODE:\n```\npackage impl\n\nimport (\n  \"context\"\n  \n  somecomponent \"github.com/DataDog/datadog-agent/comp/somecomponent/def\"\n  compdef \"github.com/DataDog/datadog-agent/comp/def\"\n)\n\ntype Requires struct {\n  Lc      compdef.Lifecycle\n}\n\ntype Provides struct {\n  Comp somecomponent.Component\n}\n\ntype component struct {\n  started  bool\n  stopped bool\n}\n\nfunc (c *component) start() error {\n  // [...]\n  \n  c.started = true\n\n  return nil\n}\n\nfunc (h *healthprobe) stop() error {\n  // [...]\n  \n  c.stopped = true\n  c.started = false\n\n  return nil\n}\n\n// NewComponent creates a new healthprobe component\nfunc NewComponent(reqs Requires) (Provides, error) {\n  provides := Provides{}\n  comp := &component{}\n\n  reqs.Lc.Append(compdef.Hook{\n    OnStart: func(ctx context.Context) error {\n      return comp.start()\n    },\n    OnStop: func(ctx context.Context) error {\n      return comp.stop()\n    },\n  })\n\n  provides.Comp = comp\n  return provides, nil\n}\n```\n\n----------------------------------------\n\nTITLE: Example Replace Directive in Go.mod\nDESCRIPTION: Example of a properly documented replace directive for managing etcd dependencies with specific version constraints for grpc libraries.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/gomodreplace.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\n// etcd uses unstable code only available until grpc v1.26.0\n// See https://github.com/etcd-io/etcd/issues/11563\nreplace (\n\tgithub.com/grpc-ecosystem/grpc-gateway => github.com/grpc-ecosystem/grpc-gateway v1.12.2\n\tgoogle.golang.org/grpc => github.com/grpc/grpc-go v1.26.0\n)\n```\n\n----------------------------------------\n\nTITLE: System-probe Testing and Building\nDESCRIPTION: Commands for running system-probe tests and building the component across different VMs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_10\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.test --vms=<vms-list>\ndda inv -e kmt.test --vms=jammy-local-distro --packages=./pkg/network/tracer --run=\"TestTracerSuite/prebuilt/TestDNSStats/valid_domain\"\ndda inv -e kmt.build --vms=<vms-list>\n```\n\n----------------------------------------\n\nTITLE: Initializing USM Events in Kernel C Code\nDESCRIPTION: Initializes the necessary eBPF maps and functions for a specific protocol's event handling. This macro creates batch enqueue and flush functions, as well as a monitoring status check function.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/protocols/events/README.md#2025-04-22_snippet_0\n\nLANGUAGE: c\nCODE:\n```\n#include \"protocols/events.h\"\nUSM_EVENTS_INIT(<protocol>, <event_type>, <batch_size>);\n```\n\n----------------------------------------\n\nTITLE: Generating CPU Profile using Pprof in Bash\nDESCRIPTION: This example shows how to generate a CPU profile using the Pprof endpoint. It uses curl to send a request for a 60-second profile and saves the output to a file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_api.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\n$ curl -s http://localhost:5000/debug/pprof/profile?seconds=60 > ./cpu.out\n```\n\n----------------------------------------\n\nTITLE: Example Inventory Checks Payload in JSON\nDESCRIPTION: This snippet demonstrates the structure of an inventory checks payload, including check metadata and logs metadata. It shows how various checks and log sources are represented, along with their configurations and metadata.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/inventorychecks/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"check_metadata\": {\n        \"cpu\": [\n            {\n                \"config.hash\": \"cpu\",\n                \"config.provider\": \"file\",\n                \"init_config\": \"\",\n                \"instance_config: {}\n            }\n        ],\n        \"disk\": [\n            {\n                \"config.hash\": \"disk:e5dffb8bef24336f\",\n                \"config.provider\": \"file\",\n                \"init_config\": \"\",\n                \"instance_config: {}\n            }\n        ],\n        \"file_handle\": [\n            {\n                \"config.hash\": \"file_handle\",\n                \"config.provider\": \"file\",\n                \"init_config\": \"\",\n                \"instance_config: {}\n            }\n        ],\n        \"io\": [\n            {\n                \"config.hash\": \"io\",\n                \"config.provider\": \"file\",\n                \"init_config\": \"\",\n                \"instance_config: {}\n            }\n        ],\n        \"load\": [\n            {\n                \"config.hash\": \"load\",\n                \"config.provider\": \"file\",\n                \"init_config\": \"\",\n                \"instance_config: {}\n            }\n        ],\n        \"redisdb\": [\n            {\n                \"config.hash\": \"redisdb:6e5e79e5b724c83a\",\n                \"config.provider\": \"container\",\n                \"init_config\": \"test: 21\",\n                \"instance_config\": \"host: localhost\\nport: 6379\\ntags:\\n- docker_image:redis\\n- image_name:redis\\n- short_image:redis\",\n                \"version.major\": \"7\",\n                \"version.minor\": \"0\",\n                \"version.patch\": \"2\",\n                \"version.raw\": \"7.0.2\",\n                \"version.scheme\": \"semver\"\n            },\n            {\n                \"config.hash\": \"redisdb:c776ecdbdded09b8\",\n                \"config.provider\": \"container\",\n                \"init_config\": \"test: 21\",\n                \"instance_config\": \"host: localhost\\nport: 7379\\ntags:\\n- docker_image:redis\\n- image_name:redis\\n- short_image:redis\",\n                \"version.major\": \"7\",\n                \"version.minor\": \"0\",\n                \"version.patch\": \"2\",\n                \"version.raw\": \"7.0.2\",\n                \"version.scheme\": \"semver\"\n            }\n        ]\n    },\n    \"logs_metadata\": {\n        \"redisdb\": [\n            {\n                \"config\": \"{\\\"path\\\":\\\"/var/log/redis_6379.log\\\",\\\"service\\\":\\\"myredis2\\\",\\\"source\\\":\\\"redis\\\",\\\"type\\\":\\\"file\\\",\\\"tags\\\":[\\\"env:prod\\\"]}\",\n                \"integration_name\": \"redis\",\n                \"service\": \"awesome_cache\",\n                \"source\": \"source1\",\n                \"state\": {\n                    \"error\": \"Error: cannot read file /var/log/redis_6379.log: stat /var/log/redis_6379.log: no such file or directory\",\n                    \"status\": \"error\"\n                },\n                \"tags\": [\"env:prod\"]\n            }\n        ],\n        \"nginx\": [\n            {\n                \"config\": \"{\\\"path\\\":\\\"/var/log/nginx/access.log\\\",\\\"service\\\":\\\"nginx\\\",\\\"source\\\":\\\"nginx\\\",\\\"type\\\":\\\"file\\\"}\",\n                \"integration_name\": \"nginx\",\n                \"service\": \"nginx\",\n                \"source\": \"source2\",\n                \"state\": {\n                    \"error\": \"\",\n                    \"status\": \"success\"\n                },\n                \"tags\": []\n            }\n        ]\n    }\n    \"hostname\": \"my-host\",\n    \"timestamp\": 1631281754507358895\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog DogStatsD Systemd Service\nDESCRIPTION: This systemd unit file defines the service configuration for Datadog DogStatsD. It specifies the executable path, runtime directory, and various service properties such as restart behavior and dependencies.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/required_files/dogstatsd-deb.txt#2025-04-22_snippet_0\n\nLANGUAGE: systemd\nCODE:\n```\n[Unit]\nDescription=Datadog DogStatsD\nAfter=network.target\n\n[Service]\nType=simple\nPIDFile=/var/run/datadog/dogstatsd.pid\nUser=dd-agent\nGroup=dd-agent\nEnvironmentFile=-/etc/datadog-agent/dogstatsd.env\nExecStartPre=/opt/datadog-agent/bin/agent/agent import dogstatsd_apm_telemetry\nExecStart=/opt/datadog-agent/bin/dogstatsd start\nExecStop=/opt/datadog-agent/bin/dogstatsd stop\nRestart=on-failure\nRuntimeDirectory=datadog\nRuntimeDirectoryMode=0755\n\n[Install]\nWantedBy=multi-user.target\n```\n\n----------------------------------------\n\nTITLE: Testing Status Provider Output in Go\nDESCRIPTION: Provides example test cases for verifying the Text and JSON output of a status provider implementation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/status.md#2025-04-22_snippet_4\n\nLANGUAGE: go\nCODE:\n```\npackage impl\n\nimport (\n  \"bytes\"\n  \"testing\"\n)\n\nfunc TestText(t *testing.T) {\n  requires := Requires{}\n  \n  provides := NewComponent(requires)\n  component := provides.Comp\n  buffer := new(bytes.Buffer)\n  \n  result, err := component.Text(false, buffer)\n  assert.Nil(t, err)\n\n  assert.Equal(t, ..., string(result))\n}\n\nfunc TestJSON(t *testing.T) {\n  requires := Requires{}\n  \n  provides := NewComponent(requires)\n  component := provides.Comp\n  info := map[string]interface{}\n  \n  result, err := component.JSON(false, info)\n  assert.Nil(t, err)\n\n  assert.Equal(t, ..., result[\"compressor\"])\n}\n```\n\n----------------------------------------\n\nTITLE: Defining RuleContext JSON Schema for Rule Matching Data\nDESCRIPTION: JSON schema definition for the RuleContext structure which captures information about rule matching including expressions and subexpressions that matched during rule evaluation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_43\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"matching_subexprs\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/MatchingSubExpr\"\n            },\n            \"type\": \"array\"\n        },\n        \"expression\": {\n            \"type\": \"string\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"RuleContext serializes rule context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Monitoring REST Client Request Latency in Prometheus Format for Kubernetes API\nDESCRIPTION: Prometheus metrics data showing latency distributions for REST client requests to various Kubernetes API endpoints. The metrics use histogram buckets to represent latency distributions across different time thresholds, with additional sum and count values for aggregate analysis.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_31\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.004\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.008\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.016\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.032\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.064\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.128\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.256\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"0.512\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\"} 0.008666967\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D\",verb=\"GET\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.004\"} 9\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.008\"} 25\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.016\"} 29\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.032\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.064\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.128\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.256\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.512\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"+Inf\"} 30\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\"} 0.16869632799999998\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.001\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.002\"} 23\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.004\"} 29\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.008\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.016\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.032\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.064\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.128\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.256\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"0.512\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\",le=\"+Inf\"} 30\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\"} 0.05174655899999999\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/nodes/%7Bname%7D?resourceVersion=%7Bvalue%7D&timeout=10s\",verb=\"GET\"} 30\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.004\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.008\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.016\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.032\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.003094545\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/nodes?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.004\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.008\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.016\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.032\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.003431327\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/pods?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\n```\n\n----------------------------------------\n\nTITLE: Remote VM Stack Configuration and Launch\nDESCRIPTION: Example demonstrating configuration and launch of remote Ubuntu VMs on both x86_64 and arm64 architectures.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\n# Setup configuration file to launch ubuntu VMs on remote x86_64 and arm64 machines\ndda inv -e kmt.gen-config  --vms=x86-ubuntu20-distro,distro-bionic-x86,distro-jammy-x86,distro-arm64-ubuntu22,arm64-ubuntu18-distro\n# Name of the ssh key to use\ndda inv -e kmt.launch-stack\n# Add amazon linux\ndda inv -e kmt.gen-config  --vms=x86-amazon5.4-disto,arm64-distro-amazon5.4\n# Name of the ssh key to use\ndda inv -e kmt.launch-stack\n```\n\n----------------------------------------\n\nTITLE: Measuring Kubernetes API Request Durations with Prometheus\nDESCRIPTION: This snippet shows Prometheus metrics for measuring the duration of Kubernetes API requests. It includes histogram buckets, sum, and count for different API endpoints and HTTP verbs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_41\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D\",verb=\"GET\"} 0.005605232\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D\",verb=\"GET\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.002\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.004\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.008\"} 288\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.016\"} 5268\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.032\"} 5616\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.064\"} 5666\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.128\"} 5673\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.256\"} 5673\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"0.512\"} 5673\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\",le=\"+Inf\"} 5673\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\"} 63.748975995000094\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/nodes/%7Bname%7D/status?timeout=10s\",verb=\"PATCH\"} 5673\n```\n\n----------------------------------------\n\nTITLE: Container Memory Mapped File Metrics - Prometheus\nDESCRIPTION: Detailed metrics showing memory mapped file sizes in bytes for various Kubernetes system containers and pods, including core components like etcd, apiserver, and scheduler\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_22\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_memory_mapped_file Size of memory mapped files in bytes.\n# TYPE container_memory_mapped_file gauge\ncontainer_memory_mapped_file{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.18451712e+08 1572450197572\n[...additional container_memory_mapped_file metrics...]\n```\n\n----------------------------------------\n\nTITLE: Accessing Logging Package in Go for Datadog Agent\nDESCRIPTION: Instructions for accessing the logging functionality in the Datadog Agent project. It mentions two methods: using the pkg/util/log package directly or using the comp/core/log component wrapper, which is recommended for adherence to component best practices.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/logger.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\nLogging utilizes the [`github.com/cihub/seelog`](https://github.com/cihub/seelog) package as its underlying framework. \nYou can access logging through `pkg/util/log` and the `comp/core/log` component wrappers.\nUsing the component wrapper is recommended, as it adheres to [component best practices](https://datadoghq.dev/datadog-agent/components/overview/).\n```\n\n----------------------------------------\n\nTITLE: Container Memory Swap Metrics in Prometheus Format\nDESCRIPTION: Prometheus metrics showing memory swap usage for containers in a Kubernetes cluster. Each metric includes container metadata like ID, image, name, namespace and pod name, along with the swap memory value and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_25\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_swap gauge\ncontainer_memory_swap{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 4096 1572450197572\ncontainer_memory_swap{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_memory_swap{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_memory_swap{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_memory_swap{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\n# HELP container_memory_usage_bytes Current memory usage in bytes, including all memory regardless of when it was accessed\n```\n\n----------------------------------------\n\nTITLE: Visualizing Client-Cluster-Agent Communication with Mermaid Sequence Diagram\nDESCRIPTION: This Mermaid sequence diagram illustrates the communication flow between the client, workloadmeta, and Cluster-Agent. It shows the subscription to events, processing of data, and periodic sending of updates to the Cluster-Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/languagedetection/client/README.md#2025-04-22_snippet_0\n\nLANGUAGE: mermaid\nCODE:\n```\nsequenceDiagram\n    Client->>workloadmeta: Subscribe to pod & process events\n    workloadmeta-->>Client: Send events\n    activate Client\n    Client->>+Client: Process events, update currentBatch\n    Note over Client: Every 'freshly updated pods period' (10s)\n    Client->>Client: Get freshlyUpdatedPods batch from currentBatch\n    Client->>Cluster-Agent: Send fresh updates\n    Note over Client: Every 'periodic flush period'\n    Client->>Client: Get all data from currentBatch (10m)'runningMetricPeriod'\n    deactivate Client\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Agent Check with Memory Profiling\nDESCRIPTION: Executes a Datadog Agent check with memory profiling enabled using the -m flag. This command produces detailed memory allocation output for the specified check.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nsudo -u dd-agent -- datadog-agent check <foo_check> -m\n```\n\n----------------------------------------\n\nTITLE: Sample pprof Top Output Analysis\nDESCRIPTION: Example output from pprof's top command showing memory usage statistics including flat and cumulative percentages for different components.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_1\n\nLANGUAGE: text\nCODE:\n```\n(pprof) top\nShowing nodes accounting for 4848.62kB, 100% of 4848.62kB total\nShowing top 10 nodes out of 31\n      flat  flat%   sum%        cum   cum%\n 1805.17kB 37.23% 37.23%  1805.17kB 37.23%  compress/flate.NewWriter\n  858.34kB 17.70% 54.93%   858.34kB 17.70%  github.com/DataDog/datadog-agent/vendor/github.com/modern-go/reflect2.loadGo17Types\n  583.01kB 12.02% 66.96%  2388.18kB 49.25%  github.com/DataDog/datadog-agent/pkg/serializer/jsonstream.(*PayloadBuilder).Build\n  553.04kB 11.41% 78.36%   553.04kB 11.41%  github.com/DataDog/datadog-agent/vendor/github.com/gogo/protobuf/proto.RegisterType\n  536.37kB 11.06% 89.43%   536.37kB 11.06%  github.com/DataDog/datadog-agent/vendor/k8s.io/apimachinery/pkg/api/meta.init.ializers\n  512.69kB 10.57%   100%   512.69kB 10.57%  crypto/x509.parseCertificate\n         0     0%   100%  1805.17kB 37.23%  compress/flate.NewWriterDict\n         0     0%   100%  1805.17kB 37.23%  compress/zlib.(*Writer).Write\n         0     0%   100%  1805.17kB 37.23%  compress/zlib.(*Writer).writeHeader\n         0     0%   100%   512.69kB 10.57%  crypto/tls.(*Conn).Handshake\n```\n\n----------------------------------------\n\nTITLE: Filtering Process Arguments in Datadog\nDESCRIPTION: Example showing how to match processes with specific argument options using the args_options field. Matches processes that have -p 0-1024 or --p=0-1024 in their arguments.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_5\n\nLANGUAGE: javascript\nCODE:\n```\nexec.args_options in [\"p=0-1024\"]\n```\n\n----------------------------------------\n\nTITLE: MatchedRule Schema Definition\nDESCRIPTION: JSON schema for rule matching data including rule ID, version, tags and policy information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_13\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"string\",\n            \"description\": \"ID of the rule\"\n        },\n        \"version\": {\n            \"type\": \"string\",\n            \"description\": \"Version of the rule\"\n        },\n        \"tags\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Tags of the rule\"\n        },\n        \"policy_name\": {\n            \"type\": \"string\",\n            \"description\": \"Name of the policy that introduced the rule\"\n        },\n        \"policy_version\": {\n            \"type\": \"string\",\n            \"description\": \"Version of the policy that introduced the rule\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"MatchedRuleSerializer serializes a rule\"\n}\n```\n\n----------------------------------------\n\nTITLE: Adding Endpoints to a Value Group in Go\nDESCRIPTION: These snippets show how to add server endpoints to a value group using fx.Out structs. They demonstrate how to use struct tags to specify group membership.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_8\n\nLANGUAGE: go\nCODE:\n```\ntype provides struct {\n    fx.Out\n    Component\n    Endpoint server.Endpoint `group:\"server\"`\n}\n```\n\nLANGUAGE: go\nCODE:\n```\ntype provides struct {\n    fx.Out\n    Component\n    Endpoint server.Endpoint `group:\"server\"`\n}\n```\n\n----------------------------------------\n\nTITLE: Using Process PID Variable in File Path Matching\nDESCRIPTION: Shows how to use the process.pid variable in a SECL rule to match a file path. This example demonstrates accessing the current process ID dynamically.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/proc/${process.pid}/maps\"\n\n```\n\n----------------------------------------\n\nTITLE: Running the Process Agent from Command Line\nDESCRIPTION: Command to run the compiled Process Agent binary with a specified configuration file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/process-agent/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n./bin/process-agent/process-agent -config $PATH_TO_PROCESS_CONFIG_FILE\n```\n\n----------------------------------------\n\nTITLE: Example Cluster-agent Metadata Payload in JSON\nDESCRIPTION: This snippet demonstrates the structure of a cluster-agent metadata payload, including fields such as cluster information, agent configuration, and feature flags. It showcases how various configuration sources are represented and how sensitive information is scrubbed.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/clusteragent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"clustername\": \"test-gke\",\n    \"cluster_id\": \"d1bd4888-2990-4312-a610-c9eae75acba4\",\n    \"timestamp\": 1742810761534538592,\n    \"datadog_cluster_agent_metadata\": {\n        \"agent_runtime_configuration\": \"internal_profiling:\\n  enabled: true\\n\",\n        \"agent_startup_time_ms\": 1742809996230,\n        \"agent_version\": \"7.65.0-devel+git.651.84a74a5\",\n        \"cli_configuration\": \"{}\\n\",\n        \"cluster_id_error\": \"\",\n        \"environment_variable_configuration\": \"admission_controller.container_registry: gcr.io/datadoghq\\nadmission_controller.enabled: \\\"true\\\"\\nadmission_controller.failure_policy: Ignore\\nadmission_controller.inject_config.local_service_name: datadog-agent-linux\\nadmission_controller.inject_config.mode: socket\\nadmission_controller.mutate_unlabelled: \\\"false\\\"\\nadmission_controller.mutation.enabled: \\\"true\\\"\\nadmission_controller.port: \\\"8000\\\"\\nadmission_controller.service_name: datadog-agent-linux-cluster-agent-admission-controller\\nadmission_controller.validation.enabled: \\\"true\\\"\\nadmission_controller.webhook_name: datadog-webhook\\napi_key: '***************************658e7'\\napm_config.install_id: 817926d8-f346-487c-a5bb-c27aa73dfc0b\\napm_config.install_time: \\\"1742809959\\\"\\napm_config.install_type: k8s_manual\\nautoscaling.failover.enabled: \\\"true\\\"\\ncluster_agent.auth_token: '********'\\ncluster_agent.collect_kubernetes_tags: \\\"true\\\"\\ncluster_agent.kubernetes_service_name: datadog-agent-linux-cluster-agent\\ncluster_agent.language_detection.patcher.enabled: \\\"false\\\"\\ncluster_agent.service_account_name: datadog-agent-linux-cluster-agent\\ncluster_agent.token_name: datadog-agent-linuxtoken\\ncluster_checks.enabled: \\\"true\\\"\\ncluster_name: minyi-test-gke\\ncollect_kubernetes_events: \\\"true\\\"\\nextra_config_providers: kube_endpoints kube_services\\nextra_listeners: kube_endpoints kube_services\\nhealth_port: \\\"5556\\\"\\ninternal_profiling.enabled: \\\"true\\\"\\nkube_resources_namespace: datadog-agent-helm\\nkubernetes_events_source_detection.enabled: \\\"false\\\"\\nkubernetes_namespace_labels_as_tags: '{\\\"kubernetes.io/metadata.name\\\":\\\"name\\\"}'\\nkubernetes_use_endpoint_slices: \\\"false\\\"\\nlanguage_detection.enabled: \\\"false\\\"\\nlanguage_detection.reporting.enabled: \\\"false\\\"\\nleader_election: \\\"true\\\"\\nleader_election_default_resource: configmap\\nleader_lease_duration: \\\"15\\\"\\nleader_lease_name: datadog-agent-linux-leader-election\\nlog_level: INFO\\norchestrator_explorer.container_scrubbing.enabled: \\\"true\\\"\\norchestrator_explorer.enabled: \\\"true\\\"\\nproxy:\\n  http: \\\"\\\"\\n  https: \\\"\\\"\\n  no_proxy:\\n  - 169.254.169.254\\n  - 100.100.100.200\\npython_version: \\\"3\\\"\\nremote_configuration.enabled: \\\"false\\\"\\nsecret_backend_command_allow_group_exec_perm: \\\"true\\\"\\nsecurity_agent.internal_profiling.api_key: '***************************658e7'\\nsslkeylogfile: /tmp/sslkeylog.txt\\n\",\n        \"feature_admission_controller_auto_instrumentation_enabled\": true,\n        \"feature_admission_controller_cws_instrumentation_enabled\": false,\n        \"feature_admission_controller_enabled\": true,\n        \"feature_admission_controller_inject_config_enabled\": true,\n        \"feature_admission_controller_inject_tags_enabled\": true,\n        \"feature_admission_controller_mutation_enabled\": true,\n        \"feature_admission_controller_validation_enabled\": true,\n        \"feature_apm_config_instrumentation_enabled\": false,\n        \"feature_autoscaling_workload_enabled\": false,\n        \"feature_cluster_checks_advanced_dispatching_enabled\": false,\n        \"feature_cluster_checks_enabled\": true,\n        \"feature_cluster_checks_exclude_checks\": [],\n        \"feature_compliance_config_enabled\": false,\n        \"feature_external_metrics_provider_enabled\": false,\n        \"feature_external_metrics_provider_use_datadogmetric_crd\": false,\n        \"file_configuration\": \"{}\\n\",\n        \"flavor\": \"cluster_agent\",\n        \"fleet_policies_configuration\": \"{}\\n\",\n        \"full_configuration\": \"ac_exclude: xxxx\",\n        \"install_method_installer_version\": \"datadog-3.110.2\",\n        \"install_method_tool\": \"helm\",\n        \"install_method_tool_version\": \"Helm\",\n        \"is_leader\": true,\n        \"leader_election\": true,\n        \"provided_configuration\": \"admission_controller ***\",\n        \"remote_configuration\": \"{}\\n\",\n        \"source_local_configuration\": \"{}\\n\"\n    },\n    \"uuid\": \"05284024-b312-f0ac-4769-9e9b99baf163\"\n}\n```\n\n----------------------------------------\n\nTITLE: Deploying Datadog Agent using mpdev\nDESCRIPTION: Commands to create a namespace for Datadog, build and push the deployer image, and install the Datadog Agent using mpdev. This process requires customizing parameters such as name, namespace, and API key.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/google-marketplace/README.md#2025-04-22_snippet_3\n\nLANGUAGE: shell\nCODE:\n```\nkubectl create ns datadog-agent\ndocker build --pull --platform linux/amd64 --build-arg TAG=$TAG --tag $REGISTRY/$APP_NAME/deployer . && docker push $REGISTRY/$APP_NAME/deployer && mpdev install \\\n  --deployer=$REGISTRY/$APP_NAME/deployer \\\n  --parameters='{\"name\": \"datadog\", \"namespace\": \"datadog-agent\", \"datadog.credentials.apiKey\": \"<your_api_key>\"}'\n```\n\n----------------------------------------\n\nTITLE: Configuring Infra Attributes Processor in YAML\nDESCRIPTION: Basic configuration for the infra attributes processor with cardinality setting. Cardinality controls the tag level granularity, with 0 (default) being low cardinality, 1 for orchestrator cardinality, and 2 for high cardinality.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/otlp/components/processor/infraattributesprocessor/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nprocessors:\n  infraattributes:\n    cardinality: 0\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for DNS and File Event Serialization\nDESCRIPTION: This extensive JSON schema defines multiple object structures for serializing various types of events and data related to DNS requests, file operations, and system events. It includes detailed property descriptions and type specifications for each structure.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_1\n\nLANGUAGE: JSON\nCODE:\n```\n{\n    \"DNSEventSerializer\": {\n        \"properties\": {\n            \"id\": {\n                \"type\": \"string\",\n                \"description\": \"id is the unique identifier of the DNS request\"\n            },\n            \"question\": {\n                \"$ref\": \"#/$defs/DNSQuestion\",\n                \"description\": \"question is a DNS question for the DNS request\"\n            }\n        },\n        \"additionalProperties\": false,\n        \"type\": \"object\",\n        \"required\": [\n            \"id\",\n            \"question\"\n        ],\n        \"description\": \"DNSEventSerializer serializes a DNS event to JSON\"\n    },\n    \"DNSQuestion\": {\n        \"properties\": {\n            \"class\": {\n                \"type\": \"string\",\n                \"description\": \"class is the class looked up by the DNS question\"\n            },\n            \"type\": {\n                \"type\": \"string\",\n                \"description\": \"type is a two octet code which specifies the DNS question type\"\n            },\n            \"name\": {\n                \"type\": \"string\",\n                \"description\": \"name is the queried domain name\"\n            },\n            \"size\": {\n                \"type\": \"integer\",\n                \"description\": \"size is the total DNS request size in bytes\"\n            },\n            \"count\": {\n                \"type\": \"integer\",\n                \"description\": \"count is the total count of questions in the DNS request\"\n            }\n        },\n        \"additionalProperties\": false,\n        \"type\": \"object\",\n        \"required\": [\n            \"class\",\n            \"type\",\n            \"name\",\n            \"size\",\n            \"count\"\n        ],\n        \"description\": \"DNSQuestionSerializer serializes a DNS question to JSON\"\n    },\n    \"EventContext\": {\n        \"properties\": {\n            \"name\": {\n                \"type\": \"string\",\n                \"description\": \"Event name\"\n            },\n            \"category\": {\n                \"type\": \"string\",\n                \"description\": \"Event category\"\n            },\n            \"outcome\": {\n                \"type\": \"string\",\n                \"description\": \"Event outcome\"\n            },\n            \"async\": {\n                \"type\": \"boolean\",\n                \"description\": \"True if the event was asynchronous\"\n            },\n            \"matched_rules\": {\n                \"items\": {\n                    \"$ref\": \"#/$defs/MatchedRule\"\n                },\n                \"type\": \"array\",\n                \"description\": \"The list of rules that the event matched (only valid in the context of an anomaly)\"\n            },\n            \"variables\": {\n                \"$ref\": \"#/$defs/Variables\",\n                \"description\": \"Variables values\"\n            },\n            \"rule_context\": {\n                \"$ref\": \"#/$defs/RuleContext\",\n                \"description\": \"RuleContext rule context\"\n            }\n        },\n        \"additionalProperties\": false,\n        \"type\": \"object\",\n        \"description\": \"EventContextSerializer serializes an event context to JSON\"\n    },\n    \"ExitEvent\": {\n        \"properties\": {\n            \"cause\": {\n                \"type\": \"string\",\n                \"description\": \"Cause of the process termination (one of EXITED, SIGNALED, COREDUMPED)\"\n            },\n            \"code\": {\n                \"type\": \"integer\",\n                \"description\": \"Exit code of the process or number of the signal that caused the process to terminate\"\n            }\n        },\n        \"additionalProperties\": false,\n        \"type\": \"object\",\n        \"required\": [\n            \"cause\",\n            \"code\"\n        ],\n        \"description\": \"ExitEventSerializer serializes an exit event to JSON\"\n    },\n    \"File\": {\n        \"properties\": {\n            \"path\": {\n                \"type\": \"string\",\n                \"description\": \"File path\"\n            },\n            \"name\": {\n                \"type\": \"string\",\n                \"description\": \"File basename\"\n            },\n            \"path_resolution_error\": {\n                \"type\": \"string\",\n                \"description\": \"Error message from path resolution\"\n            },\n            \"inode\": {\n                \"type\": \"integer\",\n                \"description\": \"File inode number\"\n            },\n            \"mode\": {\n                \"type\": \"integer\",\n                \"description\": \"File mode\"\n            },\n            \"in_upper_layer\": {\n                \"type\": \"boolean\",\n                \"description\": \"Indicator of file OverlayFS layer\"\n            },\n            \"mount_id\": {\n                \"type\": \"integer\",\n                \"description\": \"File mount ID\"\n            },\n            \"filesystem\": {\n                \"type\": \"string\",\n                \"description\": \"File filesystem name\"\n            },\n            \"uid\": {\n                \"type\": \"integer\",\n                \"description\": \"File User ID\"\n            },\n            \"gid\": {\n                \"type\": \"integer\",\n                \"description\": \"File Group ID\"\n            },\n            \"user\": {\n                \"type\": \"string\",\n                \"description\": \"File user\"\n            },\n            \"group\": {\n                \"type\": \"string\",\n                \"description\": \"File group\"\n            },\n            \"attribute_name\": {\n                \"type\": \"string\",\n                \"description\": \"File extended attribute name\"\n            },\n            \"attribute_namespace\": {\n                \"type\": \"string\",\n                \"description\": \"File extended attribute namespace\"\n            },\n            \"flags\": {\n                \"items\": {\n                    \"type\": \"string\"\n                },\n                \"type\": \"array\",\n                \"description\": \"File flags\"\n            },\n            \"access_time\": {\n                \"type\": \"string\",\n                \"format\": \"date-time\",\n                \"description\": \"File access time\"\n            },\n            \"modification_time\": {\n                \"type\": \"string\",\n                \"format\": \"date-time\",\n                \"description\": \"File modified time\"\n            },\n            \"change_time\": {\n                \"type\": \"string\",\n                \"format\": \"date-time\",\n                \"description\": \"File change time\"\n            },\n            \"package_name\": {\n                \"type\": \"string\",\n                \"description\": \"System package name\"\n            },\n            \"package_version\": {\n                \"type\": \"string\",\n                \"description\": \"System package version\"\n            },\n            \"hashes\": {\n                \"items\": {\n                    \"type\": \"string\"\n                },\n                \"type\": \"array\",\n                \"description\": \"List of cryptographic hashes of the file\"\n            },\n            \"hash_state\": {\n                \"type\": \"string\",\n                \"description\": \"State of the hashes or reason why they weren't computed\"\n            },\n            \"mount_path\": {\n                \"type\": \"string\",\n                \"description\": \"MountPath path of the mount\"\n            },\n            \"mount_source\": {\n                \"type\": \"string\",\n                \"description\": \"MountSource source of the mount\"\n            },\n            \"mount_origin\": {\n                \"type\": \"string\",\n                \"description\": \"MountOrigin origin of the mount\"\n            }\n        },\n        \"additionalProperties\": false,\n        \"type\": \"object\",\n        \"required\": [\n            \"uid\",\n            \"gid\"\n        ],\n        \"description\": \"FileSerializer serializes a file to JSON\"\n    },\n    \"FileEvent\": {\n        \"properties\": {\n            \"path\": {\n                \"type\": \"string\",\n                \"description\": \"File path\"\n            },\n            \"name\": {\n                \"type\": \"string\",\n                \"description\": \"File basename\"\n            },\n            \"path_resolution_error\": {\n                \"type\": \"string\",\n                \"description\": \"Error message from path resolution\"\n            },\n            \"inode\": {\n                \"type\": \"integer\",\n                \"description\": \"File inode number\"\n            },\n            \"mode\": {\n                \"type\": \"integer\",\n                \"description\": \"File mode\"\n            },\n            \"in_upper_layer\": {\n                \"type\": \"boolean\",\n                \"description\": \"Indicator of file OverlayFS layer\"\n            },\n            \"mount_id\": {\n                \"type\": \"integer\",\n                \"description\": \"File mount ID\"\n            },\n            \"filesystem\": {\n                \"type\": \"string\",\n                \"description\": \"File filesystem name\"\n            },\n            \"uid\": {\n                \"type\": \"integer\",\n                \"description\": \"File User ID\"\n            },\n            \"gid\": {\n                \"type\": \"integer\",\n                \"description\": \"File Group ID\"\n            },\n            \"user\": {\n                \"type\": \"string\",\n                \"description\": \"File user\"\n            },\n            \"group\": {\n                \"type\": \"string\"\n        }\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Attaching Delve Debugger to Datadog Agent\nDESCRIPTION: This command demonstrates how to attach the Delve debugger to a running Datadog Agent process for debugging.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/tools.md#2025-04-22_snippet_3\n\nLANGUAGE: sh\nCODE:\n```\n$ sudo dlv attach `pgrep -f '/opt/datadog-agent/bin/agent/agent run'`\n(dlv) help # help on all commands\n(dlv) goroutines # list goroutines\n(dlv) threads # list threads\n(dlv) goroutine <number> # switch to goroutine\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubelet Runtime Operations Errors in Prometheus\nDESCRIPTION: This snippet shows Prometheus metrics for tracking errors in Kubelet runtime operations. It includes both deprecated and current metrics for error counts by operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_27\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations_errors (Deprecated) Cumulative number of runtime operation errors by operation type.\n# TYPE kubelet_runtime_operations_errors counter\nkubelet_runtime_operations_errors{operation_type=\"container_status\"} 2\nkubelet_runtime_operations_errors{operation_type=\"exec_sync\"} 2\n# HELP kubelet_runtime_operations_errors_total Cumulative number of runtime operation errors by operation type.\n# TYPE kubelet_runtime_operations_errors_total counter\nkubelet_runtime_operations_errors_total{operation_type=\"container_status\"} 2\nkubelet_runtime_operations_errors_total{operation_type=\"exec_sync\"} 2\n# HELP kubelet_runtime_operations_latency_microseconds (Deprecated) Latency in microseconds of runtime operations. Broken down by operation type.\n```\n\n----------------------------------------\n\nTITLE: Querying Process-Agent Status with s6-svstat\nDESCRIPTION: Shows how to check the status of the process-agent service using s6-svstat command.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/SUPERVISION.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ns6-svstat /var/run/s6/services/process/\n```\n\n----------------------------------------\n\nTITLE: Kubelet Network Plugin Operations Duration Metrics in Prometheus Format\nDESCRIPTION: These metrics measure the duration in seconds of various network plugin operations including get_pod_network_status, set_up_pod, and tear_down_pod. The data is presented as histogram buckets with corresponding sum and count values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_12\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_network_plugin_operations_duration_seconds histogram\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.005\"} 25\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.01\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.025\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.05\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.1\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.25\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"0.5\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"1\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"2.5\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"5\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"10\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"get_pod_network_status\",le=\"+Inf\"} 26\nkubelet_network_plugin_operations_duration_seconds_sum{operation_type=\"get_pod_network_status\"} 0.008526665\nkubelet_network_plugin_operations_duration_seconds_count{operation_type=\"get_pod_network_status\"} 26\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.005\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.01\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.025\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.05\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.1\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.25\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"0.5\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"1\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"2.5\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"5\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"10\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"set_up_pod\",le=\"+Inf\"} 8\nkubelet_network_plugin_operations_duration_seconds_sum{operation_type=\"set_up_pod\"} 0.00036158\nkubelet_network_plugin_operations_duration_seconds_count{operation_type=\"set_up_pod\"} 8\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.005\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.01\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.025\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.05\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.1\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.25\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"0.5\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"1\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"2.5\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"5\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"10\"} 3\nkubelet_network_plugin_operations_duration_seconds_bucket{operation_type=\"tear_down_pod\",le=\"+Inf\"} 3\nkubelet_network_plugin_operations_duration_seconds_sum{operation_type=\"tear_down_pod\"} 4.3269e-05\nkubelet_network_plugin_operations_duration_seconds_count{operation_type=\"tear_down_pod\"} 3\n```\n\n----------------------------------------\n\nTITLE: Visualizing Language Detection Workflow with Mermaid Sequence Diagram\nDESCRIPTION: A sequence diagram showing the interaction between different components involved in language detection and library injection, including the Datadog Agent components (Process Collector, Workload Metadata Store, Language Detection Client) and Cluster Agent components (Workload Metadata Store, Language Detection Handler, Language Detection Patcher) and their communication with the Kubernetes API Server.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/languagedetection/languagemodels/README.md#2025-04-22_snippet_0\n\nLANGUAGE: mermaid\nCODE:\n```\nsequenceDiagram\n    box Datadog Agent\n    participant PC as Process Collector\n    participant DAW as Workload Metadata Store\n    participant LDC as Language Detection Client\n    end\n\n    box Cluster Agent\n    participant DCAW as Workload Metadata Store\n    participant LDH as Language Detection Handler\n    participant LDP as Language Detection Patcher\n    end\n\n    box Kubernetes\n    participant KAS as Kubernetes API Server\n    end\n\n\n    loop Every TTL_REFRESH\n        LDC->>LDH: Periodically Refresh TTL of languages the are still detected\n    end\n\n\n    loop Every CLEANUP_PERIOD\n        LDH->>LDH: Periodically clear expired languages\n        LDH->>DCAW: Unset expired languages\n    end\n    PC->>DAW: Store detected languages\n    DAW->>LDC: Notify process language events\n\n    loop Every CLIENT_PERIOD\n        LDC->>LDH: Reports Newly Detected Languages\n    end\n\n    LDH->>DCAW: Push Detected Languages\n    DCAW->>LDP: Notify changes in `Detected Languages`\n    LDP->>DCAW: Checks Detected and Injectable Languages\n    LDP->>KAS: Sends Annotations Patch\n    KAS->>DCAW: Update Injectable Languages\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent with Bundled Functionalities in Bash\nDESCRIPTION: Commands to build the Datadog Agent with specific bundled functionalities. This allows combining multiple features into a single binary to reduce disk space usage.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_build.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv agent.build --bundle process-agent --bundle security-agent\n```\n\nLANGUAGE: bash\nCODE:\n```\ndda inv agent.build --bundle agent\n```\n\n----------------------------------------\n\nTITLE: Starting Process-Agent Service\nDESCRIPTION: Demonstrates how to start a previously disabled process-agent service using s6-svc.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/SUPERVISION.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ns6-svc -u /var/run/s6/services/process/\ns6-svstat /var/run/s6/services/process/\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent using values.yaml for Helm Chart\nDESCRIPTION: This YAML configuration specifies settings for the Datadog Agent deployed via Helm. It enables collecting Kubernetes events, cluster checks, the Cluster Agent with metrics provider, and cluster checks runner while disabling APM socket, process agent, container collection, and process discovery features.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/cluster-checks-runners/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  collectEvents: true\n  apm:\n    socketEnabled: false\n  processAgent:\n    enabled: false\n    containerCollection: false\n    processDiscovery: false\n  clusterChecks:\n    enabled: true\nclusterAgent:\n  enabled: true\n  metricsProvider:\n    enabled: true\nclusterChecksRunner:\n  enabled: true\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent Settings in YAML\nDESCRIPTION: This YAML configuration snippet defines settings for the Datadog agent in a Kubernetes environment. It enables event collection, process monitoring, and the orchestrator explorer. It also enables the Cluster Agent but disables APM socket.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/orchestrator-explorer/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  collectEvents: true\n  apm:\n    socketEnabled: false\n  processAgent:\n    enabled: true\n  orchestratorExplorer:\n    enabled: true\nclusterAgent:\n  enabled: true\n```\n\n----------------------------------------\n\nTITLE: Datadog Helm Chart Values Configuration for Kubernetes Manifests\nDESCRIPTION: YAML configuration used to generate Kubernetes manifests from the datadog/datadog Helm chart version 3.79.0. The configuration disables APM socket, disables the standard Kube State Metrics, and enables Kube State Metrics Core.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/kubernetes_state_core/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  apm:\n    socketEnabled: false\n  kubeStateMetricsEnabled: false\n  kubeStateMetricsCore:\n    enabled: true\n```\n\n----------------------------------------\n\nTITLE: Illustrating Cluster Check Package Architecture in ASCII\nDESCRIPTION: This ASCII diagram illustrates the architecture of the cluster check package, showing the relationships between node agents, Handler, AutoConf, leaderelection, dispatcher, and clusterStore components.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/clusteragent/clusterchecks/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n```\n                               +-------------+\n                               | node agents |\n                               +-+-----------+\n                                 |\n                                 | queries (/v1/api/clusterchecks/)\n                                 |\n                       +---------v----------+\n+----------+  setups   |       Handler      |   watches   +----------------+\n| AutoConf <-----------+     Public API     +-------------> leaderelection |\n+-----+----+           |  init logic, glue  |             +----------------+\n      |                +---------+----------+\n      |                          |\n      | sends                    | inits\n      | configs                  | passes queries\n      |                          |\n      |            +-------------v-----------+\n      |            |        dispatcher       |\n      +------------>   Runs the dispatching  |\n                   |   logic in a goroutine  |\n                   |                         |\n                   |   +-----------------+   |\n                   |   |  clusterStore   |   |\n                   |   | holds the state |   |\n                   +---+-----------------+---+\n```\n```\n\n----------------------------------------\n\nTITLE: ContainerContext Schema Definition\nDESCRIPTION: Defines the structure for container context in events, including container ID, creation time, and variables. This schema is used to track container-related information within the Datadog Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_4\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"string\",\n            \"description\": \"Container ID\"\n        },\n        \"created_at\": {\n            \"type\": \"string\",\n            \"format\": \"date-time\",\n            \"description\": \"Creation time of the container\"\n        },\n        \"variables\": {\n            \"$ref\": \"#/$defs/Variables\",\n            \"description\": \"Variables values\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"ContainerContextSerializer serializes a container context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Helm Repositories for Generate Script\nDESCRIPTION: Commands to remove existing Datadog repo and add both internal and public repositories before running the generate script\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n$ helm repo remove datadog\n\"datadog\" has been removed from your repositories\n$ helm repo add internal-dd gs://datadog-helm-prod\n\"internal-dd\" has been added to your repositories\n$ helm repo add datadog https://helm.datadoghq.com\n\"datadog\" has been added to your repositories\n$ ./generate.sh \n...\n```\n\n----------------------------------------\n\nTITLE: Deploying DogStatsD6 as Kubernetes DaemonSet with UDP Protocol\nDESCRIPTION: This Kubernetes manifest deploys DogStatsD6 as a DaemonSet using the UDP protocol on port 8125. It's configured to run alongside an existing agent5, with metadata collection disabled and the hostname set to the node name.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/dogstatsd/alpine/README.md#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: dogstatsd\nspec:\n  selector:\n    matchLabels:\n      app: dogstatsd\n  template:\n    metadata:\n      labels:\n        app: dogstatsd\n      name: dogstatsd\n    spec:\n      containers:\n      - image: datadog/dogstatsd:latest\n        imagePullPolicy: Always\n        name: dogstatsd\n        ports:\n          - containerPort: 8125\n            name: dogstatsdport\n            protocol: UDP\n        env:\n          - name: DD_API_KEY\n            value: ___value___\n          - name: DD_SEND_HOST_METADATA\n            # Legacy option name, keep as `false` when running alongside another Agent\n            value: \"false\"\n          - name: DD_ENABLE_METADATA_COLLECTION\n            value: \"false\"\n          - name: DD_HOSTNAME\n            valueFrom:\n              fieldRef:\n                fieldPath: spec.nodeName\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Pod Start Duration Metrics in Prometheus Format\nDESCRIPTION: Alpha-level metrics showing the distribution of pod startup times from pending to running state. The histogram buckets represent time thresholds from 0.005 to +Inf seconds, with summary statistics for 60 pod startups.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_25\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_start_duration_seconds [ALPHA] Duration in seconds for a single pod to go from pending to running.\n# TYPE kubelet_pod_start_duration_seconds histogram\nkubelet_pod_start_duration_seconds_bucket{le=\"0.005\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"0.01\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"0.025\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"0.05\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"0.1\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"0.25\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"0.5\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"1\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"2.5\"} 30\nkubelet_pod_start_duration_seconds_bucket{le=\"5\"} 53\nkubelet_pod_start_duration_seconds_bucket{le=\"10\"} 57\nkubelet_pod_start_duration_seconds_bucket{le=\"+Inf\"} 60\nkubelet_pod_start_duration_seconds_sum 202.36887400600008\nkubelet_pod_start_duration_seconds_count 60\n```\n\n----------------------------------------\n\nTITLE: Configuring Prometheus Receiver in YAML\nDESCRIPTION: Example configuration for manually setting up the Prometheus receiver to collect collector internal health metrics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/converter/README.md#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\nprometheus.yaml\n```\n\n----------------------------------------\n\nTITLE: Defining Metric Type Constants in Python for Datadog Agent\nDESCRIPTION: This snippet defines constants for various metric types used in the Datadog Agent. These constants are used when submitting metrics to specify the type of metric being reported.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/aggregator.md#2025-04-22_snippet_0\n\nLANGUAGE: python\nCODE:\n```\nGAUGE           = DATADOG_AGENT_RTLOADER_GAUGE\nRATE            = DATADOG_AGENT_RTLOADER_RATE\nCOUNT           = DATADOG_AGENT_RTLOADER_COUNT\nMONOTONIC_COUNT = DATADOG_AGENT_RTLOADER_MONOTONIC_COUNT\nCOUNTER         = DATADOG_AGENT_RTLOADER_COUNTER\nHISTOGRAM       = DATADOG_AGENT_RTLOADER_HISTOGRAM\nHISTORATE       = DATADOG_AGENT_RTLOADER_HISTORATE\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for ModuleEvent in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing a module event in the Datadog Agent. It includes properties for module name, loading source, arguments, and truncation status.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_9\n\nLANGUAGE: JSON\nCODE:\n```\n\"ModuleEvent\": {\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"module name\"\n        },\n        \"loaded_from_memory\": {\n            \"type\": \"boolean\",\n            \"description\": \"indicates if a module was loaded from memory, as opposed to a file\"\n        },\n        \"argv\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\"\n        },\n        \"args_truncated\": {\n            \"type\": \"boolean\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"name\"\n    ],\n    \"description\": \"ModuleEventSerializer serializes a module event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Exporting Container Log Filesystem Usage Metrics in Prometheus\nDESCRIPTION: This snippet defines a Prometheus gauge metric for container log filesystem usage. It includes labels for container, namespace, pod, and UID, providing detailed information about log storage consumption for various containers across different namespaces and pods.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_8\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_container_log_filesystem_used_bytes gauge\nkubelet_container_log_filesystem_used_bytes{container=\"agent\",namespace=\"datadog-agent-helm\",pod=\"datadog-agent-linux-clusterchecks-798887cdbb-r7ft8\",uid=\"2faa2ee1-7af3-405e-b5d5-cae8b2669028\"} 1.536831488e+09\nkubelet_container_log_filesystem_used_bytes{container=\"agent\",namespace=\"datadog-agent-helm\",pod=\"datadog-agent-linux-z9zbm\",uid=\"b279b6c5-5aa8-4167-9c2e-94b695201503\"} 5.242822656e+09\n# ... (additional metric entries)\n```\n\n----------------------------------------\n\nTITLE: Storage Operation Duration Histogram Metrics\nDESCRIPTION: Prometheus histogram metrics measuring storage operation durations for different Kubernetes volume plugins. Tracks both volume mount and controller attachment verification times across multiple duration buckets from 0.1s to 600s.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_34\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE storage_operation_duration_seconds histogram\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.25\"} 3\n[...additional metrics...]\n```\n\n----------------------------------------\n\nTITLE: Example System-probe Inventory Payload in JSON Format\nDESCRIPTION: This snippet demonstrates the structure of a system-probe inventory payload sent to DataDog. It includes system metadata such as agent version, various configuration settings (full, provided, file, runtime, etc.), hostname, and timestamp. All configuration values are scrubbed to remove sensitive information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/systemprobe/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"system_probe_metadata\": {\n        \"agent_version\": \"7.55.0\",\n        \"full_configuration\": \"<entire yaml configuration for system-probe>\",\n        \"provided_configuration\": \"system_probe_config:\\n  sysprobe_socket: /tmp/sysprobe.sock\",\n        \"file_configuration\": \"system_probe_config:\\n  sysprobe_socket: /tmp/sysprobe.sock\",\n        \"agent_runtime_configuration\": \"runtime_block_profile_rate: 5000\",\n        \"environment_variable_configuration\": \"{}\",\n        \"remote_configuration\": \"{}\",\n        \"cli_configuration\": \"{}\",\n        \"source_local_configuration\": \"{}\"\n    }\n    \"hostname\": \"my-host\",\n    \"timestamp\": 1631281754507358895\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Kubernetes Resources Tags\nDESCRIPTION: Configuration example showing how to map Kubernetes annotations and labels to tags for specific resource types like deployments.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\n\"deployments.apps\": {\n  \"annotationKey1\": \"tag1\",\n  \"annotationKey2\": \"tag2\"\n}\n```\n\n----------------------------------------\n\nTITLE: Generating Protobuf and gRPC Gateway Code\nDESCRIPTION: Generates both the protobuf golang definitions and the gRPC gateway code that allows the API to be served as a REST application. This should be run from the repository root.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/proto/datadog/api/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv protobuf.generate\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Agent E2E Tests Locally with Bash\nDESCRIPTION: Commands to run Datadog Agent end-to-end tests locally. It uses aws-vault for authentication and invokes the tests with specific targets.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/orchestrator/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncd ~/dd/datadog-agent # run from the repo root, not the new-e2e project root\naws-vault exec sso-agent-sandbox-account-admin -- zsh\ndda inv new-e2e-tests.run --targets=./tests/orchestrator\n```\n\n----------------------------------------\n\nTITLE: Defining SELinuxEnforceStatus JSON Schema for Enforcement Status\nDESCRIPTION: JSON schema definition for the SELinuxEnforceStatus structure which represents the enforcement status of SELinux. It can have values of 'enforcing', 'permissive', or 'disabled'.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_46\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"status\": {\n            \"type\": \"string\",\n            \"description\": \"SELinux enforcement status (one of 'enforcing', 'permissive' or 'disabled')\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SELinuxEnforceStatusSerializer serializes a SELinux enforcement status change to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Running Pre-commit Checks Manually for Datadog Agent\nDESCRIPTION: Example command to run the 'ruff' pre-commit check manually on all files in the Datadog Agent project. This is useful for running specific checks without committing.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_10\n\nLANGUAGE: sh\nCODE:\n```\npre-commit run ruff --all-files  # run ruff on all files\n```\n\n----------------------------------------\n\nTITLE: Python Version Check Configuration in CMake\nDESCRIPTION: Sets up Python3 requirements and verifies minimum version 3.7 is available.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/three/CMakeLists.txt#2025-04-22_snippet_0\n\nLANGUAGE: cmake\nCODE:\n```\ncmake_minimum_required(VERSION 3.15)\nfind_package (Python3 COMPONENTS Interpreter Development)\n\nif(Python3_VERSION_MINOR LESS \"7\")\n  message(\n    FATAL_ERROR\n    \"Python3 version found is too old: found ${Python3_EXECUTABLE} (version \\\"${Python3_VERSION}\\\"), minimum required version is 3.7\"\n  )\nendif()\n```\n\n----------------------------------------\n\nTITLE: Defining PTraceEvent Schema in JSON\nDESCRIPTION: JSON schema for PTraceEvent that captures process tracing information including the trace request, memory address, and process context of the traced process. References ProcessContext for tracee details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_38\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"request\": {\n            \"type\": \"string\",\n            \"description\": \"ptrace request\"\n        },\n        \"address\": {\n            \"type\": \"string\",\n            \"description\": \"address at which the ptrace request was executed\"\n        },\n        \"tracee\": {\n            \"$ref\": \"#/$defs/ProcessContext\",\n            \"description\": \"process context of the tracee\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"request\",\n        \"address\"\n    ],\n    \"description\": \"PTraceEventSerializer serializes a mmap event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Example Package Signing Payload Structure in JSON\nDESCRIPTION: Demonstrates the structure of a signing inventory payload containing host identification, timestamp, and signing metadata including key fingerprints, expiration dates, and repository information. The payload includes multiple signing keys with different key types and their associated repository configurations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/packagesigning/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"hostname\": \"totoro\",\n    \"timestamp\": 1631281754507358895,\n    \"signing_metadata\": {\n      \"signing_keys\": [\n        {\n          \"fingerprint\": \"1A2B3C4D5E6F0123456789ABCDEF0987654321FF\",\n          \"expiration_date\": \"2023-02-12\",\n          \"key_type\": \"trusted\",\n        },\n        {\n          \"fingerprint\": \"F1E2D3C4B5A67890FF1234567899ABCDEF654321\",\n          \"expiration_date\": \"9999-12-24\",\n          \"key_type\": \"debsig\",\n          \"repositories\": [\n            {\n              \"name\": \"https://apt.datadoghq.com/ stable 7\",\n              \"enabled\": true,\n              \"gpgcheck\": false,\n              \"repo_gpgcheck\": false},\n            {\"name\": \"https://yum.datadoghq.com/stable/7/x86_64/\",\n              \"enabled\": true,\n              \"gpgcheck\": true,\n              \"repo_gpgcheck\": false},\n          ]\n        }\n      ]\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Generating JSON Schema for Network Device Profiles\nDESCRIPTION: Command to generate the profile JSON schema by navigating to the schema command directory and running the Go generate command. This will create the profile_rc_schema.json file in the profiledefinition/schema directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/networkdevice/profile/profiledefinition/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncd pkg/networkdevice/profile/profiledefinition/schema_cmd\ngo generate\n```\n\n----------------------------------------\n\nTITLE: Monitoring CPU Usage in Prometheus Format for Kubernetes Containers\nDESCRIPTION: Prometheus-formatted metrics for container_cpu_usage_seconds_total counter tracking CPU consumption across various Kubernetes components and containers. The metrics include detailed labels like container name, image, namespace, pod, and CPU type, along with the cumulative CPU time in seconds and timestamps.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_6\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_cpu_usage_seconds_total counter\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 2766.884348881 1572450197572\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1950.547596871 1572450197668\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 384.12174866 1572450196297\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 346.402178004 1572450199385\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0.017987668 1572450186377\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 37.770287675 1572450198309\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0.026970028 1572450196497\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1316.80363171 1572450196733\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 72.02515816 1572450196475\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0.03654334 1572450195152\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 808.254619166 1572450186468\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0.018224515 1572450199201\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 69.506933099 1572450195355\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0.104892053 1572450197313\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 333.426894381 1572450190363\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0.01509014 1572450200713\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 32.99983898 1572450201420\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0.014333209 1572450188256\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 6.61699943 1572450195286\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0.014689778 1572450196642\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 242.677118892 1572450190276\ncontainer_cpu_usage_seconds_total{container=\"\",cpu=\"total\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0.072932089 1572450189944\ncontainer_cpu_usage_seconds_total{container=\"coredns\",cpu=\"total\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 71.997998203 1572450198917\ncontainer_cpu_usage_seconds_total{container=\"coredns\",cpu=\"total\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 69.405385539 1572450196388\ncontainer_cpu_usage_seconds_total{container=\"datadog-agent\",cpu=\"total\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 242.854752689 1572450197849\ncontainer_cpu_usage_seconds_total{container=\"etcd\",cpu=\"total\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 346.450163183 1572450202927\ncontainer_cpu_usage_seconds_total{container=\"kindnet-cni\",cpu=\"total\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 6.508916083 1572450196671\ncontainer_cpu_usage_seconds_total{container=\"kube-apiserver\",cpu=\"total\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 808.319134027 1572450188597\ncontainer_cpu_usage_seconds_total{container=\"kube-controller-manager\",cpu=\"total\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 333.445483621 1572450192433\ncontainer_cpu_usage_seconds_total{container=\"kube-proxy\",cpu=\"total\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 37.742879804 1572450197292\ncontainer_cpu_usage_seconds_total{container=\"kube-scheduler\",cpu=\"total\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 32.978205751 1572450195713\n# HELP container_cpu_user_seconds_total Cumulative user cpu time consumed in seconds.\n```\n\n----------------------------------------\n\nTITLE: Running Delve with Core Dump in Docker\nDESCRIPTION: Command to run the GDB Agent Docker image using Delve instead of GDB for core dump analysis. It specifies the Agent binary and core dump file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/gdb/README.md#2025-04-22_snippet_2\n\nLANGUAGE: Shell\nCODE:\n```\ndocker run -it -v /path/to/core_dump_file:/root/core --entrypoint /root/go/bin/dlv \\\n  gdb-agent:7.18.0 core /opt/datadog-agent/bin/agent/agent /root/core\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet PLEG Relist Duration Metrics in Prometheus Format\nDESCRIPTION: Kubelet PLEG (Pod Lifecycle Event Generator) relist duration metrics showing the distribution of how long it takes to relist pods. The data is presented as histogram buckets with various time thresholds from 0.005 to +Inf seconds, along with summary statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_23\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_pleg_relist_duration_seconds histogram\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.005\"} 88778\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.01\"} 112188\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.025\"} 1.325443e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.05\"} 1.599946e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.1\"} 1.670263e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.25\"} 1.671945e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.5\"} 1.671946e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"1\"} 1.671947e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"2.5\"} 1.671948e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"5\"} 1.671949e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"10\"} 1.671949e+06\nkubelet_pleg_relist_duration_seconds_bucket{le=\"+Inf\"} 1.67195e+06\nkubelet_pleg_relist_duration_seconds_sum 35470.97548711002\nkubelet_pleg_relist_duration_seconds_count 1.67195e+06\n```\n\n----------------------------------------\n\nTITLE: Stack Status and Management Commands\nDESCRIPTION: Commands for viewing stack status and managing VM lifecycles including launching, pausing, and resuming.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.status [--stack=<name>]\ndda inv -e kmt.pause\ndda inv -e kmt.resume\n```\n\n----------------------------------------\n\nTITLE: Building USM Debugger Binary for Target Architectures\nDESCRIPTION: Commands to build the USM debugger binary for the target machine's architecture. Choose the command that matches your target machine's architecture (x86_64 or arm64).\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/usm/debugger/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e system-probe.build-usm-debugger --arch=x86_64\ndda inv -e system-probe.build-usm-debugger --arch=arm64\n```\n\n----------------------------------------\n\nTITLE: Configuring External Metrics Provider Endpoints in YAML\nDESCRIPTION: YAML configuration to specify a list of external metrics provider endpoints. The DCA will query the next endpoint if the first one fails.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_10\n\nLANGUAGE: yaml\nCODE:\n```\nexternal_metrics_provider:\n  endpoints:\n    - endpoint1\n    - endpoint2\n    - endpoint3\n```\n\n----------------------------------------\n\nTITLE: Configuring Cluster Agent Leader Election in YAML\nDESCRIPTION: YAML configuration for enabling leader election using leases in the Datadog Cluster Agent. This setting is available for Kubernetes version 1.14 and later.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nleader_election_default_resource: \"leases\"\n```\n\n----------------------------------------\n\nTITLE: Querying Agent Version using Control API in Bash\nDESCRIPTION: This snippet demonstrates how to query the Agent version using the Control API. It uses curl to send an authenticated HTTPS request to the localhost endpoint.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_api.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$ curl -qs -H \"authorization: Bearer $(cat /path/to/auth_token)\" -k https://localhost:5001/agent/version\n```\n\n----------------------------------------\n\nTITLE: Defining cAdvisor Version Metric in Prometheus Format\nDESCRIPTION: This snippet defines a Prometheus metric 'cadvisor_version_info' that provides version information for cAdvisor, Docker, kernel, and OS. It uses a gauge type with constant value 1 and includes various labels for version details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_0\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP cadvisor_version_info A metric with a constant '1' value labeled by kernel version, OS version, docker version, cadvisor version & cadvisor revision.\n# TYPE cadvisor_version_info gauge\ncadvisor_version_info{cadvisorRevision=\"\",cadvisorVersion=\"\",dockerVersion=\"Unknown\",kernelVersion=\"4.9.184-linuxkit\",osVersion=\"Ubuntu Eoan Ermine (development branch)\"} 1\n```\n\n----------------------------------------\n\nTITLE: Installing Python 3.12 on macOS\nDESCRIPTION: Homebrew command to install Python 3.12 on macOS, which is required for Agent development.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nbrew install python@3.12\n```\n\n----------------------------------------\n\nTITLE: Recording GPU Events from System-Probe Process Using Curl\nDESCRIPTION: This command uses curl to connect to the system-probe Unix socket and record GPU events through the collect-events debug endpoint. It specifies a count parameter of 100 events and saves the output to a file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/gpu/testutil/event-viewer/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncurl --unix-socket $DD_SYSPROBE_SOCKET http://unix/gpu/debug/collect-events?count=100 > events\n```\n\n----------------------------------------\n\nTITLE: Tracking Volume Manager Total Volumes in Prometheus\nDESCRIPTION: This snippet defines a gauge metric for monitoring the total number of volumes in the Volume Manager. It tracks volumes in both the actual and desired state of the world for different plugin types.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_56\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP volume_manager_total_volumes [ALPHA] Number of volumes in Volume Manager\n# TYPE volume_manager_total_volumes gauge\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/configmap\",state=\"actual_state_of_world\"} 6\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/configmap\",state=\"desired_state_of_world\"} 6\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/empty-dir\",state=\"actual_state_of_world\"} 5\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/empty-dir\",state=\"desired_state_of_world\"} 5\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/host-path\",state=\"actual_state_of_world\"} 36\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/host-path\",state=\"desired_state_of_world\"} 36\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/projected\",state=\"actual_state_of_world\"} 30\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/projected\",state=\"desired_state_of_world\"} 30\n```\n\n----------------------------------------\n\nTITLE: Container File Descriptors Metrics\nDESCRIPTION: Prometheus metrics showing file descriptor usage across containers. Includes detailed container metadata like IDs, images, names, namespaces and pods with associated timestamp values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_8\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_file_descriptors gauge\ncontainer_file_descriptors{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_file_descriptors{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\n```\n\n----------------------------------------\n\nTITLE: Benchmarking Chunk Processing in Go\nDESCRIPTION: This code snippet demonstrates how to run and compare benchmark tests for two different chunk processing implementations in Go. It includes commands for running the benchmarks and a sample of the benchmark results, showing significant improvements in performance and memory usage for the optimized version.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/tagger/server/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n// with processChunksFunc = processChunksWithSplit[int]\ngo test -bench BenchmarkProcessChunks    -benchmem -count 6 -benchtime 100x > old.txt\n\n// with processChunksFunc = processChunksInPlace[int]\ngo test -bench BenchmarkProcessChunks    -benchmem -count 6  -benchtime 100x > new.txt\n\n// Compare results\nbenchstat old.txt new.txt\n```\n\nLANGUAGE: text\nCODE:\n```\ngoos: linux\ngoarch: arm64\npkg: github.com/DataDog/datadog-agent/comp/core/tagger/server\n                               │    old.txt    │               new.txt               │\n                               │    sec/op     │    sec/op     vs base               │\nProcessChunks/100-items-10       2399.5n ± 47%   239.8n ±  4%  -90.01% (p=0.002 n=6)\nProcessChunks/1000-items-10      35.072µ ± 13%   2.344µ ± 11%  -93.32% (p=0.002 n=6)\nProcessChunks/10000-items-10     365.19µ ±  5%   22.56µ ± 18%  -93.82% (p=0.002 n=6)\nProcessChunks/100000-items-10    3435.1µ ±  7%   222.5µ ± 16%  -93.52% (p=0.002 n=6)\nProcessChunks/1000000-items-10   29.059m ±  9%   2.219m ± 31%  -92.36% (p=0.002 n=6)\ngeomean                           314.3µ         22.87µ        -92.72%\n\n                               │   old.txt    │                 new.txt                  │\n                               │     B/op     │     B/op      vs base                    │\nProcessChunks/100-items-10       2.969Ki ± 0%   0.000Ki ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/1000-items-10      29.02Ki ± 0%    0.00Ki ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/10000-items-10     370.7Ki ± 0%     0.0Ki ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/100000-items-10    4.165Mi ± 0%   0.000Mi ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/1000000-items-10   44.65Mi ± 0%    0.00Mi ± 0%  -100.00% (p=0.002 n=6)\ngeomean                          362.1Ki                      ?                      ¹ ²\n¹ summaries must be >0 to compute geomean\n² ratios must be >0 to compute geomean\n\n                               │   old.txt   │                 new.txt                 │\n                               │  allocs/op  │  allocs/op   vs base                    │\nProcessChunks/100-items-10        81.00 ± 0%     0.00 ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/1000-items-10       759.0 ± 0%      0.0 ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/10000-items-10     7.514k ± 0%   0.000k ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/100000-items-10    75.02k ± 0%    0.00k ± 0%  -100.00% (p=0.002 n=6)\nProcessChunks/1000000-items-10   750.0k ± 0%     0.0k ± 0%  -100.00% (p=0.002 n=6)\ngeomean                          7.638k                     ?                      ¹ ²\n¹ summaries must be >0 to compute geomean\n² ratios must be >0 to compute geomean\n```\n\n----------------------------------------\n\nTITLE: Defining BPFProgram JSON Schema\nDESCRIPTION: JSON schema for serializing a BPF program, including properties like name, tag, program type, attach type, and helpers used.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_18\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"Name of the BPF program\"\n        },\n        \"tag\": {\n            \"type\": \"string\",\n            \"description\": \"Hash (sha1) of the BPF program\"\n        },\n        \"program_type\": {\n            \"type\": \"string\",\n            \"description\": \"Type of the BPF program\"\n        },\n        \"attach_type\": {\n            \"type\": \"string\",\n            \"description\": \"Attach type of the BPF program\"\n        },\n        \"helpers\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"List of helpers used by the BPF program\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"BPFProgramSerializer serializes a BPF map to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent Package on macOS (Skipping Signing)\nDESCRIPTION: This command builds the Datadog Agent package on macOS, skipping the signing step. It specifies a base directory for build artifacts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_omnibus.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -- omnibus.build --base-dir=$HOME/.omnibus --skip-sign\n```\n\n----------------------------------------\n\nTITLE: FileEvent Schema Definition\nDESCRIPTION: JSON schema for file events that extends the base file schema with destination file information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_12\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"path\": {\n            \"type\": \"string\",\n            \"description\": \"File path\"\n        },\n        \"device_path\": {\n            \"type\": \"string\",\n            \"description\": \"File device path\"\n        },\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"File basename\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/File\",\n            \"description\": \"Target file information\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"FileEventSerializer serializes a file event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: RegistryEvent Schema Definition\nDESCRIPTION: JSON schema for Windows registry events including key name, path and value information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_16\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"key_name\": {\n            \"type\": \"string\",\n            \"description\": \"Registry key name\"\n        },\n        \"key_path\": {\n            \"type\": \"string\",\n            \"description\": \"Registry key path\"\n        },\n        \"value_name\": {\n            \"type\": \"string\",\n            \"description\": \"Value name of the key value\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"RegistryEventSerializer serializes a registry event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: EventContext Schema Definition\nDESCRIPTION: Defines the structure for event context including event name, category, outcome, and whether it was asynchronous. It also tracks matched rules for anomaly detection and associated variables.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_5\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"Event name\"\n        },\n        \"category\": {\n            \"type\": \"string\",\n            \"description\": \"Event category\"\n        },\n        \"outcome\": {\n            \"type\": \"string\",\n            \"description\": \"Event outcome\"\n        },\n        \"async\": {\n            \"type\": \"boolean\",\n            \"description\": \"True if the event was asynchronous\"\n        },\n        \"matched_rules\": {\n            \"items\": {\n                \"$ref\": \"#/$defs/MatchedRule\"\n            },\n            \"type\": \"array\",\n            \"description\": \"The list of rules that the event matched (only valid in the context of an anomaly)\"\n        },\n        \"variables\": {\n            \"$ref\": \"#/$defs/Variables\",\n            \"description\": \"Variables values\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"EventContextSerializer serializes an event context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring OpenTelemetry Agent in Datadog Agent\nDESCRIPTION: YAML configuration for enabling the OpenTelemetry agent within the Datadog Agent. The configuration enables the agent and specifies the flare port (7777) for data collection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddflareextension/README.md#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\notel-agent:\n enabled: true\n flare_port: 7777\n```\n\n----------------------------------------\n\nTITLE: Exposing Kubernetes Build Information in Prometheus Format\nDESCRIPTION: This snippet shows the kubernetes_build_info metric which provides information about the Kubernetes version, build date, Git commit, and platform details. This metric is useful for tracking which version of Kubernetes is running.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_23\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubernetes_build_info A metric with a constant '1' value labeled by major, minor, git version, git commit, git tree state, build date, Go version, and compiler from which Kubernetes was built, and platform on which it is running.\n# TYPE kubernetes_build_info gauge\nkubernetes_build_info{buildDate=\"2018-03-26T16:44:10Z\",compiler=\"gc\",gitCommit=\"fc32d2f3698e36b93322a3465f63a14e9f0eaead\",gitTreeState=\"clean\",gitVersion=\"v1.10.0\",goVersion=\"go1.9.3\",major=\"1\",minor=\"10\",platform=\"linux/amd64\"} 1\n```\n\n----------------------------------------\n\nTITLE: Building the Process Agent from Source\nDESCRIPTION: Command to build the Process Agent from source code using the dda invoke tool.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/process-agent/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e process-agent.build\n```\n\n----------------------------------------\n\nTITLE: Running Pre-commit Checks Manually\nDESCRIPTION: Example command to run the flake8 pre-commit check manually on all files in the repository.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_13\n\nLANGUAGE: sh\nCODE:\n```\npre-commit run flake8 --all-files  # run flake8 on all files\n```\n\n----------------------------------------\n\nTITLE: Container Filesystem Inodes Metrics\nDESCRIPTION: Prometheus metrics showing available and total inodes for container filesystems across different devices including overlay, tmpfs and physical disks.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_9\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_fs_inodes_free Number of available Inodes\n# TYPE container_fs_inodes_free gauge\ncontainer_fs_inodes_free{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.446456e+06 1572450197572\n# HELP container_fs_inodes_total Number of Inodes\n# TYPE container_fs_inodes_total gauge\ncontainer_fs_inodes_total{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 4.194304e+06 1572450197572\n```\n\n----------------------------------------\n\nTITLE: Building the Serverless Agent for Linux\nDESCRIPTION: Command to build the Datadog Serverless Agent for Linux environments. This uses the Go compiler with the 'serverless' tag to create the agent executable.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/serverless/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nGOOS=linux go build -tags serverless -o datadog-agent\n```\n\n----------------------------------------\n\nTITLE: Integrating Module with Other Datadog Agent Modules\nDESCRIPTION: This Go module configuration demonstrates how to add the new module as a dependency in another module, including the use of replace directives for local development.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/how-to/go/add-module.md#2025-04-22_snippet_4\n\nLANGUAGE: go\nCODE:\n```\nmodule github.com/DataDog/datadog-agent/myothermodule\ngo 1.18\n// Replace with local version\nreplace github.com/DataDog/datadog-agent/path/to/mymodule => ../path/to/mymodule\nrequire (\n    github.com/DataDog/datadog-agent/path/to/mymodule v0.0.0-20230526143644-ed785d3a20d5\n)\n```\n\n----------------------------------------\n\nTITLE: PowerShell Script for Building Datadog Agent Package on Windows\nDESCRIPTION: This PowerShell script provides a flexible way to build the Datadog Agent package on Windows using a Docker container. It allows customization of build parameters such as major version, target architecture, and release version.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_omnibus.md#2025-04-22_snippet_5\n\nLANGUAGE: powershell\nCODE:\n```\nparam (\n   [int]$MAJOR_VERSION=7,\n   $TARGET_ARCH=\"x64\",\n   $RELEASE_VERSION=\"nightly\",\n   [bool]$RM_CONTAINER=$true,\n   [bool]$DEBUG=$false\n)\n\n$cmd = \"docker run\"\nif ($RM_CONTAINER) {\n    $cmd += \" --rm \"\n}\n$opts = \"-e OMNIBUS_TARGET=main -e RELEASE_VERSION=$RELEASE_VERSION -e MAJOR_VERSION=$MAJOR_VERSION -e TARGET_ARCH=$TARGET_ARCH\"\nif ($DEBUG) {\n    $opts += \" -e DEBUG_CUSTOMACTION=yes \"\n}\n$cmd += \" -m 8192M -v \\\"$(Get-Location):c:\\mnt\\\" $opts datadog/agent-buildimages-windows_x64:1809 powershell -C \\\"c:\\mnt\\tasks\\winbuildscripts\\Build-AgentPackages.ps1 -BuildOutOfSource 1 -InstallDeps 1 -CheckGoVersion 1\\\"\"\nWrite-Host $cmd\nInvoke-Expression -Command $cmd\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for PTraceEvent in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing ptrace events in the Datadog Agent. It includes properties for the ptrace request, address, and process context of the tracee.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_15\n\nLANGUAGE: JSON\nCODE:\n```\n\"PTraceEvent\": {\n    \"properties\": {\n        \"request\": {\n            \"type\": \"string\",\n            \"description\": \"ptrace request\"\n        },\n        \"address\": {\n            \"type\": \"string\",\n            \"description\": \"address at which the ptrace request was executed\"\n        },\n        \"tracee\": {\n            \"$ref\": \"#/$defs/ProcessContext\",\n            \"description\": \"process context of the tracee\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"request\",\n        \"address\"\n    ],\n    \"description\": \"PTraceEventSerializer serializes a mmap event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubelet Eviction Stats Age in Kubernetes\nDESCRIPTION: These metrics track the age of stats used for pod evictions in Kubernetes. They include both deprecated microseconds metrics and current seconds metrics, using summary and histogram types respectively.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_38\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_eviction_stats_age_microseconds [ALPHA] (Deprecated) Time between when stats are collected, and when pod is evicted based on those stats by eviction signal\n# TYPE kubelet_eviction_stats_age_microseconds summary\nkubelet_eviction_stats_age_microseconds{eviction_signal=\"allocatableMemory.available\",quantile=\"0.5\"} NaN\nkubelet_eviction_stats_age_microseconds{eviction_signal=\"allocatableMemory.available\",quantile=\"0.9\"} NaN\nkubelet_eviction_stats_age_microseconds{eviction_signal=\"allocatableMemory.available\",quantile=\"0.99\"} NaN\nkubelet_eviction_stats_age_microseconds_sum{eviction_signal=\"allocatableMemory.available\"} 15557\nkubelet_eviction_stats_age_microseconds_count{eviction_signal=\"allocatableMemory.available\"} 3\n\n# HELP kubelet_eviction_stats_age_seconds [ALPHA] Time between when stats are collected, and when pod is evicted based on those stats by eviction signal\n# TYPE kubelet_eviction_stats_age_seconds histogram\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.005\"} 2\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.01\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.025\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.05\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.1\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.25\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"0.5\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"1\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"2.5\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"5\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"10\"} 3\nkubelet_eviction_stats_age_seconds_bucket{eviction_signal=\"allocatableMemory.available\",le=\"+Inf\"} 3\nkubelet_eviction_stats_age_seconds_sum{eviction_signal=\"allocatableMemory.available\"} 0.015040582\nkubelet_eviction_stats_age_seconds_count{eviction_signal=\"allocatableMemory.available\"} 3\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Runtime Operations Metrics in Prometheus\nDESCRIPTION: This snippet defines counter metrics for cumulative number of runtime operations by operation type. It includes various operation types such as container status, create container, exec, and more.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_17\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations Cumulative number of runtime operations by operation type.\n# TYPE kubelet_runtime_operations counter\nkubelet_runtime_operations{operation_type=\"container_status\"} 103\nkubelet_runtime_operations{operation_type=\"create_container\"} 18\nkubelet_runtime_operations{operation_type=\"exec\"} 2\nkubelet_runtime_operations{operation_type=\"image_status\"} 37\nkubelet_runtime_operations{operation_type=\"list_containers\"} 622\nkubelet_runtime_operations{operation_type=\"list_images\"} 40\nkubelet_runtime_operations{operation_type=\"list_podsandbox\"} 617\nkubelet_runtime_operations{operation_type=\"podsandbox_status\"} 98\nkubelet_runtime_operations{operation_type=\"pull_image\"} 4\nkubelet_runtime_operations{operation_type=\"remove_container\"} 2\nkubelet_runtime_operations{operation_type=\"run_podsandbox\"} 15\nkubelet_runtime_operations{operation_type=\"start_container\"} 18\nkubelet_runtime_operations{operation_type=\"status\"} 59\nkubelet_runtime_operations{operation_type=\"stop_container\"} 5\nkubelet_runtime_operations{operation_type=\"stop_podsandbox\"} 23\nkubelet_runtime_operations{operation_type=\"version\"} 33\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent in YAML for Kubernetes\nDESCRIPTION: This YAML configuration specifies settings for the Datadog Agent in a Kubernetes environment. It enables event collection and leader election, while disabling APM socket, process agent, and related features.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/agent-only/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  collectEvents: true\n  leaderElection: true\n  apm:\n    socketEnabled: false\n  processAgent:\n    enabled: false\n    containerCollection: false\n    processDiscovery: false\n```\n\n----------------------------------------\n\nTITLE: Complete modules.yml Configuration Example\nDESCRIPTION: Comprehensive example of modules.yml file showing various module configurations including default, ignored, and custom settings.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/modules.md#2025-04-22_snippet_4\n\nLANGUAGE: yaml\nCODE:\n```\nmodules:\n  .:\n    independent: false\n    lint_targets:\n    - ./pkg\n    - ./cmd\n    - ./comp\n    test_targets:\n    - ./pkg\n    - ./cmd\n    - ./comp\n  comp/api/api/def:\n    used_by_otel: true\n  comp/api/authtoken: default\n  test/integration/serverless/src: ignored\n  tools/retry_file_dump:\n    should_test_condition: never\n    independent: false\n    should_tag: false\n```\n\n----------------------------------------\n\nTITLE: Prometheus Metrics for Container Memory Reservation Limits in Kubernetes\nDESCRIPTION: A collection of Prometheus metrics showing memory reservation limits for containers running in a Kubernetes cluster. These metrics include container identifiers, image references, namespace information, and pod names, with all values showing 0 bytes for memory reservation limits across the environment.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_52\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_spec_memory_reservation_limit_bytes gauge\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_reservation_limit_bytes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\n# HELP container_spec_memory_swap_limit_bytes Memory swap limit for the container.\n```\n\n----------------------------------------\n\nTITLE: Container Network Receive Errors Metrics\nDESCRIPTION: Prometheus counter metric tracking network receive errors across different containers and network interfaces in a Kubernetes cluster. Each metric includes container ID, image, interface type, namespace, and pod name along with the error count and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_30\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_receive_errors_total counter\ncontainer_network_receive_errors_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_errors_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_errors_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n```\n\n----------------------------------------\n\nTITLE: Creating and Configuring KMT Stack\nDESCRIPTION: Commands to create a new stack and configure it with various VM configurations including remote x86_64 and arm64 machines with different distributions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.create-stack --stack=demo-stack\n\ndda inv -e kmt.gen-config --vms=x86-jammy-distro,x86-focal-distro,arm64-amazon4.14-distro,arm64-amazon5.10-distro --stack=demo-stack\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent with Custom values.yaml for Kubernetes\nDESCRIPTION: This YAML configuration specifies settings for the Datadog Agent deployment in Kubernetes. It enables event collection and Cluster Agent with metrics provider, while disabling APM socket functionality and process monitoring features.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/cluster-agent-datadogmetrics/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\ndatadog:\n  collectEvents: true\n  apm:\n    socketEnabled: false\n  processAgent:\n    enabled: false\n    containerCollection: false\n    processDiscovery: false\nclusterAgent:\n  enabled: true\n  metricsProvider:\n    enabled: true\n    useDatadogMetrics: true\n```\n\n----------------------------------------\n\nTITLE: API Response Structure\nDESCRIPTION: Golang struct defining the API response format for payload endpoints\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_4\n\nLANGUAGE: golang\nCODE:\n```\n{\n  \"payloads\": [][]byte\n}\n```\n\n----------------------------------------\n\nTITLE: Initializing New Go Module\nDESCRIPTION: This command initializes a new Go module in the created directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/how-to/go/add-module.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncd path/to/mymodule && go mod init\n```\n\n----------------------------------------\n\nTITLE: Configuring Go-Expvar Check for RTLoader Memory Monitoring\nDESCRIPTION: Sets up the go-expvar check to monitor RTLoader and C/C++ memory usage by collecting specific expvar metrics related to memory allocations and frees.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_6\n\nLANGUAGE: yaml\nCODE:\n```\ninit_config:\n\ninstances:\n  - expvar_url: http://localhost:5000/debug/vars\n    namespace: datadog.agent\n    metrics:\n      # other expvar metrics\n\n      # datadog-agent rtloader monitoring\n      - path: rtloader/AllocatedBytes\n        type: monotonic_counter\n      - path: rtloader/FreedBytes\n        type: monotonic_counter\n      - path: rtloader/Allocations\n        type: monotonic_counter\n      - path: rtloader/Frees\n        type: monotonic_counter\n      - path: rtloader/InuseBytes\n        type: gauge\n      - path: rtloader/UntrackedFrees\n        type: monotonic_counter\n```\n\n----------------------------------------\n\nTITLE: Defining Container Memory Failure Count Metric in Prometheus\nDESCRIPTION: This snippet defines the container_memory_failcnt metric type as a counter in Prometheus format. It represents the cumulative count of memory allocation failures for containers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_14\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_failcnt counter\n```\n\n----------------------------------------\n\nTITLE: Starting DogStatsD with config file\nDESCRIPTION: Command to start DogStatsD using a specified configuration file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/dogstatsd/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndogstatsd start -f datadog.yaml\n```\n\n----------------------------------------\n\nTITLE: Kubernetes Build Information Metrics\nDESCRIPTION: Prometheus metrics containing Kubernetes build information including version, build date, git commit, and platform details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_35\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubernetes_build_info [ALPHA] A metric with a constant '1' value labeled by major, minor, git version, git commit, git tree state, build date, Go version, and compiler from which Kubernetes was built, and platform on which it is running.\n# TYPE kubernetes_build_info gauge\nkubernetes_build_info{build_date=\"2022-02-11T09:54:21Z\",compiler=\"gc\",git_commit=\"092fbfbf53427de67cac1e9fa54aaa09a28371d7\",git_tree_state=\"clean\",git_version=\"v1.21.2\",go_version=\"go1.16.13\",major=\"1\",minor=\"21\",platform=\"linux/amd64\"} 1\n```\n\n----------------------------------------\n\nTITLE: Configuring Goimports in VSCode for Datadog Agent\nDESCRIPTION: This JSON configuration sets up VSCode to use gopls for formatting with the local package flag for the Datadog Agent project. It specifies the local package path for proper import organization.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/imports.md#2025-04-22_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"gopls\": {\n    \"formatting.local\": \"github.com/DataDog/datadog-agent\"\n  } \n}\n```\n\n----------------------------------------\n\nTITLE: Prometheus Kubelet Runtime Operations Latency Metrics\nDESCRIPTION: This snippet contains Prometheus metrics for kubelet runtime operations latency in microseconds. It includes detailed statistics for various operation types such as container_status, create_container, exec, image operations, and pod sandbox operations with quantiles, sum and count values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_20\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_runtime_operations_latency_microseconds summary\nkubelet_runtime_operations_latency_microseconds{operation_type=\"container_status\",quantile=\"0.5\"} 2368\nkubelet_runtime_operations_latency_microseconds{operation_type=\"container_status\",quantile=\"0.9\"} 7742\nkubelet_runtime_operations_latency_microseconds{operation_type=\"container_status\",quantile=\"0.99\"} 167906\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"container_status\"} 1.513538e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"container_status\"} 103\nkubelet_runtime_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.5\"} 137328\nkubelet_runtime_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.9\"} 234493\nkubelet_runtime_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.99\"} 287639\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"create_container\"} 2.984943e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"create_container\"} 18\nkubelet_runtime_operations_latency_microseconds{operation_type=\"exec\",quantile=\"0.5\"} 987\nkubelet_runtime_operations_latency_microseconds{operation_type=\"exec\",quantile=\"0.9\"} 987\nkubelet_runtime_operations_latency_microseconds{operation_type=\"exec\",quantile=\"0.99\"} 987\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"exec\"} 2041\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"exec\"} 2\nkubelet_runtime_operations_latency_microseconds{operation_type=\"image_status\",quantile=\"0.5\"} 2037\nkubelet_runtime_operations_latency_microseconds{operation_type=\"image_status\",quantile=\"0.9\"} 4973\nkubelet_runtime_operations_latency_microseconds{operation_type=\"image_status\",quantile=\"0.99\"} 8487\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"image_status\"} 122163\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"image_status\"} 37\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_containers\",quantile=\"0.5\"} 3166\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_containers\",quantile=\"0.9\"} 5437\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_containers\",quantile=\"0.99\"} 12511\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"list_containers\"} 2.135551e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"list_containers\"} 622\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_images\",quantile=\"0.5\"} 12613\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_images\",quantile=\"0.9\"} 18751\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_images\",quantile=\"0.99\"} 21122\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"list_images\"} 562315\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"list_images\"} 40\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_podsandbox\",quantile=\"0.5\"} 4957\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_podsandbox\",quantile=\"0.9\"} 10595\nkubelet_runtime_operations_latency_microseconds{operation_type=\"list_podsandbox\",quantile=\"0.99\"} 15819\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"list_podsandbox\"} 3.980385e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"list_podsandbox\"} 617\nkubelet_runtime_operations_latency_microseconds{operation_type=\"podsandbox_status\",quantile=\"0.5\"} 1322\nkubelet_runtime_operations_latency_microseconds{operation_type=\"podsandbox_status\",quantile=\"0.9\"} 3620\nkubelet_runtime_operations_latency_microseconds{operation_type=\"podsandbox_status\",quantile=\"0.99\"} 378062\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"podsandbox_status\"} 1.921336e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"podsandbox_status\"} 98\nkubelet_runtime_operations_latency_microseconds{operation_type=\"pull_image\",quantile=\"0.5\"} 1.533869e+06\nkubelet_runtime_operations_latency_microseconds{operation_type=\"pull_image\",quantile=\"0.9\"} 1.640169e+06\nkubelet_runtime_operations_latency_microseconds{operation_type=\"pull_image\",quantile=\"0.99\"} 1.640169e+06\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"pull_image\"} 6.384318e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"pull_image\"} 4\nkubelet_runtime_operations_latency_microseconds{operation_type=\"remove_container\",quantile=\"0.5\"} 39549\nkubelet_runtime_operations_latency_microseconds{operation_type=\"remove_container\",quantile=\"0.9\"} 39549\nkubelet_runtime_operations_latency_microseconds{operation_type=\"remove_container\",quantile=\"0.99\"} 39549\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"remove_container\"} 84569\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"remove_container\"} 2\nkubelet_runtime_operations_latency_microseconds{operation_type=\"run_podsandbox\",quantile=\"0.5\"} 620159\nkubelet_runtime_operations_latency_microseconds{operation_type=\"run_podsandbox\",quantile=\"0.9\"} 1.020922e+06\nkubelet_runtime_operations_latency_microseconds{operation_type=\"run_podsandbox\",quantile=\"0.99\"} 1.234262e+06\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"run_podsandbox\"} 1.1787511e+07\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"run_podsandbox\"} 15\nkubelet_runtime_operations_latency_microseconds{operation_type=\"start_container\",quantile=\"0.5\"} 299503\nkubelet_runtime_operations_latency_microseconds{operation_type=\"start_container\",quantile=\"0.9\"} 435624\nkubelet_runtime_operations_latency_microseconds{operation_type=\"start_container\",quantile=\"0.99\"} 443889\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"start_container\"} 5.832108e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"start_container\"} 18\nkubelet_runtime_operations_latency_microseconds{operation_type=\"status\",quantile=\"0.5\"} 1985\nkubelet_runtime_operations_latency_microseconds{operation_type=\"status\",quantile=\"0.9\"} 2521\nkubelet_runtime_operations_latency_microseconds{operation_type=\"status\",quantile=\"0.99\"} 3745\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"status\"} 115955\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"status\"} 59\nkubelet_runtime_operations_latency_microseconds{operation_type=\"stop_container\",quantile=\"0.5\"} 1409\nkubelet_runtime_operations_latency_microseconds{operation_type=\"stop_container\",quantile=\"0.9\"} 9797\nkubelet_runtime_operations_latency_microseconds{operation_type=\"stop_container\",quantile=\"0.99\"} 9797\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"stop_container\"} 204049\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"stop_container\"} 5\nkubelet_runtime_operations_latency_microseconds{operation_type=\"stop_podsandbox\",quantile=\"0.5\"} 275317\nkubelet_runtime_operations_latency_microseconds{operation_type=\"stop_podsandbox\",quantile=\"0.9\"} 523331\nkubelet_runtime_operations_latency_microseconds{operation_type=\"stop_podsandbox\",quantile=\"0.99\"} 566622\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"stop_podsandbox\"} 6.29327e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"stop_podsandbox\"} 23\nkubelet_runtime_operations_latency_microseconds{operation_type=\"version\",quantile=\"0.5\"} 1194\nkubelet_runtime_operations_latency_microseconds{operation_type=\"version\",quantile=\"0.9\"} 1798\nkubelet_runtime_operations_latency_microseconds{operation_type=\"version\",quantile=\"0.99\"} 1975\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"version\"} 42488\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"version\"} 33\n```\n\n----------------------------------------\n\nTITLE: Installing Required Tools for Datadog Agent Development\nDESCRIPTION: This command installs the correct versions of required tools for the Datadog Agent project. It should be run from the repository root directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/security/proto/README.md#2025-04-22_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\ndda inv install-tools\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubernetes API Request Latencies with Prometheus\nDESCRIPTION: Prometheus histogram metrics tracking REST client request latencies for various Kubernetes API endpoints. Includes latency buckets from 0.001s to +Inf, along with sum and count values for each endpoint/verb combination.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_30\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"GET\",le=\"0.002\"} 15\n# ... additional metrics truncated for brevity ...\n```\n\n----------------------------------------\n\nTITLE: Monitoring Volume Manager Statistics in Kubernetes\nDESCRIPTION: This snippet contains Prometheus metrics for monitoring the total number of volumes managed by the Volume Manager in Kubernetes. It tracks volumes in both the actual and desired states for different volume plugins.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_38\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP volume_manager_total_volumes Number of volumes in Volume Manager\n# TYPE volume_manager_total_volumes gauge\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/configmap\",state=\"actual_state_of_world\"} 3\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/configmap\",state=\"desired_state_of_world\"} 3\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/empty-dir\",state=\"actual_state_of_world\"} 3\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/empty-dir\",state=\"desired_state_of_world\"} 3\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/host-path\",state=\"actual_state_of_world\"} 20\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/host-path\",state=\"desired_state_of_world\"} 20\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/secret\",state=\"actual_state_of_world\"} 7\nvolume_manager_total_volumes{plugin_name=\"kubernetes.io/secret\",state=\"desired_state_of_world\"} 7\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Docker Operations Duration Metrics in Prometheus\nDESCRIPTION: This snippet defines a histogram metric type for kubelet Docker operations duration in seconds. It includes multiple buckets for different operation types, representing the count of operations that completed within specific duration thresholds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_12\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_docker_operations_duration_seconds histogram\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.005\"} 0\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.01\"} 0\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.025\"} 0\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.05\"} 36\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.1\"} 77\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.25\"} 88\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.5\"} 90\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"1\"} 91\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"2.5\"} 92\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"5\"} 94\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"10\"} 95\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"+Inf\"} 97\nkubelet_docker_operations_duration_seconds_sum{operation_type=\"create_container\"} 57.632651154\nkubelet_docker_operations_duration_seconds_count{operation_type=\"create_container\"} 97\n```\n\n----------------------------------------\n\nTITLE: Defining OS Filter for Windows in YAML\nDESCRIPTION: This snippet shows how to include an OS rule filter field for Windows in a YAML configuration. It's required for rules using Windows attributes and helpers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/windows_expressions.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nid: [...]\nexpression: [...]\nfilters:\n  - os == \"windows\"\n\n```\n\n----------------------------------------\n\nTITLE: Network Address Family Constants Definition\nDESCRIPTION: Complete list of supported network address family constants (AF_*) that are available across all architectures. These constants are used for specifying the address family when working with network sockets and communications.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_13\n\nLANGUAGE: markdown\nCODE:\n```\nAF_UNSPEC\nAF_LOCAL\nAF_UNIX\nAF_FILE\nAF_INET\nAF_AX25\nAF_IPX\nAF_APPLETALK\n...\n```\n\n----------------------------------------\n\nTITLE: Running KSMv2 Benchmark with Invoke\nDESCRIPTION: Executes the KSMv2 benchmark using the invoke task runner with time measurement. This command runs the main function of the KSMv2 check against the static test data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/benchmarks/kubernetes_state/README.md#2025-04-22_snippet_1\n\nLANGUAGE: sh\nCODE:\n```\ntime dda inv bench.kubernetes-state\n```\n\n----------------------------------------\n\nTITLE: Installing Systemd Development Libraries on Ubuntu/Debian\nDESCRIPTION: Command to install the systemd development libraries on Ubuntu or Debian, which are required for the Agent to collect systemd journal logs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\nsudo apt-get install libsystemd-dev\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent Package on Linux/macOS Host\nDESCRIPTION: This command runs the Omnibus build task directly on the host system for Linux or macOS. It specifies a base directory for build artifacts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_omnibus.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -- omnibus.build --base-dir=$HOME/.omnibus\n```\n\n----------------------------------------\n\nTITLE: Defining Container Memory Failures Total Metric in Prometheus\nDESCRIPTION: This snippet defines a help text for the container_memory_failures_total metric, which represents the cumulative count of memory allocation failures across all containers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_16\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_memory_failures_total Cumulative count of memory allocation failures.\n```\n\n----------------------------------------\n\nTITLE: Configuring Backtrace Support for FreeBSD\nDESCRIPTION: For FreeBSD systems, this snippet finds and links against the Backtrace package, which is required for generating stack traces.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/rtloader/CMakeLists.txt#2025-04-22_snippet_3\n\nLANGUAGE: CMake\nCODE:\n```\nif(${CMAKE_SYSTEM_NAME} STREQUAL FreeBSD)\n  find_package(Backtrace REQUIRED)\n  target_link_libraries(datadog-agent-rtloader ${Backtrace_LIBRARIES})\n  add_compile_definitions(HAS_BACKTRACE_LIB)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Custom Metric with Multi-point Timeseries Data\nDESCRIPTION: Example of a single metric with multiple timestamp-value pairs in the points array. This format allows sending historical or accumulated data points for a metric in one request.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/autodiscovery/common/README.md#2025-04-22_snippet_2\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"series\": [\n    {\n      \"metric\": \"system.proc.count\",\n      \"points\": [\n        [<TIMESTAMP_1>, <VALUE_1>],\n        [<TIMESTAMP_2>, <VALUE_2>],\n        [<TIMESTAMP_3>, <VALUE_3>]\n      ],\n      \"type\": \"gauge\",\n      \"host\": \"test.example.com\",\n      \"tags\": [\"environment:test\"]\n    }\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Histogram Metrics for Kubelet Runtime Operations in Prometheus Format\nDESCRIPTION: This snippet contains histogram metrics for various kubelet runtime operations including list_podsandbox, podsandbox_status, pull_image, remove_container, run_podsandbox, start_container, status, and stop_container. Each operation has bucket counters for different duration thresholds, along with sum and count aggregations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_25\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.5\"} 79378\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"1\"} 79392\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"2.5\"} 79458\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"5\"} 79586\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"10\"} 79667\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"+Inf\"} 79691\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"list_podsandbox\"} 1874.27877241901\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"list_podsandbox\"} 79691\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.005\"} 82\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.01\"} 100\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.025\"} 107\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.05\"} 111\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.1\"} 113\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.25\"} 113\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.5\"} 115\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"1\"} 116\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"2.5\"} 116\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"5\"} 117\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"10\"} 117\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"+Inf\"} 117\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"podsandbox_status\"} 5.021619159\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"podsandbox_status\"} 117\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.01\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.025\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.05\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.1\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.25\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.5\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"1\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"2.5\"} 1\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"5\"} 1\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"10\"} 1\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"+Inf\"} 5\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"pull_image\"} 55.357576236\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"pull_image\"} 5\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.01\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.025\"} 11\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.05\"} 14\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.1\"} 15\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.25\"} 17\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.5\"} 18\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"1\"} 22\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"2.5\"} 22\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"5\"} 22\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"10\"} 22\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"+Inf\"} 22\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"remove_container\"} 4.026389304\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"remove_container\"} 22\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.01\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.025\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.05\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.1\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.25\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.5\"} 10\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"1\"} 12\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"2.5\"} 14\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"5\"} 15\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"10\"} 15\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"+Inf\"} 15\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"run_podsandbox\"} 11.840436846\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"run_podsandbox\"} 15\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.01\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.025\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.05\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.1\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.25\"} 13\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"0.5\"} 31\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"1\"} 34\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"2.5\"} 35\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"5\"} 35\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"10\"} 36\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"start_container\",le=\"+Inf\"} 36\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"start_container\"} 18.72976257\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"start_container\"} 36\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.01\"} 1905\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.025\"} 8358\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.05\"} 8572\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.1\"} 8597\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.25\"} 8610\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"0.5\"} 8612\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"1\"} 8614\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"2.5\"} 8622\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"5\"} 8636\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"10\"} 8694\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"status\",le=\"+Inf\"} 8719\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"status\"} 937.6233801129981\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"status\"} 8719\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.01\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.025\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.05\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.1\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.25\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"0.5\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"1\"} 1\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"2.5\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"5\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"10\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_container\",le=\"+Inf\"} 3\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"stop_container\"} 3.906386785\n```\n\n----------------------------------------\n\nTITLE: Setting Resource Attributes in Kubernetes Environment\nDESCRIPTION: Example of setting required resource attributes in a Kubernetes deployment YAML. These environment variables provide the SDK with necessary information about the Kubernetes context for proper telemetry tagging.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/otlp/components/processor/infraattributesprocessor/README.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nenv:\n  ...\n  - name: OTEL_SERVICE_NAME\n    value: {{ include \"calendar.fullname\" . }}\n  - name: OTEL_K8S_NAMESPACE\n    valueFrom:\n      fieldRef:\n        apiVersion: v1\n        fieldPath: metadata.namespace\n  - name: OTEL_K8S_NODE_NAME\n    valueFrom:\n      fieldRef:\n        apiVersion: v1\n        fieldPath: spec.nodeName\n  - name: OTEL_K8S_POD_NAME\n    valueFrom:\n      fieldRef:\n        apiVersion: v1\n        fieldPath: metadata.name\n  - name: OTEL_K8S_POD_ID\n    valueFrom:\n      fieldRef:\n        apiVersion: v1\n        fieldPath: metadata.uid\n  - name: OTEL_RESOURCE_ATTRIBUTES\n    value: >\n      service.name=$(OTEL_SERVICE_NAME),\n      k8s.namespace.name=$(OTEL_K8S_NAMESPACE),\n      k8s.node.name=$(OTEL_K8S_NODE_NAME),\n      k8s.pod.name=$(OTEL_K8S_POD_NAME),\n      k8s.pod.uid=$(OTEL_K8S_POD_ID),\n      k8s.container.name={{ .Chart.Name }},\n      host.name=$(OTEL_K8S_NODE_NAME),\n      deployment.environment=$(OTEL_K8S_NAMESPACE)\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Pod Worker Start Latency Metrics in Prometheus\nDESCRIPTION: This snippet defines metrics for the latency in microseconds from seeing a pod to starting a worker. It includes summary statistics for different quantiles, sum, and count.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_14\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_worker_start_latency_microseconds Latency in microseconds from seeing a pod to starting a worker.\n# TYPE kubelet_pod_worker_start_latency_microseconds summary\nkubelet_pod_worker_start_latency_microseconds{quantile=\"0.5\"} 31968\nkubelet_pod_worker_start_latency_microseconds{quantile=\"0.9\"} 3.234522e+06\nkubelet_pod_worker_start_latency_microseconds{quantile=\"0.99\"} 3.270085e+06\nkubelet_pod_worker_start_latency_microseconds_sum 2.9303728e+07\nkubelet_pod_worker_start_latency_microseconds_count 21\n```\n\n----------------------------------------\n\nTITLE: Kubelet Runtime Operations Metrics\nDESCRIPTION: Prometheus metrics showing kubelet runtime operation counts and errors, including container operations, pod sandbox operations, and image operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_34\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations_errors_total [ALPHA] Cumulative number of runtime operation errors by operation type.\n# TYPE kubelet_runtime_operations_errors_total counter\nkubelet_runtime_operations_errors_total{operation_type=\"exec_sync\"} 16\n# HELP kubelet_runtime_operations_total [ALPHA] Cumulative number of runtime operations by operation type.\n# TYPE kubelet_runtime_operations_total counter\nkubelet_runtime_operations_total{operation_type=\"container_status\"} 212\nkubelet_runtime_operations_total{operation_type=\"create_container\"} 67\nkubelet_runtime_operations_total{operation_type=\"exec\"} 3\nkubelet_runtime_operations_total{operation_type=\"exec_sync\"} 341720\n```\n\n----------------------------------------\n\nTITLE: Measuring Kubelet Runtime Operations Duration in Prometheus\nDESCRIPTION: This snippet shows Prometheus metrics for measuring the duration of Kubelet runtime operations. It includes histogram buckets for different operation types and their corresponding counts and sums.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_26\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"stop_container\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.01\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.025\"} 4\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.05\"} 5\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.1\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.25\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"0.5\"} 7\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"1\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"2.5\"} 9\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"5\"} 9\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"10\"} 9\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"stop_podsandbox\",le=\"+Inf\"} 9\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"stop_podsandbox\"} 2.975860290000001\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"stop_podsandbox\"} 9\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.01\"} 1830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.025\"} 4202\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.05\"} 4306\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.1\"} 4326\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.25\"} 4332\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"0.5\"} 4335\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"1\"} 4335\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"2.5\"} 4336\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"5\"} 4340\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"10\"} 4360\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"version\",le=\"+Inf\"} 4371\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"version\"} 364.7011673999992\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"version\"} 4371\n```\n\n----------------------------------------\n\nTITLE: Defining RTLoader Library for Windows and Non-Windows Platforms\nDESCRIPTION: Creates the datadog-agent-rtloader library, with different configurations for Windows (static library) and non-Windows platforms (shared library). For non-Windows, it also checks for and links against the execinfo library if available.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/rtloader/CMakeLists.txt#2025-04-22_snippet_2\n\nLANGUAGE: CMake\nCODE:\n```\nif(WIN32)\nadd_library(datadog-agent-rtloader\n    api.cpp\n    rtloader.cpp\n    ../common/rtloader_mem.c\n)\nelse()\nadd_library(datadog-agent-rtloader SHARED\n    api.cpp\n    rtloader.cpp\n    ../common/rtloader_mem.c\n)\n\n# execinfo is not POSIX-compliant and some libc may have libexecinfo as a library.\nfind_library(EXECINFO execinfo)\nif(EXECINFO)\n    target_link_libraries(datadog-agent-rtloader execinfo)\n    add_compile_definitions(HAS_BACKTRACE_LIB)\nendif()\nendif()\n```\n\n----------------------------------------\n\nTITLE: Defining Docker Operations Duration Metric in Prometheus\nDESCRIPTION: This snippet introduces a Prometheus metric for measuring the latency of Docker operations. It's defined as an alpha feature and is intended to provide insights into the duration of various Docker operations, broken down by operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_11\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_duration_seconds [ALPHA] Latency in seconds of Docker operations. Broken down by operation type.\n```\n\n----------------------------------------\n\nTITLE: Kubelet Running Container and Pod Count Metrics in Prometheus Format\nDESCRIPTION: This snippet shows gauge metrics for the number of currently running containers and pods managed by the Kubelet.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_22\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_running_container_count Number of containers currently running\n# TYPE kubelet_running_container_count gauge\nkubelet_running_container_count 12\n# HELP kubelet_running_pod_count Number of pods currently running\n# TYPE kubelet_running_pod_count gauge\nkubelet_running_pod_count 12\n```\n\n----------------------------------------\n\nTITLE: Configuring kubectl for Test Kubernetes Cluster\nDESCRIPTION: YAML configuration for updating the local kubectl config to point to the test Kubernetes cluster. Includes placeholders for server address and authentication data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/orchestrator/README.md#2025-04-22_snippet_1\n\nLANGUAGE: yaml\nCODE:\n```\nclusters:\n- cluster:\n    insecure-skip-tls-verify: true\n    server: https://10.1.58.202:8443\n  name: kind-kind\n- context:\n    cluster: kind-kind\n    user: kind-kind\n  name: kind-kind\nusers:\n- name: kind-kind\n  user:\n    client-certificate-data: <base64>\n    client-key-data: <base64>\n```\n\n----------------------------------------\n\nTITLE: Network Direction Constants\nDESCRIPTION: Definition of network packet direction constants that specify whether traffic is incoming (INGRESS) or outgoing (EGRESS). These are used for network traffic monitoring and filtering.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_14\n\nLANGUAGE: markdown\nCODE:\n```\nINGRESS\nEGRESS\n```\n\n----------------------------------------\n\nTITLE: Setting up Invoke Auto-completion\nDESCRIPTION: Command to enable auto-completion for invoke tasks in zsh shell\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/README.md#2025-04-22_snippet_1\n\nLANGUAGE: shell\nCODE:\n```\necho \"source <(dda inv --print-completion-script zsh)\" >> ~/.zshrc\n```\n\n----------------------------------------\n\nTITLE: Creating Google Kubernetes Engine Cluster with gcloud\nDESCRIPTION: Commands to create a new Google Kubernetes Engine cluster and configure kubectl to connect to it. This sets up the environment for Datadog Agent installation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/google-marketplace/README.md#2025-04-22_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\nexport CLUSTER=datadog-cluster\nexport ZONE=us-west1-a\n\ngcloud container clusters create \"$CLUSTER\" --zone \"$ZONE\"\n\ngcloud container clusters get-credentials \"$CLUSTER\" --zone \"$ZONE\"\n```\n\n----------------------------------------\n\nTITLE: Building Docker Image with Nano Windows Base\nDESCRIPTION: This Docker build command creates the Agent container image using a Nano Server base image. It specifies build arguments for the base image, JMX support, and Windows variant.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/windows/README.md#2025-04-22_snippet_3\n\nLANGUAGE: powershell\nCODE:\n```\n# Build nano image\ndocker build -t mycustomagent --build-arg BASE_IMAGE=mcr.microsoft.com/powershell:lts-nanoserver-1809 --build-arg WITH_JMX=false --build-arg VARIANT=1809 -f .\\windows\\amd64\\Dockerfile .\n```\n\n----------------------------------------\n\nTITLE: Container Network Metrics in Prometheus Format\nDESCRIPTION: Prometheus metric samples showing dropped packet counts for network interfaces in Kubernetes containers. Includes metrics for both ip6tnl0 and tunl0 interfaces with container metadata labels.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_33\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n# HELP container_network_receive_packets_total Cumulative count of packets received\n```\n\n----------------------------------------\n\nTITLE: Configuring Static C Runtime for Windows\nDESCRIPTION: For Windows builds, this snippet modifies compiler flags to use the static C runtime (/MT) instead of the DLL C runtime (/MD). This eliminates the need to redistribute the CRT.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/rtloader/CMakeLists.txt#2025-04-22_snippet_1\n\nLANGUAGE: CMake\nCODE:\n```\nif(WIN32)\n# explicitly set the compiler flags to use the static C runtime (/MT(d) instead of the DLL\n# c runtime (/MD(d) so that we don't have to worry about redistributing the CRT).\nforeach(flag_var\n        CMAKE_CXX_FLAGS CMAKE_CXX_FLAGS_DEBUG CMAKE_CXX_FLAGS_RELEASE\n        CMAKE_CXX_FLAGS_MINSIZEREL CMAKE_CXX_FLAGS_RELWITHDEBINFO)\n   if(${flag_var} MATCHES \"/MD\")\n      string(REGEX REPLACE \"/MD\" \"/MT\" ${flag_var} \"${${flag_var}}\")\n   endif(${flag_var} MATCHES \"/MD\")\nendforeach(flag_var)\nendif()\n```\n\n----------------------------------------\n\nTITLE: GDB Commands for Core Dump Analysis\nDESCRIPTION: Example GDB commands for analyzing the core dump, including listing threads, switching between threads, and viewing stack traces for both native and Python code.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/gdb/README.md#2025-04-22_snippet_3\n\nLANGUAGE: Shell\nCODE:\n```\ninfo threads # list threads\nthread <ID>  # switch to thread\nbt           # show stacktrace for current thread\npy-bt        # show python stacktrace (if selected thread is a python thread and has python frames)\n```\n\n----------------------------------------\n\nTITLE: Creating a Test Suite in PowerShell\nDESCRIPTION: Demonstrates how to create a new test suite using the Suite keyword. This is the basic structure for organizing multiple test cases.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/windows/DatadogAgentInstaller/QA/README.md#2025-04-22_snippet_1\n\nLANGUAGE: powershell\nCODE:\n```\nSuite \"My new test suite\" {\n\n}\n```\n\n----------------------------------------\n\nTITLE: Using ENC Token to Reference a Secret\nDESCRIPTION: Example of using the ENC token syntax to reference a secret value in a Datadog configuration template. This token will be replaced with the actual value from the secret file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/secrets-helper/README.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nENC[db_prod_password]\n```\n\n----------------------------------------\n\nTITLE: Testing FlareBuilder Callback with Mock in Golang\nDESCRIPTION: Example of using the FlareBuilder mock to test a component's fillFlare method. It demonstrates how to create a mock, call the fillFlare method, and assert the expected results.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/flares.md#2025-04-22_snippet_2\n\nLANGUAGE: golang\nCODE:\n```\nimport (\n\t\"testing\"\n\t\"github.com/DataDog/datadog-agent/comp/core/flare/helpers\"\n)\n\nfunc TestFillFlare(t testing.T) {\n\tmyComp := newComponent(...)\n\n\tflareBuilderMock := helpers.NewFlareBuilderMock(t)\n\n\tmyComp.fillFlare(flareBuilderMock, false)\n\t\n\tflareBuilderMock.AssertFileExists(\"datadog.yaml\")\n\tflareBuilderMock.AssertFileContent(\"some_file.txt\", \"my content\")\n\t// ...\n}\n```\n\n----------------------------------------\n\nTITLE: Kubelet HTTP Request Metrics\nDESCRIPTION: Gauge metrics showing number of in-flight HTTP requests to different Kubelet endpoints with method and path labels.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_16\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_http_inflight_requests [ALPHA] Number of the inflight http requests\n# TYPE kubelet_http_inflight_requests gauge\nkubelet_http_inflight_requests{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\"} 0\nkubelet_http_inflight_requests{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\"} 1\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Network Transmit Packets Dropped Total in Prometheus\nDESCRIPTION: Prometheus metrics data tracking dropped network packets during transmission for containers across different network interfaces. The metrics include container ID, image, interface type, namespace, and pod name along with timestamps. All values are at 0, indicating no packet drops during the measured period.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_41\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_transmit_packets_dropped_total counter\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\n```\n\n----------------------------------------\n\nTITLE: Listing Helm Repositories Configuration\nDESCRIPTION: Shows the expected Helm repository configuration with both internal and public Datadog repositories\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/manifests/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$ helm repo list\nNAME       \tURL\ninternal-dd\tgs://datadog-helm-prod\ndatadog    \thttps://helm.datadoghq.com\n```\n\n----------------------------------------\n\nTITLE: RegistryEvent Schema Definition\nDESCRIPTION: Defines the structure for Windows registry events, capturing key name, path, and value name information. This schema is used to track registry operations within the Datadog Agent on Windows systems.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_8\n\nLANGUAGE: json\nCODE:\n```\n{\n            \"properties\": {\n                \"key_name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Registry key name\"\n                },\n                \"key_path\": {\n                    \"type\": \"string\",\n                    \"description\": \"Registry key path\"\n                },\n                \"value_name\": {\n                    \"type\": \"string\",\n                    \"description\": \"Value name of the key value\"\n                }\n            },\n            \"additionalProperties\": false,\n            \"type\": \"object\",\n            \"description\": \"RegistryEventSerializer serializes a registry event to JSON\"\n        }\n```\n\n----------------------------------------\n\nTITLE: Defining Syscall JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing system call information. It requires both the name and ID of the syscall in the host architecture.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_52\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"Name of the syscall\"\n        },\n        \"id\": {\n            \"type\": \"integer\",\n            \"description\": \"ID of the syscall in the host architecture\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"name\",\n        \"id\"\n    ],\n    \"description\": \"SyscallSerializer serializes a syscall\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining DNSEvent JSON Schema\nDESCRIPTION: JSON schema for serializing a DNS event, including properties for the event ID and DNS question.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_24\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"integer\",\n            \"description\": \"id is the unique identifier of the DNS request\"\n        },\n        \"question\": {\n            \"$ref\": \"#/$defs/DNSQuestion\",\n            \"description\": \"question is a DNS question for the DNS request\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"id\",\n        \"question\"\n    ],\n    \"description\": \"DNSEventSerializer serializes a DNS event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Python Notebook Integration\nDESCRIPTION: Example Python code demonstrating how to interact with the fake intake API in a Jupyter notebook\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_6\n\nLANGUAGE: python\nCODE:\n```\n# POST payloads\nimport base64\nimport requests\nimport json\n\ndata = \"totoro|25|owner:kiki\"\nresponse = requests.post(\"http://localhost:80/api/v2/series\", data)\n\njson_content = response.content.decode('utf8')\n\nprint(json_content)\n\n# GET payloads\nimport base64\nimport requests\nimport json\n\nresponse = requests.get(\"http://localhost:80/fakeintake/payloads/?endpoint=/api/v2/series\")\n\njson_content = response.content.decode('utf8')\n\ndata = json.loads(json_content)\n\nprint(data)\n\nprint(\"==== Payloads ====\")\nfor payload in data[\"payloads\"]:\n    print(base64.b64decode(payload))\n```\n\n----------------------------------------\n\nTITLE: Container Network Receive Packets Metrics in Prometheus Format\nDESCRIPTION: Prometheus metrics showing total received network packets for containers across different network interfaces. Each metric includes container metadata like ID, image, namespace, and pod name along with the packet count and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_34\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_receive_packets_total counter\ncontainer_network_receive_packets_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 117276 1572450197572\ncontainer_network_receive_packets_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_packets_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n```\n\n----------------------------------------\n\nTITLE: Configuring TLS Version for Cluster Agent API in YAML\nDESCRIPTION: YAML configuration to allow fallback to TLS 1.0 for the Cluster Agent API used by Node Agents. By default, only TLS 1.3+ is allowed.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_8\n\nLANGUAGE: yaml\nCODE:\n```\ncluster_agent:\n  allow_legacy_tls: true\n```\n\n----------------------------------------\n\nTITLE: Building RtLoader with CMake\nDESCRIPTION: Commands for building the RtLoader project using CMake. First runs the configurator/generator, then uses make to build the project.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/README.md#2025-04-22_snippet_0\n\nLANGUAGE: sh\nCODE:\n```\ncmake .\nmake\n```\n\n----------------------------------------\n\nTITLE: Running GDB with Core Dump in Docker\nDESCRIPTION: Command to run the GDB Agent Docker image, mounting the core dump file and starting a GDB session to analyze it.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/gdb/README.md#2025-04-22_snippet_1\n\nLANGUAGE: Shell\nCODE:\n```\ndocker run -it -v /path/to/core_dump_file:/root/core gdb-agent:7.18.0 /root/core\n```\n\n----------------------------------------\n\nTITLE: Configuring Infra Attributes Processor in YAML\nDESCRIPTION: Example configuration for manually setting up the infraattributes processor to add infrastructure-level tags to telemetry data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/converter/README.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\ninfraattributes.yaml\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubelet Evictions in Kubernetes\nDESCRIPTION: This snippet shows Prometheus metrics for tracking the cumulative number of pod evictions performed by the kubelet in Kubernetes. It counts evictions based on different eviction signals related to memory availability.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_39\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_evictions [ALPHA] Cumulative number of pod evictions by eviction signal\n# TYPE kubelet_evictions counter\nkubelet_evictions{eviction_signal=\"allocatableMemory.available\"} 3\nkubelet_evictions{eviction_signal=\"memory.available\"} 3\n```\n\n----------------------------------------\n\nTITLE: Listing 'diagnose all' Options in Bash\nDESCRIPTION: This command displays the help menu for the 'agent diagnose all' subcommand, showing available flags and their descriptions. It provides details on how to customize the diagnosis process.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/agent/subcommands/diagnose/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nagent.exe diagnose all -h\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Agent E2E Tests with Custom Agent Version\nDESCRIPTION: Bash commands to run Datadog Agent E2E tests with a custom agent version. It specifies the image repository and tag for both the agent and cluster agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/orchestrator/README.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nimg_repo=\"registry.hub.docker.com/datadog\"\nimg_tag=\"fisher-cap-1436-explicit-type-values-py3-jmx\"\ndda inv new-e2e-tests.run \\\n  -c ddagent:fullImagePath=$img_repo/agent-dev:$img_tag \\\n  -c ddagent:clusterAgentFullImagePath=$img_repo/cluster-agent-dev:$img_tag \\\n  --targets=./tests/orchestrator\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Runtime Operations Duration Help Text in Prometheus Format\nDESCRIPTION: Help text for the kubelet_runtime_operations_duration_seconds metric, which tracks the duration of runtime operations broken down by operation type. This is an alpha-level metric that may change in future Kubernetes versions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_30\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations_duration_seconds [ALPHA] Duration in seconds of runtime operations. Broken down by operation type.\n```\n\n----------------------------------------\n\nTITLE: Copying Artifacts for Docker Image Build\nDESCRIPTION: These PowerShell commands copy the built entrypoint executable and the Agent package to the Docker build context directory for inclusion in the image.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/windows/README.md#2025-04-22_snippet_2\n\nLANGUAGE: powershell\nCODE:\n```\nCopy-Item .\\build-out\\entrypoint.exe .\\Dockerfiles\\agent\\\nCopy-Item .\\omnibus\\pkg\\datadog-agent-*-x86_64.zip -Destination .\\Dockerfiles\\agent\\datadog-agent-latest.amd64.zip\n```\n\n----------------------------------------\n\nTITLE: Building Docker Image for Datadog Agent\nDESCRIPTION: This command builds a Docker image for the Datadog Agent build environment. It uses a Dockerfile located in the deb-x64 directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_omnibus.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndocker build -t datadog-agent-buildimages:deb_x64 -f deb-x64/Dockerfile .\n```\n\n----------------------------------------\n\nTITLE: Setting Custom DD_URL in Datadog Agent Configuration for Windows\nDESCRIPTION: This configuration option allows setting a custom dd_url variable in the datadog.yaml file. It should only be used upon request from Datadog Support.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/resources/dogstatsd/msi/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n* DD_URL=\"_string_\"\n  * Sets the **dd_url** variable in datadog.yaml to _string_.\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent URLs in Windows Installation\nDESCRIPTION: This snippet outlines additional command line options for configuring various URLs used by the Datadog Agent during installation on Windows. These options should only be used upon request from Datadog Support.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/resources/agent/msi/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n* DD_URL=\"_string_\"\n  * Sets the **dd_url** variable in datadog.yaml to _string_.\n* LOGS_DD_URL=\"_string_\"\n  * Sets the **logs_dd_url** variable in the **logs_config** section in datadog.yaml to _string_ . _string_ has to be of the form `<endpoint>:<format>`, for example `agent-intake.logs.datadoghq.com:443`.\n* PROCESS_DD_URL=\"_string_\"\n  * Sets the **process_dd_url** variable in the **process_config** section in datadog.yaml to _string_. \n* TRACE_DD_URL=\"_string_\"\n  * Sets the **apm_dd_url** variable in the **apm_config** section in datadog.yaml to _string_. \n```\n\n----------------------------------------\n\nTITLE: Defining DNSQuestion JSON Schema\nDESCRIPTION: JSON schema for serializing a DNS question, including properties for the class, type, name, size, and count of the DNS query.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_25\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"class\": {\n            \"type\": \"string\",\n            \"description\": \"class is the class looked up by the DNS question\"\n        },\n        \"type\": {\n            \"type\": \"string\",\n            \"description\": \"type is a two octet code which specifies the DNS question type\"\n        },\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"name is the queried domain name\"\n        },\n        \"size\": {\n            \"type\": \"integer\",\n            \"description\": \"size is the total DNS request size in bytes\"\n        },\n        \"count\": {\n            \"type\": \"integer\",\n            \"description\": \"count is the total count of questions in the DNS request\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"class\",\n        \"type\",\n        \"name\",\n        \"size\",\n        \"count\"\n    ],\n    \"description\": \"DNSQuestionSerializer serializes a DNS question to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Datadog Agent Configuration\nDESCRIPTION: YAML configuration for pointing Datadog Agent to the fake intake server\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\n# datadog.yaml\nDD_DD_URL: \"http://localhost:80\"\n```\n\n----------------------------------------\n\nTITLE: Prometheus Container Memory Limit Metrics for Kubernetes Containers\nDESCRIPTION: Prometheus metrics showing memory limit configurations for containers in a Kubernetes cluster. Each metric includes detailed container identification information including container name, ID, image, namespace, and pod name with corresponding memory limit values in bytes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_51\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_spec_memory_limit_bytes gauge\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 5.718659072e+09\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 5.718659072e+09\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 1.7825792e+08\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 1.7825792e+08\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 5.24288e+07\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 2.68435456e+08\ncontainer_spec_memory_limit_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_limit_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 1.7825792e+08\ncontainer_spec_memory_limit_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 1.7825792e+08\ncontainer_spec_memory_limit_bytes{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 2.68435456e+08\ncontainer_spec_memory_limit_bytes{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 5.24288e+07\ncontainer_spec_memory_limit_bytes{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_limit_bytes{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_limit_bytes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\n# HELP container_spec_memory_reservation_limit_bytes Memory reservation limit for the container.\n```\n\n----------------------------------------\n\nTITLE: Docker Command for Python Zip Generation\nDESCRIPTION: PowerShell command to run the Python zip generation script in a Docker container. The command mounts the current directory, executes the script with specified Python version, and outputs the zip file to the mounted directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/winbuildscripts/Generate-Pyzip.md#2025-04-22_snippet_0\n\nLANGUAGE: powershell\nCODE:\n```\ndocker run --rm -v \"$(Get-Location):c:\\mnt\" <image> powershell -C \"c:\\mnt\\tasks\\winbuildscripts\\generate-pyzip.ps1 -Version 3.8.1 -OutDir c:\\mnt\"\n```\n\n----------------------------------------\n\nTITLE: Configuring Admission Controller Failure Policy in YAML\nDESCRIPTION: YAML configuration for setting the failure policy of the Datadog Admission Controller. Can be set to 'Ignore' or 'Fail'.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_6\n\nLANGUAGE: yaml\nCODE:\n```\nadmission_controller:\n  failure_policy: \"Ignore\"\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Memory RSS Usage in Prometheus Format\nDESCRIPTION: This is a collection of Prometheus-formatted metrics that track container memory RSS (Resident Set Size) usage across a Kubernetes cluster. Each line represents a different container or pod with memory usage measured in bytes along with container metadata like ID, image name, namespace, and pod name. The timestamp is provided in milliseconds since the epoch.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_24\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_rss gauge\ncontainer_memory_rss{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 5.6952832e+08 1572450197572\ncontainer_memory_rss{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 4.3771904e+08 1572450197668\ncontainer_memory_rss{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 5.1142656e+07 1572450196297\ncontainer_memory_rss{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 4.282368e+07 1572450199385\ncontainer_memory_rss{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 49152 1572450186377\ncontainer_memory_rss{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 8.318976e+06 1572450198309\ncontainer_memory_rss{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 45056 1572450196497\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.34512128e+08 1572450196733\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 6.94272e+06 1572450196475\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 40960 1572450195152\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2.74649088e+08 1572450186468\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 45056 1572450199201\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 6.9632e+06 1572450195355\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 45056 1572450197313\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 3.436544e+07 1572450190363\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 45056 1572450200713\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.159168e+07 1572450201420\ncontainer_memory_rss{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 45056 1572450188256\ncontainer_memory_rss{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 4.95616e+06 1572450195286\ncontainer_memory_rss{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 45056 1572450196642\ncontainer_memory_rss{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 4.6620672e+07 1572450190276\ncontainer_memory_rss{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 45056 1572450189944\ncontainer_memory_rss{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 6.90176e+06 1572450198917\ncontainer_memory_rss{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 6.918144e+06 1572450196388\ncontainer_memory_rss{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 4.706304e+07 1572450197849\ncontainer_memory_rss{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 4.2774528e+07 1572450202927\ncontainer_memory_rss{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 4.911104e+06 1572450196671\ncontainer_memory_rss{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2.74604032e+08 1572450188597\ncontainer_memory_rss{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 3.4320384e+07 1572450192433\ncontainer_memory_rss{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 8.27392e+06 1572450197292\ncontainer_memory_rss{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.1546624e+07 1572450195713\n# HELP container_memory_swap Container swap usage in bytes.\n```\n\n----------------------------------------\n\nTITLE: Stack Trace Analysis for Windows Kernel Crash\nDESCRIPTION: This code snippet shows the stack trace at the time of the kernel crash. It includes memory addresses, function calls, and arguments passed to each function in the call stack. The trace starts at the KeBugCheckEx function and goes through various system functions, eventually leading to a call in the ddapmcrash module.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/system/wincrashdetect/probe/testdata/crashsample1.txt#2025-04-22_snippet_0\n\nLANGUAGE: Assembly\nCODE:\n```\nRetAddr           : Args to Child                                                           : Call Site\nfffff800`457f4db0 : 00000000`0000007e ffffffff`c0000005 fffff806`f7e010e6 ffffb481`789326a8 : nt!KeBugCheckEx\nfffff800`457cb7bf : 00000000`00000004 00000000`00000000 00007fff`ffff0000 ffffc582`1b4e3800 : nt!memset+0x5530\nfffff800`457e602d : ffffb481`78933000 ffffb481`789318c0 00000000`00000000 00000000`00000050 : nt!_C_specific_handler+0x9f\nfffff800`457742a1 : ffffb481`78933000 00000000`00000000 ffffb481`7892d000 00000000`00000000 : nt!_chkstk+0x5d\nfffff800`457730c4 : ffffb481`789326a8 ffffb481`789323f0 ffffb481`789326a8 ffffb481`78932570 : nt!KeQuerySystemTimePrecise+0x27d1\nfffff800`457ee482 : 00003c74`00000000 fffff800`458a1d00 00000000`00000000 fffff800`45d940c4 : nt!KeQuerySystemTimePrecise+0x15f4\nfffff800`457eafc0 : 00000000`00000000 fffff800`45a97fe0 ffff8301`2c077220 ffffc582`1bb72c30 : nt!setjmpex+0x7622\nfffff806`f7e010e6 : 00000000`00000001 00000000`00000000 ffffb481`76e2e000 fffff800`456e6511 : nt!setjmpex+0x4160\nfffff806`f7e07020 : ffffc582`1bb72c30 ffffc582`19f18000 ffffc582`1bb72c30 ffff3ac8`f399d666 : ddapmcrash+0x10e6\nfffff800`45b338f7 : 00000000`00000000 00000000`00000000 ffffc582`1bb72c30 ffffffff`000001c8 : ddapmcrash+0x7020\nfffff800`45ad140e : 00000000`00000000 00000000`00000000 00000000`00000000 fffff800`45a3e2c0 : nt!FsRtlNotifyVolumeEventEx+0x243b\nfffff800`45715dc9 : fffff800`00000000 ffffffff`80000ba4 ffffc582`1b4e3800 fffff800`45a3e2c0 : nt!MmGetPhysicalMemoryRangesEx+0xb56\nfffff800`456c6f85 : ffffc582`1b4e3800 00000000`00000080 ffffc582`18a636c0 ffffc582`1b4e3800 : nt!KdPollBreakIn+0x8059\nfffff800`457e4df6 : ffffb481`76e15180 ffffc582`1b4e3800 fffff800`456c6f44 00000000`00000246 : nt!PsGetProcessSessionIdEx+0x2d5\n00000000`00000000 : ffffb481`78933000 ffffb481`7892d000 00000000`00000000 00000000`00000000 : nt!KeSynchronizeExecution+0x7756\n```\n\n----------------------------------------\n\nTITLE: Running Revive Linter for Team Issues\nDESCRIPTION: Command to show all revive linter issues for a specific team's code. This command runs linter checks across all OS and architecture combinations that are checked in CI.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/show_linters_issues/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e show-linters-issues --filter-team \"@DataDog/your-team\" --filter-linters \"revive\"\n```\n\n----------------------------------------\n\nTITLE: Running Collision Test with Go\nDESCRIPTION: Go command to run the collision test. This test checks for collisions in the context key generator using the generated unique contexts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/aggregator/ckey/tests/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ngo test ./... -run TestCollisions\n```\n\n----------------------------------------\n\nTITLE: Configuring vim-go for Goimports in Vim\nDESCRIPTION: This snippet shows how to configure vim-go to use goimports with the local package flag for the Datadog Agent project. It sets the goimports options to include the local package path.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/imports.md#2025-04-22_snippet_0\n\nLANGUAGE: vim\nCODE:\n```\nlet g:go_fmt_options = {\n\\ 'goimports': '-local github.com/DataDog/datadog-agent',\n\\ }\n```\n\n----------------------------------------\n\nTITLE: Listing Network Directions in Markdown Table\nDESCRIPTION: A markdown table listing supported network directions for the Datadog Agent. It includes direction names and their supported architectures, which are all 'all' in this case.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_10\n\nLANGUAGE: markdown\nCODE:\n```\n| Name | Architectures |\n| ---- |---------------|\n| `INGRESS` | all |\n| `EGRESS` | all |\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for MatchingSubExpr in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing a matching sub-expression in the Datadog Agent. It includes properties for offset, length, and value of the sub-expression.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_8\n\nLANGUAGE: JSON\nCODE:\n```\n\"MatchingSubExpr\": {\n    \"properties\": {\n        \"offset\": {\n            \"type\": \"integer\"\n        },\n        \"length\": {\n            \"type\": \"integer\"\n        },\n        \"value\": {\n            \"type\": \"string\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"offset\",\n        \"length\",\n        \"value\"\n    ],\n    \"description\": \"MatchingSubExpr serializes matching sub expression to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Admission Controller Injection Mode in YAML\nDESCRIPTION: YAML configuration for setting the injection mode of the Datadog Admission Controller. Supports multiple modes including 'hostip', 'service', and 'socket'.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_4\n\nLANGUAGE: yaml\nCODE:\n```\nadmission_controller:\n  inject_config:\n    mode: \"hostip\"\n```\n\n----------------------------------------\n\nTITLE: Container Threads Gauge Metrics in Prometheus Format\nDESCRIPTION: Metrics showing the current thread count for various containers in a Kubernetes cluster. Each metric includes detailed labels for container identification including container name, ID, image, namespace, and pod name. All values are 0, suggesting this may be a metric that tracks thread usage but no threads were active at collection time.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_60\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_threads gauge\ncontainer_threads{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_threads{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_threads{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_threads{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_threads{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_threads{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450198309\ncontainer_threads{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_threads{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196733\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450196475\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450186468\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450195355\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450190363\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450201420\ncontainer_threads{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_threads{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450195286\ncontainer_threads{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_threads{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450190276\ncontainer_threads{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_threads{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450198917\ncontainer_threads{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450196388\ncontainer_threads{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450197849\ncontainer_threads{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450202927\ncontainer_threads{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196671\ncontainer_threads{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450188597\ncontainer_threads{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450192433\ncontainer_threads{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450197292\ncontainer_threads{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450195713\n# HELP container_threads_max Maximum number of threads allowed inside the container, infinity if value is zero\n```\n\n----------------------------------------\n\nTITLE: Copying Protobuf File for Retry File Dump Tool (Bash)\nDESCRIPTION: This command copies the required protobuf file from the Datadog Agent package to the current directory for building the retry file dump tool.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/retry_file_dump/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncp ../../pkg/forwarder/internal/retry/HttpTransactionProto.pb.go .\n```\n\n----------------------------------------\n\nTITLE: Defining Flow Network Event Schema in JSON\nDESCRIPTION: JSON schema for serializing network flow events with L3/L4 protocol information, source/destination endpoints, and traffic statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_30\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"l3_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l3_protocol is the layer 3 protocol name\"\n        },\n        \"l4_protocol\": {\n            \"type\": \"string\",\n            \"description\": \"l4_protocol is the layer 4 protocol name\"\n        },\n        \"source\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"source is the emitter of the network event\"\n        },\n        \"destination\": {\n            \"$ref\": \"#/$defs/IPPort\",\n            \"description\": \"destination is the receiver of the network event\"\n        },\n        \"ingress\": {\n            \"$ref\": \"#/$defs/NetworkStats\",\n            \"description\": \"ingress holds the network statistics for ingress traffic\"\n        },\n        \"egress\": {\n            \"$ref\": \"#/$defs/NetworkStats\",\n            \"description\": \"egress holds the network statistics for egress traffic\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"l3_protocol\",\n        \"l4_protocol\",\n        \"source\",\n        \"destination\"\n    ],\n    \"description\": \"FlowSerializer defines a new flow serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Installing DDA Package on macOS\nDESCRIPTION: Command to install the Datadog Agent development environment package on macOS using the installer utility.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\nsudo installer -pkg ./dda-universal.pkg -target /\n```\n\n----------------------------------------\n\nTITLE: Sample Health Check JSON Response\nDESCRIPTION: Example JSON response from the health_check extension showing server status, uptime information, and availability data that would be collected in a flare.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/otelcol/ddflareextension/README.md#2025-04-22_snippet_2\n\nLANGUAGE: json\nCODE:\n```\n{\"status\":\"Server available\",\"upSince\":\"2024-08-14T14:54:00.575804+02:00\",\"uptime\":\"28.470434291s\"}\n```\n\n----------------------------------------\n\nTITLE: Setting Up Environment Variables for Datadog Installation\nDESCRIPTION: Commands to set up environment variables necessary for deploying the Datadog application through mpdev. This includes setting the registry, application name, and version tag.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/google-marketplace/README.md#2025-04-22_snippet_2\n\nLANGUAGE: shell\nCODE:\n```\nexport REGISTRY=gcr.io/$(gcloud config get-value project | tr ':' '/')\nexport APP_NAME=datadog\nexport TAG=1.3.0 # Datadog Operator version that will be installed\n```\n\n----------------------------------------\n\nTITLE: Storage Operation Duration Histogram Metrics for Kubernetes Volume Plugins\nDESCRIPTION: Prometheus histogram metrics measuring the duration of storage operations in Kubernetes. Tracks verify_controller_attached_volume operations across different volume plugins (configmap, empty-dir, host-path, projected) with success status and non-migrated state. Includes bucket distributions from 0.1 to 600 seconds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_50\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE storage_operation_duration_seconds histogram\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.1\"} 9\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.25\"} 9\n...\n```\n\n----------------------------------------\n\nTITLE: Configuring Hostname Force Option in YAML for Datadog Agent\nDESCRIPTION: This YAML configuration enables the 'hostname_force_config_as_canonical' option in the Datadog agent config. When set to true, it allows hostnames starting with 'ip-' or 'domu' to be accepted as the canonical hostname in-app.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/hostname/hostname_force_config_as_canonical.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nhostname_force_config_as_canonical: true\n```\n\n----------------------------------------\n\nTITLE: Configuring JMX Test Server Check in YAML\nDESCRIPTION: Example configuration file for setting up a JMX test server check in the Datadog Agent. This configuration should be placed in the dev/dist/conf.d/jmx-test-server.d/conf.yaml directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/jmxfetch.md#2025-04-22_snippet_0\n\nLANGUAGE: path\nCODE:\n```\ndev/dist/conf.d/jmx-test-server.d/conf.yaml\n```\n\n----------------------------------------\n\nTITLE: Docker Command Structure Explanation\nDESCRIPTION: Detailed breakdown of each component in the Docker command used for generating Python zip files, including volume mounting and script parameter specifications.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/winbuildscripts/Generate-Pyzip.md#2025-04-22_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\n  * docker                          (run docker)\n  * run                             (run the container)\n  * --rm                            (remove the container when done)\n  * -v                              (mount a volume in the container)\n  * \"$(Get-Location):c:\\mnt\"        (mount the current working directory to c:\\mnt in the container)\n  * <image>                         (fully qualified image name)\n  * powershell                      (execute powershell in the container)\n  * -C                              (indicates command to run in the container)\n  * c:\\mnt\\generate-pyzip.ps1       (the path to the script to run.  Note this is the directory that was mounted earlier)\n  * -Version 3.8.1                  (create a zip for python 3.8.1)\n  * -OutDir c:\\mnt                  (copy to c:\\mnt.  This also must be the path mounted earlier)\n```\n\n----------------------------------------\n\nTITLE: Removing Duplicate Contexts Using Bash Commands\nDESCRIPTION: Bash command to sort and remove duplicate entries from the generated random contexts file, creating a new file with unique entries.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/aggregator/ckey/tests/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncat random_contexts.csv|sort|uniq > random_sorted_uniq_contexts.csv\n```\n\n----------------------------------------\n\nTITLE: Displaying JSON Schema for Specific Definition\nDESCRIPTION: This code block shows the JSON schema for a specific definition within the Workload Protection Windows events structure. It provides detailed information about the fields and their types for a particular component of the event data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/backend_windows.md#2025-04-22_snippet_1\n\nLANGUAGE: json\nCODE:\n```\n{{ def.schema }}\n```\n\n----------------------------------------\n\nTITLE: Defining DDContext JSON Schema\nDESCRIPTION: JSON schema for serializing a span context, including properties for the span ID and trace ID used for APM correlation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_23\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"span_id\": {\n            \"type\": \"string\",\n            \"description\": \"Span ID used for APM correlation\"\n        },\n        \"trace_id\": {\n            \"type\": \"string\",\n            \"description\": \"Trace ID used for APM correlation\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"DDContextSerializer serializes a span context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring RTLoader Demo Build in CMake\nDESCRIPTION: Defines the CMake build configuration for the RTLoader demo application. Sets up the project with appropriate compiler flags, includes necessary headers, and configures platform-specific library linking for Windows, macOS and Linux environments.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/demo/CMakeLists.txt#2025-04-22_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\ncmake_minimum_required(VERSION 3.19)\n\nproject(\"RTLoader Demo\")\n\noption(USE_AGENT_RTLOADER_LIB \"Use RTLoader implementation from the agent build\" OFF)\n\n## Use compiler debugging flags per default\nset(CMAKE_C_FLAGS \"${CMAKE_C_FLAGS} ${CMAKE_C_FLAGS_DEBUG}\")\n\nadd_executable(demo main.c)\n\n## Add our paths for includes. Note that these may be different depending on\n## where you have rtloader built and/or checked out\ninclude_directories(\"${CMAKE_SOURCE_DIR}/../include\" \"${CMAKE_SOURCE_DIR}/../common\")\n\n\nif(WIN32)\n  set_target_properties(demo PROPERTIES LINK_FLAGS -static)\n  target_link_libraries(demo PUBLIC datadog-agent-rtloader)\nelse()\n  if (APPLE)\n    set(LIB_SUFFIX \"dylib\")\n  else()\n    set(LIB_SUFFIX \"so\")\n  endif()\n\n\n  if (USE_AGENT_RTLOADER_LIB)\n    set(RTLOADER_LIB_PREFIX \"${CMAKE_SOURCE_DIR}/../build/rtloader/\")\n  else()\n    set(RTLOADER_LIB_PREFIX \"\")\n  endif()\n\n  set(RTLOADER_LIB \"${RTLOADER_LIB_PREFIX}libdatadog-agent-rtloader.${LIB_SUFFIX}\")\n  target_link_libraries(demo PUBLIC \"${RTLOADER_LIB}\" dl)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Configuring Secret Backend Skip Checks in YAML\nDESCRIPTION: YAML configuration to instruct the Cluster Agent to dispatch cluster checks without decrypting secrets. Node Agents or cluster check runners will fetch secrets after receiving configurations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_12\n\nLANGUAGE: yaml\nCODE:\n```\nDD_SECRET_BACKEND_SKIP_CHECKS: \"true\"\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet PLEG Relist Interval Metrics in Prometheus\nDESCRIPTION: This snippet defines metrics for the interval between relisting in PLEG (Pod Lifecycle Event Generator). It includes summary statistics for different quantiles, sum, and count.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_11\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pleg_relist_interval_microseconds Interval in microseconds between relisting in PLEG.\n# TYPE kubelet_pleg_relist_interval_microseconds summary\nkubelet_pleg_relist_interval_microseconds{quantile=\"0.5\"} 1.013865e+06\nkubelet_pleg_relist_interval_microseconds{quantile=\"0.9\"} 1.020161e+06\nkubelet_pleg_relist_interval_microseconds{quantile=\"0.99\"} 1.384645e+06\nkubelet_pleg_relist_interval_microseconds_sum 2.92731959e+08\nkubelet_pleg_relist_interval_microseconds_count 285\n```\n\n----------------------------------------\n\nTITLE: Creating Dummy Root Package File\nDESCRIPTION: This bash script creates a doc.go file with license information and package declaration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/how-to/go/add-module.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ncat >doc.go <<EOL\n// Unless explicitly stated otherwise all files in this repository are licensed\n// under the Apache License Version 2.0.\n// This product includes software developed at Datadog (https://www.datadoghq.com/).\n// Copyright 2016-present Datadog, Inc.\npackage mymodule\nEOL\n```\n\n----------------------------------------\n\nTITLE: Running QA Installer Test Suite in PowerShell\nDESCRIPTION: This PowerShell command demonstrates how to run the QA installer test suite. It specifies VM details, snapshot information, QA session name, and artifacts path.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/windows/DatadogAgentInstaller/QA/README.md#2025-04-22_snippet_0\n\nLANGUAGE: powershell\nCODE:\n```\n& .\\tools\\windows\\DatadogAgentInstaller\\QA\\qa_installer.ps1 -vmName \"Windows Server 2022 FR\" -vmUserName \"win-3f423u4i7ug\\administrateur\" -vmUserPassword \"********\" -vmInitialSnapshotName \"Windows Server 2022 FR - (27/07/2023 - 12:06:27)\" -qaSessionname \"Non-canonical permission issue QA\" -qaArtifactsPath \"C:\\dev\\QA\\artifacts\"\n```\n\n----------------------------------------\n\nTITLE: Updating CPU Information for ARM Processors using Python\nDESCRIPTION: This command generates Go code for ARM processor information by parsing the lscpu-arm.c source file from util-linux. The script converts C-based CPU definitions into Go code for the Gohai tool.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/gohai/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npython cpu/from-lscpu-arm.py /path/to/lscpu-arm.c > cpu/lscpu_linux_arm64.go\n```\n\n----------------------------------------\n\nTITLE: Monitoring Storage Operation Status Counts in Prometheus\nDESCRIPTION: This snippet defines a counter metric for tracking storage operation status counts across different volume plugins and operations in Kubernetes. It includes metrics for operations like volume attachment verification, mount/unmount, and fsgroup recursive apply.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_55\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE storage_operation_status_count counter\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 9\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 9\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 62\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/projected\"} 31\nstorage_operation_status_count{operation_name=\"volume_fsgroup_recursive_apply\",status=\"fail-unknown\",volume_plugin=\"kubernetes.io/empty-dir\"} 1\nstorage_operation_status_count{operation_name=\"volume_fsgroup_recursive_apply\",status=\"success\",volume_plugin=\"kubernetes.io/projected\"} 21470\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 130856\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 9\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 62\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\"} 639289\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 3\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 4\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 26\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\"} 1\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for IP and Port Serialization\nDESCRIPTION: This snippet defines schemas for serializing IP and port combinations, with and without address family information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_5\n\nLANGUAGE: JSON\nCODE:\n```\n\"IPPort\": {\n    \"properties\": {\n        \"ip\": {\n            \"type\": \"string\",\n            \"description\": \"IP address\"\n        },\n        \"port\": {\n            \"type\": \"integer\",\n            \"description\": \"Port number\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"ip\",\n        \"port\"\n    ],\n    \"description\": \"IPPortSerializer is used to serialize an IP and Port context to JSON\"\n},\n\"IPPortFamily\": {\n    \"properties\": {\n        \"family\": {\n            \"type\": \"string\",\n            \"description\": \"Address family\"\n        },\n        \"ip\": {\n            \"type\": \"string\",\n            \"description\": \"IP address\"\n        },\n        \"port\": {\n            \"type\": \"integer\",\n            \"description\": \"Port number\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"family\",\n        \"ip\",\n        \"port\"\n    ],\n    \"description\": \"IPPortFamilySerializer is used to serialize an IP, port, and address family context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Listing Layer 3 Protocols in Markdown Table\nDESCRIPTION: A markdown table listing supported Layer 3 protocols for the Datadog Agent. It includes protocol names and their supported architectures, which are all 'all' in this case.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_8\n\nLANGUAGE: markdown\nCODE:\n```\n| Name | Architectures |\n| ---- |---------------|\n| `ETH_P_LOOP` | all |\n| `ETH_P_PUP` | all |\n| `ETH_P_PUPAT` | all |\n| `ETH_P_TSN` | all |\n| `ETH_P_IP` | all |\n| `ETH_P_X25` | all |\n| `ETH_P_ARP` | all |\n| `ETH_P_BPQ` | all |\n| `ETH_P_IEEEPUP` | all |\n| `ETH_P_IEEEPUPAT` | all |\n| `ETH_P_BATMAN` | all |\n| `ETH_P_DEC` | all |\n| `ETH_P_DNADL` | all |\n| `ETH_P_DNARC` | all |\n| `ETH_P_DNART` | all |\n| `ETH_P_LAT` | all |\n| `ETH_P_DIAG` | all |\n| `ETH_P_CUST` | all |\n| `ETH_P_SCA` | all |\n| `ETH_P_TEB` | all |\n| `ETH_P_RARP` | all |\n| `ETH_P_ATALK` | all |\n| `ETH_P_AARP` | all |\n| `ETH_P_8021_Q` | all |\n| `ETH_P_ERSPAN` | all |\n| `ETH_P_IPX` | all |\n| `ETH_P_IPV6` | all |\n| `ETH_P_PAUSE` | all |\n| `ETH_P_SLOW` | all |\n| `ETH_P_WCCP` | all |\n| `ETH_P_MPLSUC` | all |\n| `ETH_P_MPLSMC` | all |\n| `ETH_P_ATMMPOA` | all |\n| `ETH_P_PPPDISC` | all |\n| `ETH_P_PPPSES` | all |\n| `ETH_P__LINK_CTL` | all |\n| `ETH_P_ATMFATE` | all |\n| `ETH_P_PAE` | all |\n| `ETH_P_AOE` | all |\n| `ETH_P_8021_AD` | all |\n| `ETH_P_802_EX1` | all |\n| `ETH_P_TIPC` | all |\n| `ETH_P_MACSEC` | all |\n| `ETH_P_8021_AH` | all |\n| `ETH_P_MVRP` | all |\n| `ETH_P_1588` | all |\n| `ETH_P_NCSI` | all |\n| `ETH_P_PRP` | all |\n| `ETH_P_FCOE` | all |\n| `ETH_P_IBOE` | all |\n| `ETH_P_TDLS` | all |\n| `ETH_P_FIP` | all |\n| `ETH_P_80221` | all |\n| `ETH_P_HSR` | all |\n| `ETH_P_NSH` | all |\n| `ETH_P_LOOPBACK` | all |\n| `ETH_P_QINQ1` | all |\n| `ETH_P_QINQ2` | all |\n| `ETH_P_QINQ3` | all |\n| `ETH_P_EDSA` | all |\n| `ETH_P_IFE` | all |\n| `ETH_P_AFIUCV` | all |\n| `ETH_P_8023_MIN` | all |\n| `ETH_P_IPV6_HOP_BY_HOP` | all |\n| `ETH_P_8023` | all |\n| `ETH_P_AX25` | all |\n| `ETH_P_ALL` | all |\n| `ETH_P_8022` | all |\n| `ETH_P_SNAP` | all |\n| `ETH_P_DDCMP` | all |\n| `ETH_P_WANPPP` | all |\n| `ETH_P_PPPMP` | all |\n| `ETH_P_LOCALTALK` | all |\n| `ETH_P_CAN` | all |\n| `ETH_P_CANFD` | all |\n| `ETH_P_PPPTALK` | all |\n| `ETH_P_TR8022` | all |\n| `ETH_P_MOBITEX` | all |\n| `ETH_P_CONTROL` | all |\n| `ETH_P_IRDA` | all |\n| `ETH_P_ECONET` | all |\n| `ETH_P_HDLC` | all |\n| `ETH_P_ARCNET` | all |\n| `ETH_P_DSA` | all |\n| `ETH_P_TRAILER` | all |\n| `ETH_P_PHONET` | all |\n| `ETH_P_IEEE802154` | all |\n| `ETH_P_CAIF` | all |\n| `ETH_P_XDSA` | all |\n| `ETH_P_MAP` | all |\n```\n\n----------------------------------------\n\nTITLE: Configuring Systemd Service Unit for Datadog Agent\nDESCRIPTION: This systemd service unit configuration defines how the Datadog Agent should be managed by systemd. It specifies the command to start the agent, its dependencies, restart behavior, and other service-related settings.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/required_files/iot-agent-rpm.txt#2025-04-22_snippet_0\n\nLANGUAGE: systemd\nCODE:\n```\n[Unit]\nDescription=Datadog Agent\nAfter=network.target\nWants=datadog-agent-process.service datadog-agent-trace.service datadog-agent-security.service\n\n[Service]\nType=simple\nPIDFile=/var/run/datadog/agent.pid\nUser=dd-agent\nPermissionsStartOnly=true\nExecStartPre=/opt/datadog-agent/bin/agent/agent import /etc/datadog-agent/datadog.yaml\nExecStart=/opt/datadog-agent/bin/agent/agent run -p /var/run/datadog/agent.pid\nExecStop=/opt/datadog-agent/bin/agent/agent stop\nExecReload=/opt/datadog-agent/bin/agent/agent reload\nRestart=on-failure\nRestartSec=5s\n\n[Install]\nWantedBy=multi-user.target\n```\n\n----------------------------------------\n\nTITLE: Defining OS Filter for Windows Rules in YAML\nDESCRIPTION: This snippet shows how to include an OS rule filter field for Windows-specific rules in YAML format. It specifies that the rule should only apply to Windows operating systems.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\nid: [...]\nexpression: [...]\nfilters:\n  - os == \"windows\"\n\n```\n\n----------------------------------------\n\nTITLE: Variables Schema Definition\nDESCRIPTION: Simple definition for the Variables schema used to store variable values across different contexts. This is a generic object type that can contain various variable values used throughout the event processing system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_10\n\nLANGUAGE: json\nCODE:\n```\n{\n            \"type\": \"object\",\n            \"description\": \"Variables serializes the variable values\"\n        }\n```\n\n----------------------------------------\n\nTITLE: Defining UserSessionContext JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing user session context, particularly for Kubernetes sessions. It captures session identifiers and Kubernetes-specific attributes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_58\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"string\",\n            \"description\": \"Unique identifier of the user session on the host\"\n        },\n        \"session_type\": {\n            \"type\": \"string\",\n            \"description\": \"Type of the user session\"\n        },\n        \"k8s_username\": {\n            \"type\": \"string\",\n            \"description\": \"Username of the Kubernetes \\\"kubectl exec\\\" session\"\n        },\n        \"k8s_uid\": {\n            \"type\": \"string\",\n            \"description\": \"UID of the Kubernetes \\\"kubectl exec\\\" session\"\n        },\n        \"k8s_groups\": {\n            \"items\": {\n                \"type\": \"string\"\n            },\n            \"type\": \"array\",\n            \"description\": \"Groups of the Kubernetes \\\"kubectl exec\\\" session\"\n        },\n        \"k8s_extra\": {\n            \"additionalProperties\": {\n                \"items\": {\n                    \"type\": \"string\"\n                },\n                \"type\": \"array\"\n            },\n            \"type\": \"object\",\n            \"description\": \"Extra of the Kubernetes \\\"kubectl exec\\\" session\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"UserSessionContextSerializer serializes the user session context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Using readsecret.sh Alternative for Kubernetes\nDESCRIPTION: Alternative environment variables configuration using the Go-based readsecret.sh script for Kubernetes secrets integration, which is faster and recommended for Agent version 7.30.0+.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/secrets-helper/README.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nDD_SECRET_BACKEND_COMMAND=/readsecret.sh\nDD_SECRET_BACKEND_ARGUMENTS=/etc/secret-volume\n```\n\n----------------------------------------\n\nTITLE: Exporting Kubelet Metrics in Prometheus Format\nDESCRIPTION: This snippet exports various kubelet metrics including certificate expiration, cgroup manager operations, and container log usage. It uses gauge and histogram metric types to provide detailed statistics on kubelet operations and resource usage.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_3\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_certificate_manager_client_expiration_seconds Gauge of the lifetime of a certificate. The value is the date the certificate will expire in seconds since January 1, 1970 UTC.\n# TYPE kubelet_certificate_manager_client_expiration_seconds gauge\nkubelet_certificate_manager_client_expiration_seconds 1.60876398e+09\n# HELP kubelet_cgroup_manager_duration_seconds Duration in seconds for cgroup manager operations. Broken down by method.\n# TYPE kubelet_cgroup_manager_duration_seconds histogram\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.005\"} 10\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.01\"} 14\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.025\"} 16\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.05\"} 17\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.1\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.25\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.5\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"1\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"2.5\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"5\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"10\"} 18\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"+Inf\"} 18\nkubelet_cgroup_manager_duration_seconds_sum{operation_type=\"create\"} 0.22226386899999995\nkubelet_cgroup_manager_duration_seconds_count{operation_type=\"create\"} 18\n# HELP kubelet_container_log_filesystem_used_bytes Bytes used by the container's logs on the filesystem.\n# TYPE kubelet_container_log_filesystem_used_bytes gauge\nkubelet_container_log_filesystem_used_bytes{container=\"cluster-agent\",namespace=\"default\",pod=\"datadog-monitoring-cluster-agent-c4fc98b6f-5xcxk\"} 40960\nkubelet_container_log_filesystem_used_bytes{container=\"coredns\",namespace=\"kube-system\",pod=\"coredns-6dcc67dcbc-k74pm\"} 28672\nkubelet_container_log_filesystem_used_bytes{container=\"coredns\",namespace=\"kube-system\",pod=\"coredns-6dcc67dcbc-xg7f9\"} 28672\nkubelet_container_log_filesystem_used_bytes{container=\"datadog\",namespace=\"default\",pod=\"datadog-monitoring-kp46r\"} 1.040384e+06\nkubelet_container_log_filesystem_used_bytes{container=\"etcd\",namespace=\"kube-system\",pod=\"etcd-minikube\"} 712704\nkubelet_container_log_filesystem_used_bytes{container=\"kube-addon-manager\",namespace=\"kube-system\",pod=\"kube-addon-manager-minikube\"} 7.3728e+06\nkubelet_container_log_filesystem_used_bytes{container=\"kube-apiserver\",namespace=\"kube-system\",pod=\"kube-apiserver-minikube\"} 905216\nkubelet_container_log_filesystem_used_bytes{container=\"kube-controller-manager\",namespace=\"kube-system\",pod=\"kube-controller-manager-minikube\"} 61440\nkubelet_container_log_filesystem_used_bytes{container=\"kube-proxy\",namespace=\"kube-system\",pod=\"kube-proxy-tfn5n\"} 28672\nkubelet_container_log_filesystem_used_bytes{container=\"kube-scheduler\",namespace=\"kube-system\",pod=\"kube-scheduler-minikube\"} 28672\nkubelet_container_log_filesystem_used_bytes{container=\"kube-state-metrics\",namespace=\"default\",pod=\"datadog-monitoring-kube-state-metrics-c99f4db8d-dn2x4\"} 32768\nkubelet_container_log_filesystem_used_bytes{container=\"storage-provisioner\",namespace=\"kube-system\",pod=\"storage-provisioner\"} 24576\n```\n\n----------------------------------------\n\nTITLE: Extracting VMWare Box Files\nDESCRIPTION: Commands to extract VMWare box files as an alternative to using Vagrant.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\nmkdir vm\ncd vm\ntar zxvf ../windows_10_ent_vmware.box\n```\n\n----------------------------------------\n\nTITLE: File Open Flags Constants\nDESCRIPTION: List of flags used with the open syscall to specify file opening modes and behaviors. Includes read/write modes, creation flags, and special handling options.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_15\n\nLANGUAGE: markdown\nCODE:\n```\nO_RDONLY\nO_WRONLY\nO_RDWR\nO_APPEND\nO_CREAT\nO_EXCL\nO_SYNC\nO_TRUNC\n...\n```\n\n----------------------------------------\n\nTITLE: Running the RtLoader Demo on OSX with Python 2\nDESCRIPTION: Command to run the RtLoader demo application on OSX with Python 2, setting the dynamic library path to include both Python 2 and 3 libraries.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/README.md#2025-04-22_snippet_1\n\nLANGUAGE: sh\nCODE:\n```\nDYLD_LIBRARY_PATH=./three:./two ./demo/demo 2 $VIRTUAL_ENV\n```\n\n----------------------------------------\n\nTITLE: UserContext Schema Definition\nDESCRIPTION: JSON schema for user context information including username and SID.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_17\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"sid\": {\n            \"type\": \"string\",\n            \"description\": \"Owner Sid\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"UserContextSerializer serializes a user context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Updating Local Kubeconfig with yq in Bash\nDESCRIPTION: Bash command using yq to update the local kubeconfig file with new cluster details. It modifies the server address and user authentication data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/orchestrator/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ncat ~/.kube/config \\\n  | yq '( .clusters[] | select(.name == \"kind-kind\") ).cluster.server |= \"https://10.1.58.202:8443\"' \\\n  | yq '( .users[] | select(.name == \"kind-kind\") ).user |= {\"client-certificate-data\": \"<base64>\", \"client-key-data\": \"<base64>\"}' \\\n  > ~/.kube/config_updated && mv ~/.kube/config_updated ~/.kube/config\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet PLEG Relist Interval Metrics in Prometheus Format\nDESCRIPTION: Metrics showing the interval between PLEG relisting operations. This histogram tracks how frequently the kubelet performs Pod Lifecycle Event Generator relisting, with an alpha-level indicator warning that this metric may change in the future.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_24\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pleg_relist_interval_seconds [ALPHA] Interval in seconds between relisting in PLEG.\n# TYPE kubelet_pleg_relist_interval_seconds histogram\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.005\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.01\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.025\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.05\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.1\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.25\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.5\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"1\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"2.5\"} 1.671947e+06\nkubelet_pleg_relist_interval_seconds_bucket{le=\"5\"} 1.671948e+06\nkubelet_pleg_relist_interval_seconds_bucket{le=\"10\"} 1.671948e+06\nkubelet_pleg_relist_interval_seconds_bucket{le=\"+Inf\"} 1.671949e+06\nkubelet_pleg_relist_interval_seconds_sum 1.7086866835435373e+06\nkubelet_pleg_relist_interval_seconds_count 1.671949e+06\n```\n\n----------------------------------------\n\nTITLE: Monitoring Network Transmission Packets in Kubernetes Containers with Prometheus\nDESCRIPTION: Prometheus metrics showing the total number of transmitted packets for network interfaces in Kubernetes containers. The metrics include container details like ID, image, interface, namespace, and pod name with corresponding timestamp values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_44\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_transmit_packets_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_transmit_packets_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n```\n\n----------------------------------------\n\nTITLE: Defining IP Port Schema in JSON\nDESCRIPTION: JSON schema for serializing IP address and port number combinations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_32\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"ip\": {\n            \"type\": \"string\",\n            \"description\": \"IP address\"\n        },\n        \"port\": {\n            \"type\": \"integer\",\n            \"description\": \"Port number\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"ip\",\n        \"port\"\n    ],\n    \"description\": \"IPPortSerializer is used to serialize an IP and Port context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Listing Layer 4 Protocols in Markdown Table\nDESCRIPTION: A markdown table listing supported Layer 4 protocols for the Datadog Agent. It includes protocol names and their supported architectures, which are all 'all' in this case.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_9\n\nLANGUAGE: markdown\nCODE:\n```\n| Name | Architectures |\n| ---- |---------------|\n| `IP_PROTO_IP` | all |\n| `IP_PROTO_ICMP` | all |\n| `IP_PROTO_IGMP` | all |\n| `IP_PROTO_IPIP` | all |\n| `IP_PROTO_TCP` | all |\n| `IP_PROTO_EGP` | all |\n| `IP_PROTO_IGP` | all |\n| `IP_PROTO_PUP` | all |\n| `IP_PROTO_UDP` | all |\n| `IP_PROTO_IDP` | all |\n| `IP_PROTO_TP` | all |\n| `IP_PROTO_DCCP` | all |\n| `IP_PROTO_IPV6` | all |\n| `IP_PROTO_RSVP` | all |\n| `IP_PROTO_GRE` | all |\n| `IP_PROTO_ESP` | all |\n| `IP_PROTO_AH` | all |\n| `IP_PROTO_ICMPV6` | all |\n| `IP_PROTO_MTP` | all |\n| `IP_PROTO_BEETPH` | all |\n| `IP_PROTO_ENCAP` | all |\n| `IP_PROTO_PIM` | all |\n| `IP_PROTO_COMP` | all |\n| `IP_PROTO_SCTP` | all |\n| `IP_PROTO_UDPLITE` | all |\n| `IP_PROTO_MPLS` | all |\n| `IP_PROTO_RAW` | all |\n```\n\n----------------------------------------\n\nTITLE: Documenting APT Update Script Execution Order in Markdown\nDESCRIPTION: This snippet details the order of script execution for APT package updates. It includes the sequence of prerm, preinst, file unpacking, postrm, dpkg actions, and postinst scripts, along with their respective arguments.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/package-scripts/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# APT\n## source https://debian-handbook.info/browse/stable/sect.package-meta-information.html\n\n * `prerm` script of the old package (with arguments: `upgrade <new-version>`)\n * `preinst` script of the new package (with arguments: `upgrade <old-version>`)\n * New files get unpacked based on the file list embedded in the `.deb` package\n * `postrm` script from the old package (with arguments `upgrade <new-version>`)\n * `dpkg` updates the files list, removes the files that don't exist anymore, etc.\n * `postinst` of the new script is run (with arguments `configure <lst-configured-version>`\n```\n\n----------------------------------------\n\nTITLE: Matching File Execution in JavaScript\nDESCRIPTION: This snippet demonstrates how to match the execution of a specific file using the 'exec.file.path' attribute in a JavaScript-like syntax.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_8\n\nLANGUAGE: javascript\nCODE:\n```\nexec.file.path == \"/usr/bin/apt\"\n```\n\n----------------------------------------\n\nTITLE: Defining Tagger Cardinality Constants in Python\nDESCRIPTION: Defines constants for different cardinality levels used in the tagger module. These constants are likely used to specify the level of detail for tag retrieval.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/tagger.md#2025-04-22_snippet_0\n\nLANGUAGE: python\nCODE:\n```\nLOW          = DATADOG_AGENT_RTLOADER_TAGGER_LOW\nORCHESTRATOR = DATADOG_AGENT_RTLOADER_TAGGER_ORCHESTRATOR\nHIGH         = DATADOG_AGENT_RTLOADER_TAGGER_HIGH\n```\n\n----------------------------------------\n\nTITLE: Setting up VSCode Development Environment\nDESCRIPTION: Command to configure VSCode with required extensions and settings for the project.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_7\n\nLANGUAGE: bash\nCODE:\n```\ndda inv vscode.setup\n```\n\n----------------------------------------\n\nTITLE: Kubelet PLEG (Pod Lifecycle Event Generator) Metrics in Prometheus Format\nDESCRIPTION: Metrics tracking Pod Lifecycle Event Generator (PLEG) performance, including relist duration, intervals between relists, and latency. Contains both current and deprecated metrics in histogram and summary formats.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_15\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pleg_relist_duration_seconds Duration in seconds for relisting pods in PLEG.\n# TYPE kubelet_pleg_relist_duration_seconds histogram\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.005\"} 3106\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.01\"} 35089\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.025\"} 42228\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.05\"} 42583\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.1\"} 42669\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.25\"} 42712\nkubelet_pleg_relist_duration_seconds_bucket{le=\"0.5\"} 42727\nkubelet_pleg_relist_duration_seconds_bucket{le=\"1\"} 42735\nkubelet_pleg_relist_duration_seconds_bucket{le=\"2.5\"} 42749\nkubelet_pleg_relist_duration_seconds_bucket{le=\"5\"} 42793\nkubelet_pleg_relist_duration_seconds_bucket{le=\"10\"} 42847\nkubelet_pleg_relist_duration_seconds_bucket{le=\"+Inf\"} 42893\nkubelet_pleg_relist_duration_seconds_sum 1629.920016523\nkubelet_pleg_relist_duration_seconds_count 42893\n# HELP kubelet_pleg_relist_interval_microseconds (Deprecated) Interval in microseconds between relisting in PLEG.\n# TYPE kubelet_pleg_relist_interval_microseconds summary\nkubelet_pleg_relist_interval_microseconds{quantile=\"0.5\"} 1.00921e+06\nkubelet_pleg_relist_interval_microseconds{quantile=\"0.9\"} 1.013194e+06\nkubelet_pleg_relist_interval_microseconds{quantile=\"0.99\"} 1.029029e+06\nkubelet_pleg_relist_interval_microseconds_sum 4.6247131304e+10\nkubelet_pleg_relist_interval_microseconds_count 42892\n# HELP kubelet_pleg_relist_interval_seconds Interval in seconds between relisting in PLEG.\n# TYPE kubelet_pleg_relist_interval_seconds histogram\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.005\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.01\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.025\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.05\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.1\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.25\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"0.5\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"1\"} 0\nkubelet_pleg_relist_interval_seconds_bucket{le=\"2.5\"} 42731\nkubelet_pleg_relist_interval_seconds_bucket{le=\"5\"} 42769\nkubelet_pleg_relist_interval_seconds_bucket{le=\"10\"} 42835\nkubelet_pleg_relist_interval_seconds_bucket{le=\"+Inf\"} 42892\nkubelet_pleg_relist_interval_seconds_sum 46245.977438063026\nkubelet_pleg_relist_interval_seconds_count 42892\n# HELP kubelet_pleg_relist_latency_microseconds (Deprecated) Latency in microseconds for relisting pods in PLEG.\n# TYPE kubelet_pleg_relist_latency_microseconds summary\nkubelet_pleg_relist_latency_microseconds{quantile=\"0.5\"} 8313\nkubelet_pleg_relist_latency_microseconds{quantile=\"0.9\"} 12285\nkubelet_pleg_relist_latency_microseconds{quantile=\"0.99\"} 28543\nkubelet_pleg_relist_latency_microseconds_sum 1.631155039e+09\nkubelet_pleg_relist_latency_microseconds_count 42893\n# HELP kubelet_pod_start_duration_seconds Duration in seconds for a single pod to go from pending to running.\n```\n\n----------------------------------------\n\nTITLE: Compiling CUDA Sample with Make\nDESCRIPTION: Command to compile the sample.cu file using the make utility.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/gpu/cuda/testutil/testdata/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Shell\nCODE:\n```\nmake\n```\n\n----------------------------------------\n\nTITLE: Creating Platform-Specific Datadog Package Archive\nDESCRIPTION: Command to create a platform-specific Datadog Package archive for testing purposes. This generates a tar archive at 'pkg/fleet/installer/fixtures/oci-layout-simple-v1-linux2-amd128.tar' with OS 'linux2' and architecture 'amd128'.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/fleet/installer/fixtures/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ndatadog-package create --archive --version \"v1\" --os \"linux2\" --arch \"amd128\" --archive-path \"pkg/fleet/installer/fixtures/oci-layout-simple-v1-linux2-amd128.tar\" --package \"simple\" pkg/fleet/installer/fixtures/simple-v1\n```\n\n----------------------------------------\n\nTITLE: Running a Single Security Agent Test in Bash\nDESCRIPTION: Command to run a specific test (TestConnect) for the security agent component. Uses the dda invoke command with the security-agent.functional-tests task, targeting only the specified test.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/security/tests/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e security-agent.functional-tests --verbose --skip-linters --testflags \"-test.run 'TestConnect'\"\n```\n\n----------------------------------------\n\nTITLE: Measuring Lease Operation Durations\nDESCRIPTION: Prometheus metrics tracking request durations for lease operations in the coordination API, including both GET and PUT operations with detailed timing buckets and counts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_45\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/coordination.k8s.io/v1/namespaces/%7Bnamespace%7D/leases/%7Bname%7D?timeout=10s\",verb=\"PUT\",le=\"0.016\"} 154334\n```\n\n----------------------------------------\n\nTITLE: Updating modules.yml Configuration\nDESCRIPTION: This YAML snippet shows how to update the modules.yml file to include the new module, specifying its properties and test targets.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/how-to/go/add-module.md#2025-04-22_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\npath/to/mymodule:\n    independent: true\n    should_tag: false\n    test_targets:\n    - .\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for NetworkDevice in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing network device information in the Datadog Agent. It includes properties for network namespace, interface index, and interface name.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_12\n\nLANGUAGE: JSON\nCODE:\n```\n\"NetworkDevice\": {\n    \"properties\": {\n        \"netns\": {\n            \"type\": \"integer\",\n            \"description\": \"netns is the interface ifindex\"\n        },\n        \"ifindex\": {\n            \"type\": \"integer\",\n            \"description\": \"ifindex is the network interface ifindex\"\n        },\n        \"ifname\": {\n            \"type\": \"string\",\n            \"description\": \"ifname is the network interface name\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"netns\",\n        \"ifindex\",\n        \"ifname\"\n    ],\n    \"description\": \"NetworkDeviceSerializer serializes the network device context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Exporting Machine CPU Cores Metric in Prometheus Format\nDESCRIPTION: This snippet exports the number of CPU cores on the machine as a Prometheus gauge metric.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_62\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP machine_cpu_cores Number of CPU cores on the machine.\n# TYPE machine_cpu_cores gauge\nmachine_cpu_cores 2\n```\n\n----------------------------------------\n\nTITLE: Reporting Installation Failure in PowerShell\nDESCRIPTION: PowerShell error output indicating a failed installation of the Datadog Agent. The error includes details about the unexpected failure and the error code 1603.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/windows/DatadogAgentInstaller/QA/README.md#2025-04-22_snippet_5\n\nLANGUAGE: PowerShell\nCODE:\n```\n[09/28/23 13:52:21] ❌ Expected installation to succeed, but it failed with code 1603\n    + CategoryInfo          : NotSpecified: (:) [Write-Error], WriteErrorException\n    + FullyQualifiedErrorId : Microsoft.PowerShell.Commands.WriteErrorException,report_err\n    + PSComputerName        : Windows Server 2022 FR\n```\n\n----------------------------------------\n\nTITLE: Setting Up Protocol Event Flushing with Kernel Probes in C\nDESCRIPTION: Demonstrates how to set up kernel probes to flush protocol events at network packet reception time. Uses both kprobe (for kernel 4.14) and tracepoint (for kernels 4.15+) approaches to handle different kernel versions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/protocols/events/README.md#2025-04-22_snippet_1\n\nLANGUAGE: c\nCODE:\n```\nSEC(\"kprobe/__netif_receive_skb_core\")\nint netif_receive_skb_core_<protocol>_4_14(void *ctx) {\n    <protocol>_batch_flush_with_telemetry(ctx);\n    return 0;\n}\n\nSEC(\"tracepoint/net/netif_receive_skb\")\nint tracepoint__net__netif_receive_skb_<protocol>(void *ctx) {\n    <protocol>_batch_flush_with_telemetry(ctx);\n    return 0;\n}\n```\n\n----------------------------------------\n\nTITLE: Using Process PID Variable in JavaScript\nDESCRIPTION: This example demonstrates how to use the process.pid variable in a SECL rule. It checks if the open file path matches a specific process-related path.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/windows_expressions.md#2025-04-22_snippet_1\n\nLANGUAGE: javascript\nCODE:\n```\nopen.file.path == \"/proc/${process.pid}/maps\"\n\n```\n\n----------------------------------------\n\nTITLE: Displaying CWS Documentation Folder Structure\nDESCRIPTION: Shows the folder structure for CWS documentation, including scripts, templates, and final documentation files.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n```\ndocs/cloud-workload-security/\n    # scripts and templates used to generate the final documentation\n--- scripts/\n--- --- templates/ # jinja2 templates\n--- --- *.py # generations scripts\n\n    # json schema of the event uploaded to the backend\n--- backend.schema.json\n\n    # event types and fields of the SECL language\n--- secl.json\n\n    # final documentation files\n--- agent_expressions.md # SECL part\n--- backend.md # backend event part\n```\n```\n\n----------------------------------------\n\nTITLE: Installing DDA via pip\nDESCRIPTION: Command to install the Datadog Agent development environment using pip package manager.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\npip install dda\n```\n\n----------------------------------------\n\nTITLE: Deprecated Kubelet Pod Start Latency Metrics in Prometheus Format\nDESCRIPTION: This snippet shows deprecated summary metrics for pod start latency in microseconds. It includes quantile values, sum, and count of pod starts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_17\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_start_latency_microseconds (Deprecated) Latency in microseconds for a single pod to go from pending to running.\n# TYPE kubelet_pod_start_latency_microseconds summary\nkubelet_pod_start_latency_microseconds{quantile=\"0.5\"} NaN\nkubelet_pod_start_latency_microseconds{quantile=\"0.9\"} NaN\nkubelet_pod_start_latency_microseconds{quantile=\"0.99\"} NaN\nkubelet_pod_start_latency_microseconds_sum 1.46698696e+08\nkubelet_pod_start_latency_microseconds_count 30\n```\n\n----------------------------------------\n\nTITLE: Alien VMs Profile Configuration\nDESCRIPTION: JSON configuration for external VMs not managed by KMT, including SSH and system details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_12\n\nLANGUAGE: json\nCODE:\n```\n[\n    {\n        \"ssh_key_path\": \"/home/user/.ssh/some-key.id_rsa\",\n        \"ip\": \"xxx.yyy.aaa.bbb\",\n        \"arch\": \"x86\",\n        \"name\": \"ubuntu-gcp\",\n        \"ssh_user\": \"ubuntu\"\n    }\n]\n```\n\n----------------------------------------\n\nTITLE: Defining Kubernetes API Server Metrics in Prometheus Format\nDESCRIPTION: This snippet defines various Prometheus metrics for a Kubernetes API server, including audit events, client certificate expiration, storage operations, and Go runtime statistics. Each metric is defined with a help text, type, and associated values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_0\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP apiserver_audit_event_total Counter of audit events generated and sent to the audit backend.\n# TYPE apiserver_audit_event_total counter\napiserver_audit_event_total 0\n# HELP apiserver_audit_requests_rejected_total Counter of apiserver requests rejected due to an error in audit logging backend.\n# TYPE apiserver_audit_requests_rejected_total counter\napiserver_audit_requests_rejected_total 0\n# HELP apiserver_client_certificate_expiration_seconds Distribution of the remaining lifetime on the certificate used to authenticate a request.\n# TYPE apiserver_client_certificate_expiration_seconds histogram\napiserver_client_certificate_expiration_seconds_bucket{le=\"0\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"1800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"3600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"7200\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"21600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"43200\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"86400\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"172800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"345600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"604800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"2.592e+06\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"7.776e+06\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"1.5552e+07\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"3.1104e+07\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"+Inf\"} 6\napiserver_client_certificate_expiration_seconds_sum 1.8861617470330057e+08\napiserver_client_certificate_expiration_seconds_count 6\n# HELP apiserver_storage_data_key_generation_duration_seconds Latencies in seconds of data encryption key(DEK) generation operations.\n# TYPE apiserver_storage_data_key_generation_duration_seconds histogram\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"5e-06\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"1e-05\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"2e-05\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"4e-05\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"8e-05\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.00016\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.00032\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.00064\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.00128\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.00256\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.00512\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.01024\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.02048\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"0.04096\"} 0\napiserver_storage_data_key_generation_duration_seconds_bucket{le=\"+Inf\"} 0\napiserver_storage_data_key_generation_duration_seconds_sum 0\napiserver_storage_data_key_generation_duration_seconds_count 0\n# HELP apiserver_storage_data_key_generation_failures_total Total number of failed data encryption key(DEK) generation operations.\n# TYPE apiserver_storage_data_key_generation_failures_total counter\napiserver_storage_data_key_generation_failures_total 0\n# HELP apiserver_storage_data_key_generation_latencies_microseconds (Deprecated) Latencies in microseconds of data encryption key(DEK) generation operations.\n# TYPE apiserver_storage_data_key_generation_latencies_microseconds histogram\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"5\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"10\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"20\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"40\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"80\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"160\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"320\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"640\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"1280\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"2560\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"5120\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"10240\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"20480\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"40960\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_bucket{le=\"+Inf\"} 0\napiserver_storage_data_key_generation_latencies_microseconds_sum 0\napiserver_storage_data_key_generation_latencies_microseconds_count 0\n# HELP apiserver_storage_envelope_transformation_cache_misses_total Total number of cache misses while accessing key decryption key(KEK).\n# TYPE apiserver_storage_envelope_transformation_cache_misses_total counter\napiserver_storage_envelope_transformation_cache_misses_total 0\n# HELP get_token_count Counter of total Token() requests to the alternate token source\n# TYPE get_token_count counter\nget_token_count 0\n# HELP get_token_fail_count Counter of failed Token() requests to the alternate token source\n# TYPE get_token_fail_count counter\nget_token_fail_count 0\n# HELP go_gc_duration_seconds A summary of the GC invocation durations.\n# TYPE go_gc_duration_seconds summary\ngo_gc_duration_seconds{quantile=\"0\"} 2.9784e-05\ngo_gc_duration_seconds{quantile=\"0.25\"} 4.5146e-05\ngo_gc_duration_seconds{quantile=\"0.5\"} 7.4655e-05\ngo_gc_duration_seconds{quantile=\"0.75\"} 0.000120809\ngo_gc_duration_seconds{quantile=\"1\"} 0.007300404\ngo_gc_duration_seconds_sum 3.075087802\ngo_gc_duration_seconds_count 8619\n# HELP go_goroutines Number of goroutines that currently exist.\n# TYPE go_goroutines gauge\ngo_goroutines 312\n# HELP go_info Information about the Go environment.\n# TYPE go_info gauge\ngo_info{version=\"go1.12.12\"} 1\n# HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.\n# TYPE go_memstats_alloc_bytes gauge\ngo_memstats_alloc_bytes 3.107744e+07\n# HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.\n# TYPE go_memstats_alloc_bytes_total counter\ngo_memstats_alloc_bytes_total 1.21129705448e+11\n# HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.\n# TYPE go_memstats_buck_hash_sys_bytes gauge\ngo_memstats_buck_hash_sys_bytes 3.681735e+06\n# HELP go_memstats_frees_total Total number of frees.\n# TYPE go_memstats_frees_total counter\ngo_memstats_frees_total 9.50481593e+08\n# HELP go_memstats_gc_cpu_fraction The fraction of this program's available CPU time used by the GC since the program started.\n# TYPE go_memstats_gc_cpu_fraction gauge\ngo_memstats_gc_cpu_fraction 0.002992656077996334\n# HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.\n# TYPE go_memstats_gc_sys_bytes gauge\ngo_memstats_gc_sys_bytes 2.639872e+06\n# HELP go_memstats_heap_alloc_bytes Number of heap bytes allocated and still in use.\n# TYPE go_memstats_heap_alloc_bytes gauge\ngo_memstats_heap_alloc_bytes 3.107744e+07\n# HELP go_memstats_heap_idle_bytes Number of heap bytes waiting to be used.\n# TYPE go_memstats_heap_idle_bytes gauge\ngo_memstats_heap_idle_bytes 2.92864e+07\n# HELP go_memstats_heap_inuse_bytes Number of heap bytes that are in use.\n# TYPE go_memstats_heap_inuse_bytes gauge\ngo_memstats_heap_inuse_bytes 3.4676736e+07\n# HELP go_memstats_heap_objects Number of allocated objects.\n# TYPE go_memstats_heap_objects gauge\ngo_memstats_heap_objects 238547\n# HELP go_memstats_heap_released_bytes Number of heap bytes released to OS.\n# TYPE go_memstats_heap_released_bytes gauge\ngo_memstats_heap_released_bytes 303104\n# HELP go_memstats_heap_sys_bytes Number of heap bytes obtained from system.\n# TYPE go_memstats_heap_sys_bytes gauge\ngo_memstats_heap_sys_bytes 6.3963136e+07\n# HELP go_memstats_last_gc_time_seconds Number of seconds since 1970 of last garbage collection.\n# TYPE go_memstats_last_gc_time_seconds gauge\ngo_memstats_last_gc_time_seconds 1.5777213959604402e+09\n# HELP go_memstats_lookups_total Total number of pointer lookups.\n# TYPE go_memstats_lookups_total counter\ngo_memstats_lookups_total 0\n# HELP go_memstats_mallocs_total Total number of mallocs.\n# TYPE go_memstats_mallocs_total counter\ngo_memstats_mallocs_total 9.5072014e+08\n# HELP go_memstats_mcache_inuse_bytes Number of bytes in use by mcache structures.\n# TYPE go_memstats_mcache_inuse_bytes gauge\ngo_memstats_mcache_inuse_bytes 3472\n# HELP go_memstats_mcache_sys_bytes Number of bytes used for mcache structures obtained from system.\n# TYPE go_memstats_mcache_sys_bytes gauge\ngo_memstats_mcache_sys_bytes 16384\n# HELP go_memstats_mspan_inuse_bytes Number of bytes in use by mspan structures.\n# TYPE go_memstats_mspan_inuse_bytes gauge\ngo_memstats_mspan_inuse_bytes 460656\n# HELP go_memstats_mspan_sys_bytes Number of bytes used for mspan structures obtained from system.\n# TYPE go_memstats_mspan_sys_bytes gauge\ngo_memstats_mspan_sys_bytes 606208\n# HELP go_memstats_next_gc_bytes Number of heap bytes when next garbage collection will take place.\n# TYPE go_memstats_next_gc_bytes gauge\ngo_memstats_next_gc_bytes 3.7456336e+07\n# HELP go_memstats_other_sys_bytes Number of bytes used for other system allocations.\n# TYPE go_memstats_other_sys_bytes gauge\ngo_memstats_other_sys_bytes 789297\n# HELP go_memstats_stack_inuse_bytes Number of bytes in use by the stack allocator.\n# TYPE go_memstats_stack_inuse_bytes gauge\ngo_memstats_stack_inuse_bytes 3.145728e+06\n```\n\n----------------------------------------\n\nTITLE: Running Packer Build Command\nDESCRIPTION: Command to build VM images using the generated packer configuration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\npacker build packer.json\n```\n\n----------------------------------------\n\nTITLE: ExitEvent Schema Definition\nDESCRIPTION: Defines the structure for process exit events, specifying the cause of termination and exit code. Both cause and code are required fields, with cause being one of EXITED, SIGNALED, or COREDUMPED.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_6\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"cause\": {\n            \"type\": \"string\",\n            \"description\": \"Cause of the process termination (one of EXITED, SIGNALED, COREDUMPED)\"\n        },\n        \"code\": {\n            \"type\": \"integer\",\n            \"description\": \"Exit code of the process or number of the signal that caused the process to terminate\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"cause\",\n        \"code\"\n    ],\n    \"description\": \"ExitEventSerializer serializes an exit event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: REST Client Plugin Metrics\nDESCRIPTION: Prometheus metrics for REST client plugin certificate rotation and TTL tracking.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_37\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP rest_client_exec_plugin_certificate_rotation_age [ALPHA] Histogram of the number of seconds the last auth exec plugin client certificate lived before being rotated. If auth exec plugin client certificates are unused, histogram will contain no data.\n# TYPE rest_client_exec_plugin_certificate_rotation_age histogram\nrest_client_exec_plugin_certificate_rotation_age_bucket{le=\"600\"} 0\nrest_client_exec_plugin_certificate_rotation_age_bucket{le=\"1800\"} 0\n# HELP rest_client_exec_plugin_ttl_seconds [ALPHA] Gauge of the shortest TTL (time-to-live) of the client certificate(s) managed by the auth exec plugin. The value is in seconds until certificate expiry (negative if already expired). If auth exec plugins are unused or manage no TLS certificates, the value will be +INF.\n# TYPE rest_client_exec_plugin_ttl_seconds gauge\nrest_client_exec_plugin_ttl_seconds +Inf\n```\n\n----------------------------------------\n\nTITLE: Defining SysCtlEvent JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema defining the structure for system control parameter events. It captures changes to system control parameters including their names, values, and metadata about truncation status.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_51\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"proc\": {\n            \"type\": \"object\",\n            \"description\": \"Proc contains the /proc system control parameters and their values\"\n        },\n        \"action\": {\n            \"type\": \"string\",\n            \"description\": \"action performed on the system control parameter\"\n        },\n        \"file_position\": {\n            \"type\": \"integer\",\n            \"description\": \"file_position is the position in the sysctl control parameter file at which the action occurred\"\n        },\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"name is the name of the system control parameter\"\n        },\n        \"name_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"name_truncated indicates if the name field is truncated\"\n        },\n        \"value\": {\n            \"type\": \"string\",\n            \"description\": \"value is the new and/or current value for the system control parameter depending on the action type\"\n        },\n        \"value_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"value_truncated indicates if the value field is truncated\"\n        },\n        \"old_value\": {\n            \"type\": \"string\",\n            \"description\": \"old_value is the old value of the system control parameter\"\n        },\n        \"old_value_truncated\": {\n            \"type\": \"boolean\",\n            \"description\": \"old_value_truncated indicates if the old_value field is truncated\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SysCtlEventSerializer defines a sysctl event serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Latency Metrics in Prometheus Format\nDESCRIPTION: Prometheus summary metrics showing the latency in microseconds of various Docker operations performed by kubelet, broken down by operation type with quantiles, sums, and counts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_9\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_latency_microseconds Latency in microseconds of Docker operations. Broken down by operation type.\n# TYPE kubelet_docker_operations_latency_microseconds summary\nkubelet_docker_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.5\"} 135483\nkubelet_docker_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.9\"} 232577\nkubelet_docker_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.99\"} 286973\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"create_container\"} 5.184381e+06\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"create_container\"} 33\nkubelet_docker_operations_latency_microseconds{operation_type=\"info\",quantile=\"0.5\"} 24543\nkubelet_docker_operations_latency_microseconds{operation_type=\"info\",quantile=\"0.9\"} 24543\nkubelet_docker_operations_latency_microseconds{operation_type=\"info\",quantile=\"0.99\"} 24543\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"info\"} 58960\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"info\"} 2\nkubelet_docker_operations_latency_microseconds{operation_type=\"inspect_container\",quantile=\"0.5\"} 938\nkubelet_docker_operations_latency_microseconds{operation_type=\"inspect_container\",quantile=\"0.9\"} 3870\nkubelet_docker_operations_latency_microseconds{operation_type=\"inspect_container\",quantile=\"0.99\"} 363515\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"inspect_container\"} 4.037885e+06\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"inspect_container\"} 264\nkubelet_docker_operations_latency_microseconds{operation_type=\"inspect_image\",quantile=\"0.5\"} 1181\nkubelet_docker_operations_latency_microseconds{operation_type=\"inspect_image\",quantile=\"0.9\"} 2935\nkubelet_docker_operations_latency_microseconds{operation_type=\"inspect_image\",quantile=\"0.99\"} 13245\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"inspect_image\"} 324403\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"inspect_image\"} 158\nkubelet_docker_operations_latency_microseconds{operation_type=\"list_containers\",quantile=\"0.5\"} 2880\nkubelet_docker_operations_latency_microseconds{operation_type=\"list_containers\",quantile=\"0.9\"} 8530\nkubelet_docker_operations_latency_microseconds{operation_type=\"list_containers\",quantile=\"0.99\"} 13617\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"list_containers\"} 5.100891e+06\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"list_containers\"} 1242\nkubelet_docker_operations_latency_microseconds{operation_type=\"list_images\",quantile=\"0.5\"} 12016\nkubelet_docker_operations_latency_microseconds{operation_type=\"list_images\",quantile=\"0.9\"} 17505\nkubelet_docker_operations_latency_microseconds{operation_type=\"list_images\",quantile=\"0.99\"} 20309\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"list_images\"} 521800\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"list_images\"} 40\nkubelet_docker_operations_latency_microseconds{operation_type=\"pull_image\",quantile=\"0.5\"} 1.530757e+06\nkubelet_docker_operations_latency_microseconds{operation_type=\"pull_image\",quantile=\"0.9\"} 1.638564e+06\nkubelet_docker_operations_latency_microseconds{operation_type=\"pull_image\",quantile=\"0.99\"} 1.638564e+06\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"pull_image\"} 6.371534e+06\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"pull_image\"} 4\nkubelet_docker_operations_latency_microseconds{operation_type=\"remove_container\",quantile=\"0.5\"} 30582\nkubelet_docker_operations_latency_microseconds{operation_type=\"remove_container\",quantile=\"0.9\"} 38238\nkubelet_docker_operations_latency_microseconds{operation_type=\"remove_container\",quantile=\"0.99\"} 38238\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"remove_container\"} 168654\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"remove_container\"} 5\nkubelet_docker_operations_latency_microseconds{operation_type=\"start_container\",quantile=\"0.5\"} 387766\nkubelet_docker_operations_latency_microseconds{operation_type=\"start_container\",quantile=\"0.9\"} 747529\nkubelet_docker_operations_latency_microseconds{operation_type=\"start_container\",quantile=\"0.99\"} 992026\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"start_container\"} 1.5029456e+07\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"start_container\"} 33\nkubelet_docker_operations_latency_microseconds{operation_type=\"stop_container\",quantile=\"0.5\"} 2172\nkubelet_docker_operations_latency_microseconds{operation_type=\"stop_container\",quantile=\"0.9\"} 515222\nkubelet_docker_operations_latency_microseconds{operation_type=\"stop_container\",quantile=\"0.99\"} 562456\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"stop_container\"} 5.641237e+06\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"stop_container\"} 31\nkubelet_docker_operations_latency_microseconds{operation_type=\"version\",quantile=\"0.5\"} 873\nkubelet_docker_operations_latency_microseconds{operation_type=\"version\",quantile=\"0.9\"} 1314\nkubelet_docker_operations_latency_microseconds{operation_type=\"version\",quantile=\"0.99\"} 1783\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"version\"} 85497\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"version\"} 95\n```\n\n----------------------------------------\n\nTITLE: Configuring Job Ownership in GitLab CI\nDESCRIPTION: This snippet defines job ownership rules for a GitLab project. It assigns teams to specific test directories and sets a default team for all other files. This configuration helps in automatically assigning appropriate reviewers for merge requests.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/unit_tests/testdata/jobowners.txt#2025-04-22_snippet_0\n\nLANGUAGE: gitlabci\nCODE:\n```\n# Extract of the .gitab/JOBOWNERS file, for testing purposes\n\n*                   @DataDog/team-everything\n\ntests_team_a_*      @DataDog/team-a\ntests_team_b_*      @DataDog/team-b\ntests_letters_*     @DataDog/team-a @DataDog/team-b\n```\n\n----------------------------------------\n\nTITLE: Referencing gopsutil Dependency Removal in Datadog Agent\nDESCRIPTION: This code snippet shows a comment referencing the removal of the gopsutil dependency in the Datadog Agent's go.py file. It's part of the strategy to address WMI and COM-related issues on Windows.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/caveats.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n[removal](https://github.com/DataDog/datadog-agent/blob/main/tasks/go.py#L295-L299)\n```\n\n----------------------------------------\n\nTITLE: Counting Kubelet Network Plugin Operations in Prometheus Format\nDESCRIPTION: Prometheus metrics showing the total count of network plugin operations performed by kubelet, categorized by operation type (get_pod_network_status, set_up_pod, tear_down_pod).\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_21\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_network_plugin_operations_total [ALPHA] Cumulative number of network plugin operations by operation type.\n# TYPE kubelet_network_plugin_operations_total counter\nkubelet_network_plugin_operations_total{operation_type=\"get_pod_network_status\"} 108\nkubelet_network_plugin_operations_total{operation_type=\"set_up_pod\"} 28\nkubelet_network_plugin_operations_total{operation_type=\"tear_down_pod\"} 1\n```\n\n----------------------------------------\n\nTITLE: Configuring Local VM Stack\nDESCRIPTION: Commands to configure a stack with local VMs matching the host architecture, including Amazon Linux, Fedora, and Debian distributions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.gen-config --vms=amzn5.10-local-distro,fedora38-local-distro,debian9-local-distro --stack=demo-stack\n```\n\n----------------------------------------\n\nTITLE: Downloading DDA Installer Package on macOS\nDESCRIPTION: curl command to download the Datadog Agent development environment installer package for macOS.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ncurl -Lo dda-universal.pkg https://github.com/DataDog/datadog-agent-dev/releases/latest/download/dda-universal.pkg\n```\n\n----------------------------------------\n\nTITLE: Kubelet Pod Worker Start Duration Metrics in Prometheus Format\nDESCRIPTION: This snippet shows histogram metrics for pod worker start duration in seconds. It includes bucket counts for various duration thresholds, sum, and total count of worker starts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_20\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_worker_start_duration_seconds Duration in seconds from seeing a pod to starting a worker.\n# TYPE kubelet_pod_worker_start_duration_seconds histogram\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.005\"} 4\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.01\"} 7\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.025\"} 9\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.05\"} 9\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.1\"} 10\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.25\"} 10\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.5\"} 10\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"1\"} 10\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"2.5\"} 10\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"5\"} 10\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"10\"} 15\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"+Inf\"} 15\nkubelet_pod_worker_start_duration_seconds_sum 26.950495594\nkubelet_pod_worker_start_duration_seconds_count 15\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Task States for Kubernetes Components in Prometheus\nDESCRIPTION: These Prometheus metrics represent the task states of various Kubernetes components (kube-controller-manager, kube-proxy, kube-scheduler) in a cluster. Each metric includes detailed labels for container identification and its current state, with a timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_59\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_tasks_state{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"running\"} 0 1572450192433\ncontainer_tasks_state{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"sleeping\"} 0 1572450192433\ncontainer_tasks_state{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"stopped\"} 0 1572450192433\ncontainer_tasks_state{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"uninterruptible\"} 0 1572450192433\ncontainer_tasks_state{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\",state=\"iowaiting\"} 0 1572450197292\ncontainer_tasks_state{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\",state=\"running\"} 0 1572450197292\ncontainer_tasks_state{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\",state=\"sleeping\"} 0 1572450197292\ncontainer_tasks_state{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\",state=\"stopped\"} 0 1572450197292\ncontainer_tasks_state{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\",state=\"uninterruptible\"} 0 1572450197292\ncontainer_tasks_state{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"iowaiting\"} 0 1572450195713\ncontainer_tasks_state{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"running\"} 0 1572450195713\ncontainer_tasks_state{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"sleeping\"} 0 1572450195713\ncontainer_tasks_state{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"stopped\"} 0 1572450195713\ncontainer_tasks_state{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"uninterruptible\"} 0 1572450195713\n# HELP container_threads Number of threads running inside the container\n```\n\n----------------------------------------\n\nTITLE: Generating CWS Documentation with Python\nDESCRIPTION: Commands for installing Python dependencies and generating CWS documentation using dda and go commands.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/README.md#2025-04-22_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\npip install dda\npip install -r docs/cloud-workload-security/scripts/requirements-docs.txt\n\ndda inv -e security-agent.cws-go-generate\n# or only the specific file\ngo generate ./path/to/the/touched/file\n\ndda inv -e security-agent.generate-cws-documentation\n```\n\n----------------------------------------\n\nTITLE: Setting up Datadog Agent Repository in GOPATH\nDESCRIPTION: Commands to clone the Datadog Agent repository into the correct GOPATH directory structure for development.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/process-agent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncd $GOPATH/src/github.com/DataDog\ngit clone git@github.com:DataDog/datadog-agent.git\ncd datadog-agent\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Docker Operations Latency Metrics in Prometheus\nDESCRIPTION: This snippet defines the 'kubelet_docker_operations_latency_microseconds' metric, which measures the latency of various Docker operations performed by Kubelet. It includes quantiles, sum, and count for different operation types.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_9\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_docker_operations_latency_microseconds summary\nkubelet_docker_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.5\"} NaN\nkubelet_docker_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.9\"} NaN\nkubelet_docker_operations_latency_microseconds{operation_type=\"create_container\",quantile=\"0.99\"} NaN\nkubelet_docker_operations_latency_microseconds_sum{operation_type=\"create_container\"} 1.3981331e+07\nkubelet_docker_operations_latency_microseconds_count{operation_type=\"create_container\"} 51\n# ... (similar entries for other operation types)\n```\n\n----------------------------------------\n\nTITLE: Setting RTLoader Library Properties and Include Directories\nDESCRIPTION: Configures properties for the datadog-agent-rtloader target, including version, soversion, and public headers. It also sets up include directories and handles 32-bit architecture compilation if necessary.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/rtloader/CMakeLists.txt#2025-04-22_snippet_4\n\nLANGUAGE: CMake\nCODE:\n```\nset_target_properties(datadog-agent-rtloader PROPERTIES\n    VERSION ${PROJECT_VERSION}\n    SOVERSION 2\n    PUBLIC_HEADER \"../include/datadog_agent_rtloader.h;../include/rtloader_types.h;../common/rtloader_mem.h\"\n)\n\nif(ARCH_I386)\n    set_target_properties(datadog-agent-rtloader PROPERTIES COMPILE_FLAGS \"-m32\" LINK_FLAGS \"-m32\")\nendif()\n\nconfigure_file(datadog-agent-rtloader.pc.in datadog-agent-rtloader.pc @ONLY)\ntarget_include_directories(datadog-agent-rtloader PRIVATE ./include)\ntarget_include_directories(datadog-agent-rtloader PUBLIC\n    ${CMAKE_SOURCE_DIR}/include\n    ${CMAKE_SOURCE_DIR}/common\n)\n```\n\n----------------------------------------\n\nTITLE: Preparing USM Debugger Build Environment for Target Architectures\nDESCRIPTION: Commands to prepare the build environment for different target architectures. This step is necessary to build eBPF object files for architectures different from the host machine. The example prepares for x86_64 and arm64 architectures.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/usm/debugger/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.prepare system-probe --compile-only --stack=foo --arch=x86_64\ndda inv -e kmt.prepare system-probe --compile-only --stack=foo --arch=arm64\n```\n\n----------------------------------------\n\nTITLE: Demonstrating Windows Registry Multi-String Format\nDESCRIPTION: Shows an example of how counter strings are stored in the Windows registry as a REG_MULTI_SZ format. This format is a list of NULL-terminated strings, with the last element indicated by a double NULL.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/util/pdhutil/README.md#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\n\"1|N|1847|N|2|N|System|N|4|N|Memory|N||N|\"\n```\n\n----------------------------------------\n\nTITLE: Building Entrypoint for Windows Docker Image\nDESCRIPTION: This command builds the entrypoint executable for the Docker container by running a batch file inside a Windows build container with the current directory mounted.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/windows/README.md#2025-04-22_snippet_1\n\nLANGUAGE: powershell\nCODE:\n```\ndocker run --rm -it -v \"${pwd}:c:\\mnt\" datadog/agent-buildimages-windows_x64:1809 c:\\mnt\\Dockerfiles\\agent\\windows\\entrypoint\\build.bat\n```\n\n----------------------------------------\n\nTITLE: Custom Kernel Configuration\nDESCRIPTION: Example showing how to configure and launch VMs with custom kernels on both local and remote machines.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\n# Configure custom kernels\ndda inv -e kmt.gen-config  --vms=custom-5.4-local,custom-4.14-local,custom-5.7-arm64\n# Launch stack\ndda inv -e kmt.launch-stack\n```\n\n----------------------------------------\n\nTITLE: Installing Shellcheck for Pre-commit Hooks\nDESCRIPTION: Command to install the shellcheck binary, which is required for the shellcheck pre-commit hook. The destination path can be specified.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_12\n\nLANGUAGE: sh\nCODE:\n```\ndda inv install-shellcheck --destination <path>\n```\n\n----------------------------------------\n\nTITLE: Installing Systemd Dependencies on Redhat/CentOS\nDESCRIPTION: Command to install the systemd-devel package on Redhat or CentOS systems, which is required for the agent to collect systemd journal logs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_10\n\nLANGUAGE: bash\nCODE:\n```\nsudo yum install systemd-devel\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Runtime Operations Latency Metrics in Prometheus\nDESCRIPTION: This snippet defines Prometheus metrics for kubelet runtime operations latency. It includes various operation types with quantiles, sum, and count for each operation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_28\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_runtime_operations_latency_microseconds summary\nkubelet_runtime_operations_latency_microseconds{operation_type=\"container_status\",quantile=\"0.5\"} NaN\nkubelet_runtime_operations_latency_microseconds{operation_type=\"container_status\",quantile=\"0.9\"} NaN\nkubelet_runtime_operations_latency_microseconds{operation_type=\"container_status\",quantile=\"0.99\"} NaN\nkubelet_runtime_operations_latency_microseconds_sum{operation_type=\"container_status\"} 4.586433e+06\nkubelet_runtime_operations_latency_microseconds_count{operation_type=\"container_status\"} 175\n# ... (similar entries for other operation types)\n```\n\n----------------------------------------\n\nTITLE: Exporting Container Network Metrics in Prometheus Format\nDESCRIPTION: These lines represent Prometheus metrics for container network receive bytes across different network interfaces. The metrics include detailed labels for container ID, image, interface type, namespace, and pod name, along with timestamp values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_29\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_receive_bytes_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_receive_bytes_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n# HELP container_network_receive_errors_total Cumulative count of errors encountered while receiving\n```\n\n----------------------------------------\n\nTITLE: Container Memory Working Set Metrics in Prometheus Format\nDESCRIPTION: Prometheus metrics showing container memory working set bytes for various Kubernetes components. The metrics include memory usage for system containers (etcd, coredns, kube-apiserver, etc.) and a Datadog agent, with timestamps and container metadata like namespace, pod name, and image.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_27\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_working_set_bytes gauge\ncontainer_memory_working_set_bytes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 7.28911872e+08 1572450197572\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 4.51313664e+08 1572450197668\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 5.3395456e+07 1572450196297\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 4.380672e+07 1572450199385\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 237568 1572450186377\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 9.588736e+06 1572450198309\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 225280 1572450196497\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.388416e+08 1572450196733\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 7.626752e+06 1572450196475\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 233472 1572450195152\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2.76013056e+08 1572450186468\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 229376 1572450199201\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 7.696384e+06 1572450195355\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 225280 1572450197313\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 3.5188736e+07 1572450190363\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 253952 1572450200713\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.2316672e+07 1572450201420\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 241664 1572450188256\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 5.566464e+06 1572450195286\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 217088 1572450196642\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 5.2871168e+07 1572450190276\ncontainer_memory_working_set_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 237568 1572450189944\ncontainer_memory_working_set_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 7.39328e+06 1572450198917\ncontainer_memory_working_set_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 7.471104e+06 1572450196388\ncontainer_memory_working_set_bytes{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 5.3272576e+07 1572450197849\ncontainer_memory_working_set_bytes{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 4.3569152e+07 1572450202927\ncontainer_memory_working_set_bytes{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 5.349376e+06 1572450196671\ncontainer_memory_working_set_bytes{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2.7578368e+08 1572450188597\ncontainer_memory_working_set_bytes{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 3.4934784e+07 1572450192433\ncontainer_memory_working_set_bytes{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 9.363456e+06 1572450197292\ncontainer_memory_working_set_bytes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.2075008e+07 1572450195713\n# HELP container_network_receive_bytes_total Cumulative count of bytes received\n```\n\n----------------------------------------\n\nTITLE: Defining File Fields in Go\nDESCRIPTION: Demonstrates how to define file fields in Go, including property name, type, and definition.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/README.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\ntype FileFields struct {\n\t...\n\tCTime uint64 `field:\"change_time\"` // Change time of the file\n\t...\n}\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for Workload Protection Windows Events\nDESCRIPTION: This code block represents the JSON schema for Workload Protection Windows backend events. It defines the structure and types of data fields in these events.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/backend_windows.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{{ event_schema }}\n```\n\n----------------------------------------\n\nTITLE: Setting Environment Variables for Docker Swarm Secrets\nDESCRIPTION: Environment variables configuration for Docker Swarm Secrets integration with the Datadog Agent. These variables tell the agent to use the readsecret script with the Docker secrets folder path.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/secrets-helper/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nDD_SECRET_BACKEND_COMMAND=/readsecret.py\nDD_SECRET_BACKEND_ARGUMENTS=/run/secrets\n```\n\n----------------------------------------\n\nTITLE: Defining Reflector Watch Duration Summary Metric\nDESCRIPTION: Defines a summary metric for measuring API watch execution duration with quantiles for tracking performance distribution\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_27\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP reflector_watch_duration_seconds How long an API watch takes to return and decode for the reflectors\n# TYPE reflector_watch_duration_seconds summary\nreflector_watch_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.5\"} NaN\nreflector_watch_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.9\"} NaN\nreflector_watch_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.99\"} NaN\nreflector_watch_duration_seconds_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 0\nreflector_watch_duration_seconds_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 0\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent in YAML\nDESCRIPTION: This snippet shows the basic structure of a Datadog Agent configuration file. It includes placeholders for essential settings like API key, site, and environment tags. Users need to customize these values for their specific setup.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/examples/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\napi_key: <YOUR_API_KEY>\nsite: datadoghq.com\n\nenv: <YOUR_ENV>\n\n# Add other configuration settings as needed\n```\n\n----------------------------------------\n\nTITLE: Running All Security Agent Tests in Bash\nDESCRIPTION: Command to run all functional tests for the security agent component. Uses the dda invoke command with the security-agent.functional-tests task, skipping linters and running all available tests.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/security/tests/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e security-agent.functional-tests --verbose --skip-linters --testflags \"-test.run '.*'\"\n```\n\n----------------------------------------\n\nTITLE: Using Jinja2 Template for Hugo Code Block\nDESCRIPTION: Demonstrates how to use Jinja2 templating to create a code block in Hugo documentation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/README.md#2025-04-22_snippet_4\n\nLANGUAGE: jinja2\nCODE:\n```\n{% raw %}\n{{< code-block lang=\"javascript\" >}}\n{% endraw %}\n```\n\n----------------------------------------\n\nTITLE: Building Docker Image with Core Windows Base\nDESCRIPTION: This Docker build command creates the Agent container image using a Windows Server Core base image. It specifies build arguments for the base image, JMX support, and Windows variant.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/windows/README.md#2025-04-22_snippet_4\n\nLANGUAGE: powershell\nCODE:\n```\n# Build core image\ndocker build -t mycustomagent --build-arg BASE_IMAGE=mcr.microsoft.com/powershell:windowsservercore-1809 --build-arg WITH_JMX=false --build-arg VARIANT=1809 -f .\\windows\\amd64\\Dockerfile .\n```\n\n----------------------------------------\n\nTITLE: Installing RTLoader Library and Handling Windows-specific Post-build Step\nDESCRIPTION: Specifies installation rules for the datadog-agent-rtloader target. For Windows, it adds a post-build step to copy the static library to a specific location expected by the Windows builder.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/rtloader/CMakeLists.txt#2025-04-22_snippet_5\n\nLANGUAGE: CMake\nCODE:\n```\ninstall(TARGETS datadog-agent-rtloader\n    RUNTIME DESTINATION bin\n    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}\n    PUBLIC_HEADER DESTINATION include\n    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}\n)\n\n# Windows builder assumes libdatadog-agent-rtloader.a is located in rtloader/rtloader folder.\nif (WIN32)\nADD_CUSTOM_COMMAND(\n    TARGET datadog-agent-rtloader\n    POST_BUILD\n    COMMAND ${CMAKE_COMMAND} -E copy ${PROJECT_BINARY_DIR}/libdatadog-agent-rtloader.a ${PROJECT_SOURCE_DIR}/libdatadog-agent-rtloader.a\n)\nendif()\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Runtime Operations Total Metrics in Prometheus\nDESCRIPTION: This snippet defines Prometheus counter metrics for the total number of kubelet runtime operations. It includes counts for various operation types.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_29\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations_total Cumulative number of runtime operations by operation type.\n# TYPE kubelet_runtime_operations_total counter\nkubelet_runtime_operations_total{operation_type=\"container_status\"} 175\nkubelet_runtime_operations_total{operation_type=\"create_container\"} 36\nkubelet_runtime_operations_total{operation_type=\"exec\"} 4\nkubelet_runtime_operations_total{operation_type=\"exec_sync\"} 4384\n# ... (similar entries for other operation types)\n```\n\n----------------------------------------\n\nTITLE: Container Memory Failures Metrics - Prometheus\nDESCRIPTION: Metrics showing container memory page fault statistics for the kube-scheduler container, including both container and hierarchy scoped measurements\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_21\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_memory_failures_total{container=\"kube-scheduler\",failure_type=\"pgmajfault\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",scope=\"container\"} 0 1572450195713\ncontainer_memory_failures_total{container=\"kube-scheduler\",failure_type=\"pgmajfault\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",scope=\"hierarchy\"} 0 1572450195713\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for Memory Mapping and Protection Events\nDESCRIPTION: This snippet defines schemas for serializing memory mapping (mmap) and memory protection (mprotect) events, including address ranges and protection flags.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_6\n\nLANGUAGE: JSON\nCODE:\n```\n\"MMapEvent\": {\n    \"properties\": {\n        \"address\": {\n            \"type\": \"string\",\n            \"description\": \"memory segment address\"\n        },\n        \"offset\": {\n            \"type\": \"integer\",\n            \"description\": \"file offset\"\n        },\n        \"length\": {\n            \"type\": \"integer\",\n            \"description\": \"memory segment length\"\n        },\n        \"protection\": {\n            \"type\": \"string\",\n            \"description\": \"memory segment protection\"\n        },\n        \"flags\": {\n            \"type\": \"string\",\n            \"description\": \"memory segment flags\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"address\",\n        \"offset\",\n        \"length\",\n        \"protection\",\n        \"flags\"\n    ],\n    \"description\": \"MMapEventSerializer serializes a mmap event to JSON\"\n},\n\"MProtectEvent\": {\n    \"properties\": {\n        \"vm_start\": {\n            \"type\": \"string\",\n            \"description\": \"memory segment start address\"\n        },\n        \"vm_end\": {\n            \"type\": \"string\",\n            \"description\": \"memory segment end address\"\n        },\n        \"vm_protection\": {\n            \"type\": \"string\",\n            \"description\": \"initial memory segment protection\"\n        },\n        \"req_protection\": {\n            \"type\": \"string\",\n            \"description\": \"new memory segment protection\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"vm_start\",\n        \"vm_end\",\n        \"vm_protection\",\n        \"req_protection\"\n    ],\n    \"description\": \"MProtectEventSerializer serializes a mmap event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Installing Invoke and Dependencies for Datadog Agent Development\nDESCRIPTION: Command to install Invoke and other Python dependencies required for Datadog Agent development using pip and the provided requirements file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_6\n\nLANGUAGE: bash\nCODE:\n```\npip install -r tasks/requirements.txt\n```\n\n----------------------------------------\n\nTITLE: Running DogStatsD in Docker\nDESCRIPTION: Docker command to run DogStatsD in a container with API key provided as an environment variable.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/dogstatsd/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ndocker run -e DD_API_KEY=XXX datadog/dogstatsd:beta\n```\n\n----------------------------------------\n\nTITLE: Creating a Release Note with Reno in Bash\nDESCRIPTION: This snippet demonstrates how to use the Reno tool to create a new release note file. It includes the command to create a new note and instructions on how to edit and commit it.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/guidelines/contributing.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\n$> reno new <topic-of-my-pr> --edit\n[...]\n# Remove unused sections and fill the relevant ones.\n# Reno will create a new file in releasenotes/notes.\n#\n# Each section from every release note are combined when the CHANGELOG.rst is\n# rendered. So the text needs to be worded so that it does not depend on any\n# information only available in another section. This may mean repeating some\n# details, but each section must be readable independently of the other.\n#\n# Each section note must be formatted as reStructuredText.\n[...]\n```\n\n----------------------------------------\n\nTITLE: Setting Environment Variables for Kubernetes Secrets\nDESCRIPTION: Environment variables configuration for Kubernetes secrets integration with the Datadog Agent. These variables specify the path to the mounted secrets volume.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/secrets-helper/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nDD_SECRET_BACKEND_COMMAND=/readsecret.py\nDD_SECRET_BACKEND_ARGUMENTS=/etc/secret-volume\n```\n\n----------------------------------------\n\nTITLE: Database Performance Counter ID Mappings\nDESCRIPTION: Mapping of database performance metric names to their numeric counter IDs. These IDs can be used to retrieve specific performance metrics from the database system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/system/testfiles/counter_indexes_en-us.txt#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nFCB Async Purge Failures (Active Tasks)/sec\n12580\nFCB Async Purge Failures (Callbacks)/sec\n12582\nFCB Async Purge Failures (Other)/sec\n12584\n[...additional entries...]\n```\n\n----------------------------------------\n\nTITLE: Container Filesystem Metrics Definition in Prometheus Format\nDESCRIPTION: Defines various filesystem metrics including I/O operations, timing, storage limits and read statistics for containers. Each metric includes labels for container, device, id, image, namespace and pod identification.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_10\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_fs_io_current gauge\ncontainer_fs_io_current{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_current{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_current{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_current{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n# HELP container_fs_io_time_seconds_total Cumulative count of seconds spent doing I/Os\n# TYPE container_fs_io_time_seconds_total counter\ncontainer_fs_io_time_seconds_total{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0.00020028 1572450197572\ncontainer_fs_io_time_seconds_total{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_time_seconds_total{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_time_seconds_total{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n# HELP container_fs_io_time_weighted_seconds_total Cumulative weighted I/O time in seconds\n# TYPE container_fs_io_time_weighted_seconds_total counter\ncontainer_fs_io_time_weighted_seconds_total{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0.01081033 1572450197572\ncontainer_fs_io_time_weighted_seconds_total{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_time_weighted_seconds_total{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_io_time_weighted_seconds_total{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n# HELP container_fs_limit_bytes Number of bytes that can be consumed by the container on this filesystem.\n# TYPE container_fs_limit_bytes gauge\ncontainer_fs_limit_bytes{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 6.7371577344e+10 1572450197572\ncontainer_fs_limit_bytes{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 6.7371577344e+10 1572450197572\ncontainer_fs_limit_bytes{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 6.7108864e+07 1572450197572\ncontainer_fs_limit_bytes{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 6.7108864e+07 1572450197572\n# HELP container_fs_read_seconds_total Cumulative count of seconds spent reading\n# TYPE container_fs_read_seconds_total counter\ncontainer_fs_read_seconds_total{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.814e-05 1572450197572\ncontainer_fs_read_seconds_total{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_read_seconds_total{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_read_seconds_total{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n# HELP container_fs_reads_bytes_total Cumulative count of bytes read\n# TYPE container_fs_reads_bytes_total counter\ncontainer_fs_reads_bytes_total{container=\"\",device=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_reads_bytes_total{container=\"\",device=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_fs_reads_bytes_total{container=\"\",device=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_fs_reads_bytes_total{container=\"\",device=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450198309\ncontainer_fs_reads_bytes_total{container=\"\",device=\"/dev/sda\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_reads_bytes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_fs_reads_bytes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_fs_reads_bytes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_fs_reads_bytes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450195286\ncontainer_fs_reads_bytes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450190276\ncontainer_fs_reads_bytes_total{container=\"datadog-agent\",device=\"/dev/sda\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 4096 1572450197849\ncontainer_fs_reads_bytes_total{container=\"etcd\",device=\"/dev/sda\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450202927\ncontainer_fs_reads_bytes_total{container=\"kindnet-cni\",device=\"/dev/sda\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196671\ncontainer_fs_reads_bytes_total{container=\"kube-proxy\",device=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 190464 1572450197292\n# HELP container_fs_reads_merged_total Cumulative count of reads merged\n# TYPE container_fs_reads_merged_total counter\ncontainer_fs_reads_merged_total{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 120 1572450197572\ncontainer_fs_reads_merged_total{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_reads_merged_total{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_reads_merged_total{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n# HELP container_fs_reads_total Cumulative count of reads completed\n```\n\n----------------------------------------\n\nTITLE: Defining Prober Probe Total Metric in Prometheus\nDESCRIPTION: This snippet defines the 'prober_probe_total' metric, which counts the cumulative number of liveness, readiness, or startup probes for containers. It includes labels for container, namespace, pod, pod_uid, probe_type, and result.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/probes.txt#2025-04-22_snippet_0\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP prober_probe_total [ALPHA] Cumulative number of a liveness, readiness or startup probe for a container by result.\n# TYPE prober_probe_total counter\nprober_probe_total{container=\"agent\",namespace=\"default\",pod=\"datadog\",pod_uid=\"2e4619c2-15e1-4a2f-8b27-f1bb9d57b957\",probe_type=\"Liveness\",result=\"successful\"} 3\nprober_probe_total{container=\"agent\",namespace=\"default\",pod=\"datadog\",pod_uid=\"2e4619c2-15e1-4a2f-8b27-f1bb9d57b957\",probe_type=\"Readiness\",result=\"successful\"} 3\nprober_probe_total{container=\"calico-node\",namespace=\"kube-system\",pod=\"calico-node-9qkw7\",probe_type=\"Liveness\",result=\"successful\"} 1.686306e+06\nprober_probe_total{container_name=\"calico-node\",namespace=\"kube-system\",pod_name=\"calico-node-9qkw7\",pod_uid=\"6daeeb11-1f06-4d07-ac39-7df7aad8ae86\",probe_type=\"Readiness\",result=\"failed\"} 180\nprober_probe_total{container=\"calico-node\",namespace=\"kube-system\",pod=\"calico-node-9qkw7\",pod_uid=\"6daeeb11-1f06-4d07-ac39-7df7aad8ae86\",probe_type=\"Liveness\",result=\"failed\"} 100\nprober_probe_total{container=\"calico-node\",namespace=\"kube-system\",pod=\"calico-node-9qkw7\",pod_uid=\"6daeeb11-1f06-4d07-ac39-7df7aad8ae86\",probe_type=\"Readiness\",result=\"successful\"} 1.686127e+06\nprober_probe_total{container=\"dnsmasq\",namespace=\"kube-system\",pod=\"kube-dns-c598bd956-wgf4n\",pod_uid=\"03bc86a4-c87a-4537-9b0f-17e52cfd3162\",probe_type=\"Liveness\",result=\"successful\"} 1.686298e+06\nprober_probe_total{container=\"fluentbit\",namespace=\"kube-system\",pod=\"fluentbit-gke-45gvm\",pod_uid=\"0310ae03-63ae-468e-b49d-7b78a7c5b0e9\",probe_type=\"Liveness\",result=\"successful\"} 281049\nprober_probe_total{container=\"fluentbit-gke\",namespace=\"kube-system\",pod=\"fluentbit-gke-45gvm\",pod_uid=\"0310ae03-63ae-468e-b49d-7b78a7c5b0e9\",probe_type=\"Liveness\",result=\"successful\"} 281049\nprober_probe_total{container=\"kubedns\",namespace=\"kube-system\",pod=\"kube-dns-c598bd956-wgf4n\",pod_uid=\"03bc86a4-c87a-4537-9b0f-17e52cfd3162\",probe_type=\"Liveness\",result=\"successful\"} 1.686298e+06\nprober_probe_total{container=\"kubedns\",namespace=\"kube-system\",pod=\"kube-dns-c598bd956-wgf4n\",pod_uid=\"03bc86a4-c87a-4537-9b0f-17e52cfd3162\",probe_type=\"Readiness\",result=\"successful\"} 1.686303e+06\nprober_probe_total{container=\"sidecar\",namespace=\"kube-system\",pod=\"kube-dns-c598bd956-wgf4n\",pod_uid=\"03bc86a4-c87a-4537-9b0f-17e52cfd3162\",probe_type=\"Liveness\",result=\"successful\"} 1.686298e+06\nprober_probe_total{container=\"kubedns\",namespace=\"kube-system\",pod=\"kube-dns-c598bd956-wgf4n\",pod_uid=\"03bc86a4-c87a-4537-9b0f-17e52cfd3162\",probe_type=\"Startup\",result=\"successful\"} 70\nprober_probe_total{container=\"kubedns\",namespace=\"kube-system\",pod=\"kube-dns-c598bd956-wgf4n\",pod_uid=\"03bc86a4-c87a-4537-9b0f-17e52cfd3162\",probe_type=\"Startup\",result=\"failed\"} 70\n```\n\n----------------------------------------\n\nTITLE: Measuring Storage Operation Durations in Prometheus for Kubernetes\nDESCRIPTION: This snippet defines a Prometheus histogram metric 'storage_operation_duration_seconds' for measuring the duration of storage operations in Kubernetes. It includes buckets for different volume plugins and operations, with a focus on 'verify_controller_attached_volume' and 'volume_mount' operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_35\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE storage_operation_duration_seconds histogram\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.1\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.25\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.5\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"1\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"2.5\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"5\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"10\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"15\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"25\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"50\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\",le=\"+Inf\"} 1\nstorage_operation_duration_seconds_sum{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\"} 0.001763707\nstorage_operation_duration_seconds_count{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/configmap\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.1\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.25\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.5\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"1\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"2.5\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"5\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"10\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"15\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"25\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"50\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\",le=\"+Inf\"} 10\nstorage_operation_duration_seconds_sum{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\"} 0.001807131\nstorage_operation_duration_seconds_count{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/downward-api\"} 10\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"2.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"10\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"15\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"50\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"+Inf\"} 3\nstorage_operation_duration_seconds_sum{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\"} 0.000646199\nstorage_operation_duration_seconds_count{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/empty-dir\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.1\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.25\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.5\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"1\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"2.5\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"5\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"10\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"15\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"25\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"50\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\",le=\"+Inf\"} 25\nstorage_operation_duration_seconds_sum{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\"} 0.010212617\nstorage_operation_duration_seconds_count{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/host-path\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"0.1\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"0.25\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"0.5\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"1\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"2.5\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"5\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"10\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"15\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"25\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"50\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\",le=\"+Inf\"} 19\nstorage_operation_duration_seconds_sum{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\"} 0.014159099\nstorage_operation_duration_seconds_count{operation_name=\"verify_controller_attached_volume\",volume_plugin=\"kubernetes.io/secret\"} 19\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"0.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"1\"} 4\n```\n\n----------------------------------------\n\nTITLE: Cleaning Up Datadog Agent E2E Test Environment\nDESCRIPTION: Command to clean up and reset the Pulumi stack configuration, state, and resources for the Datadog Agent E2E test environment.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/orchestrator/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e new-e2e-tests.clean -s\n```\n\n----------------------------------------\n\nTITLE: Displaying REST Client Request Latency Metrics in Prometheus Format\nDESCRIPTION: Histogram metrics showing REST client request latency in seconds across different HTTP verbs. The metrics include latency distribution in buckets as well as sum and count values for each HTTP verb (DELETE, GET, PATCH, POST, PUT) against the same URL endpoint.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_32\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE rest_client_request_latency_seconds histogram\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.004\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.008\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.016\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.032\"} 1\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.064\"} 1\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.128\"} 2\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.256\"} 3\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.512\"} 3\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"+Inf\"} 3\nrest_client_request_latency_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\"} 0.32611697500000003\nrest_client_request_latency_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\"} 3\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.001\"} 50\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.002\"} 3129\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.004\"} 8172\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.008\"} 8688\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.016\"} 8795\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.032\"} 8845\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.064\"} 8876\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.128\"} 8901\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.256\"} 8921\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.512\"} 8931\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"+Inf\"} 9063\nrest_client_request_latency_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\"} 585.2233559799982\nrest_client_request_latency_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\"} 9063\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.002\"} 1\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.004\"} 106\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.008\"} 715\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.016\"} 860\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.032\"} 899\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.064\"} 927\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.128\"} 945\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.256\"} 957\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.512\"} 963\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"+Inf\"} 1063\nrest_client_request_latency_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\"} 674.8700161060033\nrest_client_request_latency_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\"} 1063\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.001\"} 5\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.002\"} 314\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.004\"} 599\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.008\"} 648\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.016\"} 670\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.032\"} 675\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.064\"} 688\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.128\"} 695\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.256\"} 698\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.512\"} 703\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"+Inf\"} 722\nrest_client_request_latency_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\"} 89.41131052000009\nrest_client_request_latency_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\"} 722\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.002\"} 17\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.004\"} 2044\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.008\"} 4081\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.016\"} 4251\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.032\"} 4287\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.064\"} 4299\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.128\"} 4307\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.256\"} 4313\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.512\"} 4321\nrest_client_request_latency_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"+Inf\"} 4395\nrest_client_request_latency_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\"} 370.35423456099863\nrest_client_request_latency_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\"} 4395\n```\n\n----------------------------------------\n\nTITLE: Recording Container Memory Failure Counts in Prometheus\nDESCRIPTION: This snippet shows multiple entries of the container_memory_failcnt metric for various containers and pods. Each entry includes labels for container details, namespace, and pod name, along with the failure count and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_15\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_memory_failcnt{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_memory_failcnt{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_memory_failcnt{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_memory_failcnt{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_memory_failcnt{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet HTTP Request Duration Metrics in Prometheus Format\nDESCRIPTION: Prometheus metric data showing HTTP request duration histograms for the kubelet. The metrics capture response times for various API endpoints with different request types and path combinations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_18\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.05\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.1\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.25\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.5\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"1\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"2.5\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"5\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"10\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"+Inf\"} 80931\nkubelet_http_requests_duration_seconds_sum{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\"} 0.17157756499999818\nkubelet_http_requests_duration_seconds_count{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.005\"} 1\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.01\"} 1\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.025\"} 1\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.05\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.1\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.25\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"0.5\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"1\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"2.5\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"5\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"10\"} 2\nkubelet_http_requests_duration_seconds_bucket{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\",le=\"+Inf\"} 2\nkubelet_http_requests_duration_seconds_sum{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\"} 0.026255317\nkubelet_http_requests_duration_seconds_count{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\"} 2\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for IMDS Event Serialization\nDESCRIPTION: This snippet defines the schema for serializing Instance Metadata Service (IMDS) events, including cloud provider information and AWS-specific data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_4\n\nLANGUAGE: JSON\nCODE:\n```\n\"IMDSEvent\": {\n    \"properties\": {\n        \"type\": {\n            \"type\": \"string\",\n            \"description\": \"type is the type of IMDS event\"\n        },\n        \"cloud_provider\": {\n            \"type\": \"string\",\n            \"description\": \"cloud_provider is the intended cloud provider of the IMDS event\"\n        },\n        \"url\": {\n            \"type\": \"string\",\n            \"description\": \"url is the url of the IMDS request\"\n        },\n        \"host\": {\n            \"type\": \"string\",\n            \"description\": \"host is the host of the HTTP protocol\"\n        },\n        \"user_agent\": {\n            \"type\": \"string\",\n            \"description\": \"user_agent is the user agent of the HTTP client\"\n        },\n        \"server\": {\n            \"type\": \"string\",\n            \"description\": \"server is the server header of a response\"\n        },\n        \"aws\": {\n            \"$ref\": \"#/$defs/AWSIMDSEvent\",\n            \"description\": \"AWS holds the AWS specific data parsed from the IMDS event\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"type\",\n        \"cloud_provider\"\n    ],\n    \"description\": \"IMDSEventSerializer serializes an IMDS event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining IMDS Event Schema in JSON\nDESCRIPTION: JSON schema for serializing Instance Metadata Service (IMDS) events with cloud provider information and HTTP request details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_31\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"type\": {\n            \"type\": \"string\",\n            \"description\": \"type is the type of IMDS event\"\n        },\n        \"cloud_provider\": {\n            \"type\": \"string\",\n            \"description\": \"cloud_provider is the intended cloud provider of the IMDS event\"\n        },\n        \"url\": {\n            \"type\": \"string\",\n            \"description\": \"url is the url of the IMDS request\"\n        },\n        \"host\": {\n            \"type\": \"string\",\n            \"description\": \"host is the host of the HTTP protocol\"\n        },\n        \"user_agent\": {\n            \"type\": \"string\",\n            \"description\": \"user_agent is the user agent of the HTTP client\"\n        },\n        \"server\": {\n            \"type\": \"string\",\n            \"description\": \"server is the server header of a response\"\n        },\n        \"aws\": {\n            \"$ref\": \"#/$defs/AWSIMDSEvent\",\n            \"description\": \"AWS holds the AWS specific data parsed from the IMDS event\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"type\",\n        \"cloud_provider\"\n    ],\n    \"description\": \"IMDSEventSerializer serializes an IMDS event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Disabling Process-Agent Service\nDESCRIPTION: Shows how to disable the process-agent service using s6-svc and verify its disabled status.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/SUPERVISION.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ns6-svc -d /var/run/s6/services/process/\ns6-svstat /var/run/s6/services/process/\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent Package in Windows Docker Container\nDESCRIPTION: This PowerShell command runs the Omnibus build task for the Datadog Agent in a Windows Docker container. It mounts the current directory and sets environment variables for the build.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_omnibus.md#2025-04-22_snippet_4\n\nLANGUAGE: powershell\nCODE:\n```\ndocker run -v \"$(Get-Location):c:\\mnt\" -e OMNIBUS_TARGET=main -e RELEASE_VERSION=nightly -e MAJOR_VERSION=7 -e TARGET_ARCH=x64 datadog/agent-buildimages-windows_x64:1809 powershell -C \"c:\\mnt\\tasks\\winbuildscripts\\Build-AgentPackages.ps1 -BuildOutOfSource 1 -InstallDeps 1 -CheckGoVersion 1\"\n```\n\n----------------------------------------\n\nTITLE: Example Inventory Payload Structure in JSON\nDESCRIPTION: Complete example of an inventory payload showing the structure including hostname, metadata, configurations, and timestamps. The payload contains agent configuration details with sensitive information scrubbed for security.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/metadata/inventoryotel/README.md#2025-04-22_snippet_0\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"hostname\": \"COMP-GQ7WQN6HYC\",\n    \"otel_metadata\": {\n        \"command\": \"otelcol\",\n        \"description\": \"foo bar\",\n        \"version\": \"1.0.0\",\n        \"extension_version\": \"1.0.0\",\n        \"customer_configuration\": \"\\nreceivers:\\n  prometheus:\\n    config:\\n      scrape_configs:\\n        - job_name: \\\"otelcol\\\"\\n          scrape_interval: 60s\\n          static_configs:\\n            - targets: [\\\"0.0.0.0:8888\\\"]\\n          metric_relabel_configs:\\n            - source_labels: [__name__]\\n              regex: \\\".*grpc_io.*\\\"\\n              action: drop\\n  otlp:\\n    protocols:\\n      grpc:\\n http:\\nexporters:\\n  datadog:\\n    api:\\n      key: $DD_API_KEY\\nservice:\\n  pipelines:\\n    traces:\\n      receivers: [otlp]\\n      exporters: [datadog]\\n    metrics:\\n      receivers: [otlp, prometheus]\\n      exporters: [datadog]\\n    logs:\\n      receivers: [otlp]\\n      exporters: [datadog]\",\n        \"enabled\": true,\n        \"environment_configuration\": \"\",\n        \"runtime_configuration\": \"\\nreceivers:\\n  prometheus:\\n    config:\\n      scrape_configs:\\n        - job_name: \\\"otelcol\\\"\\n          scrape_interval: 60s\\n          static_configs:\\n            - targets: [\\\"0.0.0.0:8888\\\"]\\n          metric_relabel_configs:\\n            - source_labels: [__name__]\\n              regex: \\\".*grpc_io.*\\\"\\n              action: drop\\n  otlp:\\n    protocols:\\n      grpc:\\n http:\\nexporters:\\n  datadog:\\n    api:\\n      key: $DD_API_KEY\\nprocessors:\\n  tagenrich:\\n  batch:\\n    timeout: 10s\\nconnectors:\\n  datadog/connector:\\n\\tcompute_stats_by_span_kind: true\\n\\tpeer_tags_aggregation: true\\nservice:\\n  pipelines:\\n    traces:\\n      receivers: [otlp]\\n      processors: [batch,tagenrich]\\n      exporters: [datadog/connector,datadog]\\n    metrics:\\n      receivers: [otlp, prometheus,datadog/connector]\\n      processors: [batch,tagenrich]\\n      exporters: [datadog]\\n    logs:\\n      receivers: [otlp]\\n      processors: [batch,tagenrich]\\n      exporters: [datadog]\",\n        \"runtime_override_configuration\": \"\"\n    },\n    \"timestamp\": 1716985696922603000,\n    \"uuid\": \"eee7bdc9-93ce-5938-91c3-7643d7ba7674\"\n}\n```\n\n----------------------------------------\n\nTITLE: Running the RtLoader Demo on Unix with Python 2\nDESCRIPTION: Command to run the RtLoader demo application on Unix systems with Python 2, setting the library path appropriately.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/README.md#2025-04-22_snippet_2\n\nLANGUAGE: sh\nCODE:\n```\nLD_LIBRARY_PATH=./three:./two ./demo/demo 2 $VIRTUAL_ENV\n```\n\n----------------------------------------\n\nTITLE: Exporting API Server Audit Event Metrics in Prometheus Format\nDESCRIPTION: This snippet defines a counter metric for tracking the total number of audit events generated and sent to the audit backend by the Kubernetes API server.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_0\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP apiserver_audit_event_total Counter of audit events generated and sent to the audit backend.\n# TYPE apiserver_audit_event_total counter\napiserver_audit_event_total 0\n```\n\n----------------------------------------\n\nTITLE: Installing Python 3.12 on macOS with Homebrew\nDESCRIPTION: Command to install Python 3.12 using Homebrew on macOS. This version includes all necessary development files for building the Datadog Agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nbrew install python@3.12\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Pod Start Latency Metrics in Prometheus\nDESCRIPTION: This snippet defines metrics for the latency in microseconds for a single pod to go from pending to running. It includes summary statistics for different quantiles, sum, and count.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_13\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_start_latency_microseconds Latency in microseconds for a single pod to go from pending to running. Broken down by podname.\n# TYPE kubelet_pod_start_latency_microseconds summary\nkubelet_pod_start_latency_microseconds{quantile=\"0.5\"} 3.196738e+06\nkubelet_pod_start_latency_microseconds{quantile=\"0.9\"} 3.343591e+06\nkubelet_pod_start_latency_microseconds{quantile=\"0.99\"} 5.710003e+06\nkubelet_pod_start_latency_microseconds_sum 7.5408037e+07\nkubelet_pod_start_latency_microseconds_count 33\n```\n\n----------------------------------------\n\nTITLE: Docker Run Command\nDESCRIPTION: Command to start the fakeintake docker container\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndocker run -i datadog/fakeintake\n```\n\n----------------------------------------\n\nTITLE: Adding a Test Case to a Suite in PowerShell\nDESCRIPTION: Shows how to add a test case to an existing suite using the Case keyword. Test cases are executed sequentially in the order they are defined.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/windows/DatadogAgentInstaller/QA/README.md#2025-04-22_snippet_2\n\nLANGUAGE: powershell\nCODE:\n```\nSuite \"My new test suite\" {\n    Case \"test case 1\" {\n\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Tracking Storage Operation Status in Kubernetes\nDESCRIPTION: This snippet shows Prometheus metrics for tracking the status of various storage operations in Kubernetes. It counts successful operations for different volume plugins and operation types, such as verifying controller-attached volumes and mounting/unmounting volumes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_37\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP storage_operation_status_count Storage operation return statuses count\n# TYPE storage_operation_status_count counter\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 3\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 6\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 35\nstorage_operation_status_count{operation_name=\"verify_controller_attached_volume\",status=\"success\",volume_plugin=\"kubernetes.io/secret\"} 10\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 1773\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 6\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 35\nstorage_operation_status_count{operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/secret\"} 3544\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 3\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 15\nstorage_operation_status_count{operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/secret\"} 3\n```\n\n----------------------------------------\n\nTITLE: Container CPU System Time Metrics in Prometheus Exposition Format\nDESCRIPTION: This snippet shows container_cpu_system_seconds_total metrics in Prometheus exposition format. The metrics represent cumulative CPU system time consumed by various containers running in a Kubernetes cluster. Each metric includes labels identifying the container, pod, namespace, and image information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_5\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_cpu_system_seconds_total counter\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1006.86 1572450197572\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 704.24 1572450197668\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 135.02 1572450196297\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 115.91 1572450199385\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0.01 1572450186377\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 19.13 1572450198309\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0.01 1572450196497\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 451.01 1572450196733\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 9.98 1572450196475\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0.02 1572450195152\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 276.01 1572450186468\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 56.7 1572450195355\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0.04 1572450197313\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 98.14 1572450190363\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 10 1572450201420\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0.02 1572450188256\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 3.7 1572450195286\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 114.39 1572450190276\ncontainer_cpu_system_seconds_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0.02 1572450189944\ncontainer_cpu_system_seconds_total{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 9.96 1572450198917\ncontainer_cpu_system_seconds_total{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 56.67 1572450196388\ncontainer_cpu_system_seconds_total{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 114.45 1572450197849\ncontainer_cpu_system_seconds_total{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 115.91 1572450202927\ncontainer_cpu_system_seconds_total{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 3.65 1572450196671\ncontainer_cpu_system_seconds_total{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 276.03 1572450188597\ncontainer_cpu_system_seconds_total{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 98.14 1572450192433\ncontainer_cpu_system_seconds_total{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 19.12 1572450197292\ncontainer_cpu_system_seconds_total{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 9.98 1572450195713\n# HELP container_cpu_usage_seconds_total Cumulative cpu time consumed in seconds.\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Task States in Kubernetes\nDESCRIPTION: Prometheus metrics showing container process states across different pods in a Kubernetes cluster. Each metric includes container details, namespace information, and process state with a timestamp. The metrics cover states like running, sleeping, stopped, iowaiting, and uninterruptible.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_57\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"running\"} 0 1572450201420\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"sleeping\"} 0 1572450201420\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"stopped\"} 0 1572450201420\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"uninterruptible\"} 0 1572450201420\n```\n\n----------------------------------------\n\nTITLE: Cloning Datadog Agent Repository\nDESCRIPTION: Git commands to clone the Datadog Agent repository and navigate to the google-marketplace directory. This is a prerequisite for command-line installation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/google-marketplace/README.md#2025-04-22_snippet_1\n\nLANGUAGE: shell\nCODE:\n```\ngit clone git@github.com:DataDog/datadog-agent.git\ncd google-marketplace\n```\n\n----------------------------------------\n\nTITLE: Using GDB with Datadog Agent's Python Interpreter\nDESCRIPTION: This example shows how to use GDB to debug the embedded Python interpreter in the Datadog Agent, including attaching to a process and using the pystack macro.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/tools.md#2025-04-22_snippet_4\n\nLANGUAGE: sh\nCODE:\n```\nsudo ./gdb --pid <pid>\ninfo threads\nthread <number> # switch to thread\npystack # python stacktrace of current thread\n```\n\n----------------------------------------\n\nTITLE: Running the Datadog Agent on Windows\nDESCRIPTION: Command to start the compiled Datadog Agent on a Windows VM, specifying a configuration file path.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/logs/launchers/windowsevent/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nagent.exe start -c agent-conf\\datadog.yaml\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet PLEG Relist Latency Metrics in Prometheus\nDESCRIPTION: This snippet defines metrics for the latency in microseconds for relisting pods in PLEG. It includes summary statistics for different quantiles, sum, and count.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_12\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pleg_relist_latency_microseconds Latency in microseconds for relisting pods in PLEG.\n# TYPE kubelet_pleg_relist_latency_microseconds summary\nkubelet_pleg_relist_latency_microseconds{quantile=\"0.5\"} 13117\nkubelet_pleg_relist_latency_microseconds{quantile=\"0.9\"} 19795\nkubelet_pleg_relist_latency_microseconds{quantile=\"0.99\"} 381714\nkubelet_pleg_relist_latency_microseconds_sum 7.54184e+06\nkubelet_pleg_relist_latency_microseconds_count 286\n```\n\n----------------------------------------\n\nTITLE: Exposing Go Memory Statistics Metrics in Prometheus Format\nDESCRIPTION: This snippet exposes various Go memory statistics as Prometheus metrics. It includes counters and gauges for allocated bytes, garbage collection, heap usage, and other memory-related metrics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_5\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP go_memstats_alloc_bytes_total Total number of bytes allocated, even if freed.\n# TYPE go_memstats_alloc_bytes_total counter\ngo_memstats_alloc_bytes_total 1.1343472622544e+13\n# HELP go_memstats_buck_hash_sys_bytes Number of bytes used by the profiling bucket hash table.\n# TYPE go_memstats_buck_hash_sys_bytes gauge\ngo_memstats_buck_hash_sys_bytes 7.81763e+06\n# HELP go_memstats_frees_total Total number of frees.\n# TYPE go_memstats_frees_total counter\ngo_memstats_frees_total 8.2678552226e+10\n# HELP go_memstats_gc_cpu_fraction The fraction of this program's available CPU time used by the GC since the program started.\n# TYPE go_memstats_gc_cpu_fraction gauge\ngo_memstats_gc_cpu_fraction 0.003314326552459238\n# HELP go_memstats_gc_sys_bytes Number of bytes used for garbage collection system metadata.\n# TYPE go_memstats_gc_sys_bytes gauge\ngo_memstats_gc_sys_bytes 8.788576e+06\n```\n\n----------------------------------------\n\nTITLE: Installing Deva CLI Tool for Datadog Agent Development\nDESCRIPTION: Shell commands to download, make executable, and run the Deva CLI tool for managing the Datadog Agent development environment.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_2\n\nLANGUAGE: shell\nCODE:\n```\ncd datadog-agent\ncurl -L -o deva https://github.com/DataDog/datadog-agent-devtools/releases/download/deva-v1.0.0/deva-aarch64-unknown-linux-gnu-1.0.0\nchmod +x deva\n./deva linter.go\n```\n\n----------------------------------------\n\nTITLE: Prometheus Kubelet Volume Statistics Metrics\nDESCRIPTION: This snippet contains Prometheus metrics for kubelet volume statistics, including available bytes, capacity bytes, and inode information for persistent volume claims. The metrics are labeled with namespace and persistentvolumeclaim identifiers to track volume usage across different pods and namespaces.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_21\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_volume_stats_available_bytes Number of available bytes in the volume\n# TYPE kubelet_volume_stats_available_bytes gauge\nkubelet_volume_stats_available_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 9.785049088e+10\nkubelet_volume_stats_available_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 9.8636845056e+10\nkubelet_volume_stats_available_bytes{namespace=\"default\",persistentvolumeclaim=\"www-web-2\"} 9.785049088e+10\nkubelet_volume_stats_available_bytes{namespace=\"default\",persistentvolumeclaim=\"www2-web-3\"} 9.8636845056e+10\nkubelet_volume_stats_available_bytes{namespace=\"default\",persistentvolumeclaim=\"web-2-ephemeralvolume\"} 9.8636845056e+10\n# HELP kubelet_volume_stats_capacity_bytes Capacity in bytes of the volume\n# TYPE kubelet_volume_stats_capacity_bytes gauge\nkubelet_volume_stats_capacity_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 1.05555197952e+11\nkubelet_volume_stats_capacity_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 1.05555197952e+11\nkubelet_volume_stats_capacity_bytes{namespace=\"default\",persistentvolumeclaim=\"www-web-2\"} 1.05555197952e+11\nkubelet_volume_stats_capacity_bytes{namespace=\"default\",persistentvolumeclaim=\"www2-web-3\"} 1.05555197952e+11\nkubelet_volume_stats_capacity_bytes{namespace=\"default\",persistentvolumeclaim=\"web-2-ephemeralvolume\"} 1.05555197952e+11\n# HELP kubelet_volume_stats_inodes Maximum number of inodes in the volume\n# TYPE kubelet_volume_stats_inodes gauge\nkubelet_volume_stats_inodes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 6.5536e+06\nkubelet_volume_stats_inodes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 6.5536e+06\nkubelet_volume_stats_inodes{namespace=\"default\",persistentvolumeclaim=\"www-web-2\"} 6.5536e+06\nkubelet_volume_stats_inodes{namespace=\"default\",persistentvolumeclaim=\"www2-web-3\"} 6.5536e+06\nkubelet_volume_stats_inodes{namespace=\"default\",persistentvolumeclaim=\"web-2-ephemeralvolume\"} 6.5536e+06\n```\n\n----------------------------------------\n\nTITLE: Executing PowerShell Script with Common Parameters\nDESCRIPTION: Demonstrates how to run a PowerShell build script with common parameters provided by the Invoke-BuildScript function. These parameters control dependency installation, out-of-source builds, and Go version checking.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/winbuildscripts/README.md#2025-04-22_snippet_0\n\nLANGUAGE: PowerShell\nCODE:\n```\nGet-Help <script>\n<script> -BuildOutOfSource $true -InstallDeps $true -CheckGoVersion $true\n```\n\n----------------------------------------\n\nTITLE: Running Unit Tests with Fake API\nDESCRIPTION: Command to run unit tests for the Windows Event Log package using the Fake API, which avoids modifying the host event logs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/util/winutil/eventlog/README.md#2025-04-22_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\ngo test ./...\n```\n\n----------------------------------------\n\nTITLE: Defining Client Certificate Expiration Histogram in Prometheus\nDESCRIPTION: This snippet defines a histogram metric for the remaining lifetime of certificates used to authenticate requests. It provides insight into certificate expiration patterns.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_1\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP apiserver_client_certificate_expiration_seconds [ALPHA] Distribution of the remaining lifetime on the certificate used to authenticate a request.\n# TYPE apiserver_client_certificate_expiration_seconds histogram\napiserver_client_certificate_expiration_seconds_bucket{le=\"0\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"1800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"3600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"7200\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"21600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"43200\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"86400\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"172800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"345600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"604800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"2.592e+06\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"7.776e+06\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"1.5552e+07\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"3.1104e+07\"} 3\napiserver_client_certificate_expiration_seconds_bucket{le=\"+Inf\"} 3\napiserver_client_certificate_expiration_seconds_sum 9.208450152179563e+07\napiserver_client_certificate_expiration_seconds_count 3\n```\n\n----------------------------------------\n\nTITLE: Reporting Container CPU Throttled Periods in Prometheus Format\nDESCRIPTION: This snippet defines and reports the 'container_cpu_cfs_throttled_periods_total' metric, which counts the number of throttled CPU period intervals for containers. It includes labels for container, pod, namespace, and image details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_2\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_cpu_cfs_throttled_periods_total Number of throttled period intervals.\n# TYPE container_cpu_cfs_throttled_periods_total counter\ncontainer_cpu_cfs_throttled_periods_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 1455 1572450195286\ncontainer_cpu_cfs_throttled_periods_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 26566 1572450190276\ncontainer_cpu_cfs_throttled_periods_total{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 26467 1572450197849\ncontainer_cpu_cfs_throttled_periods_total{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 1459 1572450196671\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubelet HTTP Request Durations with Prometheus Histogram Metrics\nDESCRIPTION: This code snippet contains Prometheus histogram metrics tracking HTTP request durations to the kubelet API server. The metrics are organized in buckets representing different duration thresholds (from 0.005s to +Inf) and include sum and count values. The data is labeled by request path, method, server type, and whether the request is long-running.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_17\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_http_requests_duration_seconds histogram\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.005\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.01\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.025\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.05\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.1\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.25\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"0.5\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"1\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"2.5\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"5\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"10\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\",le=\"+Inf\"} 80930\nkubelet_http_requests_duration_seconds_sum{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\"} 0.1805992630000022\nkubelet_http_requests_duration_seconds_count{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\"} 80930\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.005\"} 81833\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.01\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.025\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.05\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.1\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.25\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"0.5\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"1\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"2.5\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"5\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"10\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\",le=\"+Inf\"} 81834\nkubelet_http_requests_duration_seconds_sum{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\"} 0.19522247999999737\nkubelet_http_requests_duration_seconds_count{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\"} 81834\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.005\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.01\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.025\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.05\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.1\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.25\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"0.5\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"1\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"2.5\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"5\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"10\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\",le=\"+Inf\"} 80931\nkubelet_http_requests_duration_seconds_sum{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\"} 0.1777525749999991\nkubelet_http_requests_duration_seconds_count{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.005\"} 80936\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.01\"} 80936\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.025\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.05\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.1\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.25\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"0.5\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"1\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"2.5\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"5\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"10\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\",le=\"+Inf\"} 80937\nkubelet_http_requests_duration_seconds_sum{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\"} 0.19166370999999868\nkubelet_http_requests_duration_seconds_count{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\"} 80937\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.005\"} 645290\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.01\"} 645291\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.025\"} 645291\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.05\"} 645291\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.1\"} 645291\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.25\"} 645291\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"0.5\"} 645291\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"1\"} 645292\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"2.5\"} 645292\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"5\"} 645292\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"10\"} 645292\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\",le=\"+Inf\"} 645292\nkubelet_http_requests_duration_seconds_sum{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\"} 2.4263850849999806\nkubelet_http_requests_duration_seconds_count{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\"} 645292\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.005\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.01\"} 80931\nkubelet_http_requests_duration_seconds_bucket{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\",le=\"0.025\"} 80931\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Filesystem Write Operations in Prometheus Format\nDESCRIPTION: Prometheus metrics data showing container_fs_writes_total counter metrics for various containers and pods in a Kubernetes cluster. The metrics track cumulative filesystem write operations across different devices, containers, and pods with associated timestamps.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_11\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_fs_writes_total Cumulative count of writes completed\n# TYPE container_fs_writes_total counter\ncontainer_fs_writes_total{container=\"\",device=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_writes_total{container=\"\",device=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_fs_writes_total{container=\"\",device=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_fs_writes_total{container=\"\",device=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450198309\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 235 1572450197572\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450195286\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450190276\ncontainer_fs_writes_total{container=\"\",device=\"/dev/sda1\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 226615 1572450197572\ncontainer_fs_writes_total{container=\"\",device=\"overlay\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_writes_total{container=\"\",device=\"shm\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_writes_total{container=\"\",device=\"tmpfs\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_fs_writes_total{container=\"datadog-agent\",device=\"/dev/sda\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 17626 1572450197849\ncontainer_fs_writes_total{container=\"etcd\",device=\"/dev/sda\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 177104 1572450202927\ncontainer_fs_writes_total{container=\"kindnet-cni\",device=\"/dev/sda\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 1 1572450196671\ncontainer_fs_writes_total{container=\"kube-proxy\",device=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450197292\n# HELP container_last_seen Last time a container was seen by the exporter\n```\n\n----------------------------------------\n\nTITLE: Defining SELinuxBoolChange JSON Schema for SELinux Boolean Operations\nDESCRIPTION: JSON schema definition for the SELinuxBoolChange structure, which represents a change to an SELinux boolean setting. It captures the name of the boolean and its new state (on/off).\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_44\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"SELinux boolean name\"\n        },\n        \"state\": {\n            \"type\": \"string\",\n            \"description\": \"SELinux boolean state ('on' or 'off')\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SELinuxBoolChangeSerializer serializes a SELinux boolean change to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Adding New Products to Remote Config Go Client\nDESCRIPTION: Instructions for extending the Remote Config Go client by adding new products to the 'products.go' file. New products should be added as constants and included in the 'validProducts' set.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/remoteconfig/state/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Remote Config Go client\n\nThis package powers the Remote Config client shipped in the Go tracer and in all the agent processes (core-agent, trace-agent, system-probe, ...).\n\nTo add a new product simply add it to `products.go` as a constant and in the `validProducts` set.\n```\n\n----------------------------------------\n\nTITLE: Configuring Datadog Agent URLs in Windows Installation\nDESCRIPTION: These command-line options allow setting various URL configurations in the datadog.yaml file during the Windows installation process. They are typically used only when requested by Datadog Support.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/resources/iot/msi/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n* DD_URL=\"_string_\"\n  * Sets the **dd_url** variable in datadog.yaml to _string_.\n* LOGS_DD_URL=\"_string_\"\n  * Sets the **logs_dd_url** variable in the **logs_config** section in datadog.yaml to _string_ . _string_ has to be of the form `<endpoint>:<format>`, for example `agent-intake.logs.datadoghq.com:443`.\n* PROCESS_DD_URL=\"_string_\"\n  * Sets the **process_dd_url** variable in the **process_config** section in datadog.yaml to _string_.\n* TRACE_DD_URL=\"_string_\"\n  * Sets the **apm_dd_url** variable in the **apm_config** section in datadog.yaml to _string_.\n```\n\n----------------------------------------\n\nTITLE: Initializing CMake Project for Datadog Agent RTLoader\nDESCRIPTION: Sets up the CMake project for the Datadog Agent RTLoader, specifying the minimum CMake version, project name, version, and description. It also includes GNUInstallDirs for standard installation directories.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/rtloader/CMakeLists.txt#2025-04-22_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\ncmake_minimum_required(VERSION 3.15)\n\nproject(datadog-agent-rtloader VERSION 0.1.0 DESCRIPTION \"CPython backend for the Datadog Agent\")\ninclude(GNUInstallDirs)\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubelet Node Status and PLEG Metrics in Prometheus Format\nDESCRIPTION: Prometheus metrics for kubelet node status and Pod Lifecycle Event Generator (PLEG) operation. These metrics track node configuration errors, node identity, and PLEG events and timestamps.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_22\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_node_config_error [ALPHA] This metric is true (1) if the node is experiencing a configuration-related error, false (0) otherwise.\n# TYPE kubelet_node_config_error gauge\nkubelet_node_config_error 0\n# HELP kubelet_node_name [ALPHA] The node's name. The count is always 1.\n# TYPE kubelet_node_name gauge\nkubelet_node_name{node=\"ip-172-29-240-188.ec2.internal\"} 1\n# HELP kubelet_pleg_discard_events [ALPHA] The number of discard events in PLEG.\n# TYPE kubelet_pleg_discard_events counter\nkubelet_pleg_discard_events 0\n# HELP kubelet_pleg_last_seen_seconds [ALPHA] Timestamp in seconds when PLEG was last seen active.\n# TYPE kubelet_pleg_last_seen_seconds gauge\nkubelet_pleg_last_seen_seconds 1.648119277e+09\n# HELP kubelet_pleg_relist_duration_seconds [ALPHA] Duration in seconds for relisting pods in PLEG.\n```\n\n----------------------------------------\n\nTITLE: Configuring Module Replace Directive in Go\nDESCRIPTION: Example of adding a replace directive in the main go.mod file to specify local module path.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/modules.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\n// main go.mod file\nreplace (\n    github.com/DataDog/datadog-agent/path/to/module => ./path/to/module\n)\n```\n\n----------------------------------------\n\nTITLE: Monitoring Process Metrics in Prometheus Format\nDESCRIPTION: This snippet shows process-level metrics including CPU usage, memory usage, and file descriptor information. These metrics help monitor the resource usage of the Kubernetes processes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_24\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.\n# TYPE process_cpu_seconds_total counter\nprocess_cpu_seconds_total 18.92\n# HELP process_max_fds Maximum number of open file descriptors.\n# TYPE process_max_fds gauge\nprocess_max_fds 1e+06\n# HELP process_open_fds Number of open file descriptors.\n# TYPE process_open_fds gauge\nprocess_open_fds 37\n# HELP process_resident_memory_bytes Resident memory size in bytes.\n# TYPE process_resident_memory_bytes gauge\nprocess_resident_memory_bytes 1.35077888e+08\n# HELP process_start_time_seconds Start time of the process since unix epoch in seconds.\n# TYPE process_start_time_seconds gauge\nprocess_start_time_seconds 1.52336142619e+09\n# HELP process_virtual_memory_bytes Virtual memory size in bytes.\n# TYPE process_virtual_memory_bytes gauge\nprocess_virtual_memory_bytes 1.551613952e+09\n```\n\n----------------------------------------\n\nTITLE: Describing Fixtures Usage in Datadog Agent Testing (Markdown)\nDESCRIPTION: This markdown snippet explains that fixtures are curl dumps from requests to a fakeintake running on ddev. These fixtures are used in unit tests to ensure that payload parsing functions correctly.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/client/fixtures/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Fixtures\n\nFixtures are curl dump from requests to a fakeintake running on ddev. Used in unit test to validate payload parsing works as expected.\n```\n\n----------------------------------------\n\nTITLE: Defining Authentication Token Cache Metrics in Prometheus\nDESCRIPTION: This snippet defines several metrics related to authentication token caching, including active fetch counts, total fetches, and request durations. These metrics help monitor the performance of the token cache.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_2\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP authentication_token_cache_active_fetch_count [ALPHA]\n# TYPE authentication_token_cache_active_fetch_count gauge\nauthentication_token_cache_active_fetch_count{status=\"blocked\"} 0\nauthentication_token_cache_active_fetch_count{status=\"in_flight\"} 0\n# HELP authentication_token_cache_fetch_total [ALPHA]\n# TYPE authentication_token_cache_fetch_total counter\nauthentication_token_cache_fetch_total{status=\"ok\"} 13337\n# HELP authentication_token_cache_request_duration_seconds [ALPHA]\n# TYPE authentication_token_cache_request_duration_seconds histogram\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.005\"} 956217\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.01\"} 956234\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.025\"} 956240\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.05\"} 956240\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.1\"} 956240\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.25\"} 956240\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"0.5\"} 956243\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"1\"} 956243\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"2.5\"} 956243\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"5\"} 956243\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"10\"} 956243\nauthentication_token_cache_request_duration_seconds_bucket{status=\"hit\",le=\"+Inf\"} 956243\nauthentication_token_cache_request_duration_seconds_sum{status=\"hit\"} 1.6299999999999906\nauthentication_token_cache_request_duration_seconds_count{status=\"hit\"} 956243\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.005\"} 15\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.01\"} 3699\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.025\"} 13045\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.05\"} 13511\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.1\"} 13601\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.25\"} 13620\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"0.5\"} 13633\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"1\"} 13676\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"2.5\"} 13676\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"5\"} 13676\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"10\"} 13676\nauthentication_token_cache_request_duration_seconds_bucket{status=\"miss\",le=\"+Inf\"} 13676\nauthentication_token_cache_request_duration_seconds_sum{status=\"miss\"} 223.1349999999765\nauthentication_token_cache_request_duration_seconds_count{status=\"miss\"} 13676\n# HELP authentication_token_cache_request_total [ALPHA]\n# TYPE authentication_token_cache_request_total counter\nauthentication_token_cache_request_total{status=\"hit\"} 956243\nauthentication_token_cache_request_total{status=\"miss\"} 13676\n```\n\n----------------------------------------\n\nTITLE: Defining Storage Operation Duration Metric in Prometheus\nDESCRIPTION: This snippet defines a Prometheus metric 'storage_operation_duration_seconds' for measuring storage operation duration. It is marked as an ALPHA feature.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_49\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP storage_operation_duration_seconds [ALPHA] Storage operation duration\n```\n\n----------------------------------------\n\nTITLE: Reporting Container CPU User Seconds in Prometheus Format\nDESCRIPTION: This snippet shows the format for reporting container CPU user seconds as a Prometheus metric. It includes labels for container, id, image, name, namespace, and pod, along with the metric value and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_7\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_cpu_user_seconds_total counter\ncontainer_cpu_user_seconds_total{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 982.46 1572450197572\ncontainer_cpu_user_seconds_total{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 649.35 1572450197668\ncontainer_cpu_user_seconds_total{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 125.21 1572450196297\n```\n\n----------------------------------------\n\nTITLE: Disabling Python Linter Example\nDESCRIPTION: Example of using the noqa directive to disable specific linter warnings in Python code\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/linters.md#2025-04-22_snippet_1\n\nLANGUAGE: python\nCODE:\n```\n# noqa: error_code\n```\n\n----------------------------------------\n\nTITLE: Creating simple-v1 Datadog Package Archive\nDESCRIPTION: Command to create a simple-v1 Datadog Package archive for testing purposes. This generates a tar archive at 'pkg/fleet/installer/fixtures/oci-layout-simple-v1.tar' with configs from specified directories.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/fleet/installer/fixtures/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndatadog-package create --archive --version \"v1\" --archive-path \"pkg/fleet/installer/fixtures/oci-layout-simple-v1.tar\" --package \"simple\" --configs pkg/fleet/installer/fixtures/simple-v1-config pkg/fleet/installer/fixtures/simple-v1\n```\n\n----------------------------------------\n\nTITLE: Tracking Container Process Counts in Kubernetes with Prometheus\nDESCRIPTION: Prometheus metrics showing the number of processes running inside various Kubernetes containers. The metrics include detailed labels for container identification, image information, namespace, and pod name with corresponding timestamps.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_45\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_processes Number of processes running inside the container.\n# TYPE container_processes gauge\ncontainer_processes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_processes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_processes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_processes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_processes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_processes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450198309\ncontainer_processes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_processes{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196733\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450196475\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450186468\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450195355\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450190363\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450201420\ncontainer_processes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_processes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450195286\ncontainer_processes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_processes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450190276\ncontainer_processes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_processes{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450198917\ncontainer_processes{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450196388\ncontainer_processes{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450197849\ncontainer_processes{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450202927\ncontainer_processes{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196671\ncontainer_processes{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450188597\ncontainer_processes{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450192433\ncontainer_processes{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450197292\ncontainer_processes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450195713\n```\n\n----------------------------------------\n\nTITLE: Prometheus REST Client Request Totals\nDESCRIPTION: Counter metrics showing total HTTP requests to the Kubernetes API server, broken down by response code, HTTP method, and host.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_33\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP rest_client_requests_total Number of HTTP requests, partitioned by status code, method, and host.\n# TYPE rest_client_requests_total counter\nrest_client_requests_total{code=\"200\",host=\"127.0.0.1:8080\",method=\"DELETE\"} 1\nrest_client_requests_total{code=\"200\",host=\"127.0.0.1:8080\",method=\"GET\"} 168\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubelet Runtime Operations Duration Metrics in Prometheus\nDESCRIPTION: Prometheus metrics data showing the distribution of duration times for various kubelet runtime operations. The metrics use histogram buckets with different time thresholds (le values) along with sum and count aggregations for each operation type, providing insights into the performance characteristics of container runtime operations in Kubernetes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_32\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"119.20928955078125\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"298.0232238769531\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"745.0580596923828\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"+Inf\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"list_containers\"} 28684.79266433511\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"list_containers\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"0.005\"} 293877\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"0.0125\"} 311571\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"0.03125\"} 316506\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"0.078125\"} 316910\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"0.1953125\"} 316913\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"0.48828125\"} 316913\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"1.220703125\"} 316913\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"3.0517578125\"} 316913\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"7.62939453125\"} 316913\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"19.073486328125\"} 316913\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"47.6837158203125\"} 316914\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"119.20928955078125\"} 316914\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"298.0232238769531\"} 316914\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"745.0580596923828\"} 316914\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_images\",le=\"+Inf\"} 316914\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"list_images\"} 1003.6615808549896\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"list_images\"} 316914\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.005\"} 211903\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.0125\"} 2.366937e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.03125\"} 3.00452e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.078125\"} 3.097341e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.1953125\"} 3.098528e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"0.48828125\"} 3.098529e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"1.220703125\"} 3.09853e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"3.0517578125\"} 3.098531e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"7.62939453125\"} 3.098531e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"19.073486328125\"} 3.098531e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"47.6837158203125\"} 3.098533e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"119.20928955078125\"} 3.098533e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"298.0232238769531\"} 3.098533e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"745.0580596923828\"} 3.098533e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_podsandbox\",le=\"+Inf\"} 3.098533e+06\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"list_podsandbox\"} 34255.342850002235\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"list_podsandbox\"} 3.098533e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.005\"} 43\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.0125\"} 124\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.03125\"} 140\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.078125\"} 150\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.1953125\"} 157\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"0.48828125\"} 158\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"1.220703125\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"3.0517578125\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"7.62939453125\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"19.073486328125\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"47.6837158203125\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"119.20928955078125\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"298.0232238769531\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"745.0580596923828\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"podsandbox_status\",le=\"+Inf\"} 159\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"podsandbox_status\"} 3.6392912779999986\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"podsandbox_status\"} 159\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.0125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.03125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.078125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.1953125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"0.48828125\"} 1\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"1.220703125\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"3.0517578125\"} 5\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"7.62939453125\"} 6\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"19.073486328125\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"47.6837158203125\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"119.20928955078125\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"298.0232238769531\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"745.0580596923828\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"pull_image\",le=\"+Inf\"} 8\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"pull_image\"} 37.081004523999994\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"pull_image\"} 8\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.0125\"} 4\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.03125\"} 10\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.078125\"} 20\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.1953125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.48828125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"1.220703125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"3.0517578125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"7.62939453125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"19.073486328125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"47.6837158203125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"119.20928955078125\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"298.0232238769531\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"745.0580596923828\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"+Inf\"} 25\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"remove_container\"} 1.201232157\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"remove_container\"} 25\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.0125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.03125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"run_podsandbox\",le=\"0.078125\"} 0\n```\n\n----------------------------------------\n\nTITLE: Simple Module Configuration in YAML\nDESCRIPTION: Basic module configuration example with condition and OpenTelemetry usage flag.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/modules.md#2025-04-22_snippet_2\n\nLANGUAGE: yaml\nCODE:\n```\nmy/module:\n    condition: is_linux\n    used_by_otel: true\n```\n\n----------------------------------------\n\nTITLE: Counting Kubelet Evictions in Kubernetes\nDESCRIPTION: This metric tracks the cumulative number of pod evictions by eviction signal in Kubernetes. It uses a counter type to record evictions for different memory-related signals.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_39\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_evictions [ALPHA] Cumulative number of pod evictions by eviction signal\n# TYPE kubelet_evictions counter\nkubelet_evictions{eviction_signal=\"allocatableMemory.available\"} 3\nkubelet_evictions{eviction_signal=\"memory.available\"} 3\n```\n\n----------------------------------------\n\nTITLE: Stack Management and Resource Updates\nDESCRIPTION: Commands for destroying stacks and updating KMT resources.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.destroy-stack --stack=demo-stack\n\ndda inv -e kmt.update-resources\n```\n\n----------------------------------------\n\nTITLE: Describing Fixtures Usage in Datadog Agent Tests (Markdown)\nDESCRIPTION: This snippet explains the purpose and source of fixtures used in Datadog Agent unit tests. Fixtures are created from curl dumps of requests to a fakeintake running on ddev, and are used to ensure payload parsing functions correctly.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/aggregator/fixtures/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Fixtures\\n\\nFixtures are curl dump from requests to a fakeintake running on ddev. Used in unit test to validate payload parsing works as expected.\n```\n\n----------------------------------------\n\nTITLE: Exposing Kubelet Certificate Manager Metrics in Prometheus Format\nDESCRIPTION: This snippet exposes metrics related to the Kubelet's certificate manager. It includes a histogram for certificate rotation times and a gauge for the TTL of the Kubelet's serving certificate.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_6\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_certificate_manager_server_rotation_seconds [ALPHA] Histogram of the number of seconds the previous certificate lived before being rotated.\n# TYPE kubelet_certificate_manager_server_rotation_seconds histogram\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"60\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"3600\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"14400\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"86400\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"604800\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"2.592e+06\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"7.776e+06\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"1.5552e+07\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"3.1104e+07\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"1.24416e+08\"} 0\nkubelet_certificate_manager_server_rotation_seconds_bucket{le=\"+Inf\"} 0\nkubelet_certificate_manager_server_rotation_seconds_sum 0\nkubelet_certificate_manager_server_rotation_seconds_count 0\n# HELP kubelet_certificate_manager_server_ttl_seconds [ALPHA] Gauge of the shortest TTL (time-to-live) of the Kubelet's serving certificate. The value is in seconds until certificate expiry (negative if already expired). If serving certificate is invalid or unused, the value will be +INF.\n# TYPE kubelet_certificate_manager_server_ttl_seconds gauge\nkubelet_certificate_manager_server_ttl_seconds 2.9826981e+07\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Error Metrics\nDESCRIPTION: Counter metrics showing cumulative number of Docker operation errors by operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_14\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_errors_total [ALPHA] Cumulative number of Docker operation errors by operation type.\n# TYPE kubelet_docker_operations_errors_total counter\nkubelet_docker_operations_errors_total{operation_type=\"inspect_image\"} 20\n```\n\n----------------------------------------\n\nTITLE: Querying Container Network Transmit Packets Metrics in Prometheus\nDESCRIPTION: This snippet shows the structure of Prometheus metrics for container_network_transmit_packets_total. It includes labels for container ID, image, interface, name, namespace, and pod, along with the packet count and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_43\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_transmit_packets_total counter\ncontainer_network_transmit_packets_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 29273 1572450197572\ncontainer_network_transmit_packets_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_packets_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubelet Evictions in Prometheus\nDESCRIPTION: This snippet defines a counter metric for monitoring the cumulative number of pod evictions by eviction signal in Kubernetes. It tracks evictions due to memory pressure.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_58\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_evictions [ALPHA] Cumulative number of pod evictions by eviction signal\n# TYPE kubelet_evictions counter\nkubelet_evictions{eviction_signal=\"allocatableMemory.available\"} 3\nkubelet_evictions{eviction_signal=\"memory.available\"} 3\n```\n\n----------------------------------------\n\nTITLE: Defining SELinuxEvent JSON Schema for Security Events\nDESCRIPTION: JSON schema definition for the SELinuxEvent structure which encapsulates different types of SELinux operations including boolean changes, enforcement status changes, and boolean commits.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_47\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"bool\": {\n            \"$ref\": \"#/$defs/SELinuxBoolChange\",\n            \"description\": \"SELinux boolean operation\"\n        },\n        \"enforce\": {\n            \"$ref\": \"#/$defs/SELinuxEnforceStatus\",\n            \"description\": \"SELinux enforcement change\"\n        },\n        \"bool_commit\": {\n            \"$ref\": \"#/$defs/SELinuxBoolCommit\",\n            \"description\": \"SELinux boolean commit\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SELinuxEventSerializer serializes a SELinux context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Rebuilding Windows Installer for Datadog Agent using Batch Script\nDESCRIPTION: The 'rebuild.bat' script mimics the omnibus build process for the Datadog Agent Windows installer. It uses 'light' to create an XML representation of the directory structure and includes configuration files. The script generates a 7z file of the Python directory on first run and reuses it in subsequent executions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/resources/agent/msi/localbuild/README.md#2025-04-22_snippet_0\n\nLANGUAGE: batch\nCODE:\n```\nrebuild.bat\n```\n\n----------------------------------------\n\nTITLE: Prometheus Container CPU Quota Metrics in Kubernetes\nDESCRIPTION: A collection of container_spec_cpu_quota metrics showing CPU quota configuration for specific containers in a Kubernetes cluster. The metrics include pods with a CPU quota of 10000 microseconds, which represents their CPU resource limits.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_49\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_spec_cpu_quota CPU quota of the container.\n# TYPE container_spec_cpu_quota gauge\ncontainer_spec_cpu_quota{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 10000\ncontainer_spec_cpu_quota{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 10000\ncontainer_spec_cpu_quota{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 10000\ncontainer_spec_cpu_quota{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 10000\n# HELP container_spec_cpu_shares CPU share of the container.\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Runtime Operations Errors Metric in Prometheus\nDESCRIPTION: This snippet defines a counter metric for cumulative number of runtime operation errors by operation type. It shows an error count for container status operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_18\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations_errors Cumulative number of runtime operation errors by operation type.\n# TYPE kubelet_runtime_operations_errors counter\nkubelet_runtime_operations_errors{operation_type=\"container_status\"} 1\n```\n\n----------------------------------------\n\nTITLE: Measuring REST Client Request Durations for Kubernetes API Endpoints\nDESCRIPTION: These Prometheus metrics capture the duration of REST client requests to various Kubernetes API endpoints. The metrics are organized into histogram buckets, with labels for the specific API URL and HTTP verb used. This data is crucial for monitoring and optimizing API performance in a Kubernetes cluster.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_46\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/coordination.k8s.io/v1/namespaces/%7Bnamespace%7D/leases?timeout=10s\",verb=\"POST\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/coordination.k8s.io/v1/namespaces/%7Bnamespace%7D/leases?timeout=10s\",verb=\"POST\",le=\"0.002\"} 0\n# ... (truncated for brevity)\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/coordination.k8s.io/v1/namespaces/%7Bnamespace%7D/leases?timeout=10s\",verb=\"POST\"} 0.01379326\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/coordination.k8s.io/v1/namespaces/%7Bnamespace%7D/leases?timeout=10s\",verb=\"POST\"} 1\n\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/node.k8s.io/v1/runtimeclasses?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\n# ... (truncated for brevity)\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/node.k8s.io/v1/runtimeclasses?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.489505334\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/node.k8s.io/v1/runtimeclasses?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\n\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/node.k8s.io/v1/runtimeclasses?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\n# ... (truncated for brevity)\nrest_client_request_duration_seconds_sum{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/node.k8s.io/v1/runtimeclasses?resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.001449255\nrest_client_request_duration_seconds_count{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/node.k8s.io/v1/runtimeclasses?resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 1\n\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/storage.k8s.io/v1/csidrivers?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\n# ... (truncated for brevity)\n```\n\n----------------------------------------\n\nTITLE: Detailed Module Configuration in YAML\nDESCRIPTION: Extended module configuration example with independence flag and custom lint/build targets.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/modules.md#2025-04-22_snippet_3\n\nLANGUAGE: yaml\nCODE:\n```\nmy/module:\n    independent: false\n    lint_targets:\n    - ./pkg\n    - ./cmd\n    - ./comp\n    targets:\n    - ./pkg\n    - ./cmd\n    - ./comp\n```\n\n----------------------------------------\n\nTITLE: Capturing Kubelet Container Count Histogram Metrics in Prometheus Format\nDESCRIPTION: This snippet shows a histogram metric that tracks the number of containers per pod in Kubelet. It includes bucket data for different thresholds, along with sum and count values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_4\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_containers_per_pod_count histogram\nkubelet_containers_per_pod_count_bucket{le=\"0.005\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"0.01\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"0.025\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"0.05\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"0.1\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"0.25\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"0.5\"} 0\nkubelet_containers_per_pod_count_bucket{le=\"1\"} 15\nkubelet_containers_per_pod_count_bucket{le=\"2.5\"} 15\nkubelet_containers_per_pod_count_bucket{le=\"5\"} 15\nkubelet_containers_per_pod_count_bucket{le=\"10\"} 15\nkubelet_containers_per_pod_count_bucket{le=\"+Inf\"} 15\nkubelet_containers_per_pod_count_sum 15\nkubelet_containers_per_pod_count_count 15\n```\n\n----------------------------------------\n\nTITLE: Generating Random Contexts in CSV Format\nDESCRIPTION: Example of the CSV format used for storing random contexts. Each line contains a metric name followed by 1 to 5 random tags, all represented as UUID4 values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/aggregator/ckey/tests/README.md#2025-04-22_snippet_0\n\nLANGUAGE: csv\nCODE:\n```\n<metric_name>,<tag1> <tag2> ...\n```\n\n----------------------------------------\n\nTITLE: Defining Containers per Pod Count Histogram in Prometheus\nDESCRIPTION: This snippet defines a Prometheus histogram metric for the number of containers per pod. It includes bucket definitions, sum, and count, providing a distribution of container counts across pods in the cluster.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_9\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_containers_per_pod_count [ALPHA] The number of containers per pod.\n# TYPE kubelet_containers_per_pod_count histogram\nkubelet_containers_per_pod_count_bucket{le=\"1\"} 28\nkubelet_containers_per_pod_count_bucket{le=\"2\"} 28\nkubelet_containers_per_pod_count_bucket{le=\"4\"} 28\nkubelet_containers_per_pod_count_bucket{le=\"8\"} 30\nkubelet_containers_per_pod_count_bucket{le=\"16\"} 30\nkubelet_containers_per_pod_count_bucket{le=\"+Inf\"} 30\nkubelet_containers_per_pod_count_sum 38\nkubelet_containers_per_pod_count_count 30\n```\n\n----------------------------------------\n\nTITLE: Exporting CPU Manager Pinning Metrics in Prometheus\nDESCRIPTION: This snippet defines two Prometheus counter metrics related to CPU manager pinning. It tracks the number of failed pinning attempts and the total number of pinning requests, providing insights into CPU resource allocation efficiency.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_10\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_cpu_manager_pinning_errors_total [ALPHA] The number of cpu core allocations which required pinning failed.\n# TYPE kubelet_cpu_manager_pinning_errors_total counter\nkubelet_cpu_manager_pinning_errors_total 7\n# HELP kubelet_cpu_manager_pinning_requests_total [ALPHA] The number of cpu core allocations which required pinning.\n# TYPE kubelet_cpu_manager_pinning_requests_total counter\nkubelet_cpu_manager_pinning_requests_total 28\n```\n\n----------------------------------------\n\nTITLE: Defining AWS API Request Duration Histogram in Prometheus\nDESCRIPTION: This snippet defines a histogram metric for the latency of AWS API calls, specifically for the 'describe_instance' request. It provides insight into the performance of AWS API interactions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_3\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP cloudprovider_aws_api_request_duration_seconds [ALPHA] Latency of AWS API calls\n# TYPE cloudprovider_aws_api_request_duration_seconds histogram\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.005\"} 0\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.01\"} 0\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.025\"} 0\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.05\"} 1\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.1\"} 1\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.25\"} 2\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"0.5\"} 2\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"1\"} 2\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"2.5\"} 2\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"5\"} 2\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"10\"} 2\ncloudprovider_aws_api_request_duration_seconds_bucket{request=\"describe_instance\",le=\"+Inf\"} 2\ncloudprovider_aws_api_request_duration_seconds_sum{request=\"describe_instance\"} 0.193797672\ncloudprovider_aws_api_request_duration_seconds_count{request=\"describe_instance\"} 2\n```\n\n----------------------------------------\n\nTITLE: Configuring Cluster Agent capabilities in Go\nDESCRIPTION: Grant the CAP_NET_BIND_SERVICE capability to the cluster agent to allow binding to privileged ports.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_13\n\nLANGUAGE: go\nCODE:\n```\nGrant CAP_NET_BIND_SERVICE capability to the cluster_agent\n```\n\n----------------------------------------\n\nTITLE: Rebuilding Windows Dogstatsd Installer with Local Artifacts (Batch)\nDESCRIPTION: This batch script mimics the omnibus build process for the Windows Dogstatsd installer. It uses 'light' to create an XML representation of the directory structure and includes configuration files. The script allows for quick iteration and testing of the installer without a full omnibus build.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/resources/dogstatsd/msi/localbuild/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Batch\nCODE:\n```\nrebuild.bat\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Counter Metrics in Prometheus Format\nDESCRIPTION: Prometheus counter metrics showing the cumulative number of Docker operations performed by kubelet, broken down by operation type such as create_container, inspect_container, and pull_image.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_7\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations Cumulative number of Docker operations by operation type.\n# TYPE kubelet_docker_operations counter\nkubelet_docker_operations{operation_type=\"create_container\"} 33\nkubelet_docker_operations{operation_type=\"info\"} 2\nkubelet_docker_operations{operation_type=\"inspect_container\"} 264\nkubelet_docker_operations{operation_type=\"inspect_image\"} 158\nkubelet_docker_operations{operation_type=\"list_containers\"} 1242\nkubelet_docker_operations{operation_type=\"list_images\"} 40\nkubelet_docker_operations{operation_type=\"pull_image\"} 4\nkubelet_docker_operations{operation_type=\"remove_container\"} 5\nkubelet_docker_operations{operation_type=\"start_container\"} 33\nkubelet_docker_operations{operation_type=\"stop_container\"} 31\nkubelet_docker_operations{operation_type=\"version\"} 95\n```\n\n----------------------------------------\n\nTITLE: Deprecated Tag Retrieval Function in Python\nDESCRIPTION: Defines a deprecated function 'get_tags' for retrieving tags. Users are advised to use the 'tags()' function instead.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/builtins/tagger.md#2025-04-22_snippet_2\n\nLANGUAGE: python\nCODE:\n```\ndef get_tags():\n    \"\"\"Deprecated, use tags() instead\"\"\"\n```\n\n----------------------------------------\n\nTITLE: Kubernetes Storage API Request Duration Metrics\nDESCRIPTION: Prometheus histogram metrics measuring REST client request durations for Kubernetes Storage API endpoints. Includes request duration buckets, sums and counts for CSI driver and node operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_47\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/storage.k8s.io/v1/csidrivers?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/storage.k8s.io/v1/csidrivers?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 0\n# HELP rest_client_requests_total [ALPHA] Number of HTTP requests, partitioned by status code, method, and host.\n```\n\n----------------------------------------\n\nTITLE: Starting DogStatsD with environment variables\nDESCRIPTION: Command to start DogStatsD with API key provided as an environment variable alongside the configuration file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/dogstatsd/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nDD_API_KEY=XXX dogstatsd start -f datadog.yaml\n```\n\n----------------------------------------\n\nTITLE: Tracking Deprecated Kubelet Docker Operations Metrics in Prometheus Format\nDESCRIPTION: This snippet displays counter metrics for various Docker operations performed by Kubelet. The metrics are deprecated but still show counts for operations like create_container, inspect_container, list_containers, and others.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_5\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations (Deprecated) Cumulative number of Docker operations by operation type.\n# TYPE kubelet_docker_operations counter\nkubelet_docker_operations{operation_type=\"create_container\"} 51\nkubelet_docker_operations{operation_type=\"info\"} 2\nkubelet_docker_operations{operation_type=\"inspect_container\"} 381\nkubelet_docker_operations{operation_type=\"inspect_image\"} 414\nkubelet_docker_operations{operation_type=\"list_containers\"} 160127\nkubelet_docker_operations{operation_type=\"list_images\"} 7806\nkubelet_docker_operations{operation_type=\"pull_image\"} 5\nkubelet_docker_operations{operation_type=\"remove_container\"} 25\nkubelet_docker_operations{operation_type=\"start_container\"} 51\nkubelet_docker_operations{operation_type=\"stop_container\"} 15\nkubelet_docker_operations{operation_type=\"version\"} 13113\n# HELP kubelet_docker_operations_duration_seconds Latency in seconds of Docker operations. Broken down by operation type.\n```\n\n----------------------------------------\n\nTITLE: Defining BindEvent JSON Schema\nDESCRIPTION: JSON schema for serializing a bind event, including properties for the bound address and protocol.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_19\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"addr\": {\n            \"$ref\": \"#/$defs/IPPortFamily\",\n            \"description\": \"Bound address (if any)\"\n        },\n        \"protocol\": {\n            \"type\": \"string\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"addr\",\n        \"protocol\"\n    ],\n    \"description\": \"BindEventSerializer serializes a bind event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Run PodSandbox Duration Metrics in Prometheus Format\nDESCRIPTION: Alpha-level metrics tracking how long it takes to run a pod sandbox, broken down by runtime handler. The metrics show histograms for the default empty runtime handler with time buckets from 0.005 to +Inf seconds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_27\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_run_podsandbox_duration_seconds [ALPHA] Duration in seconds of the run_podsandbox operations. Broken down by RuntimeClass.Handler.\n# TYPE kubelet_run_podsandbox_duration_seconds histogram\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.005\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.01\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.025\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.05\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.1\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.25\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"0.5\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"1\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"2.5\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"5\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"10\"} 30\nkubelet_run_podsandbox_duration_seconds_bucket{runtime_handler=\"\",le=\"+Inf\"} 30\nkubelet_run_podsandbox_duration_seconds_sum{runtime_handler=\"\"} 0.00010917799999999998\nkubelet_run_podsandbox_duration_seconds_count{runtime_handler=\"\"} 30\n```\n\n----------------------------------------\n\nTITLE: Measuring Storage Operation Duration in Kubernetes\nDESCRIPTION: This snippet contains Prometheus metrics for measuring the duration of storage operations, specifically volume unmount operations, for different volume plugins in Kubernetes. It uses histogram buckets to track operation durations across various time ranges.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_36\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"5\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"10\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"15\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"25\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"50\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"120\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"300\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"600\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"+Inf\"} 15\nstorage_operation_duration_seconds_sum{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\"} 0.09240096500000002\nstorage_operation_duration_seconds_count{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\"} 15\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"0.1\"} 2\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"0.25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"0.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"2.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"10\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"15\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"50\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"120\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"300\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"600\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\",le=\"+Inf\"} 3\nstorage_operation_duration_seconds_sum{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\"} 0.171444828\nstorage_operation_duration_seconds_count{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/secret\"} 3\n```\n\n----------------------------------------\n\nTITLE: Defining Component Interface in Go\nDESCRIPTION: Defines the interface for a compression component with Compress and Decompress methods.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/testing.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ntype Component interface {\n    // Compress compresses the input data.\n    Compress([]byte) ([]byte, error)\n\n    // Decompress decompresses the input data.\n    Decompress([]byte) ([]byte, error)\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Network Plugin Operations Duration Metric in Prometheus\nDESCRIPTION: This snippet introduces the 'kubelet_network_plugin_operations_duration_seconds' metric, which measures the latency of network plugin operations in seconds. The metric is broken down by operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_11\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_network_plugin_operations_duration_seconds Latency in seconds of network plugin operations. Broken down by operation type.\n```\n\n----------------------------------------\n\nTITLE: Defining SpliceEvent JSON Schema for Linux Splice Operations\nDESCRIPTION: JSON schema definition for the SpliceEvent structure which captures information about Linux splice system calls. It includes entry and exit flags for the pipe passed to the splice syscall.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_50\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"pipe_entry_flag\": {\n            \"type\": \"string\",\n            \"description\": \"Entry flag of the fd_out pipe passed to the splice syscall\"\n        },\n        \"pipe_exit_flag\": {\n            \"type\": \"string\",\n            \"description\": \"Exit flag of the fd_out pipe passed to the splice syscall\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"pipe_entry_flag\",\n        \"pipe_exit_flag\"\n    ],\n    \"description\": \"SpliceEventSerializer serializes a splice event to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Starting DogStatsD with Unix socket\nDESCRIPTION: Command to start DogStatsD with both a configuration file and Unix socket path specified.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/dogstatsd/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\ndogstatsd start -f datadog.yaml -s /tmp/dsd.sock\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Agent Installer E2E Tests Locally\nDESCRIPTION: Command to execute installer tests locally. It allows specifying test folder path, OS versions, platform, and architecture. The command uses the dda invoke script to run the tests.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv new-e2e-tests.run --targets <test folder path> --osversion '<comma separated os version list>' --platform '<debian/centos/suse/ubuntu>' --arch <x86_64/arm64>\n```\n\n----------------------------------------\n\nTITLE: Defining NetworkDevice Schema in JSON\nDESCRIPTION: JSON schema for NetworkDevice that specifies network interface details including namespace, interface index, and interface name. All fields are required for proper device identification.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_35\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"netns\": {\n            \"type\": \"integer\",\n            \"description\": \"netns is the interface ifindex\"\n        },\n        \"ifindex\": {\n            \"type\": \"integer\",\n            \"description\": \"ifindex is the network interface ifindex\"\n        },\n        \"ifname\": {\n            \"type\": \"string\",\n            \"description\": \"ifname is the network interface name\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"required\": [\n        \"netns\",\n        \"ifindex\",\n        \"ifname\"\n    ],\n    \"description\": \"NetworkDeviceSerializer serializes the network device context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Variables Schema Definition\nDESCRIPTION: Basic JSON schema for variable value serialization.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_18\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"type\": \"object\",\n    \"description\": \"Variables serializes the variable values\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring CMake for Datadog Agent Tests\nDESCRIPTION: Sets up CMake configuration for Datadog Agent tests, including package paths, library paths, compiler flags, and custom commands for test execution. It handles platform-specific settings for Windows and non-Windows environments.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/test/CMakeLists.txt#2025-04-22_snippet_0\n\nLANGUAGE: CMake\nCODE:\n```\ncmake_minimum_required(VERSION 3.15)\n\nset(PKGS\n\t\"../../test/init/...\"\n\t\"../../test/rtloader/...\"\n\t\"../../test/aggregator/...\"\n\t\"../../test/datadog_agent/...\"\n\t\"../../test/util/...\"\n\t\"../../test/uutil/...\"\n\t\"../../test/common/...\"\n\t\"../../test/tagger/...\"\n\t\"../../test/kubeutil/...\"\n\t\"../../test/containers/...\"\n)\n\nif (WIN32)\n    set(LIBS_PATH \\\"${PROJECT_BINARY_DIR}/rtloader/\\;${PROJECT_BINARY_DIR}/three/\\\")\nelse()\n    set(LIBS_PATH \"${PROJECT_BINARY_DIR}/rtloader/:${PROJECT_BINARY_DIR}/three/\")\nendif()\n\nset (CGO_CFLAGS \\\"-I${CMAKE_SOURCE_DIR}/include -I${CMAKE_SOURCE_DIR}/common -Wno-deprecated-declarations\\\")\n\nif (WIN32)\n    set (CGO_LDFLAGS -L${PROJECT_BINARY_DIR}/rtloader -ldatadog-agent-rtloader -lstdc++ -static)\nelse()\n    set (CGO_LDFLAGS -L${PROJECT_BINARY_DIR}/rtloader -ldatadog-agent-rtloader -ldl)\nendif()\n\nset (CGO_LDFLAGS \\\"-L${PROJECT_BINARY_DIR}/three/ ${CGO_LDFLAGS}\\\")\nadd_custom_command(\n    OUTPUT testPy3\n    COMMAND ${CMAKE_COMMAND} -E env CGO_CFLAGS=${CGO_CFLAGS} CGO_LDFLAGS=${CGO_LDFLAGS} DYLD_LIBRARY_PATH=${LIBS_PATH} LD_LIBRARY_PATH=${LIBS_PATH} go test -mod=readonly -tags \"three\" -count=1 -p=1 ${PKGS}\n)\nlist(APPEND TARGETS \"testPy3\")\n\nadd_custom_target(run DEPENDS ${TARGETS})\n```\n\n----------------------------------------\n\nTITLE: Storage Operation Error Metrics in Prometheus\nDESCRIPTION: Prometheus metrics for tracking storage operation errors in Kubernetes. This includes a counter for operation errors and a metric for operation status counts. These metrics are marked as ALPHA and deprecated since Kubernetes 1.21.0.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_54\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP storage_operation_errors_total [ALPHA] Storage operation errors (Deprecated since 1.21.0)\n# TYPE storage_operation_errors_total counter\nstorage_operation_errors_total{operation_name=\"volume_fsgroup_recursive_apply\",volume_plugin=\"kubernetes.io/empty-dir\"} 1\n# HELP storage_operation_status_count [ALPHA] Storage operation return statuses count (Deprecated since 1.21.0)\n```\n\n----------------------------------------\n\nTITLE: Building DataDog Agent GUI on MacOS\nDESCRIPTION: Command to build the DataDog Agent GUI using Swift build system. The build process creates a debug binary at .build/debug/dd-agent-gui.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/core/gui/guiimpl/systray/README.md#2025-04-22_snippet_0\n\nLANGUAGE: sh\nCODE:\n```\nswift build\n```\n\n----------------------------------------\n\nTITLE: Docker Operations Error Metrics\nDESCRIPTION: Counter metrics tracking cumulative Docker operation errors by operation type. Includes both deprecated and current metric versions for inspect_container and inspect_image operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_8\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_errors (Deprecated) Cumulative number of Docker operation errors by operation type.\n# TYPE kubelet_docker_operations_errors counter\nkubelet_docker_operations_errors{operation_type=\"inspect_container\"} 2\nkubelet_docker_operations_errors{operation_type=\"inspect_image\"} 5\n# HELP kubelet_docker_operations_errors_total Cumulative number of Docker operation errors by operation type.\n# TYPE kubelet_docker_operations_errors_total counter\nkubelet_docker_operations_errors_total{operation_type=\"inspect_container\"} 2\nkubelet_docker_operations_errors_total{operation_type=\"inspect_image\"} 5\n```\n\n----------------------------------------\n\nTITLE: API Response Example\nDESCRIPTION: Example JSON response showing base64 encoded payload data\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_5\n\nLANGUAGE: json\nCODE:\n```\n{\n  \"payloads\": [\n    \"dG90b3JvfDI1fG93bmVyOmtpa2k=\"\n  ]\n}\n```\n\n----------------------------------------\n\nTITLE: Defining SyscallContext JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing system call context. It contains references to SyscallArgs for different types of system calls like chmod, chown, exec, etc.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_54\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"chmod\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"chown\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"chdir\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"exec\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"open\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"unlink\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"link\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"rename\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"utimes\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"mount\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"mkdir\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        },\n        \"rmdir\": {\n            \"$ref\": \"#/$defs/SyscallArgs\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SyscallContextSerializer serializes syscall context\"\n}\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Running Container Metrics in Prometheus Format\nDESCRIPTION: Alpha-level gauge metrics showing the number of containers currently in different states: created, exited, and running. This provides a snapshot of container states on the node at the time of metric collection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_28\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_running_containers [ALPHA] Number of containers currently running\n# TYPE kubelet_running_containers gauge\nkubelet_running_containers{container_state=\"created\"} 1\nkubelet_running_containers{container_state=\"exited\"} 9\nkubelet_running_containers{container_state=\"running\"} 33\n```\n\n----------------------------------------\n\nTITLE: Prometheus SSH Tunnel Metrics\nDESCRIPTION: Counters tracking SSH tunnel operations including total open attempts and failed open attempts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_34\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP ssh_tunnel_open_count Counter of ssh tunnel total open attempts\n# TYPE ssh_tunnel_open_count counter\nssh_tunnel_open_count 0\n# HELP ssh_tunnel_open_fail_count Counter of ssh tunnel failed open attempts\n# TYPE ssh_tunnel_open_fail_count counter\nssh_tunnel_open_fail_count 0\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Duration Metrics\nDESCRIPTION: Prometheus histogram metrics showing the duration of Docker operations performed by Kubelet. Includes bucket distributions for operations like container creation, inspection, listing, and image pulls with their respective counts and sums.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_6\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_docker_operations_duration_seconds histogram\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.005\"} 0\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.01\"} 0\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.025\"} 5\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.05\"} 24\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.1\"} 33\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.25\"} 38\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.5\"} 40\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"1\"} 50\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"2.5\"} 50\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"5\"} 51\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"10\"} 51\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"+Inf\"} 51\nkubelet_docker_operations_duration_seconds_sum{operation_type=\"create_container\"} 13.980794975000002\nkubelet_docker_operations_duration_seconds_count{operation_type=\"create_container\"} 51\n```\n\n----------------------------------------\n\nTITLE: Running the RtLoader Demo on OSX with Python 3\nDESCRIPTION: Command to run the RtLoader demo application on OSX with Python 3, setting the dynamic library path to include both Python versions.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/README.md#2025-04-22_snippet_3\n\nLANGUAGE: sh\nCODE:\n```\nDYLD_LIBRARY_PATH=./three:./two ./demo/demo 3 $VIRTUAL_ENV\n```\n\n----------------------------------------\n\nTITLE: Analyzing CPU Profile with Go Tools\nDESCRIPTION: Opens the CPU profile data in a web visualization using Go's pprof tool. This allows for detailed analysis of the benchmark's performance characteristics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/benchmarks/kubernetes_state/README.md#2025-04-22_snippet_2\n\nLANGUAGE: sh\nCODE:\n```\ngo tool pprof -web cpuprofile.pprof\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Memory Page Faults in Prometheus\nDESCRIPTION: Prometheus metrics tracking container memory failures (pgfault and pgmajfault) across Kubernetes pods. Each metric includes container metadata like ID, image, name, namespace, pod name, and scope (container/hierarchy) along with timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_18\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_memory_failures_total{container=\"\",failure_type=\"pgfault\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",scope=\"hierarchy\"} 527 1572450188256\n```\n\n----------------------------------------\n\nTITLE: Installing Shellcheck for Pre-commit Hooks in Datadog Agent Development\nDESCRIPTION: Command to install the shellcheck binary, which is required for the shellcheck pre-commit hook. The destination path can be specified, defaulting to /usr/local/bin.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_9\n\nLANGUAGE: sh\nCODE:\n```\ndeva install-shellcheck --destination <path>\n```\n\n----------------------------------------\n\nTITLE: Prometheus REST Client Latency Metrics\nDESCRIPTION: REST client latency metrics in histogram format, showing request duration distributions for various Kubernetes API endpoints including services, token reviews, and subject access reviews.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_32\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/services?limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 0\n```\n\n----------------------------------------\n\nTITLE: Running Invoke-AgentPackages PowerShell Script\nDESCRIPTION: Shows how to execute the Invoke-AgentPackages.ps1 script, which runs the complete omnibus build plus MSI and OCI packages. It includes additional parameters for specifying release version and agent flavor.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/winbuildscripts/README.md#2025-04-22_snippet_1\n\nLANGUAGE: PowerShell\nCODE:\n```\n.\\Invoke-AgentPackages.ps1 -ReleaseVersion \"1.0.0\" -Flavor \"agent\"\n```\n\n----------------------------------------\n\nTITLE: Deprecated Kubelet Runtime Operations Metrics in Prometheus Format\nDESCRIPTION: This snippet shows deprecated counter metrics for various runtime operations performed by the Kubelet, broken down by operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_23\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations (Deprecated) Cumulative number of runtime operations by operation type.\n# TYPE kubelet_runtime_operations counter\nkubelet_runtime_operations{operation_type=\"container_status\"} 175\nkubelet_runtime_operations{operation_type=\"create_container\"} 36\nkubelet_runtime_operations{operation_type=\"exec\"} 4\nkubelet_runtime_operations{operation_type=\"exec_sync\"} 4384\nkubelet_runtime_operations{operation_type=\"image_status\"} 221\nkubelet_runtime_operations{operation_type=\"list_containers\"} 80433\nkubelet_runtime_operations{operation_type=\"list_images\"} 7806\nkubelet_runtime_operations{operation_type=\"list_podsandbox\"} 79691\nkubelet_runtime_operations{operation_type=\"podsandbox_status\"} 117\nkubelet_runtime_operations{operation_type=\"pull_image\"} 5\nkubelet_runtime_operations{operation_type=\"remove_container\"} 22\nkubelet_runtime_operations{operation_type=\"run_podsandbox\"} 15\nkubelet_runtime_operations{operation_type=\"start_container\"} 36\nkubelet_runtime_operations{operation_type=\"status\"} 8719\nkubelet_runtime_operations{operation_type=\"stop_container\"} 3\nkubelet_runtime_operations{operation_type=\"stop_podsandbox\"} 9\nkubelet_runtime_operations{operation_type=\"version\"} 4371\n```\n\n----------------------------------------\n\nTITLE: Defining Variables JSON Schema for Datadog Agent\nDESCRIPTION: A simple JSON schema for serializing variable values. It is defined as an object type with no specific properties.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_59\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"type\": \"object\",\n    \"description\": \"Variables serializes the variable values\"\n}\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Running Pods Metric in Prometheus Format\nDESCRIPTION: Alpha-level gauge metric showing the number of pods currently running on the node. This simple metric provides a snapshot of active pods at the time of metric collection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_29\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_running_pods [ALPHA] Number of pods currently running\n# TYPE kubelet_running_pods gauge\nkubelet_running_pods 29\n```\n\n----------------------------------------\n\nTITLE: Windows Network Performance Counters\nDESCRIPTION: Performance counter IDs for network-related metrics including SMB client shares, QoS policy statistics, and DFS namespace metrics\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/system/testfiles/counter_indexes_en-us.txt#2025-04-22_snippet_2\n\nLANGUAGE: plaintext\nCODE:\n```\nSMB Client Shares\\n16680\\nRead Bytes/sec\\n16682\\nWrite Bytes/sec\\n16684\\nRead Requests/sec\\n16686\n```\n\n----------------------------------------\n\nTITLE: Matching File Creation by Path in JavaScript\nDESCRIPTION: This snippet shows how to match the creation of a file located at 'c:\\cmd.bat' using the 'create.file.path' attribute in a security rule.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/windows_expressions.md#2025-04-22_snippet_7\n\nLANGUAGE: javascript\nCODE:\n```\ncreate.file.path == \"c:\\\\cmd.bat\"\n```\n\n----------------------------------------\n\nTITLE: Kubelet cgroup Manager Latency Metrics in Prometheus Format\nDESCRIPTION: Prometheus metrics showing kubelet's cgroup manager latency in microseconds, broken down by operation type (create, destroy, update) with quantile distributions, sums and counts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_5\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_cgroup_manager_latency_microseconds summary\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"create\",quantile=\"0.5\"} 6165\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"create\",quantile=\"0.9\"} 11263\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"create\",quantile=\"0.99\"} 11335\nkubelet_cgroup_manager_latency_microseconds_sum{operation_type=\"create\"} 93421\nkubelet_cgroup_manager_latency_microseconds_count{operation_type=\"create\"} 12\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"destroy\",quantile=\"0.5\"} 561\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"destroy\",quantile=\"0.9\"} 40592\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"destroy\",quantile=\"0.99\"} 54021\nkubelet_cgroup_manager_latency_microseconds_sum{operation_type=\"destroy\"} 192577\nkubelet_cgroup_manager_latency_microseconds_count{operation_type=\"destroy\"} 12\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"update\",quantile=\"0.5\"} 103\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"update\",quantile=\"0.9\"} 238\nkubelet_cgroup_manager_latency_microseconds{operation_type=\"update\",quantile=\"0.99\"} 739\nkubelet_cgroup_manager_latency_microseconds_sum{operation_type=\"update\"} 11325\nkubelet_cgroup_manager_latency_microseconds_count{operation_type=\"update\"} 76\n```\n\n----------------------------------------\n\nTITLE: Defining SyscallsEvent JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing an array of syscalls. It references the Syscall definition for each item in the array.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_55\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"items\": {\n        \"$ref\": \"#/$defs/Syscall\"\n    },\n    \"type\": \"array\",\n    \"description\": \"SyscallsEventSerializer serializes the syscalls from a syscalls event\"\n}\n```\n\n----------------------------------------\n\nTITLE: Installing Systemd Development Libraries on Redhat/CentOS\nDESCRIPTION: Command to install the systemd development libraries on Redhat or CentOS, which are required for the Agent to collect systemd journal logs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_dev_env.md#2025-04-22_snippet_8\n\nLANGUAGE: bash\nCODE:\n```\nsudo yum install systemd-devel\n```\n\n----------------------------------------\n\nTITLE: Running Integration Tests with Windows API\nDESCRIPTION: Commands to run integration tests using the actual Windows API implementation, which will install/remove event logs on the system and populate them with events.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/util/winutil/eventlog/README.md#2025-04-22_snippet_1\n\nLANGUAGE: shell\nCODE:\n```\ngo test ./... -evtapi Windows\n```\n\nLANGUAGE: shell\nCODE:\n```\ndda inv -e integration-tests\n```\n\n----------------------------------------\n\nTITLE: Kubelet Containers Per Pod Count Metrics in Prometheus Format\nDESCRIPTION: Prometheus metrics showing the distribution of containers per pod, including quantiles (0.5, 0.9, 0.99), sum, and count statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_6\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_containers_per_pod_count The number of containers per pod.\n# TYPE kubelet_containers_per_pod_count summary\nkubelet_containers_per_pod_count{quantile=\"0.5\"} 1\nkubelet_containers_per_pod_count{quantile=\"0.9\"} 2\nkubelet_containers_per_pod_count{quantile=\"0.99\"} 2\nkubelet_containers_per_pod_count_sum 25\nkubelet_containers_per_pod_count_count 21\n```\n\n----------------------------------------\n\nTITLE: Using Kafka Console Utilities with Custom Properties for Debugging\nDESCRIPTION: Commands for using Kafka's console producer and consumer utilities with custom client properties files for debugging purposes. These commands connect to a secure Kafka instance on localhost port 9093 using the provided client.properties configuration file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/network/protocols/kafka/testdata/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nkafka-console-producer.sh --bootstrap-server localhost:9093 --producer.config client.properties ...\nkafka-console-consumer.sh --bootstrap-server localhost:9093 --consumer.config client.properties ...\n```\n\n----------------------------------------\n\nTITLE: Kubernetes Volume Operation Duration Metrics\nDESCRIPTION: Prometheus histogram metrics tracking the duration of volume mount and unmount operations across different Kubernetes volume plugins. Includes bucket measurements from 0.1s to +Inf, along with sum and count values for statistical analysis.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_35\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"5\"} 1773\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"10\"} 1773\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"15\"} 1773\n# ... additional metrics truncated for brevity ...\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/host-path\",le=\"2.5\"} 15\n```\n\n----------------------------------------\n\nTITLE: Executing Remote Commands in Vagrant VM\nDESCRIPTION: Command to run Windows commands inside the Vagrant VM using WinRM.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nvagrant winrm -c \"ipconfig\" win-10-prl\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Duration Metrics\nDESCRIPTION: Prometheus metrics tracking duration of various Docker operations (remove_container, start_container, stop_container, version) in histogram buckets with sum and count.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_13\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"0.5\"} 26\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"1\"} 26\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"2.5\"} 26\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"5\"} 26\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"10\"} 26\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"+Inf\"} 26\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container CPU Share Allocation in Prometheus Format\nDESCRIPTION: Prometheus metrics for container_spec_cpu_shares showing CPU resource allocation across a Kubernetes cluster. The metrics include container details, pod information, and namespace context with CPU share values ranging from 2 to 2048 depending on container priority and resource requirements.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_50\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_spec_cpu_shares gauge\ncontainer_spec_cpu_shares{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1024\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 2048\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 768\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 102\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 256\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 102\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 204\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 102\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 102\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 2\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 102\ncontainer_spec_cpu_shares{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 2\ncontainer_spec_cpu_shares{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 102\ncontainer_spec_cpu_shares{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 102\ncontainer_spec_cpu_shares{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 102\ncontainer_spec_cpu_shares{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 2\ncontainer_spec_cpu_shares{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 102\ncontainer_spec_cpu_shares{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 256\ncontainer_spec_cpu_shares{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 204\ncontainer_spec_cpu_shares{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 2\ncontainer_spec_cpu_shares{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 102\n# HELP container_spec_memory_limit_bytes Memory limit for the container.\n```\n\n----------------------------------------\n\nTITLE: Defining Reflector Watches Total Counter Metric\nDESCRIPTION: Defines a counter metric for tracking the total number of API watches performed by reflectors\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_28\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP reflector_watches_total Total number of API watches done by the reflectors\n# TYPE reflector_watches_total counter\nreflector_watches_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 1\nreflector_watches_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 1\nreflector_watches_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 1\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubelet Runtime Operation Durations with Prometheus Histograms\nDESCRIPTION: This Prometheus histogram metrics output tracks duration times for various kubelet runtime operations. The data is organized into histogram buckets for each operation type, with buckets ranging from 5ms to infinity, showing both the count of operations in each time range and the total sum of durations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_31\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_runtime_operations_duration_seconds histogram\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.005\"} 177\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.0125\"} 197\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.03125\"} 207\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.078125\"} 209\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.1953125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.48828125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"1.220703125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"3.0517578125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"7.62939453125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"19.073486328125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"47.6837158203125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"119.20928955078125\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"298.0232238769531\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"745.0580596923828\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"+Inf\"} 212\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"container_status\"} 1.2043962709999991\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"container_status\"} 212\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.005\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.0125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.03125\"} 0\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.078125\"} 40\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.1953125\"} 59\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"0.48828125\"} 61\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"1.220703125\"} 62\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"3.0517578125\"} 63\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"7.62939453125\"} 64\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"19.073486328125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"47.6837158203125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"119.20928955078125\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"298.0232238769531\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"745.0580596923828\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"create_container\",le=\"+Inf\"} 67\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"create_container\"} 53.26629429099998\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"create_container\"} 67\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"0.005\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"0.0125\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"0.03125\"} 2\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"0.078125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"0.1953125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"0.48828125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"1.220703125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"3.0517578125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"7.62939453125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"19.073486328125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"47.6837158203125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"119.20928955078125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"298.0232238769531\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"745.0580596923828\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec\",le=\"+Inf\"} 3\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"exec\"} 0.037971749000000006\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"exec\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"0.005\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"0.0125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"0.03125\"} 3\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"0.078125\"} 85151\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"0.1953125\"} 341087\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"0.48828125\"} 341705\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"1.220703125\"} 341705\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"3.0517578125\"} 341707\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"7.62939453125\"} 341719\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"19.073486328125\"} 341719\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"47.6837158203125\"} 341720\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"119.20928955078125\"} 341720\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"298.0232238769531\"} 341720\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"745.0580596923828\"} 341720\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"exec_sync\",le=\"+Inf\"} 341720\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"exec_sync\"} 32831.98108225638\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"exec_sync\"} 341720\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"0.005\"} 5667\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"0.0125\"} 5790\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"0.03125\"} 5825\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"0.078125\"} 5829\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"0.1953125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"0.48828125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"1.220703125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"3.0517578125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"7.62939453125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"19.073486328125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"47.6837158203125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"119.20928955078125\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"298.0232238769531\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"745.0580596923828\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"image_status\",le=\"+Inf\"} 5830\nkubelet_runtime_operations_duration_seconds_sum{operation_type=\"image_status\"} 9.721991705999997\nkubelet_runtime_operations_duration_seconds_count{operation_type=\"image_status\"} 5830\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"0.005\"} 501405\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"0.0125\"} 2.641366e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"0.03125\"} 3.0487e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"0.078125\"} 3.126227e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"0.1953125\"} 3.126991e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"0.48828125\"} 3.126995e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"1.220703125\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"3.0517578125\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"7.62939453125\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"19.073486328125\"} 3.126996e+06\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"list_containers\",le=\"47.6837158203125\"} 3.126996e+06\n```\n\n----------------------------------------\n\nTITLE: Illustrating Counter Path Localization Differences\nDESCRIPTION: Demonstrates how the same English counter path can be translated differently in another locale (\"fooish\" in this example), leading to potential mismatches when trying to access counters.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/util/pdhutil/README.md#2025-04-22_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\n\\\\NTDS(*)\\Write Bytes/sec\n\\\\System(*)\\Write Bytes/sec\n\n\\\\NTDS(*)\\FooWrite Bytes/sec\n\\\\System(*)\\FooWrite Bytes per second\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Errors Counter in Prometheus Format\nDESCRIPTION: Prometheus counter metrics showing the cumulative number of Docker operation errors encountered by kubelet, broken down by operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_8\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_errors Cumulative number of Docker operation errors by operation type.\n# TYPE kubelet_docker_operations_errors counter\nkubelet_docker_operations_errors{operation_type=\"inspect_container\"} 1\n```\n\n----------------------------------------\n\nTITLE: Installing Systemd Dependencies on Ubuntu/Debian\nDESCRIPTION: Command to install the libsystemd-dev package on Ubuntu or Debian systems, which is required for the agent to collect systemd journal logs.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_9\n\nLANGUAGE: bash\nCODE:\n```\nsudo apt-get install libsystemd-dev\n```\n\n----------------------------------------\n\nTITLE: Executing Invoke-UnitTests PowerShell Script\nDESCRIPTION: Demonstrates how to run the Invoke-UnitTests.ps1 script for running unit tests of the Datadog Agent. It includes an additional parameter for uploading test coverage results in CI environments.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/winbuildscripts/README.md#2025-04-22_snippet_2\n\nLANGUAGE: PowerShell\nCODE:\n```\n.\\Invoke-UnitTests.ps1 -UploadCoverage $true\n```\n\n----------------------------------------\n\nTITLE: Module Version Check Configuration\nDESCRIPTION: Python module containing flags for OpenTelemetry version compatibility checking. Used to verify that module versions match those used in opentelemetry-collector-contrib.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/otel/README.md#2025-04-22_snippet_1\n\nLANGUAGE: python\nCODE:\n```\nmodules.py\n```\n\n----------------------------------------\n\nTITLE: Exporting HTTP Server Metrics in Prometheus Format\nDESCRIPTION: This snippet exports HTTP server metrics including request duration, size, and count. It uses summary and counter metric types to provide detailed statistics on server performance.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_2\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP http_request_duration_microseconds The HTTP request latencies in microseconds.\n# TYPE http_request_duration_microseconds summary\nhttp_request_duration_microseconds{handler=\"prometheus\",quantile=\"0.5\"} 8763.954\nhttp_request_duration_microseconds{handler=\"prometheus\",quantile=\"0.9\"} 21553.757\nhttp_request_duration_microseconds{handler=\"prometheus\",quantile=\"0.99\"} 29428.649\nhttp_request_duration_microseconds_sum{handler=\"prometheus\"} 2.5064447678000007e+07\nhttp_request_duration_microseconds_count{handler=\"prometheus\"} 1875\n# HELP http_request_size_bytes The HTTP request sizes in bytes.\n# TYPE http_request_size_bytes summary\nhttp_request_size_bytes{handler=\"prometheus\",quantile=\"0.5\"} 117\nhttp_request_size_bytes{handler=\"prometheus\",quantile=\"0.9\"} 117\nhttp_request_size_bytes{handler=\"prometheus\",quantile=\"0.99\"} 117\nhttp_request_size_bytes_sum{handler=\"prometheus\"} 217472\nhttp_request_size_bytes_count{handler=\"prometheus\"} 1875\n# HELP http_requests_total Total number of HTTP requests made.\n# TYPE http_requests_total counter\nhttp_requests_total{code=\"200\",handler=\"prometheus\",method=\"get\"} 1875\n# HELP http_response_size_bytes The HTTP response sizes in bytes.\n# TYPE http_response_size_bytes summary\nhttp_response_size_bytes{handler=\"prometheus\",quantile=\"0.5\"} 11666\nhttp_response_size_bytes{handler=\"prometheus\",quantile=\"0.9\"} 11686\nhttp_response_size_bytes{handler=\"prometheus\",quantile=\"0.99\"} 11689\nhttp_response_size_bytes_sum{handler=\"prometheus\"} 2.3159272e+07\nhttp_response_size_bytes_count{handler=\"prometheus\"} 1875\n```\n\n----------------------------------------\n\nTITLE: Installing Python Dependencies with pip\nDESCRIPTION: Command to install Python dependencies for the Datadog Agent using pip package manager\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/README.md#2025-04-22_snippet_0\n\nLANGUAGE: shell\nCODE:\n```\npip install dda\n```\n\n----------------------------------------\n\nTITLE: Process Metrics\nDESCRIPTION: Prometheus metrics for process-level statistics including CPU usage, memory usage, and file descriptors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_36\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP process_cpu_seconds_total Total user and system CPU time spent in seconds.\n# TYPE process_cpu_seconds_total counter\nprocess_cpu_seconds_total 110425.94\n# HELP process_max_fds Maximum number of open file descriptors.\n# TYPE process_max_fds gauge\nprocess_max_fds 1e+06\n# HELP process_open_fds Number of open file descriptors.\n# TYPE process_open_fds gauge\nprocess_open_fds 67\n```\n\n----------------------------------------\n\nTITLE: Measuring Client Certificate Expiration in Kubernetes API Server\nDESCRIPTION: This snippet defines a histogram metric that tracks the remaining lifetime of certificates used to authenticate requests to the Kubernetes API server. It provides buckets for various time ranges up to 31,104,000 seconds (approximately 1 year).\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_1\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP apiserver_client_certificate_expiration_seconds Distribution of the remaining lifetime on the certificate used to authenticate a request.\n# TYPE apiserver_client_certificate_expiration_seconds histogram\napiserver_client_certificate_expiration_seconds_bucket{le=\"0\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"21600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"43200\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"86400\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"172800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"345600\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"604800\"} 0\napiserver_client_certificate_expiration_seconds_bucket{le=\"2.592e+06\"} 36\napiserver_client_certificate_expiration_seconds_bucket{le=\"7.776e+06\"} 36\napiserver_client_certificate_expiration_seconds_bucket{le=\"1.5552e+07\"} 36\napiserver_client_certificate_expiration_seconds_bucket{le=\"3.1104e+07\"} 36\napiserver_client_certificate_expiration_seconds_bucket{le=\"+Inf\"} 36\napiserver_client_certificate_expiration_seconds_sum 8.666063466966608e+07\napiserver_client_certificate_expiration_seconds_count 36\n```\n\n----------------------------------------\n\nTITLE: Defining REST Client Requests Total Counter in Prometheus\nDESCRIPTION: This snippet defines a Prometheus counter metric 'rest_client_requests_total' with labels for HTTP response code, host, and method. It provides counts for various HTTP methods and response codes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_48\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE rest_client_requests_total counter\nrest_client_requests_total{code=\"200\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"DELETE\"} 1\nrest_client_requests_total{code=\"200\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"GET\"} 225847\nrest_client_requests_total{code=\"200\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"PATCH\"} 5801\nrest_client_requests_total{code=\"200\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"PUT\"} 167290\nrest_client_requests_total{code=\"201\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"POST\"} 45603\nrest_client_requests_total{code=\"404\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"GET\"} 4\nrest_client_requests_total{code=\"404\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"PATCH\"} 56\nrest_client_requests_total{code=\"<error>\",host=\"3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com\",method=\"PUT\"} 1\n```\n\n----------------------------------------\n\nTITLE: Defining UserContext JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing user context information. It includes fields for user ID and group name.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_57\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"string\",\n            \"description\": \"User name\"\n        },\n        \"group\": {\n            \"type\": \"string\",\n            \"description\": \"Group name\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"UserContextSerializer serializes a user context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Inspecting Fake Intake with curl in Bash\nDESCRIPTION: Bash commands to inspect the fake intake using curl. It retrieves route statistics and payloads for a specific endpoint.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/tests/orchestrator/README.md#2025-04-22_snippet_5\n\nLANGUAGE: bash\nCODE:\n```\nfakehost=\"internal-fevans-kind-cluster-fakeintake-1279144000.us-east-1.elb.amazonaws.com\"\ncurl -k -v \"https://$fakehost/fakeintake/routestats\" | jq\ncurl -k -v \"https://$fakehost/fakeintake/payloads?endpoint=/api/v2/orchmanif\" | jq\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Runtime Operations Latency Metric in Prometheus\nDESCRIPTION: This snippet defines a metric for latency in microseconds of runtime operations, broken down by operation type. The actual metric values are not shown in this snippet.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_19\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_runtime_operations_latency_microseconds Latency in microseconds of runtime operations. Broken down by operation type.\n```\n\n----------------------------------------\n\nTITLE: Defining TLSContext JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing TLS (Transport Layer Security) context information. Currently only includes a version field.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_56\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"version\": {\n            \"type\": \"string\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"TLSContextSerializer defines a tls context serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Local Fakeintake Server Execution\nDESCRIPTION: Command to run the fakeintake server locally using Go\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ngo run $DATADOG_ROOT/datadog-agent/test/fakeintake/cmd/server/main.go\n```\n\n----------------------------------------\n\nTITLE: Recording Container Memory Failures in Prometheus Format\nDESCRIPTION: This snippet shows the structure of container_memory_failures_total metrics. It includes labels for container details, failure type, and scope, along with the failure count and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_17\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_failures_total counter\ncontainer_memory_failures_total{container=\"\",failure_type=\"pgfault\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",scope=\"container\"} 61430 1572450197572\ncontainer_memory_failures_total{container=\"\",failure_type=\"pgfault\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\",scope=\"hierarchy\"} 61430 1572450197572\ncontainer_memory_failures_total{container=\"\",failure_type=\"pgfault\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\",scope=\"container\"} 0 1572450197668\ncontainer_memory_failures_total{container=\"\",failure_type=\"pgfault\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\",scope=\"hierarchy\"} 0 1572450197668\n```\n\n----------------------------------------\n\nTITLE: Cross-compiling Datadog Agent for Windows with Eventlog Support\nDESCRIPTION: Command to build the Datadog Agent for Windows using mingw-w64 on a Linux VM. This compiles with the 'log' tag to enable eventlog capabilities.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/logs/launchers/windowsevent/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nGOOS=windows CGO_ENABLED=1 CC=x86_64-w64-mingw32-gcc go build -mod=readonly -tags \"log\" -o ./DataDog/datadog-agent/bin/agent/agent github.com/DataDog/datadog-agent/cmd/agent\n```\n\n----------------------------------------\n\nTITLE: Markdown Documentation Structure\nDESCRIPTION: Main documentation structure for the Datadog Agent developer guide, outlining key sections and links to detailed documentation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Developer Guide\n\nThis guide will help you to develop and contribute code to the project.\n\n## Table of Content\n\n* [Custom checks developer guide](checks/README.md)\n  * [Python builtin modules](checks/builtins)\n* [Agent IPC API](agent_api.md)\n* [Agent development environment][dev-env]\n* [How to build the Agent binaries](agent_build.md)\n* [How to build the Agent packages][agent-omnibus]\n* [Testing guide][testing]\n* [Troubleshooting Memory Guide][memory]\n* [Caveats][caveats]\n* [Contributing][contributing]\n* [Legal][legal]\n* [Tools](tools.md) to troubleshoot a running Agent\n* Advice / Style Guide\n*   * [Using Atomics](atomics.md)\n*   * [Go Imports](imports.md)\n*   * [Logger best practices](logger.md)\n\n## How to contribute\n\n* [Sign the CLA][legal].\n* Read the [contributing][contributing] guidelines.\n\n\n[legal]: legal.md\n[dev-env]: agent_dev_env.md\n[testing]: agent_tests.md\n[memory]: agent_memory.md\n[caveats]: caveats.md\n[contributing]: contributing.md\n[agent-omnibus]: agent_omnibus.md\n[tools]: tools.md\n```\n\n----------------------------------------\n\nTITLE: Prometheus REST Client Duration Metrics for Kubernetes API\nDESCRIPTION: Prometheus histogram metrics measuring request durations for various Kubernetes API endpoints. The metrics track latencies for GET and POST requests to secrets, service account tokens, and node resources. Values are bucketed by duration thresholds ranging from 1ms to +Inf.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_40\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/namespaces/%7Bnamespace%7D/secrets?fieldSelector=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/namespaces/%7Bnamespace%7D/secrets?fieldSelector=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 4\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Scrape Errors in Prometheus\nDESCRIPTION: Prometheus metric indicating whether there was an error while getting container metrics. A value of 1 indicates an error occurred, while 0 indicates successful metric collection.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_46\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_scrape_error 1 if there was an error while getting container metrics, 0 otherwise\n# TYPE container_scrape_error gauge\ncontainer_scrape_error 0\n# HELP container_sockets Number of open sockets for the container.\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Running Container Count Metric in Prometheus\nDESCRIPTION: This snippet defines a gauge metric for the number of containers currently running.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_15\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_running_container_count Number of containers currently running\n# TYPE kubelet_running_container_count gauge\nkubelet_running_container_count 15\n```\n\n----------------------------------------\n\nTITLE: Storage Operation Duration Metrics - Prometheus Format\nDESCRIPTION: Prometheus histogram metrics measuring the duration of storage operations in Kubernetes. Includes metrics for volume mount and unmount operations across different volume plugins with various time buckets ranging from 0.1 to 600 seconds. The metrics track success status and whether the operation was migrated.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_52\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.1\"} 9\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_mount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.25\"} 9\n...\n```\n\n----------------------------------------\n\nTITLE: Defining SyscallArgs JSON Schema for Datadog Agent\nDESCRIPTION: JSON schema for serializing system call arguments. It includes fields for common syscall parameters like paths, flags, modes, and file descriptors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_53\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"path\": {\n            \"type\": \"string\",\n            \"description\": \"Path argument\"\n        },\n        \"flags\": {\n            \"type\": \"integer\",\n            \"description\": \"Flags argument\"\n        },\n        \"mode\": {\n            \"type\": \"integer\",\n            \"description\": \"Mode argument\"\n        },\n        \"uid\": {\n            \"type\": \"integer\",\n            \"description\": \"UID argument\"\n        },\n        \"gid\": {\n            \"type\": \"integer\",\n            \"description\": \"GID argument\"\n        },\n        \"dirfd\": {\n            \"type\": \"integer\",\n            \"description\": \"Directory file descriptor argument\"\n        },\n        \"destination_path\": {\n            \"type\": \"string\",\n            \"description\": \"Destination path argument\"\n        },\n        \"fs_type\": {\n            \"type\": \"string\",\n            \"description\": \"File system type argument\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SyscallArgsSerializer args serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Linking to Kubernetes State Core Check Documentation in Markdown\nDESCRIPTION: This snippet provides a Markdown link to the Kubernetes State Core Check documentation in the integrations-core repository.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/cluster/ksm/kubernetes_state.md#2025-04-22_snippet_0\n\nLANGUAGE: Markdown\nCODE:\n```\n# Kubernetes State Core Check\n\nThe check documentation is now located in the [integrations-core repository](https://github.com/DataDog/integrations-core/tree/master/kubernetes_state_core\n). \n```\n\n----------------------------------------\n\nTITLE: Windows MSMQ Performance Counters\nDESCRIPTION: Performance counter IDs for Microsoft Message Queue (MSMQ) metrics, including queue statistics, session data, and HTTP traffic measurements\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/system/testfiles/counter_indexes_en-us.txt#2025-04-22_snippet_3\n\nLANGUAGE: plaintext\nCODE:\n```\nMSMQ Queue\\n16582\\nBytes in Journal Queue\\n16584\\nBytes in Queue\\n16586\\nMessages in Journal Queue\\n16588\n```\n\n----------------------------------------\n\nTITLE: Documenting YUM Update Script Execution Order in Markdown\nDESCRIPTION: This snippet outlines the order of script execution for YUM package updates. It includes the sequence of pretrans, preinst, file copying, postinst, prerm, file removal, postrm, and posttrans scripts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/package-scripts/README.md#2025-04-22_snippet_1\n\nLANGUAGE: markdown\nCODE:\n```\n# YUM\n## source: https://fedoraproject.org/wiki/Packaging:Scriptlets\n\n * `pretrans` of new package\n * `preinst` of new package\n * Files in the list get copied\n * `postinst` of new package\n * `prerm` of old package\n * Files in the old package file list that are not in the new one's get removed\n * `postrm` of the old package gets run\n * `posttrans` of the _new_ package is run\n```\n\n----------------------------------------\n\nTITLE: Querying Container Memory Failures in Prometheus Format\nDESCRIPTION: This snippet shows the format of container_memory_failures_total metrics in Prometheus. It includes labels for container, failure_type, id, image, name, namespace, pod, and scope. The metric values represent the total number of memory failures for each container.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_20\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_memory_failures_total{container=\"datadog-agent\",failure_type=\"pgmajfault\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\",scope=\"hierarchy\"} 0 1572450197849\n```\n\n----------------------------------------\n\nTITLE: Exporting Machine Memory Bytes Metric in Prometheus Format\nDESCRIPTION: This snippet exports the amount of memory installed on the machine in bytes as a Prometheus gauge metric.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_63\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP machine_memory_bytes Amount of memory installed on the machine.\n# TYPE machine_memory_bytes gauge\nmachine_memory_bytes 5.718659072e+09\n```\n\n----------------------------------------\n\nTITLE: Initializing event recorder in Go\nDESCRIPTION: Fix initialization of the event recorder in the cluster agent.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_14\n\nLANGUAGE: go\nCODE:\n```\nFix eventrecorder init\n```\n\n----------------------------------------\n\nTITLE: Tracking Volume Unmount Duration Metrics in Prometheus\nDESCRIPTION: Prometheus metrics tracking the duration of volume unmount operations across different Kubernetes volume plugins. The metrics include histogram buckets with various time thresholds, sum of durations, and operation counts for successful operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_53\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_sum{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 0.078412193\nstorage_operation_duration_seconds_count{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/configmap\"} 3\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.1\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.25\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.5\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"1\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"2.5\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"5\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"10\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"15\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"25\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"50\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"120\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"300\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"600\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"+Inf\"} 4\nstorage_operation_duration_seconds_sum{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 0.124215714\nstorage_operation_duration_seconds_count{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/empty-dir\"} 4\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.1\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.25\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.5\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"1\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"2.5\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"5\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"10\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"15\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"25\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"50\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"120\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"300\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"600\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\",le=\"+Inf\"} 26\nstorage_operation_duration_seconds_sum{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 0.317874651\nstorage_operation_duration_seconds_count{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/host-path\"} 26\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"0.1\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"0.25\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"0.5\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"1\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"2.5\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"5\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"10\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"15\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"25\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"50\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"120\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"300\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"600\"} 1\nstorage_operation_duration_seconds_bucket{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\",le=\"+Inf\"} 1\nstorage_operation_duration_seconds_sum{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\"} 0.013909626\nstorage_operation_duration_seconds_count{migrated=\"false\",operation_name=\"volume_unmount\",status=\"success\",volume_plugin=\"kubernetes.io/projected\"} 1\n```\n\n----------------------------------------\n\nTITLE: Prometheus REST Client Request Duration Metrics\nDESCRIPTION: Histogram metrics capturing HTTP request durations in seconds for Kubernetes API endpoints. Includes bucket counters for different latency ranges, total request counts and duration sums for token reviews, subject access reviews and certificate signing requests.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_43\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/authentication.k8s.io/v1/tokenreviews\",verb=\"POST\",le=\"0.008\"} 12\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/authentication.k8s.io/v1/tokenreviews\",verb=\"POST\",le=\"0.016\"} 10901\n# Additional metrics truncated for brevity\n```\n\n----------------------------------------\n\nTITLE: Tracking Kubernetes API Reflector Metrics in Prometheus Format\nDESCRIPTION: This snippet shows reflector metrics that measure how the Kubernetes API server is being accessed, including items per list/watch, duration, and resource version information. These metrics help diagnose API server performance issues.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_25\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP reflector_items_per_list How many items an API list returns to the reflectors\n# TYPE reflector_items_per_list summary\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.5\"} 18\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.9\"} 18\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.99\"} 18\nreflector_items_per_list_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 18\nreflector_items_per_list_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 1\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.5\"} 4\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.9\"} 4\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.99\"} 4\nreflector_items_per_list_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 4\nreflector_items_per_list_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 1\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.5\"} 1\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.9\"} 1\nreflector_items_per_list{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.99\"} 1\nreflector_items_per_list_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 1\nreflector_items_per_list_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 1\n# HELP reflector_items_per_watch How many items an API watch returns to the reflectors\n# TYPE reflector_items_per_watch summary\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.5\"} NaN\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.9\"} NaN\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.99\"} NaN\nreflector_items_per_watch_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 0\nreflector_items_per_watch_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 0\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.5\"} NaN\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.9\"} NaN\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.99\"} NaN\nreflector_items_per_watch_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 0\nreflector_items_per_watch_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 0\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.5\"} NaN\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.9\"} NaN\nreflector_items_per_watch{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.99\"} NaN\nreflector_items_per_watch_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 0\nreflector_items_per_watch_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 0\n# HELP reflector_last_resource_version Last resource version seen for the reflectors\n# TYPE reflector_last_resource_version gauge\nreflector_last_resource_version{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 2962\nreflector_last_resource_version{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 360\nreflector_last_resource_version{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 2947\n# HELP reflector_list_duration_seconds How long an API list takes to return and decode for the reflectors\n# TYPE reflector_list_duration_seconds summary\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.5\"} 0.004355341\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.9\"} 0.004355341\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\",quantile=\"0.99\"} 0.004355341\nreflector_list_duration_seconds_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 0.004355341\nreflector_list_duration_seconds_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 1\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.5\"} 0.002388912\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.9\"} 0.002388912\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\",quantile=\"0.99\"} 0.002388912\nreflector_list_duration_seconds_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 0.002388912\nreflector_list_duration_seconds_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 1\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.5\"} 0.003258362\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.9\"} 0.003258362\nreflector_list_duration_seconds{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\",quantile=\"0.99\"} 0.003258362\nreflector_list_duration_seconds_sum{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 0.003258362\nreflector_list_duration_seconds_count{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 1\n# HELP reflector_lists_total Total number of API lists done by the reflectors\n# TYPE reflector_lists_total counter\nreflector_lists_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 1\nreflector_lists_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 1\nreflector_lists_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 1\n# HELP reflector_short_watches_total Total number of short API watches done by the reflectors\n```\n\n----------------------------------------\n\nTITLE: Defining JSON Schema for NetworkStats in Datadog Agent\nDESCRIPTION: This snippet defines the JSON schema for serializing network statistics in the Datadog Agent. It includes properties for total data size and packet count.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_14\n\nLANGUAGE: JSON\nCODE:\n```\n\"NetworkStats\": {\n    \"properties\": {\n        \"data_size\": {\n            \"type\": \"integer\",\n            \"description\": \"data_size is the total count of bytes sent or received\"\n        },\n        \"packet_count\": {\n            \"type\": \"integer\",\n            \"description\": \"packet_count is the total count of packets sent or received\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"NetworkStatsSerializer defines a new network stats serializer\"\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Running Pod Count Metric in Prometheus\nDESCRIPTION: This snippet defines a gauge metric for the number of pods currently running.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_16\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_running_pod_count Number of pods currently running\n# TYPE kubelet_running_pod_count gauge\nkubelet_running_pod_count 12\n```\n\n----------------------------------------\n\nTITLE: BPF Attach Types Constants Table\nDESCRIPTION: A table defining BPF (Berkeley Packet Filter) program attach types supported across all architectures. These constants are used to specify where eBPF programs can be attached in the system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/linux_expressions.md#2025-04-22_snippet_11\n\nLANGUAGE: text\nCODE:\n```\n| Name | Architectures |\n| ---- |---------------|\n| `BPF_CGROUP_INET_INGRESS` | all |\n| `BPF_CGROUP_INET_EGRESS` | all |\n| `BPF_CGROUP_INET_SOCK_CREATE` | all |\n| `BPF_CGROUP_SOCK_OPS` | all |\n| `BPF_SK_SKB_STREAM_PARSER` | all |\n```\n\n----------------------------------------\n\nTITLE: Listing Registered BPF Target Architectures\nDESCRIPTION: A listing of the available BPF target architectures for compilation, including the generic BPF target and endian-specific variants (big endian and little endian).\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/ebpf/c/expected_targets.txt#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nRegistered Targets:\n  bpf   - BPF (host endian)\n  bpfeb - BPF (big endian)\n  bpfel - BPF (little endian)\n```\n\n----------------------------------------\n\nTITLE: Using cuobjdump to Analyze Fatbin File\nDESCRIPTION: Command to use cuobjdump for dumping and analyzing the fatbin file, with an optional argument for resource usage information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/gpu/cuda/testutil/testdata/README.md#2025-04-22_snippet_2\n\nLANGUAGE: Shell\nCODE:\n```\ncuobjdump -res-usage\n```\n\n----------------------------------------\n\nTITLE: Defining Container Network Transmit Errors Metric in Prometheus\nDESCRIPTION: This snippet provides a help text for the container_network_transmit_errors_total metric in Prometheus format. It describes the metric as a cumulative count of errors encountered during network transmission.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_38\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_network_transmit_errors_total Cumulative count of errors encountered while transmitting\n```\n\n----------------------------------------\n\nTITLE: Starting Vagrant VM\nDESCRIPTION: Command to start a Windows 10 VM using Vagrant with Parallels provider.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nvagrant up win-10-prl --provider=parallels\n```\n\n----------------------------------------\n\nTITLE: Setting up cluster checks in Go\nDESCRIPTION: Improve error handling when setting up cluster checks.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_15\n\nLANGUAGE: go\nCODE:\n```\nHandle NewHandler failure better in setupClusterCheck\n```\n\n----------------------------------------\n\nTITLE: Monitoring Workqueue Performance Metrics in Prometheus\nDESCRIPTION: This snippet defines various metrics for monitoring workqueue performance in Kubernetes. It includes counters for adds and retries, gauges for depth and processing time, and histograms for queue duration and work duration.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_57\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP workqueue_adds_total [ALPHA] Total number of adds handled by workqueue\n# TYPE workqueue_adds_total counter\nworkqueue_adds_total{name=\"DynamicCABundle-client-ca-bundle\"} 28479\n# HELP workqueue_depth [ALPHA] Current depth of workqueue\n# TYPE workqueue_depth gauge\nworkqueue_depth{name=\"DynamicCABundle-client-ca-bundle\"} 0\n# HELP workqueue_longest_running_processor_seconds [ALPHA] How many seconds has the longest running processor for workqueue been running.\n# TYPE workqueue_longest_running_processor_seconds gauge\nworkqueue_longest_running_processor_seconds{name=\"DynamicCABundle-client-ca-bundle\"} 0\n# HELP workqueue_queue_duration_seconds [ALPHA] How long in seconds an item stays in workqueue before being requested.\n# TYPE workqueue_queue_duration_seconds histogram\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1e-08\"} 0\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1e-07\"} 0\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1e-06\"} 0\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"9.999999999999999e-06\"} 22436\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"9.999999999999999e-05\"} 28443\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"0.001\"} 28475\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"0.01\"} 28479\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"0.1\"} 28479\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1\"} 28479\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"10\"} 28479\nworkqueue_queue_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"+Inf\"} 28479\nworkqueue_queue_duration_seconds_sum{name=\"DynamicCABundle-client-ca-bundle\"} 0.237502246000002\nworkqueue_queue_duration_seconds_count{name=\"DynamicCABundle-client-ca-bundle\"} 28479\n# HELP workqueue_retries_total [ALPHA] Total number of retries handled by workqueue\n# TYPE workqueue_retries_total counter\nworkqueue_retries_total{name=\"DynamicCABundle-client-ca-bundle\"} 0\n# HELP workqueue_unfinished_work_seconds [ALPHA] How many seconds of work has done that is in progress and hasn't been observed by work_duration. Large values indicate stuck threads. One can deduce the number of stuck threads by observing the rate at which this increases.\n# TYPE workqueue_unfinished_work_seconds gauge\nworkqueue_unfinished_work_seconds{name=\"DynamicCABundle-client-ca-bundle\"} 0\n# HELP workqueue_work_duration_seconds [ALPHA] How long in seconds processing an item from workqueue takes.\n# TYPE workqueue_work_duration_seconds histogram\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1e-08\"} 0\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1e-07\"} 0\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1e-06\"} 0\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"9.999999999999999e-06\"} 0\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"9.999999999999999e-05\"} 27922\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"0.001\"} 28366\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"0.01\"} 28475\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"0.1\"} 28479\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"1\"} 28479\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"10\"} 28479\nworkqueue_work_duration_seconds_bucket{name=\"DynamicCABundle-client-ca-bundle\",le=\"+Inf\"} 28479\nworkqueue_work_duration_seconds_sum{name=\"DynamicCABundle-client-ca-bundle\"} 2.3146415870000094\nworkqueue_work_duration_seconds_count{name=\"DynamicCABundle-client-ca-bundle\"} 28479\n```\n\n----------------------------------------\n\nTITLE: Prometheus Request Duration Histogram Metrics\nDESCRIPTION: Histogram metrics measuring REST client request durations in seconds across different Kubernetes API endpoints. The metrics include duration buckets from 0.001s to +Inf, along with sum and count values for each URL/verb combination.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_38\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE rest_client_request_duration_seconds histogram\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/namespaces/%7Bnamespace%7D/configmaps?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/api/v1/namespaces/%7Bnamespace%7D/configmaps?fieldSelector=%7Bvalue%7D&limit=%7Bvalue%7D&resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 0\n# [Additional bucket metrics truncated for brevity]\n```\n\n----------------------------------------\n\nTITLE: Docker Operations Duration Metrics\nDESCRIPTION: Prometheus histogram metrics showing duration of various Docker operations including remove_container, start_container, stop_container, and version checks. Includes bucket distributions and summary statistics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_7\n\nLANGUAGE: prometheus\nCODE:\n```\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"1\"} 25\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"2.5\"} 25\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"5\"} 25\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"10\"} 25\nkubelet_docker_operations_duration_seconds_bucket{operation_type=\"remove_container\",le=\"+Inf\"} 25\nkubelet_docker_operations_duration_seconds_sum{operation_type=\"remove_container\"} 3.951931906\nkubelet_docker_operations_duration_seconds_count{operation_type=\"remove_container\"} 25\n```\n\n----------------------------------------\n\nTITLE: Rebuilding Windows IoT Agent Installer using Batch Script\nDESCRIPTION: The rebuild.bat script mimics the omnibus build process, creating an XML representation of the directory structure and generating the installer. It uses the 'light' command to process the Datadog agent directory and configuration files.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/omnibus/resources/iot/msi/localbuild/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Batch\nCODE:\n```\nrem rebuild.bat\n\nheat dir c:\\opt\\datadog-agent -gg -dr APPLICATIONROOTDIRECTORY -var var.ProjectSourceDir -cg ProjectDir -out directory.wxs\nheat dir c:\\omnibus-ruby\\src\\etc\\datadog-agent\\extra_package_files -gg -dr APPLICATIONROOTDIRECTORY -var var.ExtraSourceDir -cg ExtraDir -out directory2.wxs\nlight -ext WixUIExtension directory.wxs directory2.wxs product.wxs -out ddagent.msi\n```\n\n----------------------------------------\n\nTITLE: Installing Pre-commit Hooks for Datadog Agent Development\nDESCRIPTION: Commands to install pre-commit and set up hooks for running CI checks locally. The GOFLAGS is used to avoid errors when getting Go dependencies.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_11\n\nLANGUAGE: sh\nCODE:\n```\npython3 -m pip install pre-commit\nGOFLAGS=-buildvcs=false pre-commit install  # buildvcs avoids errors when getting go dependencies\n```\n\n----------------------------------------\n\nTITLE: Measuring etcd Request Cache Latencies\nDESCRIPTION: This snippet defines summary metrics for tracking latencies in microseconds for adding and getting objects from the etcd cache. It provides quantiles at 0.5, 0.9, and 0.99 for both operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_3\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP etcd_request_cache_add_latencies_summary Latency in microseconds of adding an object to etcd cache\n# TYPE etcd_request_cache_add_latencies_summary summary\netcd_request_cache_add_latencies_summary{quantile=\"0.5\"} NaN\netcd_request_cache_add_latencies_summary{quantile=\"0.9\"} NaN\netcd_request_cache_add_latencies_summary{quantile=\"0.99\"} NaN\netcd_request_cache_add_latencies_summary_sum 0\netcd_request_cache_add_latencies_summary_count 0\n# HELP etcd_request_cache_get_latencies_summary Latency in microseconds of getting an object from etcd cache\n# TYPE etcd_request_cache_get_latencies_summary summary\netcd_request_cache_get_latencies_summary{quantile=\"0.5\"} NaN\netcd_request_cache_get_latencies_summary{quantile=\"0.9\"} NaN\netcd_request_cache_get_latencies_summary{quantile=\"0.99\"} NaN\netcd_request_cache_get_latencies_summary_sum 0\netcd_request_cache_get_latencies_summary_count 0\n```\n\n----------------------------------------\n\nTITLE: Specifying Jinja2 Package Version\nDESCRIPTION: Declares a dependency on version 3.1.6 of the Jinja2 Python templating engine using pip requirements format.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/requirements-docs.txt#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\njinja2==3.1.6\n```\n\n----------------------------------------\n\nTITLE: CI Pipeline Analysis\nDESCRIPTION: Command for analyzing and explaining CI pipeline failures.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_11\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.explain-ci-failure <pipeline-id>\n```\n\n----------------------------------------\n\nTITLE: Exporting Container Thread Max Metrics in Prometheus Format\nDESCRIPTION: This snippet exports the maximum number of threads for various containers in a Kubernetes cluster. It includes detailed labels for container identification and resource allocation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_61\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_threads_max gauge\ncontainer_threads_max{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_threads_max{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_threads_max{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_threads_max{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_threads_max{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\n# ... (additional container_threads_max metrics)\n```\n\n----------------------------------------\n\nTITLE: Kubelet Network Plugin Operations Latency Metrics in Prometheus Format\nDESCRIPTION: Deprecated metrics measuring the latency in microseconds of network plugin operations, broken down by operation type including get_pod_network_status, set_up_pod, and tear_down_pod. Uses summary metric type with quantiles.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_13\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_network_plugin_operations_latency_microseconds (Deprecated) Latency in microseconds of network plugin operations. Broken down by operation type.\n# TYPE kubelet_network_plugin_operations_latency_microseconds summary\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"get_pod_network_status\",quantile=\"0.5\"} NaN\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"get_pod_network_status\",quantile=\"0.9\"} NaN\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"get_pod_network_status\",quantile=\"0.99\"} NaN\nkubelet_network_plugin_operations_latency_microseconds_sum{operation_type=\"get_pod_network_status\"} 8893\nkubelet_network_plugin_operations_latency_microseconds_count{operation_type=\"get_pod_network_status\"} 26\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"set_up_pod\",quantile=\"0.5\"} NaN\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"set_up_pod\",quantile=\"0.9\"} NaN\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"set_up_pod\",quantile=\"0.99\"} NaN\nkubelet_network_plugin_operations_latency_microseconds_sum{operation_type=\"set_up_pod\"} 525\nkubelet_network_plugin_operations_latency_microseconds_count{operation_type=\"set_up_pod\"} 8\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"tear_down_pod\",quantile=\"0.5\"} NaN\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"tear_down_pod\",quantile=\"0.9\"} NaN\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"tear_down_pod\",quantile=\"0.99\"} NaN\nkubelet_network_plugin_operations_latency_microseconds_sum{operation_type=\"tear_down_pod\"} 104\nkubelet_network_plugin_operations_latency_microseconds_count{operation_type=\"tear_down_pod\"} 3\n```\n\n----------------------------------------\n\nTITLE: Tracking REST Client Request Latency with Prometheus in Kubernetes\nDESCRIPTION: This snippet shows Prometheus histogram metrics for tracking REST client request latency when interacting with the Kubernetes API. The metrics capture request latency in seconds across various buckets (from 0.001s to +Inf) for different API endpoints and HTTP verbs, along with sum and count values.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_29\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE rest_client_request_latency_seconds histogram\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.004\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.008\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.016\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.032\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.064\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.128\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.256\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"0.512\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\",le=\"+Inf\"} 1\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\"} 0.002833964\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D\",verb=\"GET\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.001\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.002\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.004\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.008\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.016\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.032\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.064\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.128\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"0.512\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\",le=\"+Inf\"} 4\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 0.006121868999999999\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/configmaps/%7Bname%7D?resourceVersion=%7Bvalue%7D\",verb=\"GET\"} 4\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.002\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.004\"} 26\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.008\"} 70\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.016\"} 100\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.032\"} 117\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.064\"} 128\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.128\"} 131\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.256\"} 131\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"0.512\"} 131\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\",le=\"+Inf\"} 131\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\"} 1.8253591690000002\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events\",verb=\"POST\"} 131\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.004\"} 17\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.008\"} 43\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.016\"} 63\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.032\"} 73\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.064\"} 75\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.128\"} 75\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.256\"} 75\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"0.512\"} 75\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\",le=\"+Inf\"} 75\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\"} 0.6986988879999999\nrest_client_request_latency_seconds_count{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/events/%7Bname%7D\",verb=\"PATCH\"} 75\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.001\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.002\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.004\"} 0\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.008\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.016\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.032\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.064\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.128\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.256\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"0.512\"} 1\nrest_client_request_latency_seconds_bucket{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\",le=\"+Inf\"} 1\nrest_client_request_latency_seconds_sum{url=\"http://127.0.0.1:8080/api/v1/namespaces/%7Bnamespace%7D/pods/%7Bname%7D\",verb=\"DELETE\"} 0.006667733\n```\n\n----------------------------------------\n\nTITLE: Defining SECL Event in Go\nDESCRIPTION: Shows how to define a SECL event in Go, including its type, definition, and agent version.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/README.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\nCapset CapsetEvent `field:\"capset\" event:\"capset\"` // [7.27] [Process] A process changed its capacity set\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Agent\nDESCRIPTION: Command to run the Datadog Agent with a configuration file\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/README.md#2025-04-22_snippet_4\n\nLANGUAGE: shell\nCODE:\n```\n./bin/agent/agent run -c bin/agent/dist/datadog.yaml\n```\n\n----------------------------------------\n\nTITLE: Generating Packer Configuration with Ruby\nDESCRIPTION: Command to generate packer.json file for Windows 10 using the Invoke! library with virtualbox-iso provider.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_1\n\nLANGUAGE: ruby\nCODE:\n```\ndda inv packer.build --os=windows-10 --provider=virtualbox-iso\n```\n\n----------------------------------------\n\nTITLE: Tracking Token Request Metrics for Alternate Token Source\nDESCRIPTION: This snippet defines counter metrics for monitoring token requests to an alternate token source, including total requests and failed requests. These metrics help assess the reliability of the token source.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_4\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP get_token_count Counter of total Token() requests to the alternate token source\n# TYPE get_token_count counter\nget_token_count 0\n# HELP get_token_fail_count Counter of failed Token() requests to the alternate token source\n# TYPE get_token_fail_count counter\nget_token_fail_count 0\n```\n\n----------------------------------------\n\nTITLE: Defining Reflector Short Watches Counter Metric\nDESCRIPTION: Defines a counter metric for tracking short-lived reflector watches across different Kubernetes components\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_26\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE reflector_short_watches_total counter\nreflector_short_watches_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_config_apiserver_go_47_9646\"} 0\nreflector_short_watches_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_451_9647\"} 0\nreflector_short_watches_total{name=\"reflector_k8s_io_kubernetes_pkg_kubelet_kubelet_go_460_9648\"} 0\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Task States in Kubernetes\nDESCRIPTION: Prometheus metrics tracking container task states across different Kubernetes system pods including CoreDNS, etcd, API server, and other control plane components. Each metric includes container metadata like ID, image, namespace and the specific task state being measured.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_58\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_tasks_state{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"iowaiting\"} 0 1572450196388\ncontainer_tasks_state{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"running\"} 0 1572450196388\n```\n\n----------------------------------------\n\nTITLE: Kubelet Pod Worker Duration Metrics in Prometheus Format\nDESCRIPTION: This snippet shows histogram metrics for pod worker duration in seconds. It includes bucket counts for various duration thresholds, sum, and total count of sync operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_18\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_worker_duration_seconds Duration in seconds to sync a single pod. Broken down by operation type: create, update, or sync\n# TYPE kubelet_pod_worker_duration_seconds histogram\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.005\"} 42\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.01\"} 49\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.025\"} 50\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.05\"} 50\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.1\"} 53\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.25\"} 58\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"0.5\"} 66\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"1\"} 67\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"2.5\"} 74\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"5\"} 76\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"10\"} 76\nkubelet_pod_worker_duration_seconds_bucket{operation_type=\"sync\",le=\"+Inf\"} 76\nkubelet_pod_worker_duration_seconds_sum{operation_type=\"sync\"} 25.854890815999997\nkubelet_pod_worker_duration_seconds_count{operation_type=\"sync\"} 76\n```\n\n----------------------------------------\n\nTITLE: Docker Pull Command\nDESCRIPTION: Command to pull the fakeintake container image from Docker Hub\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/fakeintake/docs/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndocker pull datadog/fakeintake\n```\n\n----------------------------------------\n\nTITLE: Library Target Configuration\nDESCRIPTION: Defines the shared library target with source files and include directories for the Datadog Agent Python backend.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/three/CMakeLists.txt#2025-04-22_snippet_2\n\nLANGUAGE: cmake\nCODE:\n```\nadd_library(datadog-agent-three SHARED\n    three.cpp\n    three_mem.cpp\n    ../common/cgo_free.c\n    ../common/stringutils.c\n    ../common/log.c\n    ../common/builtins/aggregator.c\n    ../common/builtins/datadog_agent.c\n    ../common/builtins/util.c\n    ../common/builtins/_util.c\n    ../common/builtins/tagger.c\n    ../common/builtins/kubeutil.c\n    ../common/builtins/containers.c\n)\n```\n\n----------------------------------------\n\nTITLE: Creating Directory for New Go Module\nDESCRIPTION: This command creates a new directory for the module within the Datadog Agent repository.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/how-to/go/add-module.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ncd ~/my_path_to/datadog-agent && mkdir mymodule\n```\n\n----------------------------------------\n\nTITLE: Measuring Storage Operation Durations in Kubernetes using Prometheus Metrics\nDESCRIPTION: This snippet contains Prometheus metrics for measuring the duration of storage operations in Kubernetes. It includes data for different volume plugins and operations like volume mount and unmount, with various time buckets for histogram metrics.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_36\n\nLANGUAGE: prometheus\nCODE:\n```\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"2.5\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"5\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"10\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"15\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"25\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"50\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\",le=\"+Inf\"} 5\nstorage_operation_duration_seconds_sum{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\"} 2.1640189700000003\nstorage_operation_duration_seconds_count{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/configmap\"} 5\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.1\"} 27\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.25\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.5\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"1\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"2.5\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"5\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"10\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"15\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"25\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"50\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"+Inf\"} 30\nstorage_operation_duration_seconds_sum{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\"} 0.8220592589999998\nstorage_operation_duration_seconds_count{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/downward-api\"} 30\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"1\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"2.5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"5\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"10\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"15\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"25\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"50\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"+Inf\"} 3\nstorage_operation_duration_seconds_sum{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\"} 0.004260384\nstorage_operation_duration_seconds_count{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/empty-dir\"} 3\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.1\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.25\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"0.5\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"1\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"2.5\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"5\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"10\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"15\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"25\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"50\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\",le=\"+Inf\"} 25\nstorage_operation_duration_seconds_sum{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\"} 0.024385752\nstorage_operation_duration_seconds_count{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/host-path\"} 25\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"0.1\"} 51\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"0.25\"} 55\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"0.5\"} 58\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"1\"} 63\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"2.5\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"5\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"10\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"15\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"25\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"50\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\",le=\"+Inf\"} 71\nstorage_operation_duration_seconds_sum{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\"} 18.892647455000006\nstorage_operation_duration_seconds_count{operation_name=\"volume_mount\",volume_plugin=\"kubernetes.io/secret\"} 71\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.1\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.25\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"0.5\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"1\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"2.5\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"5\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"10\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"15\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"25\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"50\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\",le=\"+Inf\"} 8\nstorage_operation_duration_seconds_sum{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\"} 0.35813825499999996\nstorage_operation_duration_seconds_count{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/downward-api\"} 8\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.1\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.25\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"0.5\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"1\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"2.5\"} 1\nstorage_operation_duration_seconds_bucket{operation_name=\"volume_unmount\",volume_plugin=\"kubernetes.io/empty-dir\",le=\"5\"} 1\n```\n\n----------------------------------------\n\nTITLE: Exposing Kubelet CGroup Manager Metrics in Prometheus Format\nDESCRIPTION: This snippet exposes metrics for the Kubelet's cgroup manager operations. It includes histograms for the duration of create, destroy, and update operations on cgroups.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_7\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_cgroup_manager_duration_seconds [ALPHA] Duration in seconds for cgroup manager operations. Broken down by method.\n# TYPE kubelet_cgroup_manager_duration_seconds histogram\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.005\"} 1\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.01\"} 2\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.025\"} 28\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.05\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.1\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.25\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"0.5\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"1\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"2.5\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"5\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"10\"} 30\nkubelet_cgroup_manager_duration_seconds_bucket{operation_type=\"create\",le=\"+Inf\"} 30\nkubelet_cgroup_manager_duration_seconds_sum{operation_type=\"create\"} 0.541001887\nkubelet_cgroup_manager_duration_seconds_count{operation_type=\"create\"} 30\n```\n\n----------------------------------------\n\nTITLE: Extracting Tracer Data from Process Memory Files in Bash\nDESCRIPTION: A bash command to find and extract the contents of memfd files created by Datadog tracers from a running process. This command uses find to locate the memfd file in the process's file descriptors and then outputs its contents to a file named tracer.data.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/languagedetection/internal/detectors/privileged/testdata/tracer/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n# cat $(find /proc/$(pgrep \"${TRACED_PROCESS_NAME}\")/fd/ -lname \"/memfd:datadog-tracer-info*\") > tracer.data\n```\n\n----------------------------------------\n\nTITLE: Running Datadog Agent with LD_LIBRARY_PATH on Linux\nDESCRIPTION: This command demonstrates how to run the Datadog Agent binary using the LD_LIBRARY_PATH environment variable to resolve the Python initialization error. It specifies the path to the required libraries.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/checks/README.md#2025-04-22_snippet_4\n\nLANGUAGE: bash\nCODE:\n```\nLD_LIBRARY_PATH=$PWD/dev/lib ./bin/agent/agent run\n```\n\n----------------------------------------\n\nTITLE: Installing NVIDIA CUDA Development Tools on Ubuntu\nDESCRIPTION: Command to install the NVIDIA CUDA development package on Ubuntu, which includes nvcc and cuobjdump.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/gpu/cuda/testutil/testdata/README.md#2025-04-22_snippet_1\n\nLANGUAGE: Shell\nCODE:\n```\nsudo apt-get install nvidia-cuda-dev\n```\n\n----------------------------------------\n\nTITLE: Platform-Specific Installation Configuration\nDESCRIPTION: Sets up platform-specific installation rules and compiler options for Windows and Unix systems.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/three/CMakeLists.txt#2025-04-22_snippet_3\n\nLANGUAGE: cmake\nCODE:\n```\nif(WIN32)\n  install(TARGETS datadog-agent-three\n      RUNTIME DESTINATION ${CMAKE_INSTALL_LIBDIR}\n  )\nelse()\n  target_compile_options(datadog-agent-three PRIVATE \"-Wno-deprecated-register\")\n  install(TARGETS datadog-agent-three\n      LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}\n  )\nendif()\n```\n\n----------------------------------------\n\nTITLE: Summarizing ConfigMapStore API Calls in Markdown\nDESCRIPTION: This code snippet outlines the number of API server calls made by different methods of the configMapStore. It provides a quick reference for understanding the performance implications of using the configMapStore.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/clusteragent/autoscaling/custommetrics/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n#### Summary of apiserver calls\n\n- `NewConfigMapStore`: between 1 and 2 calls\n- `SetExternalMetricValues`: 1 call to update configmap\n- `DeleteExternalMetricValues`: 1 call to update configmap\n- `ListAllExternalMetricValues`: 1 call to get configmap\n```\n\n----------------------------------------\n\nTITLE: Kubelet Docker Operations Total Metrics\nDESCRIPTION: Counter metrics showing total number of Docker operations performed by operation type including container management, image operations and system queries.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_15\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_total [ALPHA] Cumulative number of Docker operations by operation type.\n# TYPE kubelet_docker_operations_total counter\nkubelet_docker_operations_total{operation_type=\"create_container\"} 97\nkubelet_docker_operations_total{operation_type=\"info\"} 1\nkubelet_docker_operations_total{operation_type=\"inspect_container\"} 639\n```\n\n----------------------------------------\n\nTITLE: Monitoring Kubelet HTTP Request Counts in Prometheus Format\nDESCRIPTION: Prometheus metrics showing the total count of HTTP requests received by the kubelet, broken down by request method, path, and whether they are long-running operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_19\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_http_requests_total [ALPHA] Number of the http requests received since the server started\n# TYPE kubelet_http_requests_total counter\nkubelet_http_requests_total{long_running=\"false\",method=\"GET\",path=\"healthz\",server_type=\"readwrite\"} 80930\nkubelet_http_requests_total{long_running=\"false\",method=\"GET\",path=\"metrics\",server_type=\"readwrite\"} 81835\nkubelet_http_requests_total{long_running=\"false\",method=\"GET\",path=\"metrics/cadvisor\",server_type=\"readwrite\"} 80931\nkubelet_http_requests_total{long_running=\"false\",method=\"GET\",path=\"other\",server_type=\"readwrite\"} 80937\nkubelet_http_requests_total{long_running=\"false\",method=\"GET\",path=\"pods\",server_type=\"readwrite\"} 645292\nkubelet_http_requests_total{long_running=\"false\",method=\"GET\",path=\"stats\",server_type=\"readwrite\"} 80931\nkubelet_http_requests_total{long_running=\"true\",method=\"POST\",path=\"exec\",server_type=\"readwrite\"} 3\n```\n\n----------------------------------------\n\nTITLE: Describing Scheduler Package Structure in Markdown\nDESCRIPTION: This snippet outlines the structure and purpose of the scheduler package, explaining its role in managing check executions and the design of the Scheduler struct.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/scheduler/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n## package `scheduler`\n\nThis package is responsible of sending checks to the execution pipeline with an interval specified for any number\nof `instance` configurations coming along with any check. Only one `Scheduler` instance is supposed to run at any time\nand even if this is not a requirement, a use case for multiple schedulers didn't show up and therefore wasn't tested.\n\n### Scheduler\n\nA `Scheduler` instance keeps a collection of `time.Ticker`s associated to a list of `check.Check`s: every time the\nticker fires, all the checks in that list are sent to the execution pipeline. Every queue runs in its own goroutine.\nThe `Scheduler` expose an interface based on methods attached to the struct but the implementation makes use of\nchannels to synchronize the queues and to talk with the scheduler loop to send commands like `Run` and `Stop`.\n\nOnce a scheduler is stopped, restarting it with `Run` is not expected to work. A new one should be instantiated and\n`Run` instead.\n```\n\n----------------------------------------\n\nTITLE: Kubelet Pod Start Duration Metrics in Prometheus Format\nDESCRIPTION: This snippet shows histogram metrics for pod start duration in seconds. It includes bucket counts for various duration thresholds, sum, and total count of pod starts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_16\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_pod_start_duration_seconds histogram\nkubelet_pod_start_duration_seconds_bucket{le=\"0.005\"} 4\nkubelet_pod_start_duration_seconds_bucket{le=\"0.01\"} 6\nkubelet_pod_start_duration_seconds_bucket{le=\"0.025\"} 9\nkubelet_pod_start_duration_seconds_bucket{le=\"0.05\"} 9\nkubelet_pod_start_duration_seconds_bucket{le=\"0.1\"} 10\nkubelet_pod_start_duration_seconds_bucket{le=\"0.25\"} 10\nkubelet_pod_start_duration_seconds_bucket{le=\"0.5\"} 10\nkubelet_pod_start_duration_seconds_bucket{le=\"1\"} 11\nkubelet_pod_start_duration_seconds_bucket{le=\"2.5\"} 14\nkubelet_pod_start_duration_seconds_bucket{le=\"5\"} 15\nkubelet_pod_start_duration_seconds_bucket{le=\"10\"} 26\nkubelet_pod_start_duration_seconds_bucket{le=\"+Inf\"} 30\nkubelet_pod_start_duration_seconds_sum 146.698439544\nkubelet_pod_start_duration_seconds_count 30\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Pod Worker Start Duration Metrics in Prometheus Format\nDESCRIPTION: Alpha-level metrics tracking the duration from when a pod is detected to when a worker is started to handle it. The histogram shows the distribution of this latency across various time buckets from 0.005 to +Inf seconds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_26\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_worker_start_duration_seconds [ALPHA] Duration in seconds from seeing a pod to starting a worker.\n# TYPE kubelet_pod_worker_start_duration_seconds histogram\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.005\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.01\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.025\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.05\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.1\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.25\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"0.5\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"1\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"2.5\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"5\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"10\"} 30\nkubelet_pod_worker_start_duration_seconds_bucket{le=\"+Inf\"} 30\nkubelet_pod_worker_start_duration_seconds_sum 0.026680296\nkubelet_pod_worker_start_duration_seconds_count 30\n```\n\n----------------------------------------\n\nTITLE: Recording REST Client Request Duration Metrics in Prometheus Format\nDESCRIPTION: This snippet represents a Prometheus metrics export of REST client request durations. It shows histogram buckets for different response time thresholds across various HTTP verbs (DELETE, GET, PATCH, POST, PUT), along with sum and count values used to calculate averages. The data shows performance patterns for requests to the localhost:8443 endpoint.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_31\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE rest_client_request_duration_seconds histogram\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.002\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.004\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.008\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.016\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.032\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.064\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.128\"} 2\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.256\"} 3\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"0.512\"} 3\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\",le=\"+Inf\"} 3\nrest_client_request_duration_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\"} 0.32611697500000003\nrest_client_request_duration_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"DELETE\"} 3\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.001\"} 50\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.002\"} 3129\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.004\"} 8172\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.008\"} 8688\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.016\"} 8795\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.032\"} 8845\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.064\"} 8876\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.128\"} 8901\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.256\"} 8921\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"0.512\"} 8931\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\",le=\"+Inf\"} 9063\nrest_client_request_duration_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\"} 585.2233559799982\nrest_client_request_duration_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"GET\"} 9063\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.002\"} 1\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.004\"} 106\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.008\"} 715\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.016\"} 860\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.032\"} 899\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.064\"} 927\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.128\"} 945\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.256\"} 957\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"0.512\"} 963\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\",le=\"+Inf\"} 1063\nrest_client_request_duration_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\"} 674.8700161060033\nrest_client_request_duration_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PATCH\"} 1063\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.001\"} 5\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.002\"} 314\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.004\"} 599\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.008\"} 648\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.016\"} 670\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.032\"} 675\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.064\"} 688\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.128\"} 695\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.256\"} 698\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"0.512\"} 703\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\",le=\"+Inf\"} 722\nrest_client_request_duration_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\"} 89.41131052000009\nrest_client_request_duration_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"POST\"} 722\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.001\"} 0\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.002\"} 17\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.004\"} 2044\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.008\"} 4081\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.016\"} 4251\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.032\"} 4287\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.064\"} 4299\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.128\"} 4307\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.256\"} 4313\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"0.512\"} 4321\nrest_client_request_duration_seconds_bucket{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\",le=\"+Inf\"} 4395\nrest_client_request_duration_seconds_sum{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\"} 370.35423456099863\nrest_client_request_duration_seconds_count{url=\"https://localhost:8443/%7Bprefix%7D\",verb=\"PUT\"} 4395\n# HELP rest_client_request_latency_seconds (Deprecated) Request latency in seconds. Broken down by verb and URL.\n```\n\n----------------------------------------\n\nTITLE: Configuring Stack from CI Pipeline\nDESCRIPTION: Command to configure a stack based on failed CI pipeline jobs, with option to prefer local VMs when available.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/kernel_matrix_testing/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e kmt.gen-config --from-ci-pipeline=<pipeline-id> --use-local-if-possible --stack=demo-stack\n```\n\n----------------------------------------\n\nTITLE: Defining container_start_time_seconds Metric in Prometheus\nDESCRIPTION: This snippet defines the container_start_time_seconds metric type as a gauge and provides multiple entries with different label combinations. Each entry represents the start time of a container or pod in Unix timestamp format.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_54\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_start_time_seconds gauge\ncontainer_start_time_seconds{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572431478e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572431478e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572431478e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 1.572431536e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 1.572431537e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.572431478e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 1.572431559e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 1.57243156e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 1.57243156e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 1.57243156e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.572431498e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.572431499e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 1.572431537e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 1.572431537e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 1.572432538e+09\ncontainer_start_time_seconds{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 1.572432539e+09\ncontainer_start_time_seconds{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 1.572431563e+09\ncontainer_start_time_seconds{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 1.572431563e+09\ncontainer_start_time_seconds{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 1.572432571e+09\ncontainer_start_time_seconds{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 1.572431509e+09\ncontainer_start_time_seconds{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 1.572431543e+09\ncontainer_start_time_seconds{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 1.572431506e+09\ncontainer_start_time_seconds{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 1.572431506e+09\ncontainer_start_time_seconds{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 1.572431538e+09\ncontainer_start_time_seconds{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.572431506e+09\n# HELP container_tasks_state Number of tasks in given state\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Network Packet Drops with Prometheus in Kubernetes\nDESCRIPTION: Prometheus metrics tracking dropped network packets on receive interfaces for containers in a Kubernetes cluster. Each metric includes detailed container metadata such as container ID, image, interface type, namespace, and pod name, along with a timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_32\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_receive_packets_dropped_total counter\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_receive_packets_dropped_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n```\n\n----------------------------------------\n\nTITLE: Reporting Container CPU CFS Periods in Prometheus Format\nDESCRIPTION: This snippet defines and reports the 'container_cpu_cfs_periods_total' metric, which counts the number of elapsed CPU Completely Fair Scheduler (CFS) period intervals for containers. It includes labels for container, pod, namespace, and image details.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_1\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP container_cpu_cfs_periods_total Number of elapsed enforcement period intervals.\n# TYPE container_cpu_cfs_periods_total counter\ncontainer_cpu_cfs_periods_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 6219 1572450195286\ncontainer_cpu_cfs_periods_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 115527 1572450190276\ncontainer_cpu_cfs_periods_total{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 115517 1572450197849\ncontainer_cpu_cfs_periods_total{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 6201 1572450196671\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Task States in Prometheus Format for Kubernetes\nDESCRIPTION: Prometheus metrics data that tracks container process states across multiple Kubernetes system pods. Each metric includes container metadata (ID, image, name) along with namespace, pod name, and the specific process state (sleeping, running, stopped, etc.) being measured, with a timestamp in milliseconds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_56\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\",state=\"sleeping\"} 0 1572450195152\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\",state=\"stopped\"} 0 1572450195152\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\",state=\"uninterruptible\"} 0 1572450195152\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"iowaiting\"} 0 1572450186468\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"running\"} 0 1572450186468\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"sleeping\"} 0 1572450186468\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"stopped\"} 0 1572450186468\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"uninterruptible\"} 0 1572450186468\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"iowaiting\"} 0 1572450199201\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"running\"} 0 1572450199201\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"sleeping\"} 0 1572450199201\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"stopped\"} 0 1572450199201\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\",state=\"uninterruptible\"} 0 1572450199201\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"iowaiting\"} 0 1572450195355\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"running\"} 0 1572450195355\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"sleeping\"} 0 1572450195355\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"stopped\"} 0 1572450195355\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"uninterruptible\"} 0 1572450195355\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"iowaiting\"} 0 1572450197313\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"running\"} 0 1572450197313\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"sleeping\"} 0 1572450197313\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"stopped\"} 0 1572450197313\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",state=\"uninterruptible\"} 0 1572450197313\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"iowaiting\"} 0 1572450190363\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"running\"} 0 1572450190363\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"sleeping\"} 0 1572450190363\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"stopped\"} 0 1572450190363\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"uninterruptible\"} 0 1572450190363\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"iowaiting\"} 0 1572450200713\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"running\"} 0 1572450200713\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"sleeping\"} 0 1572450200713\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"stopped\"} 0 1572450200713\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\",state=\"uninterruptible\"} 0 1572450200713\ncontainer_tasks_state{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\",state=\"iowaiting\"} 0 1572450201420\n```\n\n----------------------------------------\n\nTITLE: Defining Container Memory Cache Metrics in Prometheus Format\nDESCRIPTION: This snippet defines the container_memory_cache metric type and provides multiple sample data points for various containers and pods in a Kubernetes cluster. It includes details such as container ID, image, name, namespace, and pod name along with the memory cache value and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_13\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_cache gauge\ncontainer_memory_cache{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.364516864e+09 1572450197572\ncontainer_memory_cache{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 3.954688e+07 1572450197668\ncontainer_memory_cache{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.7907712e+07 1572450196297\ncontainer_memory_cache{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 1.7707008e+07 1572450199385\ncontainer_memory_cache{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 8192 1572450186377\ncontainer_memory_cache{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 200704 1572450198309\ncontainer_memory_cache{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 118784 1572450196733\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 28672 1572450196475\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 28672 1572450186468\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 12288 1572450199201\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 20480 1572450195355\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 28672 1572450190363\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 12288 1572450200713\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 12288 1572450201420\ncontainer_memory_cache{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 12288 1572450188256\ncontainer_memory_cache{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 4096 1572450195286\ncontainer_memory_cache{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_memory_cache{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 2.1504e+07 1572450190276\ncontainer_memory_cache{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_memory_cache{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 28672 1572450198917\ncontainer_memory_cache{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 20480 1572450196388\ncontainer_memory_cache{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 2.1520384e+07 1572450197849\ncontainer_memory_cache{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 1.7702912e+07 1572450202927\ncontainer_memory_cache{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 4096 1572450196671\ncontainer_memory_cache{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 16384 1572450188597\ncontainer_memory_cache{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 16384 1572450192433\ncontainer_memory_cache{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 200704 1572450197292\ncontainer_memory_cache{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450195713\n# HELP container_memory_failcnt Number of memory usage hits limits\n```\n\n----------------------------------------\n\nTITLE: Exporting Container Memory Max Usage Metrics in Prometheus Format\nDESCRIPTION: This snippet defines the 'container_memory_max_usage_bytes' metric in Prometheus exposition format. It captures the maximum memory usage in bytes for various containers and pods in a Kubernetes cluster, including system components and user applications.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_23\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_memory_max_usage_bytes gauge\ncontainer_memory_max_usage_bytes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 2.007793664e+09 1572450197572\ncontainer_memory_max_usage_bytes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 4.91814912e+08 1572450197668\ncontainer_memory_max_usage_bytes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 7.1790592e+07 1572450196297\n# ... additional metric entries ...\ncontainer_memory_max_usage_bytes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 1.2201984e+07 1572450195713\n```\n\n----------------------------------------\n\nTITLE: Defining Kubelet Docker Operations Total Count Metrics in Prometheus\nDESCRIPTION: This snippet defines the 'kubelet_docker_operations_total' metric, which counts the total number of Docker operations performed by Kubelet. It provides a counter for each operation type.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_10\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_docker_operations_total Cumulative number of Docker operations by operation type.\n# TYPE kubelet_docker_operations_total counter\nkubelet_docker_operations_total{operation_type=\"create_container\"} 51\nkubelet_docker_operations_total{operation_type=\"info\"} 2\nkubelet_docker_operations_total{operation_type=\"inspect_container\"} 381\nkubelet_docker_operations_total{operation_type=\"inspect_image\"} 414\nkubelet_docker_operations_total{operation_type=\"list_containers\"} 160127\nkubelet_docker_operations_total{operation_type=\"list_images\"} 7806\nkubelet_docker_operations_total{operation_type=\"pull_image\"} 5\nkubelet_docker_operations_total{operation_type=\"remove_container\"} 25\nkubelet_docker_operations_total{operation_type=\"start_container\"} 51\nkubelet_docker_operations_total{operation_type=\"stop_container\"} 15\nkubelet_docker_operations_total{operation_type=\"version\"} 13113\n```\n\n----------------------------------------\n\nTITLE: Generating KSMv2 Test Data with Shell Script\nDESCRIPTION: Executes a shell script to generate test data required for KSMv2 benchmarking. The data is generated once and reused across benchmark runs for consistent comparisons.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/benchmarks/kubernetes_state/README.md#2025-04-22_snippet_0\n\nLANGUAGE: sh\nCODE:\n```\ntest/benchmarks/kubernetes_state/testdata/generate.sh\n```\n\n----------------------------------------\n\nTITLE: Setting Admission Controller Injection Mode via Environment Variable\nDESCRIPTION: Environment variable to configure the injection mode for the Datadog Admission Controller.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_5\n\nLANGUAGE: yaml\nCODE:\n```\nDD_ADMISSION_CONTROLLER_INJECT_CONFIG_MODE: \"hostip\"\n```\n\n----------------------------------------\n\nTITLE: Prometheus Metrics for Kubernetes Container CPU Load Averages\nDESCRIPTION: Sample Prometheus-formatted metrics showing the container_cpu_load_average_10s metric for various containers in a Kubernetes cluster. The data includes metrics for both system containers and application containers across different namespaces, with timestamps from epoch.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_4\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_cpu_load_average_10s gauge\ncontainer_cpu_load_average_10s{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450198309\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196733\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450196475\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450186468\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450195355\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450190363\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450201420\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450195286\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450190276\ncontainer_cpu_load_average_10s{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_cpu_load_average_10s{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450198917\ncontainer_cpu_load_average_10s{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450196388\ncontainer_cpu_load_average_10s{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450197849\ncontainer_cpu_load_average_10s{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450202927\ncontainer_cpu_load_average_10s{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196671\ncontainer_cpu_load_average_10s{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450188597\ncontainer_cpu_load_average_10s{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450192433\ncontainer_cpu_load_average_10s{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450197292\ncontainer_cpu_load_average_10s{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450195713\n# HELP container_cpu_system_seconds_total Cumulative system cpu time consumed in seconds.\n```\n\n----------------------------------------\n\nTITLE: Querying Container Network Receive Bytes Total in Prometheus\nDESCRIPTION: This Prometheus metric tracks the total number of bytes received over the network for various containers and pods. It includes labels for container ID, image, interface, namespace, and pod name. The metric is a counter type, meaning it always increases over time.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_28\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_receive_bytes_total counter\ncontainer_network_receive_bytes_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 1.56093872e+08 1572450197572\ncontainer_network_receive_bytes_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_receive_bytes_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\n```\n\n----------------------------------------\n\nTITLE: Setting Admission Controller Reinvocation Policy in YAML\nDESCRIPTION: YAML configuration for setting the reinvocation policy of the Datadog Admission Controller.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CHANGELOG-DCA.rst#2025-04-22_snippet_7\n\nLANGUAGE: yaml\nCODE:\n```\nadmission_controller:\n  reinvocation_policy: \"IfNeeded\"\n```\n\n----------------------------------------\n\nTITLE: Displaying Kubelet Volume Statistics in Prometheus Format\nDESCRIPTION: This snippet shows kubelet volume statistics metrics including free inodes, used inodes, and used bytes for persistent volume claims across different namespaces. These metrics help monitor disk space usage in Kubernetes volumes.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_22\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_volume_stats_inodes_free Number of free inodes in the volume\n# TYPE kubelet_volume_stats_inodes_free gauge\nkubelet_volume_stats_inodes_free{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 6.538687e+06\nkubelet_volume_stats_inodes_free{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 6.535645e+06\nkubelet_volume_stats_inodes_free{namespace=\"default\",persistentvolumeclaim=\"www-web-2\"} 6.538687e+06\nkubelet_volume_stats_inodes_free{namespace=\"default\",persistentvolumeclaim=\"www2-web-3\"} 6.535645e+06\nkubelet_volume_stats_inodes_free{namespace=\"default\",persistentvolumeclaim=\"web-2-ephemeralvolume\"} 6.535645e+06\n# HELP kubelet_volume_stats_inodes_used Number of used inodes in the volume\n# TYPE kubelet_volume_stats_inodes_used gauge\nkubelet_volume_stats_inodes_used{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 14913\nkubelet_volume_stats_inodes_used{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 17955\nkubelet_volume_stats_inodes_used{namespace=\"default\",persistentvolumeclaim=\"www-web-2\"} 14913\nkubelet_volume_stats_inodes_used{namespace=\"default\",persistentvolumeclaim=\"www2-web-3\"} 17955\nkubelet_volume_stats_inodes_used{namespace=\"default\",persistentvolumeclaim=\"web-2-ephemeralvolume\"} 17955\n# HELP kubelet_volume_stats_used_bytes Number of used bytes in the volume\n# TYPE kubelet_volume_stats_used_bytes gauge\nkubelet_volume_stats_used_bytes{namespace=\"default\",persistentvolumeclaim=\"www-web-2\"} 2.319220736e+09\nkubelet_volume_stats_used_bytes{namespace=\"default\",persistentvolumeclaim=\"www2-web-3\"} 1.53286656e+09\nkubelet_volume_stats_used_bytes{namespace=\"default\",persistentvolumeclaim=\"web-2-ephemeralvolume\"} 1.53286656e+09\nkubelet_volume_stats_used_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-2\"} 2.319220736e+09\nkubelet_volume_stats_used_bytes{namespace=\"unit-test\",persistentvolumeclaim=\"ddagent-pvc-ddagent-test-3\"} 1.53286656e+09\n```\n\n----------------------------------------\n\nTITLE: Tracking Container Network Transmit Bytes with Prometheus Metrics\nDESCRIPTION: A collection of Prometheus metrics tracking the total number of bytes transmitted over network interfaces by containers in a Kubernetes cluster. Each metric includes detailed labels for container identification, including container ID, image, interface type, namespace, and pod name, along with the transmitted byte count and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_36\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_network_transmit_bytes_total counter\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/\",image=\"\",interface=\"eth0\",name=\"\",namespace=\"\",pod=\"\"} 7.332795e+06 1572450197572\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/\",image=\"\",interface=\"ip6tnl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/\",image=\"\",interface=\"tunl0\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 7.309918e+06 1572450186377\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 7.332056e+06 1572450196497\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 3.172254e+06 1572450195152\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 7.343242e+06 1572450199201\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 3.153333e+06 1572450197313\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 7.35138e+06 1572450200713\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 7.31355e+06 1572450188256\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 7.332369e+06 1572450196642\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 5.535161e+06 1572450189944\n```\n\n----------------------------------------\n\nTITLE: Querying Container Memory Failures in Prometheus Format\nDESCRIPTION: This snippet shows the structure of container_memory_failures_total metrics in Prometheus format. It includes labels for container, failure_type, id, image, name, namespace, pod, and scope, along with the metric value and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_19\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_memory_failures_total{container=\"\",failure_type=\"pgmajfault\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\",scope=\"hierarchy\"} 0 1572450197313\n```\n\n----------------------------------------\n\nTITLE: Running the RtLoader Demo on Unix with Python 3\nDESCRIPTION: Command to run the RtLoader demo application on Unix systems with Python 3, setting the library path appropriately.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/README.md#2025-04-22_snippet_4\n\nLANGUAGE: sh\nCODE:\n```\nLD_LIBRARY_PATH=./three:./two ./demo/demo 3 $VIRTUAL_ENV\n```\n\n----------------------------------------\n\nTITLE: Sample pprof Tree Output Analysis\nDESCRIPTION: Example output from pprof's tree command showing hierarchical memory usage with calling context and percentages.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_memory.md#2025-04-22_snippet_2\n\nLANGUAGE: text\nCODE:\n```\n(pprof) tree\nShowing nodes accounting for 4848.62kB, 100% of 4848.62kB total\n----------------------------------------------------------+-------------\n      flat  flat%   sum%        cum   cum%   calls calls% + context\n----------------------------------------------------------+-------------\n                                         1805.17kB   100% |   compress/flate.NewWriterDict\n 1805.17kB 37.23% 37.23%  1805.17kB 37.23%                | compress/flate.NewWriter\n----------------------------------------------------------+-------------\n```\n\n----------------------------------------\n\nTITLE: Deprecated Kubelet Pod Worker Latency Metrics in Prometheus Format\nDESCRIPTION: This snippet shows deprecated summary metrics for pod worker latency in microseconds. It includes quantile values, sum, and count of sync operations.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_19\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_worker_latency_microseconds (Deprecated) Latency in microseconds to sync a single pod. Broken down by operation type: create, update, or sync\n# TYPE kubelet_pod_worker_latency_microseconds summary\nkubelet_pod_worker_latency_microseconds{operation_type=\"sync\",quantile=\"0.5\"} NaN\nkubelet_pod_worker_latency_microseconds{operation_type=\"sync\",quantile=\"0.9\"} NaN\nkubelet_pod_worker_latency_microseconds{operation_type=\"sync\",quantile=\"0.99\"} NaN\nkubelet_pod_worker_latency_microseconds_sum{operation_type=\"sync\"} 2.6458212e+07\nkubelet_pod_worker_latency_microseconds_count{operation_type=\"sync\"} 76\n```\n\n----------------------------------------\n\nTITLE: Exporting Container Socket Metrics in Prometheus Format\nDESCRIPTION: This code snippet exports container socket metrics in Prometheus format. It includes metrics for various containers and pods in a Kubernetes cluster, with labels for container details, namespace, and pod information. The metric type is 'gauge' and represents the number of sockets for each container.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_47\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_sockets gauge\ncontainer_sockets{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197572\ncontainer_sockets{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450197668\ncontainer_sockets{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196297\ncontainer_sockets{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450199385\ncontainer_sockets{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450186377\ncontainer_sockets{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450198309\ncontainer_sockets{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450196497\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0 1572450196733\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450196475\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450195152\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450186468\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450199201\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450195355\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450197313\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450190363\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450200713\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450201420\ncontainer_sockets{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450188256\ncontainer_sockets{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450195286\ncontainer_sockets{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196642\ncontainer_sockets{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450190276\ncontainer_sockets{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_sockets{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0 1572450198917\ncontainer_sockets{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0 1572450196388\ncontainer_sockets{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450197849\ncontainer_sockets{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0 1572450202927\ncontainer_sockets{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0 1572450196671\ncontainer_sockets{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0 1572450188597\ncontainer_sockets{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0 1572450192433\ncontainer_sockets{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0 1572450197292\ncontainer_sockets{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0 1572450195713\n# HELP container_spec_cpu_period CPU period of the container.\n```\n\n----------------------------------------\n\nTITLE: Demonstrating Line Continuation in Markdown Lists\nDESCRIPTION: This snippet shows how to achieve multi-line ordered list items in Markdown by indenting the second line by 2 spaces from the start of the text and ending the block with a new line.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/guidelines/docs.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n1. first line\n\n     second line\n\n1. third line\n```\n\n----------------------------------------\n\nTITLE: Kubelet Network Plugin Operations Latency Metrics in Prometheus Format\nDESCRIPTION: Prometheus summary metrics showing the latency in microseconds of network plugin operations performed by kubelet, broken down by operation type (get_pod_network_status, set_up_pod, tear_down_pod) with quantiles, sums, and counts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_10\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_network_plugin_operations_latency_microseconds Latency in microseconds of network plugin operations. Broken down by operation type.\n# TYPE kubelet_network_plugin_operations_latency_microseconds summary\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"get_pod_network_status\",quantile=\"0.5\"} 3\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"get_pod_network_status\",quantile=\"0.9\"} 4\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"get_pod_network_status\",quantile=\"0.99\"} 21\nkubelet_network_plugin_operations_latency_microseconds_sum{operation_type=\"get_pod_network_status\"} 302\nkubelet_network_plugin_operations_latency_microseconds_count{operation_type=\"get_pod_network_status\"} 67\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"set_up_pod\",quantile=\"0.5\"} 20\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"set_up_pod\",quantile=\"0.9\"} 26\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"set_up_pod\",quantile=\"0.99\"} 36\nkubelet_network_plugin_operations_latency_microseconds_sum{operation_type=\"set_up_pod\"} 318\nkubelet_network_plugin_operations_latency_microseconds_count{operation_type=\"set_up_pod\"} 14\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"tear_down_pod\",quantile=\"0.5\"} 44\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"tear_down_pod\",quantile=\"0.9\"} 55\nkubelet_network_plugin_operations_latency_microseconds{operation_type=\"tear_down_pod\",quantile=\"0.99\"} 63\nkubelet_network_plugin_operations_latency_microseconds_sum{operation_type=\"tear_down_pod\"} 1119\nkubelet_network_plugin_operations_latency_microseconds_count{operation_type=\"tear_down_pod\"} 13\n```\n\n----------------------------------------\n\nTITLE: Prometheus Container CPU Period Metrics in Kubernetes\nDESCRIPTION: A collection of container_spec_cpu_period metrics for various containers running in a Kubernetes cluster. These metrics show the CPU period configuration (100000 microseconds) for different containers across pods, namespaces, and cgroups.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_48\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_spec_cpu_period gauge\ncontainer_spec_cpu_period{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 100000\ncontainer_spec_cpu_period{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 100000\ncontainer_spec_cpu_period{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 100000\ncontainer_spec_cpu_period{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 100000\ncontainer_spec_cpu_period{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 100000\ncontainer_spec_cpu_period{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 100000\ncontainer_spec_cpu_period{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 100000\ncontainer_spec_cpu_period{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 100000\ncontainer_spec_cpu_period{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 100000\n```\n\n----------------------------------------\n\nTITLE: Container Network Receive Errors Metrics in Prometheus Format\nDESCRIPTION: These Prometheus metrics represent the cumulative count of network receive errors for Kubernetes containers. The metrics are labeled with container details including ID, image, interfaces, namespaces, and pod names, followed by the error value and timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_31\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_receive_errors_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_receive_errors_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n# HELP container_network_receive_packets_dropped_total Cumulative count of packets dropped while receiving\n```\n\n----------------------------------------\n\nTITLE: Defining Audit Event Total Counter in Prometheus\nDESCRIPTION: This snippet defines a counter metric for the total number of audit events generated and sent to the audit backend. It's an alpha feature in the Kubernetes API server.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_0\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP apiserver_audit_event_total [ALPHA] Counter of audit events generated and sent to the audit backend.\n# TYPE apiserver_audit_event_total counter\napiserver_audit_event_total 0\n```\n\n----------------------------------------\n\nTITLE: Using Admonitions in Markdown for Emphasis\nDESCRIPTION: This example demonstrates how to use admonitions in Markdown to call out important information, which is preferred over large chunks of bold or italicized text.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/guidelines/docs.md#2025-04-22_snippet_1\n\nLANGUAGE: markdown\nCODE:\n```\n!!! info\n    Lorem ipsum ...\n```\n\n----------------------------------------\n\nTITLE: Tracking etcd Helper Cache Performance Metrics\nDESCRIPTION: This snippet defines counter metrics for monitoring the performance of the etcd helper cache, including entry count, hit count, and miss count. These metrics help assess the efficiency of the cache system.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics.txt#2025-04-22_snippet_2\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP etcd_helper_cache_entry_count Counter of etcd helper cache entries. This can be different from etcd_helper_cache_miss_count because two concurrent threads can miss the cache and generate the same entry twice.\n# TYPE etcd_helper_cache_entry_count counter\netcd_helper_cache_entry_count 0\n# HELP etcd_helper_cache_hit_count Counter of etcd helper cache hits.\n# TYPE etcd_helper_cache_hit_count counter\netcd_helper_cache_hit_count 0\n# HELP etcd_helper_cache_miss_count Counter of etcd helper cache miss.\n# TYPE etcd_helper_cache_miss_count counter\netcd_helper_cache_miss_count 0\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Memory Swap Limits in Prometheus\nDESCRIPTION: Prometheus metrics data showing memory swap limits for containers in a Kubernetes cluster. Each metric includes container ID, image, name, namespace, and pod labels, with values representing the memory swap limit in bytes for different containers and pods in the cluster.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_53\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE container_spec_memory_swap_limit_bytes gauge\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 1.073737728e+09\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/besteffort\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",image=\"k8s.gcr.io/pause:3.1\",name=\"2c4e70b84674c46f7c0c0645a724da67f76738d6256dd97a11af1b96f9bcb813\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",image=\"k8s.gcr.io/pause:3.1\",name=\"f48be3a6354ddcff99dd51ded97bff900c5841cf94658ee9a8a2cf54485accc1\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable\",image=\"\",name=\"\",namespace=\"\",pod=\"\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",image=\"k8s.gcr.io/pause:3.1\",name=\"1c01487607b2fc9034b71cd61bf5694ccfa7677682a1aeb8606916b957f52b48\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",image=\"k8s.gcr.io/pause:3.1\",name=\"3a89059045a36876a2bf64b2a53a3eef76d5cf5f7410e7db599ab10e0c85742e\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",image=\"k8s.gcr.io/pause:3.1\",name=\"a2ac8105637f2d3d78763bb163b036f8a3ec100d329eea5091e0f806c428e75e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",image=\"k8s.gcr.io/pause:3.1\",name=\"3666b075a75f806962b7071669377c6801f9e0eecde5706e1b016f52d7b1af44\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",image=\"k8s.gcr.io/pause:3.1\",name=\"e687e0da7461c481fbc76e24b43febc34fecc1593bd3a06358a42ef43e97de43\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62\",image=\"\",name=\"\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",image=\"k8s.gcr.io/pause:3.1\",name=\"b77f9be2d81f924157d6d82a0e9be62882ecce6fe04d7a6764936954525d36fb\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a\",image=\"\",name=\"\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod2e4a8134-958b-4b93-a054-b289a73ea206/3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"3f47c9fc7c82894a00bb8c8371734e00ee00af9742d1ed2351791b4a989db78e\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-9msql\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"coredns\",id=\"/kubepods/burstable/pod5e7e8b7d-9b9e-44ff-ad5a-fb796dfa1438/e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",image=\"k8s.gcr.io/coredns:1.6.2\",name=\"e7198823c2fcb09c6ced571d8b6d5f6d5dc9b7a81961224947f031852a1d9587\",namespace=\"kube-system\",pod=\"coredns-5644d7b6d9-mcjfn\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"datadog-agent\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",image=\"docker.io/datadog/agent:7.15.0-rc.8\",name=\"a27eeae6b6d388f14684fc1a804ef6acaabeee013723df47f5038377fbaf5ef1\",namespace=\"default\",pod=\"agent-nsvs4\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"etcd\",id=\"/kubepods/besteffort/pod1b7e79458f25cd7ce30cd4e63978244a/11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",image=\"k8s.gcr.io/etcd:3.3.15-0\",name=\"11ca804d7bd545c390bec86856c0ff3b20a5cb6d1847b8716402ae7511889092\",namespace=\"kube-system\",pod=\"etcd-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"kindnet-cni\",id=\"/kubepods/pod5e647fb9-0ea4-4d2c-8d11-108657bf9a62/78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",image=\"sha256:ef97cccdfdb5048fe112cf868b2779e06dea11b0d742aad14d4bea690f653549\",name=\"78e9ba4bed5ef899932387dcee877db9b9e3ced5462062f9c9d7b41c64ea3169\",namespace=\"kube-system\",pod=\"kindnet-2dv6p\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"kube-apiserver\",id=\"/kubepods/burstable/pod4f0c7a8a1ab3a3f954e34ee342ee6289/97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",image=\"k8s.gcr.io/kube-apiserver:v1.16.1\",name=\"97e0254e65d6fa6dededb6fdbfa77dfc445bc0587d27df3f5a7341ca54894474\",namespace=\"kube-system\",pod=\"kube-apiserver-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"kube-controller-manager\",id=\"/kubepods/burstable/podbbcd59010eb11cc9276880362e52c560/2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",image=\"k8s.gcr.io/kube-controller-manager:v1.16.1\",name=\"2b392cd80184f790db6fce8cc1aebfd73deafbf74e25763c0f3dafb7720f3f11\",namespace=\"kube-system\",pod=\"kube-controller-manager-kind-control-plane\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"kube-proxy\",id=\"/kubepods/besteffort/pod5c4cffef-a021-4e08-88b2-1cd4789f8f9a/d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",image=\"sha256:26bd9734c77c4a7a52ef2ce570c7b7bf9a7193957581bd2562e16f23a7b4ba1e\",name=\"d27d7e61aa5d757cbe1d79d295b319d41d0430d4500dcd924dbccef894da5670\",namespace=\"kube-system\",pod=\"kube-proxy-zr52v\"} 0\ncontainer_spec_memory_swap_limit_bytes{container=\"kube-scheduler\",id=\"/kubepods/burstable/pode05eb744bc3406614b4a55dd00e7af9f/0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",image=\"k8s.gcr.io/kube-scheduler:v1.16.1\",name=\"0db3c51e7e8dd0dba36eca29ec569f541e438432e633308018cc3ef48ef6e014\",namespace=\"kube-system\",pod=\"kube-scheduler-kind-control-plane\"} 0\n# HELP container_start_time_seconds Start time of the container since unix epoch in seconds.\n```\n\n----------------------------------------\n\nTITLE: Markdown Link to Contributing Guidelines\nDESCRIPTION: A markdown reference directing users to the full contribution documentation file within the project's docs directory.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/CONTRIBUTING.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n# Contributing\n\nYou can find information about how to contribute issues and pull requests for this repo in the [project documentation](docs/public/guidelines/contributing.md).\n```\n\n----------------------------------------\n\nTITLE: Exporting Go Runtime Metrics in Prometheus Format\nDESCRIPTION: This snippet exports Go runtime metrics including memory statistics and thread count. It uses the Prometheus exposition format with HELP and TYPE metadata for each metric.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_1\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP go_memstats_stack_sys_bytes Number of bytes obtained from system for stack allocator.\n# TYPE go_memstats_stack_sys_bytes gauge\ngo_memstats_stack_sys_bytes 3.145728e+06\n# HELP go_memstats_sys_bytes Number of bytes obtained from system.\n# TYPE go_memstats_sys_bytes gauge\ngo_memstats_sys_bytes 7.484236e+07\n# HELP go_threads Number of OS threads created.\n# TYPE go_threads gauge\ngo_threads 20\n```\n\n----------------------------------------\n\nTITLE: Container Network Transmit Errors Metrics\nDESCRIPTION: Prometheus metrics showing container network transmission errors for different network interfaces. The metrics include detailed labels for container identification, networking parameters, and Kubernetes metadata. Each metric represents a cumulative count of transmission errors.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_40\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_transmit_errors_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n# HELP container_network_transmit_packets_dropped_total Cumulative count of packets dropped while transmitting\n```\n\n----------------------------------------\n\nTITLE: Defining Go Runtime Metrics in Prometheus\nDESCRIPTION: This snippet defines several metrics related to the Go runtime, including garbage collection duration, number of goroutines, Go version information, and memory allocation. These metrics provide insights into the performance of the Go application.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_4\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP go_gc_duration_seconds A summary of the pause duration of garbage collection cycles.\n# TYPE go_gc_duration_seconds summary\ngo_gc_duration_seconds{quantile=\"0\"} 4.8026e-05\ngo_gc_duration_seconds{quantile=\"0.25\"} 7.9622e-05\ngo_gc_duration_seconds{quantile=\"0.5\"} 9.8971e-05\ngo_gc_duration_seconds{quantile=\"0.75\"} 0.000127097\ngo_gc_duration_seconds{quantile=\"1\"} 0.061485613\ngo_gc_duration_seconds_sum 222.73604075\ngo_gc_duration_seconds_count 560398\n# HELP go_goroutines Number of goroutines that currently exist.\n# TYPE go_goroutines gauge\ngo_goroutines 424\n# HELP go_info Information about the Go environment.\n# TYPE go_info gauge\ngo_info{version=\"go1.16.13\"} 1\n# HELP go_memstats_alloc_bytes Number of bytes allocated and still in use.\n# TYPE go_memstats_alloc_bytes gauge\ngo_memstats_alloc_bytes 3.8401184e+07\n```\n\n----------------------------------------\n\nTITLE: Deprecated Kubelet Pod Worker Start Latency Metrics in Prometheus Format\nDESCRIPTION: This snippet shows deprecated summary metrics for pod worker start latency in microseconds. It includes quantile values, sum, and count of worker starts.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_21\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_pod_worker_start_latency_microseconds (Deprecated) Latency in microseconds from seeing a pod to starting a worker.\n# TYPE kubelet_pod_worker_start_latency_microseconds summary\nkubelet_pod_worker_start_latency_microseconds{quantile=\"0.5\"} NaN\nkubelet_pod_worker_start_latency_microseconds{quantile=\"0.9\"} NaN\nkubelet_pod_worker_start_latency_microseconds{quantile=\"0.99\"} NaN\nkubelet_pod_worker_start_latency_microseconds_sum 2.6950588e+07\nkubelet_pod_worker_start_latency_microseconds_count 15\n```\n\n----------------------------------------\n\nTITLE: Original Code Structure Example in Go\nDESCRIPTION: Example showing the initial code structure before refactoring to use internal folders. Contains a simple struct definition in the main package.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/internal.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\n// a/code.go\npackage a\n\ntype exampleStruct struct {\n    // some fields\n}\n\nfunc doSomethingWithExampleStruct(e exampleStruct) {\n    // some code goes here ...\n}\n```\n\n----------------------------------------\n\nTITLE: Defining Keyboard Navigation Shortcuts in Markdown\nDESCRIPTION: This code snippet defines a markdown table that lists keyboard shortcuts for navigating the documentation. It includes shortcuts for moving to the previous and next pages, as well as opening the search modal.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/index.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n| Keys | Action |\n| --- | --- |\n| <ul><li><kbd>,</kbd> (comma)</li><li><kbd>p</kbd></li></ul> | Navigate to the \"previous\" page |\n| <ul><li><kbd>.</kbd> (period)</li><li><kbd>n</kbd></li></ul> | Navigate to the \"next\" page |\n| <ul><li><kbd>/</kbd></li><li><kbd>s</kbd></li></ul> | Display the search modal |\n```\n\n----------------------------------------\n\nTITLE: Measuring Certificate Signing Request Durations\nDESCRIPTION: Prometheus metrics tracking request durations for certificate signing requests API endpoints, with histogram buckets ranging from 1ms to infinite.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_21.txt#2025-04-22_snippet_44\n\nLANGUAGE: prometheus\nCODE:\n```\nrest_client_request_duration_seconds_bucket{url=\"https://3FFBFD220E427C1C2DCAB691B805C88C.gr7.us-east-1.eks.amazonaws.com/apis/certificates.k8s.io/v1/certificatesigningrequests?fieldSelector=%7Bvalue%7D\",verb=\"GET\",le=\"0.256\"} 1\n```\n\n----------------------------------------\n\nTITLE: Updated Main Package Code with Internal Import in Go\nDESCRIPTION: Example showing how to import and use the internally packaged struct from the main package code.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/internal.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\n// a/code.go\npackage a\n\nimport (\n    \"example.com/a/internal/b\"\n)\n\nfunc doSomethingWithExampleStruct(e b.exampleStruct) {\n    // some code goes here\n}\n```\n\n----------------------------------------\n\nTITLE: Rendering Helper Function Signature in Go\nDESCRIPTION: Defines the signature for helper functions used to render text and HTML output for status providers.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/status.md#2025-04-22_snippet_2\n\nLANGUAGE: go\nCODE:\n```\n(templateFS embed.FS, template string, buffer io.Writer, data any)\n```\n\n----------------------------------------\n\nTITLE: Kubelet Node Configuration Metrics in Prometheus Format\nDESCRIPTION: Gauge metrics providing information about node configuration error status and node identity. The node_config_error is 1 if there's a configuration error, 0 otherwise, while node_name identifies the node with a count of 1.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_14\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP kubelet_node_config_error This metric is true (1) if the node is experiencing a configuration-related error, false (0) otherwise.\n# TYPE kubelet_node_config_error gauge\nkubelet_node_config_error 0\n# HELP kubelet_node_name The node's name. The count is always 1.\n# TYPE kubelet_node_name gauge\nkubelet_node_name{node=\"minikube\"} 1\n```\n\n----------------------------------------\n\nTITLE: Adding Required Module Dependency in Go\nDESCRIPTION: Example of adding a require directive for a nested module dependency with version v0.0.0.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/modules.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\nrequire (\n    // ...\n    github.com/DataDog/datadog-agent/path/to/module v0.0.0\n    // ...\n)\n```\n\n----------------------------------------\n\nTITLE: Referencing Micro-VM Initialization Script in Markdown\nDESCRIPTION: This code snippet references the micro-vm-init.sh script, which is responsible for executing the test-runner helper inside each micro-VM. The script is part of the KMT framework's test execution process.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/new-e2e/system-probe/test-runner/README.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n[micro-vm-init.sh](../test/micro-vm-init.sh)\n```\n\n----------------------------------------\n\nTITLE: Kubelet Runtime Operations Duration Metrics\nDESCRIPTION: Prometheus histogram metrics tracking duration of kubelet runtime operations in seconds. Includes buckets for various operation types like container_status, create_container, exec, exec_sync, image operations, and container/pod listing with their corresponding counts and sums.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_24\n\nLANGUAGE: prometheus\nCODE:\n```\n# TYPE kubelet_runtime_operations_duration_seconds histogram\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.005\"} 93\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.01\"} 130\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.025\"} 156\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.05\"} 164\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.1\"} 167\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.25\"} 172\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"0.5\"} 173\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"1\"} 174\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"2.5\"} 175\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"5\"} 175\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"10\"} 175\nkubelet_runtime_operations_duration_seconds_bucket{operation_type=\"container_status\",le=\"+Inf\"} 175\n```\n\n----------------------------------------\n\nTITLE: File Schema Definition\nDESCRIPTION: JSON schema for serializing file information including path, device path and basename properties.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_windows.md#2025-04-22_snippet_11\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"path\": {\n            \"type\": \"string\",\n            \"description\": \"File path\"\n        },\n        \"device_path\": {\n            \"type\": \"string\",\n            \"description\": \"File device path\"\n        },\n        \"name\": {\n            \"type\": \"string\",\n            \"description\": \"File basename\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"FileSerializer serializes a file to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring CI Tags for Datadog Agent Windows Installer Job\nDESCRIPTION: Sets up tags for a CI job that builds and tests the Datadog Agent Windows installer. The tags specify the job name, architecture, operating system, and include an option for deriving the OS version from the job name.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/unit_tests/testdata/secret.tar.gz/tags.txt#2025-04-22_snippet_0\n\nLANGUAGE: Shell\nCODE:\n```\n--tags ci.job.name:kitchen_windows_installer_agent-a6 --tags arch:x86_64 --tags os:windows upload_option.os_version_from_name\n```\n\n----------------------------------------\n\nTITLE: Displaying REST Client Request Totals by Status Code in Prometheus Format\nDESCRIPTION: Counter metrics showing total REST client requests categorized by HTTP status code, method, and host. The metrics track successful responses (200, 201), client errors (403, 404, 409), server errors (504), and generic error conditions for each HTTP method.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/kubelet_metrics_1_14.txt#2025-04-22_snippet_33\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP rest_client_requests_total Number of HTTP requests, partitioned by status code, method, and host.\n# TYPE rest_client_requests_total counter\nrest_client_requests_total{code=\"200\",host=\"localhost:8443\",method=\"DELETE\"} 3\nrest_client_requests_total{code=\"200\",host=\"localhost:8443\",method=\"GET\"} 10551\nrest_client_requests_total{code=\"200\",host=\"localhost:8443\",method=\"PATCH\"} 1021\nrest_client_requests_total{code=\"200\",host=\"localhost:8443\",method=\"PUT\"} 4370\nrest_client_requests_total{code=\"201\",host=\"localhost:8443\",method=\"POST\"} 705\nrest_client_requests_total{code=\"403\",host=\"localhost:8443\",method=\"GET\"} 2\nrest_client_requests_total{code=\"404\",host=\"localhost:8443\",method=\"GET\"} 9\nrest_client_requests_total{code=\"404\",host=\"localhost:8443\",method=\"PATCH\"} 30\nrest_client_requests_total{code=\"404\",host=\"localhost:8443\",method=\"POST\"} 10\nrest_client_requests_total{code=\"409\",host=\"localhost:8443\",method=\"PUT\"} 16\nrest_client_requests_total{code=\"504\",host=\"localhost:8443\",method=\"PUT\"} 3\nrest_client_requests_total{code=\"<error>\",host=\"localhost:8443\",method=\"GET\"} 50\nrest_client_requests_total{code=\"<error>\",host=\"localhost:8443\",method=\"PATCH\"} 12\nrest_client_requests_total{code=\"<error>\",host=\"localhost:8443\",method=\"POST\"} 7\nrest_client_requests_total{code=\"<error>\",host=\"localhost:8443\",method=\"PUT\"} 6\n# HELP storage_operation_duration_seconds Storage operation duration\n```\n\n----------------------------------------\n\nTITLE: Warning Comment for Auto-generated Windows Security Package\nDESCRIPTION: This comment block warns users not to edit the file manually, as it is auto-generated from a specific source in the project structure.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/security/seclwin/README.md#2025-04-22_snippet_0\n\nLANGUAGE: Markdown\nCODE:\n```\n# DO NOT EDIT\n\nThis package has been auto-generated from the windows file in `pkg/security/secl`. Please do not edit those manually.\n```\n\n----------------------------------------\n\nTITLE: CIDR and IP Range Matching in SECL\nDESCRIPTION: This snippet demonstrates how to use CIDR and IP matching in a SECL rule. It combines DNS question name checking with network destination IP matching using CIDR notation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/scripts/templates/linux_expressions.md#2025-04-22_snippet_2\n\nLANGUAGE: javascript\nCODE:\n```\ndns.question.name == \"example.com\" && network.destination.ip in [192.168.1.25, 10.0.0.0/24]\n\n```\n\n----------------------------------------\n\nTITLE: Demonstrating Git Commit Message Improvement in Markdown\nDESCRIPTION: This snippet shows an example of how to improve a git commit message from a list of unrelated changes to a concise, meaningful description of the changes made.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/guidelines/contributing.md#2025-04-22_snippet_0\n\nLANGUAGE: markdown\nCODE:\n```\n```\nIncluding new features\n\n* Fix linter\n* WIP\n* Add test for x86\n* Fix licenses\n* Cleanup headers\n```\n\nto:\n\n```\nIncluding new features\n\nThis feature does this and that. Some tests are excluded on x86 because of ...\n```\n```\n\n----------------------------------------\n\nTITLE: Querying Container Network Receive Packets in Prometheus Format\nDESCRIPTION: These metrics represent the total number of received packets for specific containers in a Kubernetes cluster. They include detailed labels for container identification and network interface information.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_35\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_receive_packets_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_receive_packets_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n# HELP container_network_transmit_bytes_total Cumulative count of bytes transmitted\n```\n\n----------------------------------------\n\nTITLE: Importing SNMP Scanning Package in Go\nDESCRIPTION: This code snippet demonstrates how to import the snmpscan package from the Datadog Agent project. The package provides functionality for SNMP scanning and walking of network devices.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/comp/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\nimport \"github.com/DataDog/datadog-agent/comp/snmpscan\"\n```\n\n----------------------------------------\n\nTITLE: Querying Container Network Transmit Bytes in Prometheus\nDESCRIPTION: This snippet shows Prometheus metrics for container network transmit bytes. It includes detailed labels for container identification, network interface, and Kubernetes metadata. The metric value and timestamp are provided.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_37\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_transmit_bytes_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n```\n\n----------------------------------------\n\nTITLE: Structuring CMD Folder for Datadog Agent\nDESCRIPTION: Demonstrates the recommended folder structure for organizing binary entry points and subcommands in the Datadog Agent project.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/using-components.md#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\ncmd /\n    <binary name> /\n        main.go                   <-- The entry points from your binary\n        subcommands /             <-- All subcommand for your binary CLI\n            <subcommand name> /   <-- The code specific to a single subcommand\n                command.go\n                command_test.go\n```\n\n----------------------------------------\n\nTITLE: Dependency Imports for OpenTelemetry Build Test\nDESCRIPTION: A skeleton Go file that imports all direct dependencies used in the upstream datadogexporter and datadogconnector modules. Used to verify build compatibility and CGO requirements.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/otel/README.md#2025-04-22_snippet_0\n\nLANGUAGE: go\nCODE:\n```\ndependencies.go\n```\n\n----------------------------------------\n\nTITLE: Configuring Experiment Optimization Goal in YAML\nDESCRIPTION: This YAML snippet demonstrates how to set the optimization goal for a regression detection experiment. The optimization goal determines which metric the Regression Detector will analyze at the conclusion of the experiment.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/test/regression/README.md#2025-04-22_snippet_0\n\nLANGUAGE: yaml\nCODE:\n```\noptimization_goal: ingress_throughput\n```\n\n----------------------------------------\n\nTITLE: Building and Using the GPU Event Viewer Tool\nDESCRIPTION: These commands build the GPU event viewer tool using the Datadog Agent's invoke task system, then run the built tool against the previously recorded events file to view and analyze the GPU events.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/gpu/testutil/event-viewer/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv system-probe.build-gpu-event-viewer\npkg/gpu/testutil/event-viewer/event-viewer path-to-events-file\n```\n\n----------------------------------------\n\nTITLE: Monitoring Container Network Transmit Packets in Prometheus Format\nDESCRIPTION: Prometheus metrics showing container_network_transmit_packets_dropped_total statistics across different network interfaces (eth0, ip6tnl0, tunl0) for a Kubernetes pod. Metrics include container ID, image details, namespace, and pod name along with timestamp.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/cadvisor_metrics_post_1_16.txt#2025-04-22_snippet_42\n\nLANGUAGE: prometheus\nCODE:\n```\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"eth0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"ip6tnl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\ncontainer_network_transmit_packets_dropped_total{container=\"\",id=\"/kubepods/podb2a9216f-557b-45de-8305-18c01e3a598a/7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",image=\"k8s.gcr.io/pause:3.1\",interface=\"tunl0\",name=\"7c19c360f7db4e29653ec4937517eddd10615f069b979aeb87118a93956a51b7\",namespace=\"default\",pod=\"agent-nsvs4\"} 0 1572450189944\n# HELP container_network_transmit_packets_total Cumulative count of packets transmitted\n```\n\n----------------------------------------\n\nTITLE: Building Retry File Dump Tool (Go)\nDESCRIPTION: Instructions for building the retry file dump tool. It involves replacing the package declaration in the copied protobuf file and then building the tool using the Go compiler.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/retry_file_dump/README.md#2025-04-22_snippet_1\n\nLANGUAGE: go\nCODE:\n```\n// In HttpTransactionProto.pb.go replace:\npackage retry\n// with:\npackage main\n```\n\n----------------------------------------\n\nTITLE: Building Agent Binaries for Windows Docker Image\nDESCRIPTION: This command builds the Datadog Agent binaries using a Windows build container. It mounts the current directory, sets necessary environment variables, and executes the PowerShell build script.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/windows/README.md#2025-04-22_snippet_0\n\nLANGUAGE: powershell\nCODE:\n```\ndocker run --rm -it -v \"${pwd}:c:\\mnt\" -e OMNIBUS_TARGET=main -e MAJOR_VERSION=7 -e RELEASE_VERSION=nightly -e PY_RUNTIMES=3 datadog/agent-buildimages-windows_x64:1809 powershell -C \"c:\\mnt\\tasks\\winbuildscripts\\Build-AgentPackages.ps1 -BuildOutOfSource 1 -InstallDeps 1 -CheckGoVersion 1\"\n```\n\n----------------------------------------\n\nTITLE: Defining Process Start Time Metric in Prometheus\nDESCRIPTION: This snippet defines the 'process_start_time_seconds' metric, which represents the start time of the process since the Unix epoch in seconds. It is an ALPHA gauge metric.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/containers/kubelet/testdata/probes.txt#2025-04-22_snippet_1\n\nLANGUAGE: prometheus\nCODE:\n```\n# HELP process_start_time_seconds [ALPHA] Start time of the process since unix epoch in seconds.\n# TYPE process_start_time_seconds gauge\nprocess_start_time_seconds 1.63055914421e+09\n```\n\n----------------------------------------\n\nTITLE: Verifying DDA Installation on macOS/Linux\nDESCRIPTION: Command to verify the successful installation of the Datadog Agent development environment by checking the version of the 'dda' command.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/setup.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\n$ dda --version\n<DDA_LATEST_VERSION>\n```\n\n----------------------------------------\n\nTITLE: Windows-Specific Compiler Configuration\nDESCRIPTION: Configures MSVC to use static C runtime and sets GNU compiler flags for Windows builds.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/rtloader/three/CMakeLists.txt#2025-04-22_snippet_1\n\nLANGUAGE: cmake\nCODE:\n```\nif(WIN32)\n  if(MSVC)\n    foreach(flag_var\n            CMAKE_CXX_FLAGS CMAKE_CXX_FLAGS_DEBUG CMAKE_CXX_FLAGS_RELEASE\n            CMAKE_CXX_FLAGS_MINSIZEREL CMAKE_CXX_FLAGS_RELWITHDEBINFO)\n    if(${flag_var} MATCHES \"/MD\")\n        string(REGEX REPLACE \"/MD\" \"/MT\" ${flag_var} \"${${flag_var}}\")\n    endif(${flag_var} MATCHES \"/MD\")\n    endforeach(flag_var)\n  else()\n     set(CMAKE_C_FLAGS \"-D_hypot=hypot\")\n     set(CMAKE_CXX_FLAGS \"-D_hypot=hypot\")\n  endif()\n  string(REPLACE \"\\\\\" \"\\\\\\\\\" Python3_STDLIB ${Python3_STDLIB})\nendif()\n```\n\n----------------------------------------\n\nTITLE: Creating simple-v2 Datadog Package Archive\nDESCRIPTION: Command to create a simple-v2 Datadog Package archive for testing purposes. This generates a tar archive at 'pkg/fleet/installer/fixtures/oci-layout-simple-v2.tar' with configs from specified directories.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/fleet/installer/fixtures/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndatadog-package create --archive --version \"v2\" --archive-path \"pkg/fleet/installer/fixtures/oci-layout-simple-v2.tar\" --package \"simple\" --configs pkg/fleet/installer/fixtures/simple-v2-config pkg/fleet/installer/fixtures/simple-v2\n```\n\n----------------------------------------\n\nTITLE: Using Retry File Dump Tool (Bash)\nDESCRIPTION: This command demonstrates how to use the retry file dump tool. It processes all .retry files in a specified directory and creates corresponding JSON files.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tools/retry_file_dump/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\n./retry_file_dump --folder=/opt/datadog-agent/run/transactions_to_retry/c47da40ac935c8fd5ca1441a5ee3d068/\n```\n\n----------------------------------------\n\nTITLE: Installing Parallels Virtualization SDK\nDESCRIPTION: Homebrew command to install Parallels Virtualization SDK for macOS.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/devenv/README.md#2025-04-22_snippet_3\n\nLANGUAGE: bash\nCODE:\n```\nbrew cask install parallels-virtualization-sdk\n```\n\n----------------------------------------\n\nTITLE: TODO Comment in Markdown for Datadog Agent Metadata\nDESCRIPTION: A placeholder comment in Markdown indicating that metadata information needs to be added to this file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/shared_features/metadata.md#2025-04-22_snippet_0\n\nLANGUAGE: Markdown\nCODE:\n```\n# Metadata\n\n<!-- TODO -->\n```\n\n----------------------------------------\n\nTITLE: Windows System Resource Performance Counters\nDESCRIPTION: Performance counter IDs and descriptions for Windows system resource monitoring, including executive resource metrics, synchronization, and spinlock statistics\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/system/testfiles/counter_indexes_en-us.txt#2025-04-22_snippet_1\n\nLANGUAGE: plaintext\nCODE:\n```\nExec. Resource Acquires AcqShrdStarveExcl/sec\\n16874\\nExec. Resource Recursive Sh. Acquires AcqShrdStarveExcl/sec\\n16876\\nExec. Resource Contention AcqShrdStarveExcl/sec\\n16878\n```\n\n----------------------------------------\n\nTITLE: Building Datadog Agent Package in Linux Docker Container\nDESCRIPTION: This command runs the Omnibus build task for the Datadog Agent in a Docker container. It mounts necessary volumes for source code, build artifacts, and Ruby gems.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/dev/agent_omnibus.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\ndocker run -v \"$PWD:/go/src/github.com/DataDog/datadog-agent\" -v \"/tmp/omnibus:/omnibus\" -v \"/tmp/opt/datadog-agent:/opt/datadog-agent\" -v\"/tmp/gems:/gems\" --workdir=/go/src/github.com/DataDog/datadog-agent datadog/agent-buildimages-linux-glibc-2-17-x64 dda inv -- -e omnibus.build --base-dir=/omnibus --gem-path=/gems\n```\n\n----------------------------------------\n\nTITLE: Running Revive Linter for Branch Changes\nDESCRIPTION: Command to show revive linter issues only for changes in the current branch compared to main. Useful for checking new code changes before submitting a PR.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/show_linters_issues/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\ndda inv -e show-linters-issues --filter-linters \"revive\" --from-commit-hash \"main\"\n```\n\n----------------------------------------\n\nTITLE: Listing Diagnose Subcommands in Bash\nDESCRIPTION: This command shows the help menu for the 'agent diagnose' command, listing available subcommands and their descriptions. It provides an overview of the diagnose command's capabilities.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/cmd/agent/subcommands/diagnose/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\nagent diagnose -h\n```\n\n----------------------------------------\n\nTITLE: Defining SELinuxBoolCommit JSON Schema for Boolean Commit Operations\nDESCRIPTION: JSON schema definition for the SELinuxBoolCommit structure which represents a commit operation for SELinux boolean changes. It captures the state of the commit operation.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_45\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"state\": {\n            \"type\": \"boolean\",\n            \"description\": \"SELinux boolean commit operation\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"SELinuxBoolCommitSerializer serializes a SELinux boolean commit to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Accessing Kubernetes Password Secret with ENC Token\nDESCRIPTION: Example of referencing a Kubernetes secret named 'password' using the ENC token syntax in Datadog configuration templates.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/secrets-helper/README.md#2025-04-22_snippet_5\n\nLANGUAGE: yaml\nCODE:\n```\nENC[password]\n```\n\n----------------------------------------\n\nTITLE: Defining CGroupContext JSON Schema\nDESCRIPTION: JSON schema for serializing a cgroup context, including properties for the CGroup ID and manager.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/cloud-workload-security/backend_linux.md#2025-04-22_snippet_20\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"properties\": {\n        \"id\": {\n            \"type\": \"string\",\n            \"description\": \"CGroup ID\"\n        },\n        \"manager\": {\n            \"type\": \"string\",\n            \"description\": \"CGroup manager\"\n        }\n    },\n    \"additionalProperties\": false,\n    \"type\": \"object\",\n    \"description\": \"CGroupContextSerializer serializes a cgroup context to JSON\"\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Code Ownership Rules for GitLab Repository\nDESCRIPTION: This snippet defines code ownership rules for different file patterns in a GitLab repository. It specifies which teams are responsible for reviewing changes to various parts of the codebase, including the root directory, markdown files, GitLab-specific files, and a security configuration file.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/tasks/unit_tests/testdata/codeowners.txt#2025-04-22_snippet_0\n\nLANGUAGE: GitLab CODEOWNERS\nCODE:\n```\n/.*                     @DataDog/team-everything\n/*.md                   @DataDog/team-a @DataDog/team-doc\n/.gitlab/               @DataDog/team-a\n/.gitlab/security.yml   @DataDog/team-b\n```\n\n----------------------------------------\n\nTITLE: Defining a Scrubber Module in Go\nDESCRIPTION: This snippet shows how to create an Fx module for a scrubber component. It demonstrates the use of fx.Module to group related options and improve code organization.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/docs/public/components/fx.md#2025-04-22_snippet_4\n\nLANGUAGE: go\nCODE:\n```\nfunc Module() fxutil.Module {\n    return fx.Module(\"scrubber\",\n    fx.Provide(newScrubber))    // now newScrubber need not be exported\n}\n```\n\n----------------------------------------\n\nTITLE: Sample Windows Debugger Output for Crash Dump Analysis\nDESCRIPTION: This code snippet shows a sample output from the Windows debugger callback when analyzing a crash dump. It includes information about the crash, loaded modules, symbol loading errors, and the call stack at the time of the crash.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/pkg/collector/corechecks/system/wincrashdetect/probe/README.md#2025-04-22_snippet_0\n\nLANGUAGE: plaintext\nCODE:\n```\nKernel Bitmap Dump File: Kernel address space is available, User address space may not be available.\n\nSymbol search path is: srv*\nExecutable search path is:\n*** ERROR: Symbol file could not be found.  Defaulted to export symbols for ntkrnlmp.exe -\nWindows 10 Kernel Version 14393 MP (2 procs) Free x64\nProduct: Server, suite: TerminalServer SingleUserTS\nBuilt by: 14393.5989.amd64fre.GitEnlistment.230602-1907\nMachine Name:\nKernel base = 0xfffff800`4567f000 PsLoadedModuleList = 0xfffff800`45984cf0\nDebug session time: Mon Jun 26 20:44:49.742 2023 (UTC - 7:00)\nSystem Uptime: 0 days 0:03:58.449\n*** ERROR: Symbol file could not be found.  Defaulted to export symbols for ntkrnlmp.exe -\nLoading Kernel Symbols\n...............................................................\n................................................................\n........................\nLoading User Symbols\n\nLoading unloaded module list\n...........\n\n************* Symbol Loading Error Summary **************\nModule name            Error\nntkrnlmp               The system cannot find the file specified\n\nYou can troubleshoot most symbol related issues by turning on symbol loading diagnostics (!sym noisy) and repeating the\ncommand that caused symbols to be loaded.\nYou should also verify that your symbol search path (.sympath) is correct.\nUnable to add extension DLL: kdexts\nUnable to add extension DLL: kext\nUnable to add extension DLL: exts\nThe call to LoadLibrary(ext) failed, Win32 error 0n2\n    \"The system cannot find the file specified.\"\nPlease check your debugger configuration and/or network access.\nThe call to LoadLibrary(ext) failed, Win32 error 0n2\n    \"The system cannot find the file specified.\"\nPlease check your debugger configuration and/or network access.\n*******************************************************************************\n*                                                                             *\n*                        Bugcheck Analysis                                    *\n*                                                                             *\n*******************************************************************************\nBugcheck code 0000007E\nArguments ffffffff`c0000005 fffff806`f7e010e6 ffffb481`789326a8 ffffb481`78931ef0\n\nRetAddr           : Args to Child                                                           : Call Site\nfffff800`457f4db0 : 00000000`0000007e ffffffff`c0000005 fffff806`f7e010e6 ffffb481`789326a8 : nt!KeBugCheckEx\nfffff800`457cb7bf : 00000000`00000004 00000000`00000000 00007fff`ffff0000 ffffc582`1b4e3800 : nt!memset+0x5530\nfffff800`457e602d : ffffb481`78933000 ffffb481`789318c0 00000000`00000000 00000000`00000050 : nt!_C_specific_handler+0x9\nf\nfffff800`457742a1 : ffffb481`78933000 00000000`00000000 ffffb481`7892d000 00000000`00000000 : nt!_chkstk+0x5d\nfffff800`457730c4 : ffffb481`789326a8 ffffb481`789323f0 ffffb481`789326a8 ffffb481`78932570 : nt!KeQuerySystemTimePrecis\ne+0x27d1\nfffff800`457ee482 : 00003c74`00000000 fffff800`458a1d00 00000000`00000000 fffff800`45d940c4 : nt!KeQuerySystemTimePrecis\ne+0x15f4\nfffff800`457eafc0 : 00000000`00000000 fffff800`45a97fe0 ffff8301`2c077220 ffffc582`1bb72c30 : nt!setjmpex+0x7622\nfffff806`f7e010e6 : 00000000`00000001 00000000`00000000 ffffb481`76e2e000 fffff800`456e6511 : nt!setjmpex+0x4160\n*** ERROR: Module load completed but symbols could not be loaded for ddapmcrash.sys\nfffff806`f7e07020 : ffffc582`1bb72c30 ffffc582`19f18000 ffffc582`1bb72c30 ffff3ac8`f399d666 : ddapmcrash+0x10e6\nfffff800`45b338f7 : 00000000`00000000 00000000`00000000 ffffc582`1bb72c30 ffffffff`000001c8 : ddapmcrash+0x7020\nfffff800`45ad140e : 00000000`00000000 00000000`00000000 00000000`00000000 fffff800`45a3e2c0 : nt!FsRtlNotifyVolumeEventE\nx+0x243b\nfffff800`45715dc9 : fffff800`00000000 ffffffff`80000ba4 ffffc582`1b4e3800 fffff800`45a3e2c0 : nt!MmGetPhysicalMemoryRang\nesEx+0xb56\nfffff800`456c6f85 : ffffc582`1b4e3800 00000000`00000080 ffffc582`18a636c0 ffffc582`1b4e3800 : nt!KdPollBreakIn+0x8059\nfffff800`457e4df6 : ffffb481`76e15180 ffffc582`1b4e3800 fffff800`456c6f44 00000000`00000246 : nt!PsGetProcessSessionIdEx\n+0x2d5\n00000000`00000000 : ffffb481`78933000 ffffb481`7892d000 00000000`00000000 00000000`00000000 : nt!KeSynchronizeExecution+\n0x7756\n\nRetAddr           : Args to Child                                                           : Call Site\nfffff800`457f4db0 : 00000000`0000007e ffffffff`c0000005 fffff806`f7e010e6 ffffb481`789326a8 : nt!KeBugCheckEx\nfffff800`457cb7bf : 00000000`00000004 00000000`00000000 00007fff`ffff0000 ffffc582`1b4e3800 : nt!memset+0x5530\nfffff800`457e602d : ffffb481`78933000 ffffb481`789318c0 00000000`00000000 00000000`00000050 : nt!_C_specific_handler+0x9\nf\nfffff800`457742a1 : ffffb481`78933000 00000000`00000000 ffffb481`7892d000 00000000`00000000 : nt!_chkstk+0x5d\nfffff800`457730c4 : ffffb481`789326a8 ffffb481`789323f0 ffffb481`789326a8 ffffb481`78932570 : nt!KeQuerySystemTimePrecis\ne+0x27d1\nfffff800`457ee482 : 00003c74`00000000 fffff800`458a1d00 00000000`00000000 fffff800`45d940c4 : nt!KeQuerySystemTimePrecis\ne+0x15f4\nfffff800`457eafc0 : 00000000`00000000 fffff800`45a97fe0 ffff8301`2c077220 ffffc582`1bb72c30 : nt!setjmpex+0x7622\nfffff806`f7e010e6 : 00000000`00000001 00000000`00000000 ffffb481`76e2e000 fffff800`456e6511 : nt!setjmpex+0x4160\nfffff806`f7e07020 : ffffc582`1bb72c30 ffffc582`19f18000 ffffc582`1bb72c30 ffff3ac8`f399d666 : ddapmcrash+0x10e6\nfffff800`45b338f7 : 00000000`00000000 00000000`00000000 ffffc582`1bb72c30 ffffffff`000001c8 : ddapmcrash+0x7020\nfffff800`45ad140e : 00000000`00000000 00000000`00000000 00000000`00000000 fffff800`45a3e2c0 : nt!FsRtlNotifyVolumeEventE\nx+0x243b\nfffff800`45715dc9 : fffff800`00000000 ffffffff`80000ba4 ffffc582`1b4e3800 fffff800`45a3e2c0 : nt!MmGetPhysicalMemoryRang\nesEx+0xb56\nfffff800`456c6f85 : ffffc582`1b4e3800 00000000`00000080 ffffc582`18a636c0 ffffc582`1b4e3800 : nt!KdPollBreakIn+0x8059\nfffff800`457e4df6 : ffffb481`76e15180 ffffc582`1b4e3800 fffff800`456c6f44 00000000`00000246 : nt!PsGetProcessSessionIdEx\n+0x2d5\n00000000`00000000 : ffffb481`78933000 ffffb481`7892d000 00000000`00000000 00000000`00000000 : nt!KeSynchronizeExecution+\n0x7756\nPS C:\\Users\\Administrator>\n```\n\n----------------------------------------\n\nTITLE: Force Killing and Auto-Restarting Process-Agent\nDESCRIPTION: Demonstrates how to force kill the process-agent, which will automatically restart due to s6 supervision.\nSOURCE: https://github.com/datadog/datadog-agent/blob/main/Dockerfiles/agent/SUPERVISION.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\nkill -9 $(pidof process-agent)\ns6-svstat /var/run/s6/services/process/\n```"
  }
]