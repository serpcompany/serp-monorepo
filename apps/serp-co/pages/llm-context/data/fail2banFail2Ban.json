[
  {
    "owner": "fail2ban",
    "repo": "fail2ban",
    "content": "TITLE: Defining a Fail2ban Filter Configuration\nDESCRIPTION: Example of a filter configuration file structure showing the failregex parameter that defines patterns for identifying failed authentication attempts in log files.\n\nLANGUAGE: ini\nCODE:\n```\n[Definition]\n\nfailregex = authentication failed for .* from <HOST>\n            Failed [-/\\w]+ for .* from <HOST>\n\nignoreregex =\n```\n\n----------------------------------------\n\nTITLE: Defining a Fail2ban Filter with Time Pattern\nDESCRIPTION: Example of a filter definition showing how to capture and parse timestamps in log entries using the failregex parameter with the <HOST> macro.\n\nLANGUAGE: ini\nCODE:\n```\n[Definition]\n\nfailregex = ^%(__prefix_line)s(?:\\[\\d+\\])?\\s*Authentication failure for .* from <HOST>\n\nignoreregex =\n\ndatepattern = {^LN-BEG}(?:DAY )?MON Day 24hour:Minute:Second(?:\\.Microseconds)?(?: Year)?\n```\n\n----------------------------------------\n\nTITLE: Configuring a Fail2ban Action with Command Parameters\nDESCRIPTION: Example of an action configuration showing the actionban parameter that defines the command executed when an IP address is banned. It demonstrates variable substitution with <ip>.\n\nLANGUAGE: ini\nCODE:\n```\n[Definition]\n\nactionban = iptables -I fail2ban-<name> 1 -s <ip> -j DROP\n```\n\n----------------------------------------\n\nTITLE: SSH Authentication Failure Logs Showing Failed Login Attempts from Suspicious Users\nDESCRIPTION: Log entries from sshd showing multiple failed authentication attempts, including invalid users 'r00t' and 'oracle' from IP 192.0.2.100. The logs also show PAM authentication errors from example.com, which fail2ban would typically monitor to block brute force attacks.\n\nLANGUAGE: log\nCODE:\n```\nApr  2 17:51:27 <4.3> pancake sshd[55624]: error: PAM: authentication error for nick from example.com\nApr  2 17:51:32 <4.6> pancake sshd[55628]: Invalid user r00t from 192.0.2.100\nApr  2 17:51:33 <4.3> pancake sshd[55628]: error: PAM: authentication error for illegal user r00t from example.com\nApr  2 17:51:33 <4.6> pancake sshd[55628]: Failed keyboard-interactive/pam for invalid user r00t from 192.0.2.100 port 46050 ssh2\nApr  2 17:51:34 <4.3> pancake sshd[55628]: error: PAM: authentication error for illegal user r00t from example.com\nApr  2 17:51:34 <4.6> pancake sshd[55628]: Failed keyboard-interactive/pam for invalid user r00t from 192.0.2.100 port 46050 ssh2\nApr  2 17:51:36 <4.3> pancake sshd[55628]: error: PAM: authentication error for illegal user r00t from example.com\nApr  2 17:51:36 <4.6> pancake sshd[55628]: Failed keyboard-interactive/pam for invalid user r00t from 192.0.2.100 port 46050 ssh2\nApr  2 17:52:06 <4.6> pancake sshd[55647]: Invalid user oracle from 192.0.2.100\nApr  2 17:52:07 <4.3> pancake sshd[55647]: error: PAM: authentication error for illegal user oracle from example.com\n```\n\n----------------------------------------\n\nTITLE: Parsing SSH Authentication Failure Logs\nDESCRIPTION: System log entries showing multiple failed SSH login attempts with different invalid usernames from the same IP address (183.60.159.20). This type of log data is typically monitored by security tools like fail2ban to detect and block brute force attacks.\n\nLANGUAGE: log\nCODE:\n```\nMar 19 23:48:18 <auth.info> pancake sshd[55517]: Invalid user r00t from 183.60.159.20\nMar 19 23:48:20 <auth.info> pancake sshd[55519]: Invalid user r00t from 183.60.159.20\nMar 19 23:50:03 <auth.info> pancake sshd[55604]: Invalid user http from 183.60.159.20\nMar 19 23:50:05 <auth.info> pancake sshd[55606]: Invalid user kylix from 183.60.159.20\nMar 19 23:50:08 <auth.info> pancake sshd[55608]: Invalid user nagios from 183.60.159.20\n```\n\n----------------------------------------\n\nTITLE: Examining SSH Authentication Failure Log Entries\nDESCRIPTION: These log entries show three related SSH authentication failures for an invalid user 'oracle' from IP 192.0.2.100. The logs include the initial invalid user detection, a PAM authentication error, and a failed keyboard-interactive authentication attempt.\n\nLANGUAGE: log\nCODE:\n```\nApr  2 17:52:55 pancake sshd[55657]: Invalid user oracle from 192.0.2.100\nApr  2 17:53:01 pancake sshd[55657]: error: PAM: authentication error for illegal user oracle from example.com\nApr  2 17:53:01 pancake sshd[55657]: Failed keyboard-interactive/pam for invalid user oracle from 192.0.2.100 port 48856 ssh2\n```\n\n----------------------------------------\n\nTITLE: Configuring iptables Rules for xt_recent Module\nDESCRIPTION: Sample iptables command to set up a rule that checks the xt_recent list to block IPs for one hour. This rule must be added to the static firewall initialization script.\n\nLANGUAGE: bash\nCODE:\n```\niptables -I INPUT -m recent --update --seconds 3600 --name fail2ban-<name> -j DROP\n```\n\n----------------------------------------\n\nTITLE: Creating an Unprivileged Fail2ban User with System Access\nDESCRIPTION: Command to create a system user 'fail2ban' that can access log files by adding it to the 'adm' group without creating a home directory.\n\nLANGUAGE: bash\nCODE:\n```\nuseradd --system --no-create-home --home-dir / --groups adm fail2ban\n```\n\n----------------------------------------\n\nTITLE: Including Issue Closing Statement in Pull Requests for Fail2Ban\nDESCRIPTION: Shows the syntax for closing an issue when submitting a pull request to the Fail2Ban repository. The code demonstrates how to include a reference to close an issue automatically when the pull request is merged.\n\nLANGUAGE: markdown\nCODE:\n```\nCloses #ISSUE\n```\n\n----------------------------------------\n\nTITLE: Creating Documentation Table of Contents in reStructuredText\nDESCRIPTION: This snippet defines the main structure of the Fail2Ban developer documentation using Sphinx's toctree directive. It sets up a maximum depth of 2 and includes links to development guides, filters documentation, release information, and general Fail2Ban documentation.\n\nLANGUAGE: rst\nCODE:\n```\n.. toctree::\n   :maxdepth: 2\n\n   develop\n   filters\n   release\n   fail2ban\n```\n\n----------------------------------------\n\nTITLE: Defining fail2ban Package Structure with reStructuredText\nDESCRIPTION: A reStructuredText (rst) toctree directive that defines the structure of the fail2ban package documentation. It lists the major modules and components that make up the fail2ban system.\n\nLANGUAGE: rst\nCODE:\n```\n.. toctree::\n\n   fail2ban.client\n   fail2ban.server\n\n   fail2ban.exceptions\n   fail2ban.helpers\n   fail2ban.protocol\n   fail2ban.version\n```\n\n----------------------------------------\n\nTITLE: Including Development Documentation in RST\nDESCRIPTION: A reStructuredText directive that includes external documentation from the '../DEVELOP' file. This is a common pattern for modularizing documentation in RST-based documentation systems.\n\nLANGUAGE: rst\nCODE:\n```\n.. include:: ../DEVELOP\n```\n\n----------------------------------------\n\nTITLE: Sphinx Documentation Directive for fail2ban.server.filter Module\nDESCRIPTION: A restructuredtext directive for Sphinx that configures autodoc to generate documentation for the fail2ban.server.filter module. The directive includes all members, undocumented members, and inheritance information.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.filter\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx Documentation Directive for fail2ban.server.actions Module\nDESCRIPTION: A Sphinx reStructuredText directive that automatically generates documentation for the fail2ban.server.actions module. The directive is configured to include all members, undocumented members, and show inheritance information.\n\nLANGUAGE: rst\nCODE:\n```\n.. automodule:: fail2ban.server.actions\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring Sphinx Documentation for fail2ban.server.action Module\nDESCRIPTION: This RST (reStructuredText) directive configures how Sphinx should document the fail2ban.server.action module, including all members, undocumented members, and inheritance relationships.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.action\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring Autodoc for fail2ban.server.database Module in ReStructuredText\nDESCRIPTION: Sphinx autodoc directive configuration for generating comprehensive API documentation for the fail2ban.server.database module. The directive includes all members, undocumented members, and shows class inheritance relationships.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.database\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx automodule Directive for fail2ban.server.jails Module\nDESCRIPTION: A Sphinx directive that automatically documents the fail2ban.server.jails module. The directive includes all members, undocumented members, and shows inheritance relationships.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.jails\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring Sphinx Automodule for fail2ban.server.utils\nDESCRIPTION: This RST directive configures Sphinx to automatically generate documentation for all members, undocumented members, and inheritance relationships in the fail2ban.server.utils module.\n\nLANGUAGE: rst\nCODE:\n```\n.. automodule:: fail2ban.server.utils\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring Sphinx Documentation for fail2ban.server.ticket Module\nDESCRIPTION: Sphinx configuration directives for generating documentation for the fail2ban.server.ticket module. The configuration includes showing all members, undocumented members, and inheritance relationships.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.ticket\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx autodoc directive for Fail2ban transmitter module in reST\nDESCRIPTION: This Sphinx directive automatically generates documentation for the transmitter module in the Fail2ban server component. It includes all members, undocumented members, and shows inheritance relationships.\n\nLANGUAGE: reST\nCODE:\n```\n.. automodule:: fail2ban.server.transmitter\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx Autodoc Configuration for Fail2ban Asyncserver Module\nDESCRIPTION: Sphinx configuration directive that sets up automatic documentation generation for the fail2ban.server.asyncserver module. The configuration includes all members, undocumented members, and displays inheritance information.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.asyncserver\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring autodoc for fail2ban.server.jailthread Module in reStructuredText\nDESCRIPTION: This snippet configures Sphinx's autodoc extension to generate documentation for the fail2ban.server.jailthread module, including all members, undocumented members, and inheritance relationships.\n\nLANGUAGE: reStructuredText\nCODE:\n```\n.. automodule:: fail2ban.server.jailthread\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx Documentation for fail2ban.server.filterpoll Module\nDESCRIPTION: A reStructuredText (RST) directive that uses Sphinx's automodule feature to automatically generate documentation for the fail2ban.server.filterpoll module. The directive includes all members, undocumented members, and inheritance information.\n\nLANGUAGE: rst\nCODE:\n```\n.. automodule:: fail2ban.server.filterpoll\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Generating Module Documentation with Sphinx/reStructuredText for fail2ban.server.filtersystemd\nDESCRIPTION: A reStructuredText directive for automatically generating documentation for the fail2ban.server.filtersystemd module. It includes all members, undocumented members, and shows inheritance information.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.filtersystemd\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Defining Sphinx toctree for Fail2ban Client Package in ReStructuredText\nDESCRIPTION: This snippet defines a toctree directive in Sphinx documentation that lists all the modules included in the fail2ban.client package. The toctree serves as a navigation structure for the package documentation.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. toctree::\n\n   fail2ban.client.actionreader\n   fail2ban.client.beautifier\n   fail2ban.client.configparserinc\n   fail2ban.client.configreader\n   fail2ban.client.configurator\n   fail2ban.client.csocket\n   fail2ban.client.fail2banreader\n   fail2ban.client.filterreader\n   fail2ban.client.jailreader\n   fail2ban.client.jailsreader\n```\n\n----------------------------------------\n\nTITLE: Setting up automatic module documentation with Sphinx for Fail2ban's configparserinc module\nDESCRIPTION: A Sphinx documentation directive that automatically generates documentation for the fail2ban.client.configparserinc module. It includes all module members, undocumented members, and inheritance information.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.client.configparserinc\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring Module Documentation in RST\nDESCRIPTION: This RST (reStructuredText) snippet configures automatic documentation generation for the fail2ban.client.jailreader module. It uses the automodule directive to include all members, undocumented members, and show inheritance relationships.\n\nLANGUAGE: rst\nCODE:\n```\nfail2ban.client.jailreader module\n=================================\n\n.. automodule:: fail2ban.client.jailreader\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Autodoc Configuration for fail2ban.server.datetemplate Module\nDESCRIPTION: This snippet uses Sphinx autodoc directives to automatically generate documentation for the fail2ban.server.datetemplate module. It includes all members, undocumented members, and inheritance information.\n\nLANGUAGE: restructuredtext\nCODE:\n```\n.. automodule:: fail2ban.server.datetemplate\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx Documentation Directive for fail2ban.server.mytime Module\nDESCRIPTION: This reStructuredText snippet configures Sphinx to automatically document the fail2ban.server.mytime module. It includes all members, undocumented members, and shows inheritance relationships in the generated documentation.\n\nLANGUAGE: rst\nCODE:\n```\n.. automodule:: fail2ban.server.mytime\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring automodule for fail2ban.server.strptime Documentation\nDESCRIPTION: reStructuredText directive that configures the autodoc extension to generate comprehensive documentation for the fail2ban.server.strptime module, including all members, undocumented members, and inheritance information.\n\nLANGUAGE: reStructuredText\nCODE:\n```\n.. automodule:: fail2ban.server.strptime\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx autodoc directive for fail2ban.helpers module in reStructuredText\nDESCRIPTION: A reStructuredText directive that instructs Sphinx documentation system to automatically document the fail2ban.helpers module, including its members, undocumented members, and inheritance relationships.\n\nLANGUAGE: reStructuredText\nCODE:\n```\n.. automodule:: fail2ban.helpers\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Sphinx Autodocumentation for fail2ban.protocol Module\nDESCRIPTION: Sphinx directive to automatically generate documentation for the fail2ban.protocol module. The directive includes options to document all members, undocumented members, and show inheritance relationships.\n\nLANGUAGE: rst\nCODE:\n```\n.. automodule:: fail2ban.protocol\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```\n\n----------------------------------------\n\nTITLE: Configuring Sphinx Documentation for fail2ban.version Module\nDESCRIPTION: ReStructuredText directive for Sphinx that automatically generates documentation for the fail2ban.version module. It includes all members, undocumented members, and shows inheritance information.\n\nLANGUAGE: rst\nCODE:\n```\n.. automodule:: fail2ban.version\n    :members:\n    :undoc-members:\n    :show-inheritance:\n```"
  }
]