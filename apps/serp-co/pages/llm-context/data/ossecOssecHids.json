[
  {
    "owner": "ossec",
    "repo": "ossec-hids",
    "content": "TITLE: Detecting Empty Password Accounts in OSSEC\nDESCRIPTION: OSSEC rule that searches for accounts with empty passwords in the /etc/shadow file. This check satisfies PCI-DSS requirement 10.2.5 and is a critical security control.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - Account with empty password present {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Local Admin Password Management\nDESCRIPTION: Registry check to ensure LAPS Local Admin Password Management is enabled. Verifies AdmPwdEnabled is set to 1 and exists in the AdmPwd services policy path.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> AdmPwdEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !AdmPwdEnabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying Security Event Log Size\nDESCRIPTION: Checks if the Security Event Log maximum size is set to at least 196,608 KB to ensure sufficient storage for security audit events that are critical for incident response and security monitoring.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:0\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:1\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:2\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Detecting Non-root Accounts with UID 0 in OSSEC\nDESCRIPTION: OSSEC rule to check for non-root accounts with UID 0 in /etc/passwd. This is a critical security check that identifies privilege escalation vulnerabilities where regular accounts have root-level access.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 9.2.5 - Non-root account with uid 0 {CIS: 9.2.5 RHEL5} {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender Attack Surface Reduction Rules in Registry\nDESCRIPTION: Verifies that Attack Surface Reduction rules in Windows Defender are enabled by checking if the ExploitGuard_ASR_Rules registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR -> ExploitGuard_ASR_Rules -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR -> !ExploitGuard_ASR_Rules;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: Microsoft Firewall Disabled Detection\nDESCRIPTION: Identifies when the Microsoft Windows Firewall has been disabled, creating potential security vulnerabilities. References PCI-DSS sections 10.6.1 and 1.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[Microsoft Firewall disabled {PCI_DSS: 10.6.1, 1.4}] [all] []\nr:HKEY_LOCAL_MACHINE\\software\\policies\\microsoft\\windowsfirewall\\domainprofile -> enablefirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\software\\policies\\microsoft\\windowsfirewall\\standardprofile -> enablefirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Audit Log Connection Policy Check in OSSEC\nDESCRIPTION: Ensures audit_log_connection_policy is not set to 'none' per CIS recommendation 6.5. This setting controls what connection events are written to the audit log.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.5: audit_log_connection_policy is set to 'none' change it to all or erros] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r^# && r::audit_log_connection_policy\\s*=\\s*none;\nf:$mysql-cnfs -> r:audit_log_connection_policy\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Defining Rootkit Detection Patterns for OSSEC Security\nDESCRIPTION: A comprehensive list of file paths and patterns associated with known rootkits, worms, sniffers and other malicious software. Each line specifies a file path pattern followed by an explanation of the associated threat, along with links to additional information where applicable.\n\nLANGUAGE: plain text\nCODE:\n```\n# 0vason rootkit\n*/ovas0n                ! ovas0n rootkit ::/rootkits/ovason.php\n*/ovason                ! ovas0n rootkit ::/rootkits/ovason.php\n\n# Rpimp reverse telnet\n*/rpimp                 ! rpv21 (Reverse Pimpage)::/rootkits/rpimp.php\n\n# Cback Linux worm\ntmp/cback              ! cback worm ::/rootkits/cback.php\ntmp/derfiq             ! cback worm ::/rootkits/cback.php\n\n# aPa Kit (from rkhunter)\nusr/share/.aPa          ! Apa Kit\n\n# enye-sec Rootkit\netc/.enyelkmHIDE^IT.ko  ! enye-sec Rootkit ::/rootkits/enye-sec.php\n\n# Override Rootkit\ndev/grid-hide-pid-     ! Override rootkit ::/rootkits/override.php\ndev/grid-unhide-pid-   ! Override rootkit ::/rootkits/override.php\ndev/grid-show-pids     ! Override rootkit ::/rootkits/override.php\ndev/grid-hide-port-    ! Override rootkit ::/rootkits/override.php\ndev/grid-unhide-port-  ! Override rootkit ::/rootkits/override.php\n\n# PHALANX rootkit\nusr/share/.home*        ! PHALANX rootkit ::\nusr/share/.home*/tty    ! PHALANX rootkit ::\netc/host.ph1            ! PHALANX rootkit ::\nbin/host.ph1            ! PHALANX rootkit ::\n\n# ZK rootkit (http://honeyblog.org/junkyard/reports/redhat-compromise2.pdf)\n# and from chkrootkit\nusr/share/.zk                   ! ZK rootkit ::\nusr/share/.zk/zk                ! ZK rootkit ::\netc/1ssue.net                   ! ZK rootkit ::\nusr/X11R6/.zk                   ! ZK rootkit ::\nusr/X11R6/.zk/xfs               ! ZK rootkit ::\nusr/X11R6/.zk/echo              ! ZK rootkit ::\netc/sysconfig/console/load.zk   ! ZK rootkit ::\n\n# Public sniffers\n*/.linux-sniff          ! Sniffer log ::\n*/sniff-l0g             ! Sniffer log ::\n*/core_$                ! Sniffer log ::\n*/tcp.log               ! Sniffer log ::\n*/chipsul               ! Sniffer log ::\n*/beshina               ! Sniffer log ::\n*/.owned$               | Sniffer log ::\n\n# Solaris worm -\n# http://blogs.sun.com/security/entry/solaris_in_telnetd_worm_seen\nvar/adm/.profile        ! Solaris Worm ::\nvar/spool/lp/.profile   ! Solaris Worm ::\nvar/adm/sa/.adm         ! Solaris Worm ::\nvar/spool/lp/admins/.lp ! Solaris Worm ::\n\n# Suspicious files\netc/rc.d/init.d/rc.modules  ! Suspicious file ::rootkits/Suspicious.php\nlib/ldd.so                  ! Suspicious file ::rootkits/Suspicious.php\nusr/man/muie                ! Suspicious file ::rootkits/Suspicious.php\nusr/X11R6/include/pain      ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/sourcemask          ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/ras2xm              ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/ddc                 ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/jdc                 ! Suspicious file ::rootkits/Suspicious.php\nusr/sbin/in.telnet          ! Suspicious file ::rootkits/Suspicious.php\nsbin/vobiscum               ! Suspicious file ::rootkits/Suspicious.php\nusr/sbin/jcd                ! Suspicious file ::rootkits/Suspicious.php\nusr/sbin/atd2               ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/ishit               ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/.etc                ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/xstat               ! Suspicious file ::rootkits/Suspicious.php\nvar/run/.tmp                ! Suspicious file ::rootkits/Suspicious.php\nusr/man/man1/lib/.lib       ! Suspicious file ::rootkits/Suspicious.php\nusr/man/man2/.man8          ! Suspicious file ::rootkits/Suspicious.php\nvar/run/.pid                ! Suspicious file ::rootkits/Suspicious.php\nlib/.so                     ! Suspicious file ::rootkits/Suspicious.php\nlib/.fx                     ! Suspicious file ::rootkits/Suspicious.php\nlib/lblip.tk                ! Suspicious file ::rootkits/Suspicious.php\nusr/lib/.fx                 ! Suspicious file ::rootkits/Suspicious.php\nvar/local/.lpd              ! Suspicious file ::rootkits/Suspicious.php\ndev/rd/cdb                  ! Suspicious file ::rootkits/Suspicious.php\ndev/.rd/                    ! Suspicious file ::rootkits/Suspicious.php\nusr/lib/pt07                ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/atm                 ! Suspicious file ::rootkits/Suspicious.php\ntmp/.cheese                 ! Suspicious file ::rootkits/Suspicious.php\ndev/.arctic                 ! Suspicious file ::rootkits/Suspicious.php\ndev/.xman                   ! Suspicious file ::rootkits/Suspicious.php\ndev/.golf                   ! Suspicious file ::rootkits/Suspicious.php\ndev/srd0                    ! Suspicious file ::rootkits/Suspicious.php\ndev/ptyzx                   ! Suspicious file ::rootkits/Suspicious.php\ndev/ptyzg                   ! Suspicious file ::rootkits/Suspicious.php\ndev/xdf1                    ! Suspicious file ::rootkits/Suspicious.php\ndev/ttyop                   ! Suspicious file ::rootkits/Suspicious.php\ndev/ttyof                   ! Suspicious file ::rootkits/Suspicious.php\ndev/hd7                     ! Suspicious file ::rootkits/Suspicious.php\ndev/hdx1                    ! Suspicious file ::rootkits/Suspicious.php\ndev/hdx2                    ! Suspicious file ::rootkits/Suspicious.php\ndev/xdf2                    ! Suspicious file ::rootkits/Suspicious.php\ndev/ptyp                    ! Suspicious file ::rootkits/Suspicious.php\ndev/ptyr                    ! Suspicious file ::rootkits/Suspicious.php\nsbin/pback                  ! Suspicious file ::rootkits/Suspicious.php\nusr/man/man3/psid           ! Suspicious file ::rootkits/Suspicious.php\nproc/kset                   ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/gib                 ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/snick               ! Suspicious file ::rootkits/Suspicious.php\nusr/bin/kfl                 ! Suspicious file ::rootkits/Suspicious.php\ntmp/.dump                   ! Suspicious file ::rootkits/Suspicious.php\nvar/.x                      ! Suspicious file ::rootkits/Suspicious.php\nvar/.x/psotnic              ! Suspicious file ::rootkits/Suspicious.php\n*/.log                      ! Suspicious file ::rootkits/Suspicious.php\n*/ecmf                      ! Suspicious file ::rootkits/Suspicious.php\n*/mirkforce                 ! Suspicious file ::rootkits/Suspicious.php\n*/mfclean                   ! Suspicious file ::rootkits/Suspicious.php\n\n/reptile/reptile_cmd        ! Suspicious file ::reptile\n/lib/udev/reptile           ! Suspicious file ::reptile\n\n# BEURK rootkit\n/lib/libselinux.so          ! BEURK rootkit\n\n# JynxKit2 rootkit\n*/jynx2.so                  ! JynxKit2 rootkit\n\n# JynxKit rootkit\n*/ld_poison.so              ! JynxKit rootkit\n```\n\n----------------------------------------\n\nTITLE: Checking Password Complexity Setting in OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters' as required by CIS benchmark 18.2.4. The rule checks for non-compliant registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.2.4 Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters'\n[CIS - Microsoft Windows 10 - 18.2.4 Ensure 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordComplexity -> !4;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: LAN Manager authentication level' setting\nDESCRIPTION: Registry check to ensure the LAN Manager authentication level is set to send NTLMv2 responses only and refuse LM & NTLM, ensuring more secure authentication protocols.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 3;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 4;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !LmCompatibilityLevel;\n```\n\n----------------------------------------\n\nTITLE: Building JSON Objects with Helper Functions in cJSON\nDESCRIPTION: A simplified version of the previous example using cJSON's helper functions. This approach is more concise and reduces the amount of explicit error handling required while building the JSON structure.\n\nLANGUAGE: c\nCODE:\n```\nchar *create_monitor_with_helpers(void)\n{\n    const unsigned int resolution_numbers[3][2] = {\n        {1280, 720},\n        {1920, 1080},\n        {3840, 2160}\n    };\n    char *string = NULL;\n    cJSON *resolutions = NULL;\n    size_t index = 0;\n\n    cJSON *monitor = cJSON_CreateObject();\n\n    if (cJSON_AddStringToObject(monitor, \"name\", \"Awesome 4K\") == NULL)\n    {\n        goto end;\n    }\n\n    resolutions = cJSON_AddArrayToObject(monitor, \"resolutions\");\n    if (resolutions == NULL)\n    {\n        goto end;\n    }\n\n    for (index = 0; index < (sizeof(resolution_numbers) / (2 * sizeof(int))); ++index)\n    {\n        cJSON *resolution = cJSON_CreateObject();\n\n        if (cJSON_AddNumberToObject(resolution, \"width\", resolution_numbers[index][0]) == NULL)\n        {\n            goto end;\n        }\n\n        if(cJSON_AddNumberToObject(resolution, \"height\", resolution_numbers[index][1]) == NULL)\n        {\n            goto end;\n        }\n\n        cJSON_AddItemToArray(resolutions, resolution);\n    }\n\n    string = cJSON_Print(monitor);\n    if (string == NULL) {\n        fprintf(stderr, \"Failed to print monitor.\\n\");\n    }\n\nend:\n    cJSON_Delete(monitor);\n    return string;\n}\n```\n\n----------------------------------------\n\nTITLE: Detecting ICMP Redirect Acceptance in RHEL7\nDESCRIPTION: OSSEC rule that checks if ICMP redirects are accepted, which would violate CIS benchmark 4.2.2 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.2.2 - Network parameters - ICMP redirects accepted {CIS: 1.1.1 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/accept_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/accept_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Configuring OSSEC Windows Malware Detection Rules\nDESCRIPTION: This configuration file defines detection patterns for OSSEC to identify Windows malware. It specifies rules for detecting malicious files, registry entries, and processes, with specific definitions for known malware families and generic suspicious behaviors in compliance with PCI-DSS requirement 11.4.\n\nLANGUAGE: ossec\nCODE:\n```\n# OSSEC Windows Malware list - (C) 2018 OSSEC Project\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Malware name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# # Values can be preceded by: =: (for equal) - default\n#                               r: (for ossec regexes)\n#                               >: (for strcmp greater)\n#                               <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n\n# http://www.iss.net/threats/ginwui.html\n[Ginwui Backdoor {PCI_DSS: 11.4}] [any] [http://www.iss.net/threats/ginwui.html]\nf:%WINDIR%\\System32\\zsyhide.dll;\nf:%WINDIR%\\System32\\zsydll.dll;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\Notify\\zsydll;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Windows -> AppInit_DLLs -> r:zsyhide.dll;\n\n# http://www.symantec.com/security_response/writeup.jsp?docid=2006-081312-3302-99&tabid=2\n[Wargbot Backdoor {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\wgareg.exe;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\wgareg;\n\n# http://www.f-prot.com/virusinfo/descriptions/sober_j.html\n[Sober Worm {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\nonzipsr.noz;\nf:%WINDIR%\\System32\\clonzips.ssc;\nf:%WINDIR%\\System32\\clsobern.isc;\nf:%WINDIR%\\System32\\sb2run.dii;\nf:%WINDIR%\\System32\\winsend32.dal;\nf:%WINDIR%\\System32\\winroot64.dal;\nf:%WINDIR%\\System32\\zippedsr.piz;\nf:%WINDIR%\\System32\\winexerun.dal;\nf:%WINDIR%\\System32\\winmprot.dal;\nf:%WINDIR%\\System32\\dgssxy.yoi;\nf:%WINDIR%\\System32\\cvqaikxt.apk;\nf:%WINDIR%\\System32\\sysmms32.lla;\nf:%WINDIR%\\System32\\Odin-Anon.Ger;\n\n# http://www.symantec.com/security_response/writeup.jsp?docid=2005-042611-0148-99&tabid=2\n[Hotword Trojan {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\_;\nf:%WINDIR%\\System32\\explore.exe;\nf:%WINDIR%\\System32\\ svchost.exe;\nf:%WINDIR%\\System32\\mmsystem.dlx;\nf:%WINDIR%\\System32\\WINDLL-ObjectsWin*.DLX;\nf:%WINDIR%\\System32\\CFXP.DRV;\nf:%WINDIR%\\System32\\CHJO.DRV;\nf:%WINDIR%\\System32\\MMSYSTEM.DLX;\nf:%WINDIR%\\System32\\OLECLI.DL;\n\n[Beagle worm {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\System32\\winxp.exe;\nf:%WINDIR%\\System32\\winxp.exeopen;\nf:%WINDIR%\\System32\\winxp.exeopenopen;\nf:%WINDIR%\\System32\\winxp.exeopenopenopen;\nf:%WINDIR%\\System32\\winxp.exeopenopenopenopen;\n\n# http://symantec.com/security_response/writeup.jsp?docid=2007-071711-3132-99\n[Gpcoder Trojan {PCI_DSS: 11.4}] [any] [http://symantec.com/security_response/writeup.jsp?docid=2007-071711-3132-99]\nf:%WINDIR%\\System32\\ntos.exe;\nf:%WINDIR%\\System32\\wsnpoem;\nf:%WINDIR%\\System32\\wsnpoem\\audio.dll;\nf:%WINDIR%\\System32\\wsnpoem\\video.dll;\nr:HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run -> userinit -> r:ntos.exe;\n\n# [http://www.symantec.com/security_response/writeup.jsp?docid=2006-112813-0222-99&tabid=2\n[Looked.BK Worm {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\uninstall\\rundl132.exe;\nf:%WINDIR%\\Logo1_.exe;\nf:%Windir%\\RichDll.dll;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run -> load -> r:rundl132.exe;\n\n[Possible Malware - Svchost running outside system32 {PCI_DSS: 11.4}] [all] []\np:r:svchost.exe && !%WINDIR%\\System32\\svchost.exe;\nf:!%WINDIR%\\SysWOW64;\n\n[Possible Malware - Inetinfo running outside system32\\inetsrv {PCI_DSS: 11.4}] [all] []\np:r:inetinfo.exe && !%WINDIR%\\System32\\inetsrv\\inetinfo.exe;\nf:!%WINDIR%\\SysWOW64;\n\n[Possible Malware - Rbot/Sdbot detected {PCI_DSS: 11.4}] [any] []\nf:%Windir%\\System32\\rdriv.sys;\nf:%Windir%\\lsass.exe;\n\n[Possible Malware File {PCI_DSS: 11.4}] [any] []\nf:%WINDIR%\\utorrent.exe;\nf:%WINDIR%\\System32\\utorrent.exe;\nf:%WINDIR%\\System32\\Files32.vxd;\n\n# Modified /etc/hosts entries\n# Idea taken from:\n# http://blog.tenablesecurity.com/2006/12/detecting_compr.html\n# http://www.sophos.com/security/analyses/trojbagledll.html\n# http://www.f-secure.com/v-descs/fantibag_b.shtml\n[Anti-virus site on the hosts file] [any] []\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:avp.ch|avp.ru|nai.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:awaps.net|ca.com|mcafee.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:microsoft.com|f-secure.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:sophos.com|symantec.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:my-etrust.com|viruslist.ru;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:networkassociates.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:kaspersky|grisoft.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:symantecliveupdate.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:clamav.net|bitdefender.com;\nf:%WINDIR%\\System32\\Drivers\\etc\\HOSTS -> r:antivirus.com|sans.org;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Protocol Version Configuration\nDESCRIPTION: Detects if SSH is configured to allow Protocol version 1, which is insecure, as per CIS-RHEL6 section 6.2.1. This check examines the SSH daemon configuration to ensure only secure protocol versions are in use for PCI DSS compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager Authentication Level in Windows 10\nDESCRIPTION: Verifies that 'Network security: LAN Manager authentication level' is set to 'Send NTLMv2 response only. Refuse LM & NTLM' by checking that the LmCompatibilityLevel registry value is set to 5.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 3;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 4;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !LmCompatibilityLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Inbound Connections Setting\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Inbound connections' is set to 'Block' by checking the DefaultInboundAction registry value in both policy and current configuration locations.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Non-root Accounts with UID 0 in OSSEC\nDESCRIPTION: OSSEC rule that checks for non-root accounts with UID 0 in the /etc/passwd file, which is a serious security risk. This rule implements CIS benchmark 9.2.5 for RHEL6 and satisfies PCI-DSS requirement 10.2.5.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - 9.2.5 - Non-root account with uid 0 {CIS: 9.2.5 RHEL6} {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Script Block Logging Settings\nDESCRIPTION: OSSEC rule to verify PowerShell Script Block Logging is disabled according to CIS benchmark 18.9.95.1. Checks if EnableScriptBlockLogging is not set to 0 or is not configured.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.95.1 Ensure 'Turn on PowerShell Script Block Logging' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.95.1 Ensure 'Turn on PowerShell Script Block Logging' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Verifying System Event Log Size\nDESCRIPTION: Checks if the System Event Log maximum size is set to at least 32,768 KB to ensure sufficient storage for system events related to hardware, drivers, and system components.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Detecting Weak SSH MaxAuthTries Setting in RHEL7\nDESCRIPTION: OSSEC rule that checks if SSH MaxAuthTries is set to a value higher than 3, is commented out, or is missing, which would violate CIS benchmark 6.2.5 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[ CIS - RHEL7 - 6.2.5 - SSH Configuration - Set SSH MaxAuthTries to 4 or Less  {CIS - RHEL7 - 6.2.5} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:$sshd_file -> !r:^# && r:MaxAuthTries && !r:3\\s*$;\nf:$sshd_file -> r:^#\\s*MaxAuthTries;\nf:$sshd_file -> !r:MaxAuthTries;\n```\n\n----------------------------------------\n\nTITLE: Validating SSH Root Login Disablement\nDESCRIPTION: Rules for checking that SSH root login is disabled according to CIS benchmark 9.3.8. Prevents direct root access via SSH to improve security posture.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.8 Disable SSH Root Login\n[CIS - Debian Linux 7/8 - 9.3.8 Disable SSH Root Login] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\s+yes;\nf:/etc/ssh/sshd_config -> !r:^PermitRootLogin\\s+no;\n```\n\n----------------------------------------\n\nTITLE: MySQL Secure Authentication Check in OSSEC\nDESCRIPTION: Ensures secure_auth is set to 'ON' according to CIS recommendation 7.2. This setting prevents authentication using pre-4.1 style passwords which are less secure.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 7.2: Ensure 'secure_auth' is set to 'ON'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:secure_auth\\s*=\\s*off;\nf:$mysql-cnfs -> !r:secure_auth\\s*=\\s*on;\nf:$mysql-cnfs -> r:secure_auth\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Validating Failed Password Attempt Lockout\nDESCRIPTION: Rules for checking account lockout settings after failed password attempts according to CIS benchmark 9.2.2. Verifies proper pam_tally2 configuration.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.2.2 Set Lockout for Failed Password Attempts\n[CIS - Debian Linux 7/8 - 9.2.2 Set Lockout for Failed Password Attempts] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/pam.d/login -> !r:auth required pam_tally2.so onerr=fail audit silent deny=\\d unlock_time=\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Unencrypted Traffic Setting\nDESCRIPTION: Verifies that unencrypted traffic for WinRM Service is disabled by checking the AllowUnencryptedTraffic registry value is not set to anything other than 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Root Login Configuration\nDESCRIPTION: Detects if SSH is configured to allow direct root login, which is insecure, as per CIS-RHEL6 section 6.2.8. This check examines the SSH daemon configuration to prevent direct root access via SSH for PCI DSS compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Configuring Trojan Detection Patterns in OSSEC\nDESCRIPTION: This configuration file defines patterns for detecting trojanized system binaries and compromised files. Each line follows the format 'file_name !string_to_search!Description' where the string represents suspicious content that may indicate a trojan or rootkit.\n\nLANGUAGE: plaintext\nCODE:\n```\n# rootkit_trojans.txt, (C) 2018 OSSEC Project\n# Imported from the rootcheck project.\n# Some entries taken from the chkrootkit project.\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# Blank lines and lines starting with '#' are ignored.\n#\n# Each line must be in the following format:\n# file_name !string_to_search!Description\n\n# Common binaries and public trojan entries\nls          !bash|^/bin/sh|dev/[^clu]|\\.tmp/lsfile|duarawkz|/prof|/security|file\\.h!\nenv         !bash|^/bin/sh|file\\.h|proc\\.h|/dev/|^/bin/.*sh!\necho        !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^cl]|^/bin/.*sh!\nchown       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^cl]|^/bin/.*sh!\nchmod       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^cl]|^/bin/.*sh!\nchgrp       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^cl]|^/bin/.*sh!\ncat         !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^cl]|^/bin/.*sh!\nbash        !proc\\.h|/dev/[0-9]|/dev/[hijkz]!\nsh          !proc\\.h|/dev/[0-9]|/dev/[hijkz]!\nuname       !bash|^/bin/sh|file\\.h|proc\\.h|^/bin/.*sh!\ndate        !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^cln]|^/bin/.*sh!\ndu          !w0rm|/prof|file\\.h!\ndf          !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^clurdv]|^/bin/.*sh!\nlogin       !elite|SucKIT|xlogin|vejeta|porcao|lets_log|sukasuk!\npasswd      !bash|file\\.h|proc\\.h|/dev/ttyo|/dev/[A-Z]|/dev/[b-s,uvxz]!\nmingetty    !bash|Dimensioni|pacchetto!\nchfn        !bash|file\\.h|proc\\.h|/dev/ttyo|/dev/[A-Z]|/dev/[a-s,uvxz]!\nchsh        !bash|file\\.h|proc\\.h|/dev/ttyo|/dev/[A-Z]|/dev/[a-s,uvxz]!\nmail        !file\\.h|proc\\.h|/dev/[^nu]!\nsu          !/dev/[d-s,abuvxz]|/dev/[A-D]|/dev/[F-Z]|/dev/[0-9]|satori|vejeta|conf\\.inv!\nsudo        !satori|vejeta|conf\\.inv!\ncrond       !/dev/[^nt]|bash!\ngpm         !bash|mingetty!\nifconfig    !bash|^/bin/sh|/dev/tux|session.null|/dev/[^cludisopt]!\ndiff        !bash|^/bin/sh|file\\.h|proc\\.h|^/bin/.*sh!\nmd5sum      !bash|^/bin/sh|file\\.h|proc\\.h|/dev/|^/bin/.*sh!\nhdparm      !bash|/dev/ida!\nldd         !/dev/[^n]|proc\\.h|libshow.so|libproc.a!\n\n# Trojan entries for troubleshooting binaries\ngrep        !bash|givemer!\negrep       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/|^/bin/.*sh!\nfind        !bash|/dev/[^tnlcs]|/prof|/home/virus|file\\.h!\nlsof        !/prof|/dev/[^apcmnfk]|proc\\.h|bash|^/bin/sh|/dev/ttyo|/dev/ttyp!\nnetstat     !bash|^/bin/sh|/dev/[^aik]|/prof|grep|addr\\.h!\ntop         !/dev/[^npi3st%]|proc\\.h|/prof/!\nps          !/dev/ttyo|\\.1proc|proc\\.h|bash|^/bin/sh!\ntcpdump     !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^bu]|^/bin/.*sh!\npidof       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^f]|^/bin/.*sh!\nfuser       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[a-dtz]|^/bin/.*sh!\nw           !uname -a|proc\\.h|bash!\n\n# Trojan entries for common daemons\nsendmail    !bash|fuck!\nnamed       !bash|blah|/dev/[0-9]|^/bin/sh!\ninetd       !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^un%]|^/bin/.*sh!\napachectl   !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^n]|^/bin/.*sh!\nsshd        !check_global_passwd|panasonic|satori|vejeta|\\.ark|/hash\\.zk|bash|/dev[a-s]|/dev[A-Z]/!\nsyslogd     !bash|/usr/lib/pt07|/dev/[^cln]]|syslogs\\.h|proc\\.h!\nxinetd      !bash|file\\.h|proc\\.h!\nin.telnetd  !cterm100|vt350|VT100|ansi-term|bash|^/bin/sh|/dev[A-R]|/dev/[a-z]/!\nin.fingerd  !bash|^/bin/sh|cterm100|/dev/!\nidentd      !bash|^/bin/sh|file\\.h|proc\\.h|/dev/[^n]|^/bin/.*sh!\ninit        !bash|/dev/h\ntcpd        !bash|proc\\.h|p1r0c4|hack|/dev/[^n]!\nrlogin      !p1r0c4|r00t|bash|/dev/[^nt]!\n\n# Kill trojan\nkillall     !/dev/[^t%]|proc\\.h|bash|tmp!\nkill        !/dev/[ab,d-k,m-z]|/dev/[F-Z]|/dev/[A-D]|/dev/[0-9]|proc\\.h|bash|tmp!\n\n# Rootkit entries\n/etc/rc.d/rc.sysinit    !enyelkmHIDE! enye-sec Rootkit\n\n# ZK rootkit (http://honeyblog.org/junkyard/reports/redhat-compromise2.pdf)\n/etc/sysconfig/console/load.zk   !/bin/sh! ZK rootkit\n/etc/sysconfig/console/load.zk   !usr/bin/run! ZK rootkit\n\n# Modified /etc/hosts entries\n# Idea taken from:\n# http://blog.tenablesecurity.com/2006/12/detecting_compr.html\n# http://www.sophos.com/security/analyses/trojbagledll.html\n# http://www.f-secure.com/v-descs/fantibag_b.shtml\n/etc/hosts  !^[^#]*avp.ch!Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*avp.ru!Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*awaps.net! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*ca.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*mcafee.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*microsoft.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*f-secure.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*sophos.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*symantec.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*my-etrust.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*nai.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*networkassociates.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*viruslist.ru! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*kaspersky! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*symantecliveupdate.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*grisoft.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*clamav.net! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*bitdefender.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*antivirus.com! Anti-virus site on the hosts file\n/etc/hosts  !^[^#]*sans.org! Security site on the hosts file\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Protocol Version 1 in RHEL5\nDESCRIPTION: Checks if SSH Protocol version 1 is enabled in the system. This CIS benchmark rule (6.2.1) verifies that the SSH Protocol is not set to version 1 in sshd_config to prevent using the insecure SSH protocol version.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Configuring Maximum Password Age Check in OSSEC for Windows Server 2012 R2\nDESCRIPTION: Defines OSSEC registry checks to verify that 'Maximum password age' is set to 60 or fewer days, but not 0. This implements CIS Benchmark check 1.1.2 for Windows Server 2012 R2 Domain Controllers.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - Ensure 'Maximum password age' is set to '60 or fewer days, but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3D;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3E;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3F;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:A\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:B\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:C\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:E\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:F\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking for Non-root UID 0 Accounts\nDESCRIPTION: Ensures that no accounts other than root have UID 0. Any account with UID 0 has full superuser privileges, which presents a significant security risk if not properly controlled.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Machine Inactivity Timeout\nDESCRIPTION: Verifies the 'Interactive logon: Machine inactivity limit' policy is set to 900 or fewer seconds (but not 0) in Windows Server 2016. Uses complex regex patterns to check if the InactivityTimeoutSecs registry value is correctly configured.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.7.3 Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 385;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 386;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 387;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 388;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 389;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:38\\D;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:39\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:3\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:4\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:5\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:6\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:7\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:8\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:9\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\D\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\w\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !InactivityTimeoutSecs;\n```\n\n----------------------------------------\n\nTITLE: Checking System EventLog Maximum File Size in Windows Registry\nDESCRIPTION: Registry check to ensure that 'System: Specify the maximum log file size (KB)' is set to 32,768 KB or greater as required by CIS benchmark 18.9.26.4.2. The rule checks for valid registry values or flags missing configurations.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.26.4.2 Ensure 'System: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'\n[CIS - Microsoft Windows Server 2016 - 18.9.26.4.2: Ensure 'System: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender AntiVirus Status\nDESCRIPTION: OSSEC rule to ensure Windows Defender AntiVirus is not turned off, as required by CIS benchmark 18.9.76.14. Detects if the registry key DisableAntiSpyware is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.76.14 Ensure 'Turn off Windows Defender AntiVirus' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.76.14 Ensure 'Turn off Windows Defender AntiVirus' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender -> DisableAntiSpyware -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Local Admin Password Management Setting in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Enable Local Admin Password Management' is set to 'Enabled' according to CIS benchmark 18.2.3. The rule identifies non-compliant systems by checking for incorrect registry values and missing keys.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.2.3 Ensure 'Enable Local Admin Password Management' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.2.3 Ensure 'Enable Local Admin Password Management' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> AdmPwdEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !AdmPwdEnabled;\n```\n\n----------------------------------------\n\nTITLE: Detecting Improper SSH LogLevel in RHEL7\nDESCRIPTION: OSSEC rule that checks if SSH LogLevel is not set to INFO, which would violate CIS benchmark 6.2.1 for RHEL7 and PCI-DSS requirement 4.1.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 6.2.1 - SSH Configuration - Protocol version 1 enabled {CIS: 6.2.1 RHEL7} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && !r:LogLevel\\.+INFO;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Application Installation Detection in Windows Registry\nDESCRIPTION: Checks that 'User Account Control: Detect application installations and prompt for elevation' is set to 'Enabled' by verifying EnableInstallerDetection registry value is not 0 or missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableInstallerDetection -> 0;\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !EnableInstallerDetection;\n```\n\n----------------------------------------\n\nTITLE: Defining MySQL Configuration Audit Rules for OSSEC\nDESCRIPTION: This configuration file defines security audit rules for MySQL installations based on CIS benchmarks. It uses pattern matching to check for security vulnerabilities across MySQL configuration files, environment files, and user permissions. The rules look for insecure settings like plaintext passwords, disabled security features, and improper logging configurations.\n\nLANGUAGE: text\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018 \n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - p (process running)\n#             - d (any file inside the directory)\n#\n# Additional values:\n# For the registry , use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n\n# CIS Checks for MYSQL \n# Based on Center for Internet Security Benchmark for MYSQL v1.1.0 \n#\n$home_dirs=/usr2/home/*,/home/*,/home,/*/home/*,/*/home,/;\n$enviroment_files=/*/home/*/\\.bashrc,/*/home/*/\\.profile,/*/home/*/\\.bash_profile,/home/*/\\.bashrc,/home/*/\\.profile,/home/*/\\.bash_profile;\n$mysql-cnfs=/etc/mysql/my.cnf,/etc/mysql/mariadb.cnf,/etc/mysql/conf.d/*.cnf,/etc/mysql/mariadb.conf.d/*.cnf,~/.my.cnf;\n#\n#\n#1.3 Disable MySQL Command History\n[CIS - MySQL Configuration - 1.3: Disable MySQL Command History] [any] [https://workbench.cisecurity.org/files/1310/download]\nd:$home_dirs -> ^.mysql_history$;\n#\n#\n#1.5 Disable Interactive Login\n[CIS - MySQL Configuration - 1.5: Disable Interactive Login] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:/etc/passwd -> r:^mysql && !r:\\.*/bin/false$|/sbin/nologin$;\n#\n#\n#1.6 Verify That 'MYSQL_PWD' Is Not In Use\n[CIS - MySQL Configuration - 1.6: 'MYSQL_PWD' Is in Use] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$enviroment_files -> r:\\.*MYSQL_PWD\\.*;\n#\n#\n#4.3 Ensure 'allow-suspicious-udfs' Is Set to 'FALSE' \n[CIS - MySQL Configuration - 4.3: 'allow-suspicious-udfs' Is Set in my.cnf'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:allow-suspicious-udfs\\.+true;\nf:$mysql-cnfs -> r:allow-suspicious-udfs\\s*$;\n#\n#\n#4.4 Ensure 'local_infile' Is Disabled\n[CIS - MySQL Configuration - 4.4: local_infile is not forbidden in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:local-infile\\s*=\\s*1;\nf:$mysql-cnfs -> r:local-infile\\s*$;\n#\n#\n#4.5 Ensure 'mysqld' Is Not Started with '--skip-grant-tables'\n[CIS - MySQL Configuration - 4.5: skip-grant-tables is set in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:skip-grant-tables\\s*=\\s*true;\nf:$mysql-cnfs -> !r:skip-grant-tables\\s*=\\s*false;\nf:$mysql-cnfs -> r:skip-grant-tables\\s*$;\n#\n#\n#4.6 Ensure '--skip-symbolic-links' Is Enabled\n[CIS - MySQL Configuration - 4.6: skip_symbolic_links is not enabled in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:skip_symbolic_links\\s*=\\s*no;\nf:$mysql-cnfs -> !r:skip_symbolic_links\\s*=\\s*yes;\nf:$mysql-cnfs -> r:skip_symbolic_links\\s*$;\n#\n#\n#4.8 Ensure 'secure_file_priv' is not empty\n[CIS - MySQL Configuration - 4.8: Ensure 'secure_file_priv' is not empty] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> r:^# && r:secure_file_priv=\\s*\\S+\\s*;\nf:$mysql-cnfs -> !r:secure_file_priv=\\s*\\S+\\s*;\nf:$mysql-cnfs -> r:secure_file_priv\\s*$;\n#\n#\n#4.9 Ensure 'sql_mode' Contains 'STRICT_ALL_TABLES'\n[CIS - MySQL Configuration - 4.9: strict_all_tables is not set at sql_mode section of my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:strict_all_tables\\s*$;\n#\n#\n#6.1 Ensure 'log_error' is not empty\n[CIS - MySQL Configuration - 6.1: log-error is not set in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> r:^# && r:log_error\\s*=\\s*\\S+\\s*;\nf:$mysql-cnfs -> !r:log_error\\s*=\\s*\\S+\\s*;\nf:$mysql-cnfs -> r:log_error\\s*$;\n#\n#\n#6.2 Ensure Log Files are not Stored on a non-system partition\n[CIS - MySQL Configuration - 6.2: log files are maybe stored on systempartition] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/\\S*\\s*;\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/var/\\S*\\s*;\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/usr/\\S*\\s*;\nf:$mysql-cnfs -> r:log_bin\\s*$;\n#\n#\n#6.3 Ensure 'log_warning' is set to 2 at least\n[CIS - MySQL Configuration - 6.3: log warnings is set low] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*0;\nf:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*1;\nf:$mysql-cnfs -> !r:log_warnings\\s*=\\s*\\d+;\nf:$mysql-cnfs -> r:log_warnings\\s*$;\n#\n#\n#6.5 Ensure 'log_raw' is set to 'off'\n[CIS - MySQL Configuration - 6.5: log_raw is not set to off] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:log-raw\\s*=\\s*on;\nf:$mysql-cnfs -> r:log-raw\\s*$;\n#\n#\n#7.1 Ensure 'old_password' is not set to '1' or 'On'\n[CIS - MySQL Configuration - 7.1:Ensure 'old_passwords' is not set to '1' or 'on'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*1;\nf:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*on;\nf:$mysql-cnfs -> !r:old_passwords\\s*=\\s*2;\nf:$mysql-cnfs -> r:old_passwords\\s*$;\n#\n#\n#7.2 Ensure 'secure_auth' is set to 'ON'\n[CIS - MySQL Configuration - 7.2: Ensure 'secure_auth' is set to 'ON'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:secure_auth\\s*=\\s*off;\nf:$mysql-cnfs -> !r:secure_auth\\s*=\\s*on;\nf:$mysql-cnfs -> r:secure_auth\\s*$;\n#\n#\n#7.3 Ensure Passwords Are Not Stored in the Global Configuration\n[CIS - MySQL Configuration - 7.3: Passwords are stored in global configuration] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:^\\s*password\\.*;\n#\n#\n#7.4 Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER'\n[CIS - MySQL Configuration - 7.4: Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:no_auto_create_user\\s*$;\nf:$mysql-cnfs -> r:^# && r:\\s*no_auto_create_user\\s*$;\n#\n#\n#7.6 Ensure Password Policy is in Place\n[CIS - MySQL Configuration - 7.6: Ensure Password Policy is in Place ] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:plugin-load\\s*=\\s*validate_password.so\\s*$;\nf:$mysql-cnfs -> !r:validate-password\\s*=\\s*force_plus_permanent\\s*$;\nf:$mysql-cnfs -> !r:validate_password_length\\s*=\\s*14\\s$;\nf:$mysql-cnfs -> !r:validate_password_mixed_case_count\\s*=\\s*1\\s*$;\nf:$mysql-cnfs -> !r:validate_password_number_count\\s*=\\s*1\\s*$;\nf:$mysql-cnfs -> !r:validate_password_special_char_count\\s*=\\s*1;\nf:$mysql-cnfs -> !r:validate_password_policy\\s*=\\s*medium\\s*;\n#\n#\n#9.2 Ensure 'master_info_repository' is set to 'Table'\n[CIS - MySQL Configuration - 9.2: Ensure 'master_info_repositrory' is set to 'Table'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:master_info_repository\\s*=\\s*file;\nf:$mysql-cnfs -> !r:master_info_repository\\s*=\\s*table;\nf:$mysql-cnfs -> r:master_info_repository\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Idle Timeout Settings\nDESCRIPTION: Rules for validating SSH idle timeout settings according to CIS benchmark 9.3.12. Ensures proper timeout configuration to automatically disconnect inactive sessions.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.12 Set Idle Timeout Interval for User Login\n[CIS - Debian Linux 7/8 - 9.3.12 Set Idle Timeout Interval for User Login] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^ClientAliveInterval\\s+\\d+;\nf:/etc/ssh/sshd_config -> !r:^ClientAliveCountMax\\s+\\d;\n```\n\n----------------------------------------\n\nTITLE: Checking Restricted Anonymous Access to Named Pipes and Shares (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled' according to CIS benchmark 2.3.10.9.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RestrictNullSessAccess -> !1;\n```\n\n----------------------------------------\n\nTITLE: Verifying GRUB Menu Security\nDESCRIPTION: Rule to check if the GRUB boot menu is secured with a password, as specified in CIS Solaris 11 benchmark section 6.17. This prevents unauthorized boot modifications.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/rpool/boot/grub/menu.lst -> !r:^password\\s*--md5;\n```\n\n----------------------------------------\n\nTITLE: Checking Safe DLL Search Mode Settings in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode' is set to 'Enabled'. This setting changes the DLL search order to search for system directory DLLs first, reducing risk of DLL hijacking.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Host-based Authentication Configuration\nDESCRIPTION: Detects if SSH is configured with host-based authentication enabled, which is insecure, as per CIS-RHEL6 section 6.2.7. This check examines the SSH daemon configuration to ensure proper authentication methods for PCI DSS compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking for Non-root Accounts with UID 0\nDESCRIPTION: Rule to detect non-root accounts with UID 0 (superuser privileges) in the /etc/passwd file. This check helps enforce CIS SLES11 section 13.5 requirement and PCI-DSS requirement 10.2.5 by ensuring only the root account has administrative privileges.\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Auditing Unsuccessful Unauthorized Access Attempts to Files in Debian Linux\nDESCRIPTION: Configuration for auditing unsuccessful unauthorized access attempts to files according to CIS Benchmark 8.1.11. It checks for the presence of necessary audit rules that track access denials (EACCES) and permission errors (EPERM) for certain file operations.\n\nLANGUAGE: auditd\nCODE:\n```\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate \\\n-F exit=-EACCES -F auid>=1000 -F auid!=4294967295 -k access\n```\n\nLANGUAGE: auditd\nCODE:\n```\n-a always,exit -F arch=b32 -S creat -S open -S openat -S truncate -S ftruncate \\\n-F exit=-EPERM -F auid>=1000 -F auid!=4294967295 -k access\n```\n\n----------------------------------------\n\nTITLE: MySQL Secure File Privileges Check in OSSEC\nDESCRIPTION: Ensures secure_file_priv is not empty according to CIS recommendation 4.8. This setting restricts import and export operations to specific directories to prevent unauthorized file access.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 4.8: Ensure 'secure_file_priv' is not empty] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> r:^# && r:secure_file_priv=\\s*\\S+\\s*;\nf:$mysql-cnfs -> !r:secure_file_priv=\\s*\\S+\\s*;\nf:$mysql-cnfs -> r:secure_file_priv\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking for Root Login Permission in OSSEC Rootcheck\nDESCRIPTION: Verifies if the SSH daemon allows direct root login, which is considered a security risk as it exposes the most privileged account to brute force attacks.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 3: Root can log in] [any] [3]\nf:$sshd_file -> !r:^# && r:PermitRootLogin\\.+yes;\nf:$sshd_file -> r:^#\\s*PermitRootLogin;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: Null Sessions Detection\nDESCRIPTION: Checks if null sessions (anonymous access) are permitted, which could allow unauthorized access to system resources. References PCI-DSS section 11.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[Null sessions allowed {PCI_DSS: 11.4}] [any] []\nr:HKLM\\System\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymous -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking for Empty Password Fields\nDESCRIPTION: Detects accounts with empty password fields in the shadow file. Empty password fields allow login without authentication, creating a significant security risk.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Empty Passwords Configuration (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if SSH permits empty passwords, which is against CIS recommendation 6.2.9. The rule checks the sshd_config file for a non-commented line that sets PermitEmptyPasswords to yes or if the option is commented out.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - 6.2.9 - SSH Configuration - Empty passwords permitted {CIS: 6.2.9 RHEL7} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\nf:/etc/ssh/sshd_config -> r:^#\\s*PermitEmptyPasswords;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Behavior Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Security: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' as per CIS benchmark 18.9.26.2.1. Checks if Retention value is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Root Login in RHEL5\nDESCRIPTION: Checks if SSH root login is allowed in the system. This CIS benchmark rule (6.2.8) verifies that the PermitRootLogin option is not set to 'yes' in sshd_config to prevent direct root login via SSH.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Length Setting in OSSEC\nDESCRIPTION: OSSEC rule for checking if 'Password Settings: Password Length' is set to 'Enabled: 15 or more' according to CIS benchmark 18.2.5. The rule detects non-compliant configurations through various regular expression patterns checking registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.2.5 Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more'\n[CIS - Microsoft Windows 10 - 18.2.5 Ensure 'Password Settings: Password Length' is set to 'Enabled: 15 or more'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:a;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:b;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:c;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:e;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PasswordLength;\n```\n\n----------------------------------------\n\nTITLE: Checking for Empty Passwords Permission in OSSEC Rootcheck\nDESCRIPTION: Checks if the SSH daemon allows logging in with empty passwords, which is a significant security vulnerability that should never be allowed.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 6: Empty passwords allowed {PCI_DSS: 2.2.4}] [any] [6]\nf:$sshd_file -> !r:^# && r:PermitEmptyPasswords\\.+yes;\nf:$sshd_file -> r:^#\\s*PermitEmptyPasswords;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC and WDigest Authentication Settings\nDESCRIPTION: Registry checks to ensure that UAC restrictions are applied to local accounts on network logons and that WDigest Authentication is disabled for credential protection.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.6.1 Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.6.1 Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> LocalAccountTokenFilterPolicy -> !0;\n#\n#\n#18.6.2 Ensure 'WDigest Authentication' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.6.2 Ensure 'WDigest Authentication' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Linux Audit Header and Format Documentation\nDESCRIPTION: Header comment explaining the format and structure of OSSEC Linux Audit rules, including license information and syntax guidelines for defining entries to search for files, registry entries, and processes.\n\nLANGUAGE: conf\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018 OSSEC Project\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n```\n\n----------------------------------------\n\nTITLE: Detecting Telnet Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if telnet server is enabled through xinetd or systemd. This implements CIS benchmark 2.1.1 by checking relevant configuration files for telnet service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/telnet@.service -> r:ExecStart=-/usr/sbin/in.telnetd;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: Automatic Logon Detection\nDESCRIPTION: Checks if automatic Windows logon is enabled, which poses a security risk by bypassing authentication requirements. References PCI-DSS section 10.6.1.\n\nLANGUAGE: ossec\nCODE:\n```\n[Automatic Logon enabled {PCI_DSS: 10.6.1}] [any] [http://support.microsoft.com/default.aspx?scid=315231]\nr:HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> DefaultPassword;\nr:HKLM\\SOFTWARE\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: Configure encryption types allowed for Kerberos' setting\nDESCRIPTION: Registry check to ensure Kerberos is configured to use secure encryption types (RC4_HMAC_MD5, AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types).\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters -> SupportedEncryptionTypes -> !2147483644;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile State in Windows Registry\nDESCRIPTION: Checks that 'Windows Firewall: Domain: Firewall state' is set to 'On' by verifying EnableFirewall registry value is not 0 in policy and current settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking WDigest Authentication Settings in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'WDigest Authentication' is set to 'Disabled'. This setting prevents credentials from being stored in memory in plaintext, reducing risk of credential theft during memory attacks.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Password Policy Check in OSSEC\nDESCRIPTION: Verifies that password policy is properly configured per CIS recommendation 7.6. This includes password validation plugin settings and complexity requirements.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 7.6: Ensure Password Policy is in Place ] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:plugin-load\\s*=\\s*validate_password.so\\s*$;\nf:$mysql-cnfs -> !r:validate-password\\s*=\\s*force_plus_permanent\\s*$;\nf:$mysql-cnfs -> !r:validate_password_length\\s*=\\s*14\\s$;\nf:$mysql-cnfs -> !r:validate_password_mixed_case_count\\s*=\\s*1\\s*$;\nf:$mysql-cnfs -> !r:validate_password_number_count\\s*=\\s*1\\s*$;\nf:$mysql-cnfs -> !r:validate_password_special_char_count\\s*=\\s*1;\nf:$mysql-cnfs -> !r:validate_password_policy\\s*=\\s*medium\\s*;\n```\n\n----------------------------------------\n\nTITLE: Verifying Firewall Activation\nDESCRIPTION: Rules for checking that the firewall is active at appropriate runlevels according to CIS benchmark 7.7. Ensures iptables-persistent is properly configured across runlevels 2-5.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.7 Ensure Firewall is active (RunLevel 2, 3, 4, 5; Priority 01)\n[CIS - Debian Linux 7/8 - 7.7 Ensure Firewall is active (RunLevel 2, 3, 4, 5; Priority 01)] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/rc2.d/S01iptables-persistent; \nf:!/etc/rc3.d/S01iptables-persistent;\nf:!/etc/rc4.d/S01iptables-persistent;\nf:!/etc/rc5.d/S01iptables-persistent;\n```\n\n----------------------------------------\n\nTITLE: Checking Auto Admin Logon Compliance for Windows Server\nDESCRIPTION: Verifies that automatic administrator logon is disabled for security purposes. Detects non-compliance when the AutoAdminLogon registry value is not set to 0.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Making Audit Configuration Immutable in Debian Linux\nDESCRIPTION: Configuration to make audit rules immutable according to CIS Benchmark 8.1.18. This prevents changes to the audit configuration until the system is rebooted, protecting the integrity of the audit system.\n\nLANGUAGE: auditd\nCODE:\n```\n-e 2\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Automatic Restart Policy\nDESCRIPTION: Verifies that 'No auto-restart with logged on users for scheduled automatic updates installations' is set to 'Disabled' (value equal to 0) in the Windows Update registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoRebootWithLoggedOnUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Client Session Security in Windows 10\nDESCRIPTION: Verifies that 'Network security: Minimum session security for NTLM SSP based clients' is set to 'Require NTLMv2 session security, Require 128-bit encryption' by checking the NTLMMinClientSec registry value.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinClientSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinClientSec;\n```\n\n----------------------------------------\n\nTITLE: Checking Insecure Guest Logons for Windows Server\nDESCRIPTION: Verifies that insecure guest logons are disabled for security. Detects non-compliance when AllowInsecureGuestAuth is not set to 0 or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation -> AllowInsecureGuestAuth -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation -> !AllowInsecureGuestAuth;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv4 Source Routing Protection for Windows Server\nDESCRIPTION: Verifies that IPv4 source routing protection is set to the highest level to guard against packet spoofing. Detects non-compliance when DisableIPSourceRouting is not set to 2 or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Drive Redirection Prevention in Registry\nDESCRIPTION: Registry check to ensure that 'Do not allow drive redirection' is set to 'Enabled' as required by CIS benchmark 18.9.52.3.3.2. This prevents accessing local drives from Remote Desktop sessions.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.52.3.3.2 Ensure 'Do not allow drive redirection' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.52.3.3.2: Ensure 'Do not allow drive redirection' is set to 'Enabled] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCdma -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCdm;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Microsoft Accounts Blocking\nDESCRIPTION: Registry check to verify that Microsoft accounts are blocked according to CIS benchmark 2.3.1.2, checking the NoConnectedUser value in the System policies registry path.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !NoConnectedUser;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot Loader and Account Security Settings in Red Hat Linux\nDESCRIPTION: Security rules to verify that boot loaders (LILO and GRUB) have passwords set, and that there are no accounts with empty passwords or unauthorized root access. These checks help prevent unauthorized system access and privilege escalation.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/lilo.conf -> !r:^# && !r:restricted;\nf:/etc/lilo.conf -> !r:^# && !r:password=;\n\nf:/boot/grub/menu.lst -> !r:^# && !r:password;\n\nf:/etc/shadow -> r:^\\w+::;\n\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP SYN Cookies in OSSEC\nDESCRIPTION: OSSEC rules to verify TCP SYN Cookies are enabled as per CIS Benchmark 7.2.8, checking both for explicit disabling and lack of explicit enabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.tcp_syncookies=0;\nf:/etc/sysctl.conf -> !r:^net.ipv4.tcp_syncookies=1;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Check for Blank Password Restrictions\nDESCRIPTION: Registry check to verify that blank passwords are limited to console logon only as specified in CIS Benchmark item 2.3.1.4, improving login security.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.1.4 Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.1.4 Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LimitBlankPasswordUse -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Root Login Configuration (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if SSH root login is allowed, which is against CIS recommendation 6.2.8. The rule checks the sshd_config file for a non-commented line that sets PermitRootLogin to yes or if the option is commented out.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - 6.2.8 - SSH Configuration - Root login allowed {CIS: 6.2.8 RHEL7} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\nf:/etc/ssh/sshd_config -> r:^#\\s*PermitRootLogin;\n```\n\n----------------------------------------\n\nTITLE: Verifying MaxKeepAliveRequests Configuration in Apache\nDESCRIPTION: Rule to check that MaxKeepAliveRequests is set to 100 or greater for optimal performance.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^maxkeepaliverequests\\s+\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Proxy Modules in Apache\nDESCRIPTION: Audit rule that checks if Proxy modules are enabled in Apache configurations, which could be misused for malicious activities if not properly secured. Searches for uncommented LoadModule directives in various locations.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 2.6: Proxy Modules are enabled] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:loadmodule\\sproxy;\nd:$conf-dirs -> load -> !r:^# && r:loadmodule\\sproxy;\nf:/etc/httpd/conf.d -> !r:^# && r:loadmodule\\sproxy;\nd:$mods-en -> proxy.load;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: Minimum session security for NTLM SSP servers' setting\nDESCRIPTION: Registry check to ensure NTLM SSP server session security requires NTLMv2 and 128-bit encryption, providing strong protection for server communications.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Verifying SSH Root Login Configuration\nDESCRIPTION: Checks if SSH root login is disabled. This test verifies if PermitRootLogin is set to 'yes' or if the setting is commented out, both of which could allow direct root access via SSH.\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\nf:/etc/ssh/sshd_config -> r:^#\\s*PermitRootLogin;\n```\n\n----------------------------------------\n\nTITLE: Verifying Strong Password Creation Policies\nDESCRIPTION: Rule to check for strong password creation policies, as specified in CIS Solaris 11 benchmark section 7.2. The checks ensure password complexity, history, and dictionary requirements are enforced.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/default/passwd -> !r:^passlength\\p8;\nf:/etc/default/passwd -> !r:^# && r:passlength\\p8\\d;\nf:/etc/default/passwd -> !r:^namecheck\\pyes;\nf:/etc/default/passwd -> !r:^# && r:namecheck\\pno;\nf:/etc/default/passwd -> !r:^history\\p10;\nf:/etc/default/passwd -> !r:^# && r:history\\p10\\d;\nf:/etc/default/passwd -> !r:^mindiff\\p3;\nf:/etc/default/passwd -> !r:^# && r:mindiff\\p3\\d;\nf:/etc/default/passwd -> !r:^minalpha\\p2;\nf:/etc/default/passwd -> !r:^# && r:minalpha\\p2\\d;\nf:/etc/default/passwd -> !r:^minupper\\p1;\nf:/etc/default/passwd -> !r:^# && r:minupper\\p1\\d;\nf:/etc/default/passwd -> !r:^minlower\\p1;\nf:/etc/default/passwd -> !r:^# && r:minlower\\p1\\d;\nf:/etc/default/passwd -> !r:^minnonalpha\\p1;\nf:/etc/default/passwd -> !r:^# && r:minnonalpha\\p1\\d;\nf:/etc/default/passwd -> !r:^maxrepeats\\p0;\nf:/etc/default/passwd -> !r:^# && r:maxrepeats\\p0\\d;\nf:/etc/default/passwd -> !r:^whitespace\\pyes;\nf:/etc/default/passwd -> !r:^# && r:whitespace\\pno;\nf:/etc/default/passwd -> !r:^dictiondbdir\\p/var/passwd;\nf:/etc/default/passwd -> !r:^dictionlist\\p/usr/share/lib/dict/words;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Age Compliance for Windows Server\nDESCRIPTION: Verifies that the 'Password Settings: Password Age (Days)' is set to 30 or fewer days by checking registry values. Detects non-compliance when the PasswordAgeDays value exceeds 30 days or matches specific patterns.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> 1F;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Dropped Packets Logging\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile is logging dropped packets. Verifies LogDroppedPackets is not set to 0 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Non-Root Accounts with UID 0 (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check for non-root accounts with UID 0, which is against CIS recommendation 9.2.5. The rule checks the /etc/passwd file for any accounts other than root that have the UID 0, which would give them root-level privileges.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - 9.2.5 - Non-root account with uid 0 {CIS: 9.2.5 RHEL7} {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Named Pipes that can be accessed anonymously' configuration\nDESCRIPTION: Registry check to verify that only approved named pipes (lsarpc, netlogon, samr) can be accessed anonymously, limiting potential attack vectors.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionPipes -> !r:lsarpc|netlogon|samr;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !NullSessionPipes;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for HTTP TRACE Method\nDESCRIPTION: Audit rule that checks if the HTTP TRACE method is enabled. The TRACE method should be disabled to prevent Cross-Site Tracing (XST) attacks that can lead to cookie theft.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.8: Disable HTTP Trace Method] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:$traceen -> !r:^# && r:traceenable\\s+on\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Firewall State in Registry\nDESCRIPTION: Verifies that the Windows Firewall for Private Profile is enabled by checking registry values. The rule looks for a value of 0 in the EnableFirewall key, which indicates a non-compliant configuration.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Hardened UNC Paths configuration for NETLOGON and SYSVOL shares\nDESCRIPTION: Verifies that the 'Hardened UNC Paths' setting is properly configured with 'Require Mutual Authentication' and 'Require Integrity' for NETLOGON and SYSVOL shares. This improves security for network connections to these critical shares.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkProvider\\HardenedPaths -> \\\\\\\\*\\\\NETLOGON -> !r:RequireMutualAuthentication=1, RequireIntegrity=1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\NetworkProvider\\HardenedPaths -> \\\\\\\\*\\\\SYSVOL -> !r:RequireMutualAuthentication=1, RequireIntegrity=1;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: Allow LocalSystem NULL session fallback' setting\nDESCRIPTION: Registry check to ensure NULL session fallback is disabled, preventing potential security vulnerabilities from system services using null sessions.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> allownullsessionfallback -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !allownullsessionfallback;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark for Windows 10 Microsoft Accounts Check\nDESCRIPTION: Registry check to verify that Microsoft accounts are properly blocked according to CIS Benchmark item 2.3.1.2, ensuring users can't add or log on with Microsoft accounts.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.1.2 Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'\n[CIS - Microsoft Windows 10 - 2.3.1.2 Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !NoConnectedUser;\n```\n\n----------------------------------------\n\nTITLE: Checking Data Execution Prevention for Explorer\nDESCRIPTION: Ensures that Data Execution Prevention (DEP) for Windows Explorer is enabled by verifying the NoDataExecutionPrevention registry value is not set to disable it. DEP helps prevent execution of malicious code.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting RSH Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that checks if rsh/rlogin/rcp services are enabled through xinetd or systemd. This implements CIS benchmark 2.1.3 by examining the relevant service configuration files.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/shell -> !r:^# && r:disable && r:no;\n# TODO (finish this)\nf:/usr/lib/systemd/system/rexec@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/rlogin@.service -> r:ExecStart;\nf:/usr/lib/systemd/system/rsh@.service -> r:ExecStart;\n```\n\n----------------------------------------\n\nTITLE: Checking SmartScreen Site Prompts Bypass Prevention\nDESCRIPTION: OSSEC rule to ensure users can't bypass Windows Defender SmartScreen prompts for sites according to CIS benchmark 18.9.80.2.3. Verifies PreventOverride is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.80.2.3 Ensure 'Prevent bypassing Windows Defender SmartScreen prompts for sites' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.9.80.2.3 Ensure 'Prevent bypassing Windows Defender SmartScreen prompts for sites' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> PreventOverride -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> !PreventOverride;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Protection Settings in Windows Defender\nDESCRIPTION: OSSEC rule to verify the 'Prevent users and apps from accessing dangerous websites' setting is enabled and set to 'Block' as required by CIS benchmark 18.9.76.13.3.1.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.76.13.3.1 Ensure 'Prevent users and apps from accessing dangerous websites' is set to 'Enabled: Block'\n[CIS - Microsoft Windows 10 - 18.9.76.13.3.1 Ensure 'Prevent users and apps from accessing dangerous websites' is set to 'Enabled: Block'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Network Protection -> EnableNetworkProtection -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\Network Protection -> !EnableNetworkProtection;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Secure Channel Data Encryption\nDESCRIPTION: Registry check to verify that secure channel data is encrypted when possible according to CIS benchmark 2.3.6.2, examining the SealSecureChannel registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SealSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive Logon Machine Inactivity Limit Registry Setting\nDESCRIPTION: Validates that the Interactive logon machine inactivity limit is set to a value between 1 and 900 seconds as specified in CIS benchmark 2.3.7.3. The rule checks for incorrect values and missing registry keys.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.7.3 Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 385;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 386;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 387;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 388;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 389;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:38\\D;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:39\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:3\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:4\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:5\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:6\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:7\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:8\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:9\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\D\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\w\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !InactivityTimeoutSecs;\n```\n\n----------------------------------------\n\nTITLE: Detecting HTTP Strict Transport Security Configuration\nDESCRIPTION: Rules to verify HSTS is enabled with an appropriate max-age value, enforcing secure connections to the server.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/apache2/apache2.conf -> !r:Header\\salways\\sset\\sStrict-Transport-Security\\s\"max-age=\\d\\d\\d\\d*\";\nf:/etc/apache2/apache2.conf -> !r:^# && r:Header\\salways\\sset\\sStrict-Transport-Security\\s\"max-age=1\\d\\d\";\nf:/etc/apache2/apache2.conf -> !r:^# && r:Header\\salways\\sset\\sStrict-Transport-Security\\s\"max-age=2\\d\\d\";\nf:/etc/apache2/apache2.conf -> !r:^# && r:Header\\salways\\sset\\sStrict-Transport-Security\\s\"max-age=3\\d\\d\";\nf:/etc/apache2/apache2.conf -> !r:^# && r:Header\\salways\\sset\\sStrict-Transport-Security\\s\"max-age=4\\d\\d\";\nf:/etc/apache2/apache2.conf -> !r:^# && r:Header\\salways\\sset\\sStrict-Transport-Security\\s\"max-age=5\\d\\d\";\n```\n\n----------------------------------------\n\nTITLE: OSSEC Security Audit Rules for Windows Server 2012 R2 Registry Checks\nDESCRIPTION: This configuration defines registry checks for Windows Server 2012 R2 security compliance based on CIS benchmarks. It includes checks for password policies, account restrictions, audit settings, device permissions, domain controller configurations, and logon settings.\n\nLANGUAGE: bash\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018 OSSEC Project\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n\n# CIS Checks for Windows Server 2012 R2 Domain Controller L1\n# Based on Center for Internet Security Benchmark v2.2.1 for Microsoft Windows Server 2012 R2 (https://workbench.cisecurity.org/benchmarks/288)\n#\n#\n#\n#1.1.2 Ensure 'Maximum password age' is set to '60 or fewer days, but not 0'\n[CIS - Microsoft Windows Server 2012 R2 - Ensure 'Maximum password age' is set to '60 or fewer days, but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3D;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3E;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> 3F;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:A\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:B\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:C\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:E\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:F\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> MaximumPasswordAge -> r:\\w\\w\\w+;\n#\n#\n#2.3.1.2 Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.1.2: Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !NoConnectedUser;\n#\n#\n#2.3.1.4 Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.1.4: Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LimitBlankPasswordUse -> 0;\n#\n#\n#2.3.2.1 Ensure 'Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.2.1: Ensure 'Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> SCENoApplyLegacyAuditPolicy -> !1;\n#\n#\n#2.3.2.2 Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.2.2: Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 2;\n#\n#\n#2.3.4.1 Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators' \n[CIS - Microsoft Windows Server 2012 R2 - 2.3.4.1: Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 2;\n#\n#\n#2.3.4.2 Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.4.2: Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> AddPrinterDrivers -> !1;\n#\n#\n#2.3.5.1 Ensure 'Domain controller: Allow server operators to schedule tasks' is set to 'Disabled' (DC only)\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.5.1: Ensure 'Domain controller: Allow server operators to schedule tasks' is set to 'Disabled' (DC only)] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\SubmitControl -> !0;\n\n#\n#\n#2.3.5.2 Ensure 'Domain controller: LDAP server signing requirements' is set to 'Require signing'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.5.2: Ensure 'Domain controller: LDAP server signing requirements' is set to 'Require signing'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NTDS\\Parameters -> LDAPServerIntegrity -> !2;\n#\n#\n#2.3.5.3 Ensure 'Domain controller: Refuse machine account password changes' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.5.3: Ensure 'Domain controller: Refuse machine account password changes' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RefusePasswordChange -> 1;\n#\n#\n#2.3.6.1 Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.1: Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireSignOrSeal -> 0;\n#\n#\n#2.3.6.2 Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.2: Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SealSecureChannel -> 0;\n#\n#\n#2.3.6.3 Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.3: Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SignSecureChannel -> 0;\n#\n#\n#2.3.6.4 Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.4: Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> DisablePasswordChange -> 1;\n#\n#\n#2.3.6.6 Ensure 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.6: Ensure 'Domain member: Require strong session key' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireStrongKey -> 0;\n#\n#\n#2.3.7.1 Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.1: Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DontDisplayLastUserName;\n#\n```\n\n----------------------------------------\n\nTITLE: Checking SMB v1 Client Driver Configuration in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver' according to CIS benchmark 18.3.2. The rule identifies non-compliant configurations in the system services registry.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.3.2 Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver'\n[CIS - Microsoft Windows 10 - 18.3.2 Ensure 'Configure SMB v1 client driver' is set to 'Enabled: Disable driver'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\mrxsmb10 -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\mrxsmb10 -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Empty Passwords in RHEL5\nDESCRIPTION: Checks if SSH empty passwords are permitted in the system. This CIS benchmark rule (6.2.9) verifies that the PermitEmptyPasswords option is not set to 'yes' in sshd_config to prevent authentication with empty passwords.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Detecting Non-Root Accounts with UID 0 in OSSEC\nDESCRIPTION: This rule checks for non-root accounts with UID 0 in /etc/passwd file. The rule identifies entries that have UID 0 but are not named 'root', which violates CIS benchmark 13.11 and represents a serious security vulnerability.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Checking for Non-Default SSH Port Configuration in OSSEC Rootcheck\nDESCRIPTION: Verifies if SSH daemon is configured to use the default port 22, which is considered less secure as it's commonly targeted by attackers.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 1: Port 22 {PCI_DSS: 2.2.4}] [any] [1]\nf:$sshd_file -> !r:^# && r:Port\\.+22;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Access Security Settings in Windows 10\nDESCRIPTION: Registry checks to verify network access restrictions including anonymous enumeration, credential storage, and anonymous user permissions meet CIS security recommendations.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.10.2 Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.10.2 Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymousSAM -> 0;\n#\n#\n#2.3.10.3 Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts and shares' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.10.3 Ensure 'Network access: Do not allow anonymous enumeration of SAM accounts and shares' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymous -> !1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> !RestrictAnonymous;\n#\n#\n#2.3.10.4 Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.10.4 Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> DisableDomainCreds -> !1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> !DisableDomainCreds;\n#\n#\n#2.3.10.5 Ensure 'Network access: Let Everyone permissions apply to anonymous users' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 2.3.10.5 Ensure 'Network access: Let Everyone permissions apply to anonymous users' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Remotely Accessible Registry Paths and Sub-paths Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network access: Remotely accessible registry paths and sub-paths' configuration according to CIS benchmark 2.3.10.8.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> Machine -> !r:Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|Software\\\\Microsoft\\\\OLAP Server|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog|System\\\\CurrentControlSet\\\\Services\\\\CertSvc|System\\\\CurrentControlSet\\\\Services\\\\WINS;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Host-based Authentication in RHEL5\nDESCRIPTION: Checks if SSH host-based authentication is enabled in the system. This CIS benchmark rule (6.2.7) verifies that the HostbasedAuthentication option is not set to 'yes' in sshd_config to prevent insecure host-based authentication.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Detecting Insecure SSL Renegotiation Settings in Apache\nDESCRIPTION: Rules to verify SSL insecure renegotiation is disabled to prevent man-in-the-middle attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslinsecurerenegotiation\\s+on\\s*;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslinsecurerenegotiation\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Source Routing Protection for Windows Server\nDESCRIPTION: Verifies that IPv6 source routing protection is set to the highest level to guard against packet spoofing. Detects non-compliance when DisableIPSourceRouting is not set to 2 or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Successful Connections Logging in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes' as required by CIS benchmark 9.3.10. The rule identifies non-compliant registry settings in both policy and service configuration locations.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#9.3.10 Ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes'\n[CIS - Microsoft Windows 10 - 9.3.10 Ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring OSSEC Registry Checks for Windows Server 2016 Security Settings\nDESCRIPTION: This code implements OSSEC security audit rules for Windows Server 2016 based on CIS Benchmark v1.0.0. Each rule checks registry keys and values to ensure they conform to recommended security settings. The checks cover areas like logon caching, network authentication, TCP/IP parameters, and various system configurations.\n\nLANGUAGE: ossec\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n\n# CIS Checks for Windows Server 2016 Member Server L2\n# Based on Center for Internet Security Benchmark v1.0.0 for Microsoft Windows Server 2016 (https://workbench.cisecurity.org/benchmarks/515)\n#\n#\n#\n#2.3.7.6 Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)'\n[CIS - Microsoft Windows Server 2016 - 2.3.1.2 Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> !4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> !CachedLogonsCount;\n#\n#\n#2.3.10.4 Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 2.3.10.4 Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> DisableDomainCreds -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !DisableDomainCreds;\n#\n#\n#18.3.5 Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'\n[CIS - Microsoft Windows Server 2016 - 18.3.5 Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n#\n#\n#18.3.7 Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.3.7 Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> PerformRouterDiscovery  -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !PerformRouterDiscovery;\n#\n#\n#18.3.10 Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'\n[CIS - Microsoft Windows Server 2016 - 18.3.10 Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !TcpMaxDataRetransmissions;\n#\n#\n#18.3.11 Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'\n[CIS - Microsoft Windows Server 2016 - 18.3.11 Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !TcpMaxDataRetransmissions;\n#\n#\n#18.4.5.1 Ensure 'Enable Font Providers' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.5.1 Ensure 'Enable Font Providers' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableFontProviders -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableFontProviders;\n#\n#\n#18.4.9.1 Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.9.1 Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableLLTDIO -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitLLTDIOOnPrivateNet -> !0;\n#\n#\n#18.4.9.2 Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.9.2 Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableRspndr -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitRspndrOnPrivateNet -> !0;\n#\n#\n#18.4.10.2 Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.10.2 Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> !Disabled;\n#\n#\n#18.4.19.2.1 Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)')\n[CIS - Microsoft Windows Server 2016 - 18.4.19.2.1 Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)')] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> DisabledComponents -> !ff;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !DisabledComponents;\n#\n#\n#18.4.20.1 Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.20.1 Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> EnableRegistrars -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !EnableRegistrars;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableUPnPRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableUPnPRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableInBand802DOT11Registrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableInBand802DOT11Registrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableFlashConfigRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableFlashConfigRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableWPDRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableWPDRegistrar;\n#\n#\n#18.4.20.2 Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.20.2 Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> DisableWcnUi -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> !DisableWcnUi;\n#\n#\n#18.4.21.2 Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.21.2 Ensure 'Prohibit connection to non-domain networks when connected to domain authenticated network' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fBlockNonDomain -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> !fBlockNonDomain;\n#\n#\n#18.8.20.1.1 Ensure 'Turn off access to the Store' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.20.1.1 Ensure 'Turn off access to the Store' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n#\n```\n\n----------------------------------------\n\nTITLE: Parsing JSON with cJSON and Traversing Objects and Arrays\nDESCRIPTION: A function that parses a JSON string representing a monitor configuration and checks if it supports Full HD resolution. It demonstrates parsing, error handling, and traversing the JSON structure including accessing object properties and iterating through arrays.\n\nLANGUAGE: c\nCODE:\n```\n/* return 1 if the monitor supports full hd, 0 otherwise */\nint supports_full_hd(const char * const monitor)\n{\n    const cJSON *resolution = NULL;\n    const cJSON *resolutions = NULL;\n    const cJSON *name = NULL;\n    int status = 0;\n    cJSON *monitor_json = cJSON_Parse(monitor);\n    if (monitor_json == NULL)\n    {\n        const char *error_ptr = cJSON_GetErrorPtr();\n        if (error_ptr != NULL)\n        {\n            fprintf(stderr, \"Error before: %s\\n\", error_ptr);\n        }\n        status = 0;\n        goto end;\n    }\n\n    name = cJSON_GetObjectItemCaseSensitive(monitor_json, \"name\");\n    if (cJSON_IsString(name) && (name->valuestring != NULL))\n    {\n        printf(\"Checking monitor \\\"%s\\\"\\n\", name->valuestring);\n    }\n\n    resolutions = cJSON_GetObjectItemCaseSensitive(monitor_json, \"resolutions\");\n    cJSON_ArrayForEach(resolution, resolutions)\n    {\n        cJSON *width = cJSON_GetObjectItemCaseSensitive(resolution, \"width\");\n        cJSON *height = cJSON_GetObjectItemCaseSensitive(resolution, \"height\");\n\n        if (!cJSON_IsNumber(width) || !cJSON_IsNumber(height))\n        {\n            status = 0;\n            goto end;\n        }\n\n        if ((width->valuedouble == 1920) && (height->valuedouble == 1080))\n        {\n            status = 1;\n            goto end;\n        }\n    }\n\nend:\n    cJSON_Delete(monitor_json);\n    return status;\n}\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Blank Password Restriction\nDESCRIPTION: Verifies the 'Accounts: Limit local account use of blank passwords to console logon only' policy is enabled in Windows Server 2016. Checks if the LimitBlankPasswordUse registry value is properly configured.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.1.4 Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LimitBlankPasswordUse -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Retention Behavior in Windows Registry\nDESCRIPTION: Registry check to ensure that Security event log behavior is appropriately configured when it reaches maximum size. Implements CIS benchmark 18.9.26.2.1 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for System Shutdown on Audit Failures\nDESCRIPTION: Verifies the 'Audit: Shut down system immediately if unable to log security audits' policy is disabled in Windows Server 2016. Checks if the CrashOnAuditFail registry value is properly configured.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.2.2 Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender Behavior Monitoring in Registry\nDESCRIPTION: Confirms that Windows Defender behavior monitoring is enabled by checking if the DisableBehaviorMonitoring registry value is not set to 1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Real-Time Protection -> DisableBehaviorMonitoring -> !1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Secure Channel Data Encryption\nDESCRIPTION: Verifies the 'Domain member: Digitally encrypt or sign secure channel data (always)' policy is enabled in Windows Server 2016. Checks if the RequireSignOrSeal registry value is correctly configured for domain security.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.6.1 Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireSignOrSeal -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Unencrypted Traffic Settings\nDESCRIPTION: Verifies that unencrypted traffic is disabled in WinRM Service by ensuring the AllowUnencryptedTraffic registry key is not set to a non-zero value.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Non-Empty Password Fields\nDESCRIPTION: Rule to ensure all password fields are not empty, as specified in CIS Solaris 11 benchmark section 9.4. This prevents accounts with no password protection.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/shadow -> r:\\.+::\\.+\\w+\\.*$;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Listen Directive Restrictions\nDESCRIPTION: Audit rule that checks if Listen directives are properly restricted. The server should not listen on wildcard addresses (0.0.0.0 or ::) as this exposes it to all network interfaces, including potentially untrusted ones.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.13: Restrict Listen Directive] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:listen\\s80$;\nd:$conf-dirs -> conf -> !r:^# && r:listen\\s0.0.0.0\\p80;\nd:$conf-dirs -> conf -> !r:^# && r:listen\\s[\\p\\pffff\\p0.0.0.0]\\p80;\nf:$main-conf -> !r:^# && r:listen\\s80$;\nf:$main-conf -> !r:^# && r:listen\\s0.0.0.0\\p\\d*;\nf:$main-conf -> !r:^# && r:listen\\s[\\p\\pffff\\p0.0.0.0]\\p\\d*; \nf:/etc/apache2/sites-enabled/000-default.conf -> !r:^# && r:listen\\s80$;\nf:/etc/apache2/sites-enabled/000-default.conf -> !r:^# && r:listen\\s0.0.0.0\\p\\d*;\nf:/etc/apache2/sites-enabled/000-default.conf -> !r:^# && r:listen\\s[\\p\\pffff\\p0.0.0.0]\\p\\d*;\nf:/etc/apache2/ports.conf -> !r:^# && r:listen\\s80$;\nf:/etc/apache2/ports.conf -> !r:^# && r:listen\\s0.0.0.0\\p\\d*;\nf:/etc/apache2/ports.conf -> !r:^# && r:listen\\s[\\p\\pffff\\p0.0.0.0]\\p\\d*;\n```\n\n----------------------------------------\n\nTITLE: Detecting NIS Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if NIS server (ypserv) is enabled. This implements CIS benchmark 2.1.6 by checking for boot services and systemd configurations that would start the NIS server.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dypserv$;\nf:/usr/lib/systemd/system/ypserv.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Auditing Changes to System Administration Scope in Debian Linux\nDESCRIPTION: Configuration for monitoring changes to the sudoers file according to CIS Benchmark 8.1.15. This tracks modifications to the system administration permissions which could indicate privilege escalation attempts.\n\nLANGUAGE: auditd\nCODE:\n```\n-w /etc/sudoers -p wa -k scope\n```\n\n----------------------------------------\n\nTITLE: Checking Password Length Compliance for Windows Server\nDESCRIPTION: Verifies that the 'Password Settings: Password Length' is set to 15 or more characters by checking registry values. Detects non-compliance when the PasswordLength value is less than 15 or missing entirely.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:a;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:b;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:c;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:e;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PasswordLength;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Complexity Setting\nDESCRIPTION: Registry check to ensure LAPS password complexity is set correctly. Verifies PasswordComplexity is set to 4 (which requires large letters, small letters, numbers, and special characters).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordComplexity -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking for Password Authentication in OSSEC Rootcheck\nDESCRIPTION: Verifies if password authentication is enabled, which is considered less secure than public key authentication and should be disabled when possible.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 5: Password Authentication {PCI_DSS: 2.2.4}] [any] [5]\nf:$sshd_file -> !r:^# && r:PasswordAuthentication\\.+yes;\nf:$sshd_file -> r:^#\\s*PasswordAuthentication;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Inbound Connections\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile inbound connections are set to Block. Verifies this setting in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking LimitRequestLine Directive in Apache Configuration\nDESCRIPTION: This code verifies that the LimitRequestLine directive is set to 512 or less in Apache configuration files, following CIS benchmark section 10.1. This helps prevent buffer overflow attacks by limiting the size of HTTP request lines.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^limitrequestline\\s+\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\13;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\14;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\15;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\16;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\17;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\18;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\19;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\2\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\3\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\4\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\5\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\6\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\7\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\8\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+5\\9\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+6\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+7\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+8\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+9\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestline\\s+\\d\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous enumeration of SAM accounts and shares restriction\nDESCRIPTION: Verifies that anonymous users are prevented from enumerating SAM accounts and shares by checking that RestrictAnonymous registry value is set to 1.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymous -> !1;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Apache User Account Lock Status\nDESCRIPTION: Audit rule that checks if the Apache user account is locked, which is a security best practice. The rule examines the /etc/shadow file to verify if the user accounts used by Apache have locked passwords.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 3.3: Lock the Apache User Account] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:/etc/shadow -> r:^daemon|^wwwrun|^www-data|^apache && !r:\\p!\\.*$;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv4 Source Routing Protection Registry Settings\nDESCRIPTION: Validates that IP source routing protection level for IPv4 is set to highest protection by checking the DisableIPSourceRouting registry value is set to 2.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode Setting\nDESCRIPTION: Verifies that 'User Account Control: Run all administrators in Admin Approval Mode' is enabled by checking the EnableLUA registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableLUA -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Session Idle Time Limits in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if the Windows network server idle time limit is set to 15 or fewer minutes but not 0, as required by CIS benchmark 2.3.9.1. It verifies the AutoDisconnect registry value using multiple pattern checks.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.9.1 Ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s), but not 0'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.9.1: Ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s), but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !AutoDisconnect;\n```\n\n----------------------------------------\n\nTITLE: Checking Heap Termination on Corruption\nDESCRIPTION: Verifies that heap termination on corruption is enabled by ensuring the NoHeapTerminationOnCorruption registry value is not set to disable it. This helps prevent exploitation of memory corruption vulnerabilities.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoHeapTerminationOnCorruption -> !0;\n```\n\n----------------------------------------\n\nTITLE: Telnet Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify telnet server is disabled on RHEL5 systems. Examines /etc/xinetd.d/telnet to ensure the service is properly disabled, meeting CIS requirement 2.1.1 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 2.1.1 - Telnet enabled on xinetd {CIS: 2.1.1 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking rsyslog Configuration\nDESCRIPTION: Rules for verifying proper rsyslog configuration according to CIS benchmark 8.2.3. Ensures various logging rules are properly set for different message types and priorities.\n\nLANGUAGE: ossec\nCODE:\n```\n#8.2.3 Configure /etc/rsyslog.conf\n[CIS - Debian Linux 7/8 - 8.2.3 Configure /etc/rsyslog.conf] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:$rsyslog_files -> !r:^*.emerg\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^mail.*\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^mail.info\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^mail.warning\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^mail.err\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^news.crit\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^news.err\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^news.notice\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^*.=warning;*.=err\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^*.crit\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^*.*;mail.none;news.none\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^local0,local1.*\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^local2,local3.*\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^local4,local5.*\\s*\\t*\\s*\\S;\nf:$rsyslog_files -> !r:^local6,local7.*\\s*\\t*\\s*\\S;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Audit Policy Override\nDESCRIPTION: Registry check to ensure that audit policy subcategory settings override audit policy category settings according to CIS benchmark 2.3.2.1, checking the SCENoApplyLegacyAuditPolicy registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> SCENoApplyLegacyAuditPolicy -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking User Modification Restrictions for Security Settings\nDESCRIPTION: OSSEC rule to verify that users are prevented from modifying security settings by checking if DisallowExploitProtectionOverride is properly set according to CIS benchmark 18.9.79.1.1.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.79.1.1 Ensure 'Prevent users from modifying settings' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.9.79.1.1 Ensure 'Prevent users from modifying settings' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and Browser protection -> DisallowExploitProtectionOverride -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender Security Center\\App and Browser protection -> !DisallowExploitProtectionOverride;\n```\n\n----------------------------------------\n\nTITLE: Verifying SSL Compression Settings in Apache\nDESCRIPTION: Rules to check that SSL compression is disabled to prevent CRIME attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslcompression\\s+on\\s*;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslcompression\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH HostbasedAuthentication Setting\nDESCRIPTION: Rules for verifying SSH HostbasedAuthentication settings according to CIS benchmark 9.3.7. Ensures host-based authentication is disabled for improved security.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.7 Set SSH HostbasedAuthentication to No\n[CIS - Debian Linux 7/8 - 9.3.7 Set SSH HostbasedAuthentication to No] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^HostbasedAuthentication\\s+no;\n```\n\n----------------------------------------\n\nTITLE: Checking System Account Default Passwords\nDESCRIPTION: Rule to verify system accounts have secure password settings, as specified in CIS Solaris 11 benchmark section 9.3. This ensures system accounts cannot be compromised through default passwords.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/shadow -> r:daemon && !r::NL:|:NP:;\nf:/etc/shadow -> r:lp && !r::NL:|:NP:;\nf:/etc/shadow -> r:adm && !r::NL:|:NP:;\nf:/etc/shadow -> r:bin && !r::NL:|:NP:;\nf:/etc/shadow -> r:gdm && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:noaccess && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:nobody && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:nobody4 && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:openldap && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:unknown && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:webservd && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:mysql && !r::NL:|:NP:;\nf:/etc/shadow -> r:nuuc && !r::NL:|:NP:;\nf:/etc/shadow -> r:postgres && !r::NL:|:NP:;\nf:/etc/shadow -> r:smmsp && !r::NL:|:NP:;\nf:/etc/shadow -> r:sys && !r::NL:|:NP:;\nf:/etc/shadow -> r:uucp && !r::NL:|:NP:;\nf:/etc/shadow -> r:aiuser && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:dhcpserv && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:dladm && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:ftp && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:netadm && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:netcfg && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:pkg5srv && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:svctag && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:xvm && !r:\\p*LK\\p*:;\nf:/etc/shadow -> r:upnp && !r::NL:|:NP:;\nf:/etc/shadow -> r:zfssnap && !r::NL:|:NP:;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Audit Rules for Linux Password Security\nDESCRIPTION: A set of OSSEC audit rules that check password security configurations on Linux systems. The rules verify encryption algorithms, password hashing methods, creation requirements, and expiration settings across various system configuration files.\n\nLANGUAGE: ossec\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - p (process running)\n#             - d (any file inside the directory)\n#\n# Additional values:\n# For the registry , use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n#\n# Checks for Password Security on Linux Systems\n#\n#1 Set Default Algorithm for Password Encryption to SHA256 or SHA 512\n[Password Hardening - 1: Set Default Algorithm for Password Encryption to SHA256 or SHA 512] [any] [https://security.stackexchange.com/questions/77349/how-can-i-find-out-the-password-hashing-schemes-used-by-the-specific-unix-accoun, https://docs.oracle.com/cd/E26505_01/html/E27224/secsystask-42.html]\nf:/etc/security/policy.conf -> !r:^# && r:^CRYPT_DEFAULT=1|^CRYPT_DEFAULT=2|^CRYPT_DEFAULT=2a|^CRYPT_DEFAULT=2x|^CRYPT_DEFAULT=2y|^CRYPT_DEFAULT=md5|^CRYPT_DEFAULT=__unix__;\nf:/etc/security/policy.conf -> !r:^CRYPT_DEFAULT=\\d;\nf:/etc/login.defs -> !r:^# && r:^ENCRYPT_METHOD\\s+MD5|^ENCRYPT_METHOD\\s+DES;\nf:/etc/login.defs -> !r:^ENCRYPT_METHOD\\s+SHA512|^ENCRYPT_METHOD\\s+SHA256;\nf:/etc/pam.d/common-password -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;\nf:/etc/pam.d/common-password -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;\nf:/etc/pam.d/password-auth -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;\nf:/etc/pam.d/password-auth -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;\nf:/etc/pam.d/system-auth -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;\nf:/etc/pam.d/system-auth -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;\nf:/etc/pam.d/system-auth-ac -> !r:^# && r:password\\.+pam_unix.so\\.+md5|password\\.+pam_unix.so\\.+des;\nf:/etc/pam.d/system-auth-ac -> !r:^password\\.+pam_unix.so\\.+sha512|^password\\.+pam_unix.so\\.+sha256;\n#\n#\n#2 Passwords in /etc/shadow not hashed with SHA-256 or SHA-512\n[Password Hardening - 2: Not all Passwords in /etc/shadow are hashed with SHA-256 or SHA-512] [any] [https://linux-audit.com/password-security-with-linux-etc-shadow-file/, https://docs.oracle.com/cd/E19253-01/816-4557/concept-23/index.html]\nf:/etc/shadow -> !r:^# && !r:^\\w+:NP:\\d+:\\d*:\\d*:\\d*:\\d*:\\d*:\\d*$ && r:^\\w+:\\w\\.*:\\d+:\\d*:\\d*:\\d*:\\d*:\\d*:\\d*$;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$1\\$\\.+;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$2\\$\\.+;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$2a\\$\\.+;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$2x\\$\\.+;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$2y\\$\\.+;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$md5\\$\\.+;\nf:/etc/shadow -> !r:^# && r:\\w+:\\$__unix__\\$\\.+;\n#\n#\n#3 Set Password Creation Requirement Parameters\n[Password Hardening - 3: Set Password Creation Requirement Parameters] [any] [https://linux-audit.com/configure-the-minimum-password-length-on-linux-systems/, https://workbench.cisecurity.org]\nf:/etc/pam.d/common-password -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;\nf:/etc/pam.d/common-password -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;\nf:/etc/pam.d/password-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;\nf:/etc/pam.d/password-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;\nf:/etc/pam.d/system-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;\nf:/etc/pam.d/system-auth -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;\nf:/etc/pam.d/system-auth-ac -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass;\nf:/etc/pam.d/system-auth-ac -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+;\nf:/etc/pam.d/passwd -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+try_first_pass|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+try_first_pass|^@include\\s+common-password;\nf:/etc/pam.d/passwd -> !r:^password\\s*\\t*requisite\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*requisite\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_cracklib.so\\.+retry=\\d+|^password\\s*\\t*required\\s*\\t*pam_pwquality.so\\.+retry=\\d+|^@include\\s+common-password;\nf:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:minlen=\\d\\d+;\nf:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:minlen=\\d\\d+;\nf:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:minlen=\\d\\d+;\nf:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:minlen=\\d\\d+;\nf:/etc/security/pwquality.conf -> !r:^minlen=\\d\\d+;\nf:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;\nf:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;\nf:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;\nf:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:dcredit=\\p*\\d+;\nf:/etc/security/pwquality.conf -> !r:^dcredit=\\p*\\d+;\nf:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;\nf:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;\nf:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;\nf:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:lcredit=\\p*\\d+;\nf:/etc/security/pwquality.conf -> !r:^lcredit=\\p*\\d+;\nf:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;\nf:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;\nf:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;\nf:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:ocredit=\\p*\\d+;\nf:/etc/security/pwquality.conf -> !r:^ocredit=\\p*\\d+;\nf:/etc/pam.d/common-password -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;\nf:/etc/pam.d/password-auth -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;\nf:/etc/pam.d/system-auth -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;\nf:/etc/pam.d/passwd -> r:pam_cracklib.so && !r:ucredit=\\p*\\d+;\nf:/etc/security/pwquality.conf -> !r:^ucredit=\\p*\\d+;\n#\n#\n#4 Set default password expiration / aging parameters\n[Password Hardening - 4: Set password expiration / aging parameters] [any] [https://www.thegeekdiary.com/understanding-etclogin-defs-file, https://workbench.cisecurity.org/sections/26024/recommendations/63001]\nf:/etc/default/passwd -> !r:^MAXWEEKS=\\d\\d$;\nf:/etc/default/passwd -> !r:^MINWEEKS=\\d;\nf:/etc/default/passwd -> !r:^WARNWEEKS=\\d;\nf:/etc/login.defs -> !r:^PASS_MAX_DAYS\\s*\\t*\\d\\d$;\nf:/etc/login.defs -> !r:^PASS_MIN_DAYS\\s*\\t*\\d;\nf:/etc/login.defs -> !r:^PASS_WARN_AGE\\s*\\t*\\d;\n```\n\n----------------------------------------\n\nTITLE: Checking Kerberos Encryption Types Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network Security: Configure encryption types allowed for Kerberos' is set to 'RC4_HMAC_MD5, AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types' according to CIS benchmark 2.3.11.4.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters -> SupportedEncryptionTypes -> !2147483644;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Blank Password Limitation\nDESCRIPTION: Registry check to verify that blank passwords are limited to console logon only according to CIS benchmark 2.3.1.4, examining the LimitBlankPasswordUse value in the LSA registry key.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LimitBlankPasswordUse -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Maximum Size in Windows Registry\nDESCRIPTION: OSSEC rule to verify 'Security: Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater' in Windows registry. This complex rule checks for various size configurations that would be less than the required minimum size.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:0\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:1\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:2\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking for Rhosts Authentication in OSSEC Rootcheck\nDESCRIPTION: Verifies if rhosts or shosts files are used for authentication, which is insecure and should be disabled for better security.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 7: Rhost or shost used for authentication {PCI_DSS: 2.2.4}] [any] [7]\nf:$sshd_file -> !r:^# && r:IgnoreRhosts\\.+no;\nf:$sshd_file -> r:^#\\s*IgnoreRhosts;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for LDAP Server Signing Requirements\nDESCRIPTION: Registry check to ensure that LDAP server signing is required according to CIS benchmark 2.3.5.2, verifying the LDAPServerIntegrity value in the NTDS Parameters registry key.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NTDS\\Parameters -> LDAPServerIntegrity -> !2;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Strong Session Key Requirement\nDESCRIPTION: Registry check to ensure that strong session keys are required according to CIS benchmark 2.3.6.6, verifying the RequireStrongKey registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireStrongKey -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Client Session Security Configuration in Windows Registry\nDESCRIPTION: Verifies the 'Network security: Minimum session security for NTLM SSP based clients' is properly configured to require NTLMv2 session security and 128-bit encryption. Checks for proper registry value (537395200) or missing key in MSV1_0.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinClientSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinClientSec;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for AllowOverride Restrictions\nDESCRIPTION: Audit rule that checks if AllowOverride is restricted appropriately in Apache configurations. AllowOverride should be set to 'None' to prevent .htaccess files from overriding security configurations.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 4.4: Restrict Override for All Directories] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && !r:\\w+ && r:allowoverride && !r:none$;\nd:$conf-dirs -> conf -> !r:^# && !r:\\w+ && r:allowoverridelist;\nf:$main-conf -> !r:^# && !r:\\w+ && r:allowoverride && !r:none$;\nf:$main-conf -> !r:^# && !r:\\w+ && r:allowoverridelist;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Source Routing Protection Registry Settings\nDESCRIPTION: Validates that IP source routing protection level for IPv6 is set to highest protection by checking the DisableIPSourceRouting registry value is set to 2.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile State in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Firewall state' is set to 'On'. Checks if the EnableFirewall registry value is set to 0 in either policy or current configuration, which would indicate the firewall is disabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking NTP Configuration in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that verifies proper NTP configuration. This implements CIS benchmark 3.6 by checking both the NTP server configuration and daemon options to ensure proper settings for secure time synchronization.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/ntp.conf -> r:restrict default kod nomodify notrap nopeer noquery && r:^server;\nf:/etc/sysconfig/ntpd -> r:OPTIONS=\"-u ntp:ntp -p /var/run/ntpd.pid\";\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH Protocol Version 1 in RHEL7\nDESCRIPTION: OSSEC rule that checks if SSH Protocol version 1 is enabled, which would violate CIS benchmark 6.2.1 for RHEL7 and PCI-DSS requirement 4.1.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 6.2.1 - SSH Configuration - Protocol version 1 enabled {CIS: 6.2.1 RHEL7} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Checking WDigest Authentication Disabled Status\nDESCRIPTION: OSSEC rule to verify that WDigest Authentication is disabled for improved security. The rule checks if the UseLogonCredential registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Shell Protocol Protected Mode\nDESCRIPTION: Ensures that shell protocol protected mode is enabled by verifying the PreXPSP2ShellProtocolBehavior registry value is not set to disable it. This provides additional security protections in the Windows shell.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> PreXPSP2ShellProtocolBehavior -> !0;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Microsoft Account Blocking Policy\nDESCRIPTION: Verifies the 'Accounts: Block Microsoft accounts' policy setting is configured properly in Windows Server 2016. Checks the NoConnectedUser registry value to ensure Microsoft accounts can't be added or used for logon.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.1.2 Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !NoConnectedUser;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode Setting in Windows Registry\nDESCRIPTION: Checks that 'User Account Control: Run all administrators in Admin Approval Mode' is set to 'Enabled' by verifying EnableLUA registry value is not 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableLUA -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Saving Prevention in Registry\nDESCRIPTION: Registry check to ensure that 'Do not allow passwords to be saved' is set to 'Enabled' as required by CIS benchmark 18.9.52.2.2. This prevents credentials from being saved in Remote Desktop sessions.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.52.2 Ensure 'Do not allow passwords to be saved' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.52.2.2: Ensure 'Do not allow passwords to be saved' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !DisablePasswordSaving;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender SmartScreen System Settings\nDESCRIPTION: OSSEC rule to check if Windows Defender SmartScreen is configured to warn and prevent bypass according to CIS benchmark 18.9.80.1.1. Verifies EnableSmartScreen is set to 1 and ShellSmartScreenLevel is set to 'Block'.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.80.1.1 Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'\n[CIS - Microsoft Windows 10 - 18.9.80.1.1 Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled: Warn and prevent bypass'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableSmartScreen;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> ShellSmartScreenLevel -> !Block;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !ShellSmartScreenLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking PKU2U Authentication Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network Security: Allow PKU2U authentication requests to this computer to use online identities' is set to 'Disabled' according to CIS benchmark 2.3.11.3.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\pku2u -> AllowOnlineID -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Standard User Elevation Prompt Behavior in Windows Registry\nDESCRIPTION: Checks that 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests' by verifying ConsentPromptBehaviorUser registry value is not 1 or missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorUser;\n```\n\n----------------------------------------\n\nTITLE: Setting Variables for OSSEC Linux Audit in RHEL 7\nDESCRIPTION: Defines key variables used in the OSSEC audit configuration including the path to SSH daemon configuration and RC script directories. These variables are referenced in subsequent audit rules.\n\nLANGUAGE: bash\nCODE:\n```\n# Vars\n$sshd_file=/etc/ssh/sshd_config;\n\n# RC scripts location\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Checking for Accounts with Empty Passwords\nDESCRIPTION: Rule to detect accounts with empty passwords in the /etc/shadow file. This check helps enforce PCI-DSS requirement 10.2.5 by identifying security vulnerabilities where accounts might be accessed without authentication.\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Server Session Security Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: Minimum session security for NTLM SSP based servers' is set to 'Require NTLMv2 session security, Require 128-bit encryption' according to CIS benchmark 2.3.11.10.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Validating SSH IgnoreRhosts Setting\nDESCRIPTION: Rules for checking that SSH IgnoreRhosts is properly set according to CIS benchmark 9.3.6. Ensures .rhosts files are ignored for enhanced security.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.6 Set SSH IgnoreRhosts to Yes\n[CIS - Debian Linux 7/8 - 9.3.6 Set SSH IgnoreRhosts to Yes] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^IgnoreRhosts\\s+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Configuration Registry Setting\nDESCRIPTION: Verifies that 'Configure Automatic Updates' is enabled by checking if the NoAutoUpdate registry value is not set to 1 or does not exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Configuration\nDESCRIPTION: Verifies if appropriate password expiration settings are configured in login.defs. This includes checking maximum password age to ensure users change their passwords regularly as part of security best practices.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/login.defs -> !r:^PASS_MAX_DAYS\\s+\\d+;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+\\d\\d\\d+;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+91;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+92;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+93;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+94;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+95;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+96;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+97;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+98;\nf:/etc/login.defs -> !r:^# && r:PASS_MAX_DAYS\\s+99;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Digest Authentication Settings in Registry\nDESCRIPTION: Registry checks to ensure 'Disallow Digest authentication' for WinRM client is set to 'Enabled' per CIS benchmark 18.9.86.1.3. This prevents the less secure Digest authentication method from being used.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowDigest -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> !AllowDigest;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Dropped Packets Logging\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes' as required by CIS benchmark 9.3.9 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Maximum Size Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater' as per CIS benchmark 18.9.26.1.2. Checks if MaxSize value exists and is large enough.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile State\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile state is enabled. Verifies this setting in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge SmartScreen Settings\nDESCRIPTION: OSSEC rule to verify Windows Defender SmartScreen is enabled in Microsoft Edge according to CIS benchmark 18.9.80.2.1. Checks if EnabledV9 registry value is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.80.2.1 Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.9.80.2.1 Ensure 'Configure Windows Defender SmartScreen' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> EnabledV9 -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Network Client Digital Signature Requirements in Windows Server 2016\nDESCRIPTION: Verifies that 'Microsoft network client: Digitally sign communications (always)' is enabled. This rule checks the RequireSecuritySignature registry value to ensure secure communications are enforced for network clients.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> !RequireSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Collect Login and Logout Events Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.8 that checks if auditd is configured to collect login and logout events. It verifies audit rules monitoring login logs to track authentication activities and potential unauthorized access attempts.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.8 Collect Login and Logout Events] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-w /var/log/faillog -p wa -k logins;\nf:/etc/audit/audit.rules -> !r:^-w /var/log/lastlog -p wa -k logins;\nf:/etc/audit/audit.rules -> !r:^-w /var/log/tallylog -p wa -k logins;\n```\n\n----------------------------------------\n\nTITLE: Checking Idle Session Time Limit for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if the time limit for idle Remote Desktop Services sessions is set to 15 minutes or less, as per CIS benchmark 18.9.52.3.10.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba\\D;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbb\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbc\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbd\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbe\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbf\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbc\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbd\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbe\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbf\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dc\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dd\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:de\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:df\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:e\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:f\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:\\w\\w\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxIdleTime;\n```\n\n----------------------------------------\n\nTITLE: Checking Secure Desktop for Elevation Prompts Setting\nDESCRIPTION: Verifies that 'Switch to the secure desktop when prompting for elevation' is enabled by checking if PromptOnSecureDesktop registry value is set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> PromptOnSecureDesktop -> 0;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for WebDAV Modules in Apache\nDESCRIPTION: Audit rule that checks if WebDAV modules are enabled in Apache configurations, which could introduce security vulnerabilities if not needed. The check looks for uncommented LoadModule directives for DAV across various configuration locations.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 2.3: WebDAV Modules are enabled] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:loadmodule\\sdav;\nd:$conf-dirs -> load -> !r:^# && r:loadmodule\\sdav;\nf:/etc/httpd/conf.d -> !r:^# && r:loadmodule\\sdav;\nd:$mods-en -> dav.load;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Dropped Packets Logging in OSSEC\nDESCRIPTION: OSSEC rule that verifies 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes' as required by CIS benchmark 9.3.9. The rule checks for non-compliant configuration in both policy and current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#9.3.9 Ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes'\n[CIS - Microsoft Windows 10 - 9.3.9 Ensure 'Windows Firewall: Public: Logging: Log dropped packets' is set to 'Yes'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled IP Forwarding in RHEL7\nDESCRIPTION: OSSEC rule that checks if IP forwarding is enabled on IPv4 and IPv6, which would violate CIS benchmark 4.1.1 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.1.1 - Network parameters - IP Forwarding enabled {CIS: 4.1.1 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled PostgreSQL Server (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if the PostgreSQL database server is enabled at boot time, which is against PCI-DSS requirement 2.2.2 unless specifically needed. The rule looks for PostgreSQL startup scripts in the rc directories.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - Disable standard boot services - PostgreSQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager Hash Storage in Windows 10\nDESCRIPTION: Verifies that 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled' by checking that the NoLMHash registry value is not set to 0.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> NoLMHash -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Source Routing Protection Settings in Windows Server 2016\nDESCRIPTION: Registry checks to ensure IPv6 source routing protection is set to highest level. Validates that the DisableIPSourceRouting registry key for IPv6 is set to 2 as required by CIS benchmark 18.3.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Secure Channel Data Encryption (When Possible)\nDESCRIPTION: Verifies the 'Domain member: Digitally encrypt secure channel data (when possible)' policy is enabled in Windows Server 2016. Checks if the SealSecureChannel registry value is correctly configured.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.6.2 Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SealSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Inbound Connections\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Inbound connections' is set to 'Block (default)' as required by CIS benchmark 9.3.2 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH MaxAuthTries Configuration\nDESCRIPTION: Rule to check if SSH MaxAuthTries is set to 4 or less. According to CIS SLES12 benchmark 9.2.5, MaxAuthTries should be set to 4 or less to limit brute force attempts.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:MaxAuthTries && !r:3\\s*$;\nf:/etc/ssh/sshd_config -> r:^#\\s*MaxAuthTries;\nf:/etc/ssh/sshd_config -> !r:MaxAuthTries;\n```\n\n----------------------------------------\n\nTITLE: Checking Anonymous Access to Shares in Windows 10\nDESCRIPTION: Verifies that 'Network access: Shares that can be accessed anonymously' is set to 'None' by checking that the NullSessionShares registry key doesn't contain any values.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionShares -> r:\\S*;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Banner Configuration\nDESCRIPTION: Ensures that an SSH banner is properly configured in the SSH daemon configuration. SSH banners provide legal notices and warnings to users attempting to connect to the system.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^Banner\\s+\\S+;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Successful Connections Logging\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Domain: Logging: Log successful connections' is set to 'Yes' as required by CIS benchmark 9.2.10 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking restriction of anonymous access to Named Pipes and Shares\nDESCRIPTION: Verifies that anonymous access to Named Pipes and Shares is restricted by checking that RestrictNullSessAccess registry value is set to 1.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RestrictNullSessAccess -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking User Control over Installations\nDESCRIPTION: Verifies that 'Allow user control over installs' is set to 'Disabled' (value equal to 0) in the Windows Installer registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Skip Grant Tables Check in OSSEC\nDESCRIPTION: Checks if MySQL is configured with skip-grant-tables option per CIS recommendation 4.5. This dangerous setting allows anyone to connect without a password and with all privileges.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 4.5: skip-grant-tables is set in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:skip-grant-tables\\s*=\\s*true;\nf:$mysql-cnfs -> !r:skip-grant-tables\\s*=\\s*false;\nf:$mysql-cnfs -> r:skip-grant-tables\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking LDAP client signing requirements\nDESCRIPTION: Verifies that LDAP client signing requirements are set to at least 'Negotiate signing' by checking that LDAPClientIntegrity registry value is at least 1.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LDAP -> LDAPClientIntegrity -> !1;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Checks for Interactive Logon Settings\nDESCRIPTION: Registry checks to verify interactive logon security settings including last user name display, CTRL+ALT+DEL requirement, and machine inactivity limits, according to CIS Benchmark items 2.3.7.1, 2.3.7.2, and 2.3.7.4.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.7.1 Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.7.1 Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> !1;\n#\n#\n#2.3.7.2 Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 2.3.7.2 Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableCAD -> !0;\n#\n#\n#2.3.7.4 Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'[CIS - Microsoft Windows 10 - 2.3.7.4 Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 385;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 386;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 387;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 388;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 389;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:38\\D;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:39\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:3\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:4\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:5\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:6\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:7\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:8\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:9\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\D\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\w\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !InactivityTimeoutSecs;\n```\n\n----------------------------------------\n\nTITLE: MySQL Audit Plugin Unload Prevention Check in OSSEC\nDESCRIPTION: Verifies that the audit plugin cannot be unloaded per CIS recommendation 6.12. This prevents disabling of audit logging by unloading the plugin.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.12: Audit plugin can be unloaded] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:^audit_log\\s*=\\s*on\\s*;\nf:$mysql-cnfs -> !r:^# && r:^audit_log\\s*=\\s*off\\s*;\nf:$mysql-cnfs -> !r:^# && r:^audit_log\\s*=\\s*force\\s*;\nf:$mysql-cnfs -> !r:^audit_log\\s*=\\s*force_plus_permanent\\s*;\nf:$mysql-cnfs -> r:^audit_log\\s$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Notification Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile displays notifications. Validates registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.4.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode for Built-in Administrator in Registry\nDESCRIPTION: Verifies that 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is enabled. Checks if the FilterAdministratorToken registry value is set to 0 or is missing, which would indicate the policy is not properly configured.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> FilterAdministratorToken -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !FilterAdministratorToken;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Autoindex Module in Apache\nDESCRIPTION: Audit rule that checks if the Autoindex module is enabled in Apache configurations, which automatically generates directory listings and could expose sensitive information. Examines various configuration files for uncommented LoadModule directives.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 2.5: Autoindex Module is enabled] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:loadmodule\\sautoindex;\nd:$conf-dirs -> load -> !r:^# && r:loadmodule\\sautoindex;\nf:/etc/httpd/conf.d -> !r:^# && r:loadmodule\\sautoindex;\nd:$mods-en -> autoindex.load;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile State\nDESCRIPTION: Registry check to ensure the Windows Firewall for Public profile is enabled. Verifies that the EnableFirewall registry value is not set to 0 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: Do not store LAN Manager hash value' setting\nDESCRIPTION: Registry check to ensure LAN Manager hash values are not stored on password changes, preventing the storage of weak password hashes.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> NoLMHash -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Dropped Packets Setting\nDESCRIPTION: Ensures Windows Firewall Domain Profile is configured to log dropped packets by verifying the LogDroppedPackets value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP download of print drivers\nDESCRIPTION: Verifies that downloading print drivers over HTTP is disabled. This prevents potential security risks associated with downloading drivers from untrusted sources.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Printer Driver Installation Restriction\nDESCRIPTION: Verifies the 'Devices: Prevent users from installing printer drivers' policy is enabled in Windows Server 2016. Checks if the AddPrinterDrivers registry value is correctly set to restrict printer driver installation.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.4.2 Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> AddPrinterDrivers -> !1;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: Allow Local System to use computer identity for NTLM' setting\nDESCRIPTION: Registry check to ensure the Local System service can use the computer's identity for NTLM authentication, which is necessary for proper authentication processes.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> UseMachineId -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !UseMachineId;\n```\n\n----------------------------------------\n\nTITLE: Verifying Root Console Login Restriction\nDESCRIPTION: Rule to check if root login is restricted to the system console, as specified in CIS Solaris 11 benchmark section 6.14. This prevents remote root logins that could be exploited.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/default/login -> !r:^CONSOLE\\p/dev/console;\n```\n\n----------------------------------------\n\nTITLE: Checking Core Dumps Restrictions in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that checks if core dumps are properly restricted in the system limits configuration file. This implements CIS benchmark 1.6.1 by verifying that hard core limits are set to zero.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/security/limits.conf -> !r:^# && !r:hard\\.+core\\.+0;\n```\n\n----------------------------------------\n\nTITLE: Checking LDAP Client Signing Requirements (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: LDAP client signing requirements' is set to 'Negotiate signing' or higher according to CIS benchmark 2.3.11.8.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LDAP -> LDAPClientIntegrity -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting Missing Log of Suspicious Packets in RHEL5\nDESCRIPTION: Checks if logging of suspicious packets (martians) is disabled in the system. This CIS benchmark rule (4.2.4) verifies that the log_martians parameter is not set to 0 to ensure proper logging of suspicious network packets.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/log_martians -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting X11 Window System in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if X11 Window System is enabled. This implements CIS benchmark 3.2 by checking for the graphical target in systemd and the presence of X session processes.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/usr/lib/systemd/system/default.target -> r:Graphical;\np:gdm-x-session;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Local Rules Setting in Windows Registry\nDESCRIPTION: Checks that 'Windows Firewall: Domain: Settings: Apply local firewall rules' is set to 'Yes' by verifying AllowLocalPolicyMerge registry value is not 0 in policy and current settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Age Setting in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer' according to CIS benchmark 18.2.6. The rule uses multiple regular expression patterns to identify non-compliant registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.2.6 Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer'\n[CIS - Microsoft Windows 10 - 18.2.6 Ensure 'Password Settings: Password Age (Days)' is set to 'Enabled: 30 or fewer'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> 1F;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordAgeDays -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Unencrypted Traffic Settings\nDESCRIPTION: OSSEC rule to ensure WinRM client does not allow unencrypted traffic according to CIS benchmark 18.9.97.1.2. Verifies AllowUnencryptedTraffic is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.97.1.2 Ensure 'Allow unencrypted traffic' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.97.1.2 Ensure 'Allow unencrypted traffic' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: MySQL SQL Mode Configuration Check in OSSEC\nDESCRIPTION: Checks if STRICT_ALL_TABLES is included in the sql_mode setting as required by CIS recommendation 4.9. This enforces strict data validation for all storage engines.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 4.9: strict_all_tables is not set at sql_mode section of my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:strict_all_tables\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking SMB Unencrypted Password Setting\nDESCRIPTION: Validates that Microsoft network client is not allowed to send unencrypted passwords to third-party SMB servers as specified in CIS benchmark 2.3.8.3. The rule checks for incorrect registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.8.3 Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnablePlainTextPassword -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Warning Settings in Windows 10\nDESCRIPTION: Registry checks to ensure the 'Interactive logon: Prompt user to change password before expiration' setting is configured to be between 5 and 14 days. This validates that users receive appropriate warning before password expiration.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.7.8 Ensure 'Interactive logon: Prompt user to change password before expiration' is set to 'between 5 and 14 days'\n[CIS - Microsoft Windows 10 - 2.3.7.8 Ensure 'Interactive logon: Prompt user to change password before expiration' is set to 'between 5 and 14 days'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 2;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 3;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 4;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0F;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH HostbasedAuthentication Configuration (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if SSH HostbasedAuthentication is enabled, which is against CIS recommendation 6.2.7. The rule checks the sshd_config file for a non-commented line that sets HostbasedAuthentication to yes.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - 6.2.7 - SSH Configuration - Host based authentication enabled {CIS: 6.2.7 RHEL7} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Verifying SSH LogLevel Configuration\nDESCRIPTION: Checks if SSH LogLevel is set to INFO as recommended. This test searches for non-commented lines in the SSH configuration file that do not set LogLevel to INFO, which is the recommended setting for proper logging.\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && !r:LogLevel\\.+INFO;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled MySQL Server (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if the MySQL database server is enabled at boot time, which is against PCI-DSS requirement 2.2.2 unless specifically needed. The rule looks for MySQL startup scripts in the rc directories.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - Disable standard boot services - MySQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dmysqld$;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Apache Handlers\nDESCRIPTION: Audit rule that checks if any HTTP handlers are enabled in Apache configurations. Custom handlers can introduce security risks if not properly configured and should be reviewed.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.4.5: A Handler is configured] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:/wsethandler;\nf:$main-conf -> !r:^# && r:/wsethandler;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Server Security Signature Settings\nDESCRIPTION: Validates Microsoft network server security signature settings according to CIS benchmarks 2.3.9.2 and 2.3.9.3. The rules check that digital signing is required and enabled for network communications.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.9.2 Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !RequireSecuritySignature;\n```\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.9.3 Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !EnableSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Checking System Event Log Retention Behavior in Windows Registry\nDESCRIPTION: Registry check to ensure that System event log behavior is appropriately configured when it reaches maximum size. Implements CIS benchmark 18.9.26.4.1 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled MySQL Server in OSSEC\nDESCRIPTION: OSSEC rule that checks if MySQL database server is enabled at boot time. This check satisfies PCI-DSS requirement 2.2.2 which requires disabling unnecessary services.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - Disable standard boot services - MySQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nd:$rc_dirs -> ^S\\d\\dmysqld$;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Installation Detection Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Detect application installations and prompt for elevation' is set to 'Enabled' by checking the EnableInstallerDetection registry value.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableInstallerDetection -> 0;\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !EnableInstallerDetection;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager Authentication Level Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: LAN Manager authentication level' is set to 'Send NTLMv2 response only. Refuse LM & NTLM' according to CIS benchmark 2.3.11.7.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 3;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 4;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !LmCompatibilityLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Account Lockout Policy\nDESCRIPTION: Rule to verify the retry limit for account lockout is properly configured, as specified in CIS Solaris 11 benchmark section 6.15. This helps prevent brute force password attacks.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/default/login -> !r:^RETRIES\\p3;\nf:/etc/default/login -> !r:^# && r:RETRIES\\p3\\d;\nf:/etc/security/policy.conf -> !r:^LOCK_AFTER_RETRIES\\pyes;\nf:/etc/security/policy.conf -> !r:^# && r:LOCK_AFTER_RETRIES\\pno;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Server Session Security Configuration in Windows Registry\nDESCRIPTION: Verifies the 'Network security: Minimum session security for NTLM SSP based servers' is properly configured to require NTLMv2 session security and 128-bit encryption. Checks for proper registry value (537395200) or missing key in MSV1_0.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is set to 'Enabled' by checking if the FilterAdministratorToken registry value is set to 0 or not present.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> FilterAdministratorToken -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !FilterAdministratorToken;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH HostbasedAuthentication Configuration\nDESCRIPTION: Rule to check if SSH HostbasedAuthentication is enabled. According to CIS SLES12 benchmark 9.2.7, HostbasedAuthentication should be set to no to disable the less secure host-based authentication.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode Setting in Windows Registry\nDESCRIPTION: Checks that 'User Account Control: Admin Approval Mode for the Built-in Administrator account' is set to 'Enabled' by verifying FilterAdministratorToken registry value is not 0 or missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> FilterAdministratorToken -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !FilterAdministratorToken;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Script Block Logging Settings in Registry\nDESCRIPTION: Registry checks to ensure 'Turn on PowerShell Script Block Logging' is set to 'Disabled' per CIS benchmark 18.9.84.1. This controls whether PowerShell logs script blocks which could impact performance or create excessive logging.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Detecting KeepAliveTimeout Configuration in Apache\nDESCRIPTION: Rules to ensure KeepAliveTimeout is set to a low value to mitigate denial of service attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:keepalivetimeout\\s+\\d\\d*;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+16;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+17;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+18;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+19;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+2\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+3\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+4\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+5\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+6\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+7\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+8\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+9\\d;\nf:$main-conf -> !r:^# && r:keepalivetimeout\\s+\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Basic Authentication Settings\nDESCRIPTION: Verifies that Basic authentication is disabled in WinRM Service by ensuring the AllowBasic registry key is not set to a non-zero value.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Safe DLL Search Mode Registry Settings\nDESCRIPTION: Validates that Safe DLL search mode is enabled by checking the SafeDllSearchMode registry value is not set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH IgnoreRhosts Configuration (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if SSH IgnoreRhosts is disabled, which is against CIS recommendation 6.2.6. The rule checks the sshd_config file for a non-commented line that sets IgnoreRhosts to no.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - 6.2.6 - SSH Configuration - IgnoreRHosts disabled {CIS: 6.2.6 RHEL7} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH LogLevel Configuration\nDESCRIPTION: Rule to check if SSH LogLevel is set to INFO. According to CIS SLES12 benchmark 9.2.1, LogLevel should be set to INFO to capture login and logout activity.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && !r:LogLevel\\.+INFO;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for HTTP Request Method Limitations\nDESCRIPTION: Audit rule that checks if HTTP request methods are properly limited. Only necessary methods (GET, POST, OPTIONS) should be allowed to reduce the attack surface of the web server.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.7: Disable HTTP Request Method] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:$main-conf -> !r:<limitexcept\\sget\\spost\\soptions>;\n```\n\n----------------------------------------\n\nTITLE: Checking Disconnected Session Time Limit in Registry\nDESCRIPTION: This rule verifies that the time limit for disconnected Remote Desktop Services sessions is set to 1 minute by checking if the MaxDisconnectionTime registry key is set to EA60 (hexadecimal for 60000 milliseconds). The rule triggers if the key is missing or not set to EA60.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxDisconnectionTime;\n```\n\n----------------------------------------\n\nTITLE: MySQL Symbolic Links Check in OSSEC\nDESCRIPTION: Validates that skip_symbolic_links is enabled as per CIS recommendation 4.6. Disabling symbolic links prevents attackers from accessing files outside the data directory via symbolic links.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 4.6: skip_symbolic_links is not enabled in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:skip_symbolic_links\\s*=\\s*no;\nf:$mysql-cnfs -> !r:skip_symbolic_links\\s*=\\s*yes;\nf:$mysql-cnfs -> r:skip_symbolic_links\\s*$;\n```\n\n----------------------------------------\n\nTITLE: MySQL Audit Log Strategy Check in OSSEC\nDESCRIPTION: Ensures audit_log_strategy is set to synchronous or semisynchronous per CIS recommendation 6.11. This setting determines how audit records are written to the audit log file.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.11: Ensure audit_log_strategy is set to all] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:audit_log_strategy\\.+asynchronous;\nf:$mysql-cnfs -> !r:^# && r:audit_log_strategy\\.+performance;\nf:$mysql-cnfs -> !r:audit_log_strategy\\s*=\\s* && r:semisynchronous|synchronous;\nf:$mysql-cnfs -> r:audit_log_strategy\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Input Personalization Settings in Windows Server 2016\nDESCRIPTION: Registry checks to ensure Input Personalization is disabled. Validates that the AllowInputPersonalization registry key is not set to 1 as required by CIS benchmark 18.1.2.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization -> AllowInputPersonalization -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization -> !AllowInputPersonalization;\n```\n\n----------------------------------------\n\nTITLE: Checking Admin Approval Mode for All Administrators Setting\nDESCRIPTION: Verifies that 'Run all administrators in Admin Approval Mode' is enabled by checking if EnableLUA registry value is set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableLUA -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Connectivity on Battery Settings\nDESCRIPTION: Verifies that 'Allow network connectivity during connected-standby (on battery)' is disabled by checking if DCSettingIndex registry value is set to 0 in the power settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> !DCSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive logon: CTRL+ALT+DEL Requirement\nDESCRIPTION: Registry check to ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'. Verifies the DisableCAD registry value is not set to 1, which would disable the CTRL+ALT+DEL requirement for login.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableCAD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableCAD;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Secure Channel Data Signing\nDESCRIPTION: Registry check to ensure that secure channel data is digitally signed when possible according to CIS benchmark 2.3.6.3, checking the SignSecureChannel registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SignSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Local Infile Setting Check in OSSEC\nDESCRIPTION: Examines if local_infile is disabled according to CIS recommendation 4.4. When enabled, this setting allows potentially malicious SQL clients to read any file accessible to the MySQL server process.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 4.4: local_infile is not forbidden in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:local-infile\\s*=\\s*1;\nf:$mysql-cnfs -> r:local-infile\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous access to shares configuration\nDESCRIPTION: Verifies that shares accessible anonymously are set to 'None' by checking the NullSessionShares registry value does not contain entries.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionShares -> r:\\S*;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Outbound Connections Registry Configuration\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Outbound connections' is set to 'Allow (default)' by checking if the DefaultOutboundAction registry value is set to 1 in both policy and local settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft MAPS Membership Settings in Registry\nDESCRIPTION: This rule ensures that 'Join Microsoft MAPS' is disabled by verifying the SpynetReporting registry key is set to 0. The rule triggers if the key is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Security Event Log Max Size\nDESCRIPTION: OSSEC rule that checks if 'Security: Specify the maximum log file size (KB)' is set to 'Enabled: 196,608 or greater' by verifying the MaxSize registry key.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:0\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:1\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:2\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking Screen Saver Grace Period Settings in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires' is set to 5 or fewer seconds by checking values greater than 5.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> r:\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Collect Session Initiation Information Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.9 that verifies if auditd is configured to collect session initiation information. It checks for audit rules monitoring session tracking files to identify user activities and potential malicious sessions.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.9 Collect Session Initiation Information] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-w /var/run/utmp -p wa -k session;\nf:/etc/audit/audit.rules -> !r:^-w /var/log/wtmp -p wa -k session;\nf:/etc/audit/audit.rules -> !r:^-w /var/log/btmp -p wa -k session;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Configuration in Registry\nDESCRIPTION: Registry checks for Windows Firewall Private profile logging configuration. Verifies LogDroppedPackets and LogSuccessfulConnections are properly set to enforce logging requirements.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogDroppedPackets -> 0;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Restrictions on Network Logons in OSSEC\nDESCRIPTION: OSSEC rule for verifying if 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled' according to CIS benchmark 18.3.1. The rule checks for non-compliant registry values in the system policies.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.3.1 Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.3.1 Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> LocalAccountTokenFilterPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Bridge Installation Policy in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Prohibit installation and configuration of Network Bridge on your DNS domain network' is set to 'Enabled'. This setting prevents users from connecting two or more network segments, which could bypass network security measures.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Checking Blank Password Restrictions in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to verify that 'Accounts: Limit local account use of blank passwords to console logon only' is enabled. Implements CIS Benchmark check 2.3.1.4 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.1.4: Ensure 'Accounts: Limit local account use of blank passwords to console logon only' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LimitBlankPasswordUse -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Parameter Configurations in Red Hat Linux\nDESCRIPTION: A series of checks to verify secure network parameter settings according to CIS benchmarks. These rules check kernel settings like source routing, ICMP broadcasts, and IP forwarding, which can pose security risks if improperly configured.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\n\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Simultaneous Internet Connections Settings\nDESCRIPTION: Verifies that the policy to minimize simultaneous connections to the Internet or Windows Domain is enabled by checking if fMinimizeConnections is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Safe DLL Search Mode for Windows Server\nDESCRIPTION: Verifies that Safe DLL search mode is enabled for security. Detects non-compliance when SafeDllSearchMode is set to 0.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Auditing File Deletion Events by Users in Debian Linux\nDESCRIPTION: Configuration for auditing file deletion events according to CIS Benchmark 8.1.14. It monitors unlink, unlinkat, rename, and renameat syscalls which can be used to delete files, focusing on non-system users.\n\nLANGUAGE: auditd\nCODE:\n```\n-a always,exit -F arch=b32 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 \\\n-F auid!=4294967295 -k delete\n```\n\n----------------------------------------\n\nTITLE: Checking Admin Approval Mode for Administrator Account Registry Setting\nDESCRIPTION: Verifies that 'Admin Approval Mode for the Built-in Administrator account' is enabled by checking if FilterAdministratorToken registry value is set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> FilterAdministratorToken -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !FilterAdministratorToken;\n```\n\n----------------------------------------\n\nTITLE: MySQL Raw Logging Configuration Check in OSSEC\nDESCRIPTION: Verifies that log_raw is set to 'off' according to CIS recommendation 6.4. Raw logging can expose sensitive information in log files including passwords.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.4: log_raw is not set to off] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:log-raw\\s*=\\s*on;\nf:$mysql-cnfs -> r:log-raw\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Prelink Disabling Check in OSSEC\nDESCRIPTION: OSSEC rule to verify that prelink is disabled on RHEL5 systems. Checks /etc/sysconfig/prelink to ensure PRELINKING is set to 'no', satisfying CIS requirement 1.6.5.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 1.6.5 - Prelink not disabled {CIS: 1.6.5 RHEL5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/sysconfig/prelink -> !r:PRELINKING=no;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM RunAs Credentials Storage Setting\nDESCRIPTION: Verifies that WinRM is disallowed from storing RunAs credentials by checking the DisableRunAs registry value is not set to anything other than 1, or the key doesn't exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> DisableRunAs -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> !DisableRunAs;\n```\n\n----------------------------------------\n\nTITLE: Checking Anonymous User Permissions in Windows Server 2016\nDESCRIPTION: Verifies that 'Network access: Let Everyone permissions apply to anonymous users' is disabled. This checks the EveryoneIncludesAnonymous registry value to ensure proper permission restriction for anonymous users.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 2;\n```\n\n----------------------------------------\n\nTITLE: MySQL Audit Log Include Accounts Check in OSSEC\nDESCRIPTION: Verifies that audit_log_include_accounts is set to Null per CIS recommendation 6.7. This ensures consistent audit logging policy is applied to all accounts.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.7:audit_log_include_accounts is not set to Null] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:audit_log_include_accounts\\s*=\\s* && !r:null\\s*$;\nf:$mysql-cnfs -> r:audit_log_include_accounts\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Maximum Size in Windows Registry\nDESCRIPTION: Registry check to ensure the Security log file size is set to 196,608KB or greater. Implements CIS benchmark 18.9.26.2.2 requirement by verifying registry values.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:0\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:1\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> MaxSize -> r:2\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Outbound Connections\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile has outbound connections set to 'Allow'. Verifies DefaultOutboundAction is not set to 1 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: MySQL Audit Log Policy Check in OSSEC\nDESCRIPTION: Ensures audit_log_policy is set to 'all' according to CIS recommendation 6.9. This setting determines which events are logged in the audit log file.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.9: audit_log_policy is not set to all] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:audit_log_policy\\s*=\\s*queries;\nf:$mysql-cnfs -> !r:^# && r:audit_log_policy\\s*=\\s*none;\nf:$mysql-cnfs -> !r:^# && r:audit_log_policy\\s*=\\s*logins;\nf:$mysql-cnfs -> r:audit_log_policy\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot-Start Driver Initialization Policy in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'. This setting determines which boot-start drivers are initialized based on their status as good, unknown, or bad but critical.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Checking IP Forwarding Configuration\nDESCRIPTION: Verifies that IP forwarding is disabled for IPv4 and IPv6. Part of CIS SLES12 benchmark section 7.1.1.\n\nLANGUAGE: shell\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking for User .netrc Files\nDESCRIPTION: Detects the presence of .netrc files in user home directories. These files can contain login credentials in plaintext and should be removed to prevent credential exposure.\n\nLANGUAGE: plaintext\nCODE:\n```\nd:$home_dirs -> r:^.netrc$;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Policy Setting in OSSEC\nDESCRIPTION: OSSEC rule for checking if 'Do not allow password expiration time longer than required by policy' is set to 'Enabled' according to CIS benchmark 18.2.2. The rule verifies both for incorrect registry values and missing keys that would indicate non-compliance.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.2.2 Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.2.2 Ensure 'Do not allow password expiration time longer than required by policy' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PwdExpirationProtectionEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PwdExpirationProtectionEnabled;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Checks for Domain Member Security Settings\nDESCRIPTION: Series of registry checks to verify domain member security settings for secure channel data encryption and signing according to CIS Benchmark items 2.3.6.1 through 2.3.6.6.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.6.1 Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'[CIS - Microsoft Windows 10 - 2.3.6.1 Ensure 'Domain member: Digitally encrypt or sign secure channel data (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireSignOrSeal -> 0;\n#\n#\n#2.3.6.2 Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.6.2 Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SealSecureChannel -> 0;\n#\n#\n#2.3.6.3 Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.6.3 Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SignSecureChannel -> 0;\n#\n#\n#2.3.6.4 Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 2.3.6.4 Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters -> DisablePasswordChange -> !0;\n#\n#\n#2.3.6.6 Ensure 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.6.6 Ensure 'Domain member: Require strong (Windows 2000 or later) session key' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireStrongKey -> !1;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Sharing and security model for local accounts' setting\nDESCRIPTION: Registry check to ensure the sharing and security model is set to 'Classic', requiring local users to authenticate as themselves rather than as guests.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> ForceGuest -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Server SPN Target Name Validation in Windows Server 2016\nDESCRIPTION: Ensures 'Microsoft network server: Server SPN target name validation level' is set appropriately. This validates the SMBServerNameHardeningLevel registry value to prevent potential security vulnerabilities in service principal name handling.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> SMBServerNameHardeningLevel -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !SMBServerNameHardeningLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Smart Card Removal Behavior in Windows Server 2016\nDESCRIPTION: Ensures that 'Interactive logon: Smart card removal behavior' is configured to at least 'Lock Workstation'. This rule checks the ScRemoveOption registry value to verify appropriate actions are taken when smart cards are removed.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> ScRemoveOption -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> !ScRemoveOption;\n```\n\n----------------------------------------\n\nTITLE: Checking Elevated Install Privileges Registry Setting in Windows\nDESCRIPTION: Ensures that 'Always install with elevated privileges' is disabled by checking if the AlwaysInstallElevated registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> AlwaysInstallElevated -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Shell Protocol Protected Mode in Registry\nDESCRIPTION: Registry check to ensure shell protocol protected mode is not disabled. Implements CIS benchmark 18.9.30.5 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> PreXPSP2ShellProtocolBehavior -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender PUA Protection Registry Settings\nDESCRIPTION: Validates that Windows Defender protection against Potentially Unwanted Applications is enabled by checking the MpEnablePus registry value is not set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\MpEngine -> MpEnablePus -> 0;\n```\n\n----------------------------------------\n\nTITLE: Validating Remote Server Management through WinRM Settings\nDESCRIPTION: Verifies that remote server management through Windows Remote Management (WinRM) is disabled. This check ensures compliance with CIS benchmark item 18.9.86.2.2 by confirming the AllowAutoConfig registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowAutoConfig -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Unencrypted Password Transmission in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if the Windows setting to prevent sending unencrypted passwords to third-party SMB servers is enabled, as required by CIS benchmark 2.3.8.3. It verifies the EnablePlainTextPassword registry value.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.8.3 Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.8.3: Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnablePlainTextPassword -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating Shell Protocol Protected Mode Setting\nDESCRIPTION: Ensures that shell protocol protected mode is enabled by checking that the PreXPSP2ShellProtocolBehavior registry value is set to 0 per CIS benchmark 18.9.30.5.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> PreXPSP2ShellProtocolBehavior -> !0;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Word Add-ins Management\nDESCRIPTION: OSSEC audit rules to verify that unmanaged add-ins are blocked in Word. These security settings ensure that only approved add-ins can run in Word documents.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\resiliency -> restricttolist -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\resiliency -> !restricttolist;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Turn off Autoplay\nDESCRIPTION: OSSEC rule that checks if 'Turn off Autoplay' is set to 'Enabled: All drives' by verifying the NoDriveTypeAutoRun registry key is set to ff.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> NoDriveTypeAutoRun -> !ff;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> !NoDriveTypeAutoRun;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Warning Registry Setting\nDESCRIPTION: Validates that the interactive logon password expiration warning is set to between 5 and 14 days as specified in CIS benchmark 2.3.7.7. The rule checks for values outside the recommended range.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.7.7 Ensure 'Interactive logon: Prompt user to change password before expiration' is set to 'between 5 and 14 days'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 2;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 3;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 4;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0F;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking if Shadow Group is Empty\nDESCRIPTION: Ensures that the shadow group contains no members. The shadow group should remain empty as members would have read access to the shadow file containing password hashes.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/group -> !r:^# && r:shadow:\\w*:\\w*:\\S+;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Server Session Security in Windows 10\nDESCRIPTION: Verifies that 'Network security: Minimum session security for NTLM SSP based servers' is set to 'Require NTLMv2 session security, Require 128-bit encryption' by checking the NTLMMinServerSec registry value.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Digest Authentication\nDESCRIPTION: Verifies that 'Disallow Digest authentication' is set to 'Enabled' (value equal to 0) in the WinRM Client registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowDigest -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> !AllowDigest;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP Client Session Security Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: Minimum session security for NTLM SSP based clients' is set to 'Require NTLMv2 session security, Require 128-bit encryption' according to CIS benchmark 2.3.11.9.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinClientSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinClientSec;\n```\n\n----------------------------------------\n\nTITLE: Checking Location Settings in Registry with OSSEC\nDESCRIPTION: Verifies that 'Turn off location' is enabled by checking if DisableLocation is set to 1. This helps protect user privacy by preventing apps from accessing the system's location information.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> DisableLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> !DisableLocation;\n```\n\n----------------------------------------\n\nTITLE: FTP Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify VSFTP server is disabled on RHEL5 systems. Examines /etc/xinetd.d/vsftpd to ensure the service is properly disabled, satisfying CIS requirement 3.10 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.10 - VSFTP enabled on xinetd {CIS: 3.10 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/vsftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Disable Mounting of udf Filesystems Rule for OSSEC\nDESCRIPTION: CIS rule 2.24 that checks for the existence of /etc/modprobe.d/CIS.conf and verifies it contains a directive to disable mounting of udf filesystems for security hardening.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 2.24 Disable Mounting of udf Filesystems] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install udf /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service RunAs Credentials Storage Settings in Registry\nDESCRIPTION: Registry checks to ensure 'Disallow WinRM from storing RunAs credentials' is set to 'Enabled' per CIS benchmark 18.9.86.2.4. This prevents WinRM from storing credentials that could be exposed to unauthorized access.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> DisableRunAs -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> !DisableRunAs;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Assistance Settings\nDESCRIPTION: Registry checks to ensure both solicited and unsolicited Remote Assistance are disabled for improved security.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.8.31.1 Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.31.1 Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n#\n#\n#18.8.31.2 Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.31.2 Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled NetFS Service (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if the NetFS service is enabled at boot time, which is against PCI-DSS requirement 2.2.2 unless specifically needed. The rule looks for NetFS startup scripts in the rc directories.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - Disable standard boot services - NetFS Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous access to Named Pipes\nDESCRIPTION: Verifies that 'Network access: Named Pipes that can be accessed anonymously' is properly configured by checking NullSessionPipes registry value for appropriate restrictions.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionPipes -> !r:lsarpc|netlogon|samr;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !NullSessionPipes;\n```\n\n----------------------------------------\n\nTITLE: Checking Client Digital Signature Support in Windows Server 2016\nDESCRIPTION: Ensures that 'Microsoft network client: Digitally sign communications (if server agrees)' is enabled. This validates the EnableSecuritySignature registry value is set to enhance security when the server supports digital signatures.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnableSecuritySignature -> !1;\n```\n\n----------------------------------------\n\nTITLE: GZIP File Format CRC32 and ISIZE Structure\nDESCRIPTION: Diagram showing the final 8 bytes of a GZIP file that contain the CRC32 checksum and ISIZE (original input size) fields.\n\nLANGUAGE: plain\nCODE:\n```\n           0   1   2   3   4   5   6   7\n         +---+---+---+---+---+---+---+---+\n         |     CRC32     |     ISIZE     |\n         +---+---+---+---+---+---+---+---+\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Maximum Size in Windows Registry\nDESCRIPTION: Registry check to ensure the Application log file size is set to 32,768KB or greater. Implements CIS benchmark 18.9.26.1.2 requirement by checking various possible registry value patterns.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile State in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile is enabled per CIS benchmark 9.1.1. The check confirms the EnableFirewall value is not set to 0 across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager hash storage setting\nDESCRIPTION: Verifies that LAN Manager hash values are not stored on next password change by checking that NoLMHash registry value is not set to 0.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> NoLMHash -> 0;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Enumerate Administrator Accounts on Elevation\nDESCRIPTION: OSSEC rule that checks if 'Enumerate administrator accounts on elevation' is set to 'Disabled' by verifying the EnumerateAdministrators registry key is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI -> EnumerateAdministrators -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Pre-release Features Setting in Windows 10\nDESCRIPTION: Verifies that 'Disable pre-release features or settings' is set to 'Disabled' by checking registry values related to EnableConfigFlighting.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.16.3 Ensure 'Disable pre-release features or settings' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> EnableConfigFlighting -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> !EnableConfigFlighting;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off Windows Customer Experience Improvement Program' is set to 'Enabled' per CIS benchmark 18.8.20.1.13. The check verifies that the CEIPEnable registry value is set to 0.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Server Digital Signature Requirements in Windows Server 2016\nDESCRIPTION: Verifies that 'Microsoft network server: Digitally sign communications (always)' is enabled. This checks the RequireSecuritySignature registry value to enforce digital signatures for server communications.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !RequireSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: IP Forwarding Check in OSSEC\nDESCRIPTION: OSSEC rule to verify IP forwarding is disabled on RHEL5 systems. Examines kernel parameters to ensure IP forwarding for both IPv4 and IPv6 is properly disabled, satisfying CIS requirement 4.1.1 and PCI DSS 2.2.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 4.1.1 - Network parameters - IP Forwarding enabled {CIS: 4.1.1 RHEL5} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Warning Threshold\nDESCRIPTION: Ensures the warning threshold for the security event log is set to 90% or less by detecting if WarningLevel is above 90% or missing completely.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Unencrypted Traffic Setting\nDESCRIPTION: Verifies that unencrypted traffic for WinRM Client is disabled by checking the AllowUnencryptedTraffic registry value is not set to anything other than 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Content File Updates in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off Search Companion content file updates' is set to 'Enabled' per CIS benchmark 18.8.20.1.9. The check verifies that the DisableContentFileUpdates registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Disconnected Session Time Limits in Remote Desktop Services\nDESCRIPTION: Registry checks to ensure disconnected Remote Desktop sessions have a time limit set to 1 minute, enforcing CIS Windows Server 2016 benchmark rule 18.9.52.3.10.2.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxDisconnectionTime;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Proxy Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify HTTP Proxy Server (squid3) is not enabled in run-level directories as per CIS Benchmark 6.13.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:squid3;\n```\n\n----------------------------------------\n\nTITLE: Checking Connected Users Enumeration Setting\nDESCRIPTION: Verifies that connected users are not enumerated on domain-joined computers by checking if DontEnumerateConnectedUsers is set to 1 or exists.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontEnumerateConnectedUsers -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontEnumerateConnectedUsers;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Unencrypted Traffic Settings in Registry\nDESCRIPTION: Registry check to ensure 'Allow unencrypted traffic' for WinRM service is set to 'Disabled' per CIS benchmark 18.9.86.2.3. This requires all WinRM service traffic to be encrypted.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Remote Server Management in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'AllowAutoConfig' registry setting for WinRM. This rule checks for compliance with CIS recommendation 18.9.97.2.2, ensuring remote server management through WinRM is disabled.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowAutoConfig -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Cookie Configuration in Registry\nDESCRIPTION: Registry check to ensure that 'Configure cookies' is set to 'Enabled: Block only 3rd-party cookies' or higher as required by CIS benchmark 18.9.41.3. This helps protect user privacy in Microsoft Edge.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.41.3 Ensure 'Configure cookies' is set to 'Enabled: Block only 3rd-party cookies' or higher\n[CIS - Microsoft Windows Server 2016 - 18.9.41.3: Ensure 'Configure cookies' is set to 'Enabled: Block only 3rd-party cookies' or higher] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> Cookies -> 2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !Cookies;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Temporary Folder Configuration\nDESCRIPTION: Verifies that 'Do not use temporary folders per session' is set to 'Disabled' (value not equal to 1) in the Terminal Services registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> PerSessionTempDir -> !1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for System Shutdown on Audit Failure\nDESCRIPTION: Registry check to verify that the system is not configured to shut down if unable to log security audits, according to CIS benchmark 2.3.2.2, checking the CrashOnAuditFail registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 2;\n```\n\n----------------------------------------\n\nTITLE: Verifying LLTDIO Driver Configuration\nDESCRIPTION: Checks that 'Turn on Mapper I/O (LLTDIO) driver' is disabled. This rule verifies multiple registry values to ensure the Link-Layer Topology Discovery Mapper I/O Driver is disabled across all network types.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableLLTDIO -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitLLTDIOOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Camera Setting in OSSEC\nDESCRIPTION: OSSEC rule for checking if 'Prevent enabling lock screen camera' is set to 'Enabled' according to CIS benchmark 18.1.1.1. The rule verifies both the correct registry value and checks for missing registry keys that would indicate non-compliance.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.1.1.1 Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.1.1.1 Ensure 'Prevent enabling lock screen camera' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenCamera -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking Setup Event Log Retention Behavior in Windows Registry\nDESCRIPTION: Registry check to ensure that Setup event log behavior is appropriately configured when it reaches maximum size. Implements CIS benchmark 18.9.26.3.1 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Audit Policy Override Settings in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to check that 'Audit: Force audit policy subcategory settings to override audit policy category settings' is enabled. Implements CIS Benchmark check 2.3.2.1 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.2.1: Ensure 'Audit: Force audit policy subcategory settings (Windows Vista or later) to override audit policy category settings' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> SCENoApplyLegacyAuditPolicy -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking network selection UI display\nDESCRIPTION: Verifies that the network selection UI is not displayed. This simplifies the sign-in process and prevents users from connecting to potentially insecure networks during sign-in.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n```\n\n----------------------------------------\n\nTITLE: Router Discovery Protocol Security Setting Verification\nDESCRIPTION: Checks that 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses' is set to 'Disabled' per CIS benchmark 18.3.7 to prevent potential DoS attacks.\n\nLANGUAGE: text\nCODE:\n```\n#18.3.7 Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.3.7 Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> PerformRouterDiscovery  -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !PerformRouterDiscovery;\n```\n\n----------------------------------------\n\nTITLE: Checking Word Security File Block Settings for Word 2 Documents\nDESCRIPTION: Checks registry values to ensure Word 2 and earlier binary documents and templates are blocked in Microsoft Word 2016. These legacy formats may contain vulnerabilities that could be exploited.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> word2files -> !2;\n```\n\n----------------------------------------\n\nTITLE: Checking Smart Card Removal Behavior in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if the Windows smart card removal behavior is set to 'Lock Workstation' or higher, as required by CIS benchmark 2.3.7.9. It verifies the ScRemoveOption registry value.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.7.9 Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.9: Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> ScRemoveOption -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> !ScRemoveOption;\n```\n\n----------------------------------------\n\nTITLE: Send Packet Redirects Check in OSSEC\nDESCRIPTION: OSSEC rule to verify packet redirects are disabled on RHEL5 systems. Examines kernel parameters to ensure send_redirects is properly disabled for all interfaces, satisfying CIS requirement 4.1.2 and PCI DSS 2.2.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 4.1.2 - Network parameters - IP send redirects enabled {CIS: 4.1.2 RHEL5} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Behavior in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Security: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' in Windows registry. Ensures the Retention value is set to 0 in the Security Event Log policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Security -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Scheduled Install Day\nDESCRIPTION: Verifies that Windows Automatic Updates scheduled install day is set to 'Every day' by checking the ScheduledInstallDay registry value is not set to anything other than 0, or the key doesn't exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> ScheduledInstallDay -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !ScheduledInstallDay;\n```\n\n----------------------------------------\n\nTITLE: Windows Handwriting Personalization Data Sharing Check in OSSEC\nDESCRIPTION: Verifies handwriting personalization data sharing is disabled by checking if the PreventHandwritingDataSharing registry value is set to 1 in the TabletPC policy path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.8.20.1.3: Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn on PowerShell Script Block Logging' Registry Setting\nDESCRIPTION: Registry check to ensure 'Turn on PowerShell Script Block Logging' is disabled per CIS benchmark 18.9.84.1. Verifies the EnableScriptBlockLogging value is set to 0 or is not present.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Configuring GoToMyPC Remote Access Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting GoToMyPC remote access software through files, registry entries, and processes. Includes PCI DSS compliance reference 10.6.1.\n\nLANGUAGE: conf\nCODE:\n```\n# http://www.gotomypc.com\n[Remote Access - GoToMyPC {PCI_DSS: 10.6.1}] [any] []\nf:\\Program Files\\Citrix\\GoToMyPC;\nf:\\Program Files\\Citrix\\GoToMyPC\\g2svc.exe;\nf:\\Program Files\\Citrix\\GoToMyPC\\g2comm.exe;\nf:\\Program Files\\expertcity\\GoToMyPC;\nr:HKLM\\software\\microsoft\\windows\\currentversion\\run -> gotomypc;\nr:HKEY_LOCAL_MACHINE\\software\\citrix\\gotomypc;\nr:HKEY_LOCAL_MACHINE\\system\\currentcontrolset\\services\\gotomypc;\np:r:g2svc.exe;\np:r:g2pre.exe;\n```\n\n----------------------------------------\n\nTITLE: Checking Temp Folder Deletion for Terminal Services Registry Setting\nDESCRIPTION: Verifies that temp folders are deleted upon exit for Terminal Services by checking if DeleteTempDirsOnExit is not set to 1, which ensures temporary folders are cleaned up after sessions end.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DeleteTempDirsOnExit -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Memory Dumps for OS Error Reports Setting\nDESCRIPTION: Validates that automatic sending of memory dumps for OS-generated error reports is disabled by ensuring the AutoApproveOSDumps registry value is set to 0 or doesn't exist per CIS benchmark 18.9.70.3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> AutoApproveOSDumps -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !AutoApproveOSDumps;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Outbound Connections in Registry\nDESCRIPTION: Verifies that the Windows Firewall for Private Profile allows outbound connections by default. The rule looks for a value of 1 in the DefaultOutboundAction key, which indicates a non-compliant setting.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Game Recording and Broadcasting Status\nDESCRIPTION: OSSEC rule to ensure Windows Game Recording and Broadcasting is disabled according to CIS benchmark 18.9.82.1. Detects if AllowGameDVR is set to 1 or not configured.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.82.1 Ensure 'Enables or disables Windows Game Recording and Broadcasting' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.82.1 Ensure 'Enables or disables Windows Game Recording and Broadcasting' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\GameDVR -> AllowGameDVR -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\GameDVR -> !AllowGameDVR;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows SmartScreen Configuration in Registry\nDESCRIPTION: Registry check to ensure that 'Configure Windows SmartScreen' is set to 'Enabled' as required by CIS benchmark 18.9.30.2. SmartScreen helps protect against malicious applications and websites.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.30.2 Ensure 'Configure Windows SmartScreen' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.30.2: Ensure 'Configure Windows SmartScreen' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableSmartScreen;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive Logon Machine Inactivity Limit in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if the Windows machine inactivity timeout is set to a value between 1 and 900 seconds, as required by CIS benchmark 2.3.7.3. It verifies the InactivityTimeoutSecs registry value using multiple pattern checks.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.7.3 Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.3: Ensure 'Interactive logon: Machine inactivity limit' is set to '900 or fewer second(s), but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 385;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 386;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 387;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 388;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> 389;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:38\\D;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:39\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:3\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:4\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:5\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:6\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:7\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:8\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:9\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\D\\w\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> InactivityTimeoutSecs -> r:\\w\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !InactivityTimeoutSecs;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Web Pages and XML Spreadsheets\nDESCRIPTION: Examines registry values to confirm that Web pages and Excel 2003 XML spreadsheets are blocked in Microsoft Excel 2016. These file types can contain active content that poses security risks.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock ->\thtmlandxmlssfiles -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !htmlandxmlssfiles;\n```\n\n----------------------------------------\n\nTITLE: Checking File Validation in PowerPoint\nDESCRIPTION: Registry check to ensure file validation is enabled in Microsoft PowerPoint. This feature validates files against known file formats and helps protect against potential security vulnerabilities.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\filevalidation -> enableonload -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\filevalidation -> !enableonload;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging Size in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Windows Firewall: Public: Logging: Size limit (KB)' is set to at least 16,384 KB as required by CIS benchmark 9.3.8. The rule verifies registry keys in both policy and current configuration locations.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#9.3.8 Ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16,384 KB or greater'\n[CIS - Microsoft Windows 10 - 9.3.8 Ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16,384 KB or greater'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile State\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Firewall state' is set to 'On' as required by CIS benchmark 9.3.1 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Secure Desktop Elevation Prompt Setting\nDESCRIPTION: Verifies that 'User Account Control: Switch to the secure desktop when prompting for elevation' is enabled by checking the PromptOnSecureDesktop registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> PromptOnSecureDesktop -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting POP3 Services in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if POP3 services (dovecot) are enabled through xinetd. This implements part of CIS benchmark 3.12 by checking the dovecot configuration in xinetd.d directory.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/dovecot -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Location Elevation Requirement\nDESCRIPTION: Ensures domain users are required to elevate when setting a network's location by verifying NC_StdDomainUserSetLocation is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off app notifications on the lock screen registry setting in OSSEC\nDESCRIPTION: Verifies that 'Turn off app notifications on the lock screen' is set to 'Enabled' by checking if the DisableLockScreenAppNotifications registry value equals 1 and that the key exists in the specified registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DisableLockScreenAppNotifications -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DisableLockScreenAppNotifications;\n```\n\n----------------------------------------\n\nTITLE: Detecting Source Routed Packet Acceptance in RHEL5\nDESCRIPTION: Checks if source routed packet acceptance is enabled in the system. This CIS benchmark rule (4.2.1) verifies that the accept_source_route parameter is not set to 1 to prevent source routing attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Verifying Secure Channel Data Encryption in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to check that 'Domain member: Digitally encrypt secure channel data (when possible)' is enabled. Implements CIS Benchmark check 2.3.6.2 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.2: Ensure 'Domain member: Digitally encrypt secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SealSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Windows Registry Security Audit Implementation\nDESCRIPTION: A collection of OSSEC security audit checks for Windows Server 2016 Domain Controllers based on CIS Benchmarks. These checks validate registry settings for network access control, TCP/IP parameters, service configurations, and various security-related Windows features.\n\nLANGUAGE: text\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer Script Security Prompt Settings in Registry\nDESCRIPTION: This rule verifies that Internet Explorer security prompts for Windows Installer scripts are enabled by checking if the SafeForScripting registry key is set to 0. The rule triggers if the key is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> SafeForScripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Update Configuration\nDESCRIPTION: Verifies that 'Configure Automatic Updates' is set to 'Enabled' (NoAutoUpdate value not equal to 1) in the Windows Update registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH IgnoreRhosts Configuration\nDESCRIPTION: Detects if SSH is configured with IgnoreRhosts disabled, which is insecure, as per CIS-RHEL6 section 6.2.6. This check examines the SSH daemon configuration to ensure .rhosts files are properly ignored for PCI DSS compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password on Battery Settings\nDESCRIPTION: Verifies that 'Require a password when a computer wakes (on battery)' is enabled by checking if DCSettingIndex registry value is set to 1 in the wake power settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Secure RPC Communication Requirement for Terminal Services\nDESCRIPTION: Validates that secure RPC communication is required for Terminal Services by ensuring the fEncryptRPCTraffic registry value is set to 1 or exists per CIS benchmark 18.9.52.3.9.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fEncryptRPCTraffic -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fEncryptRPCTraffic;\n```\n\n----------------------------------------\n\nTITLE: Checking Solicited Remote Assistance Configuration\nDESCRIPTION: OSSEC rule to verify that Solicited Remote Assistance is disabled. The rule checks if the fAllowToGetHelp registry value is not set to 0 or is missing entirely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Sign-in After Restart Settings in Registry\nDESCRIPTION: Registry checks to ensure 'Sign-in last interactive user automatically after a system-initiated restart' is set to 'Disabled' per CIS benchmark 18.9.75.1. This prevents automatic authentication after system restarts which could be a security risk.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableAutomaticRestartSignOn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableAutomaticRestartSignOn;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn Off Autoplay Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Turn off Autoplay' is set to 'Enabled: All drives' as per CIS benchmark 18.9.8.3. Checks if NoDriveTypeAutoRun value exists and is set to ff (hexadecimal).\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> NoDriveTypeAutoRun -> !ff;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> !NoDriveTypeAutoRun;\n```\n\n----------------------------------------\n\nTITLE: Checking remotely accessible registry paths and sub-paths configuration\nDESCRIPTION: Verifies that remotely accessible registry paths and sub-paths are properly configured according to CIS guidelines by checking the Machine registry value contains all required paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> Machine -> !r:Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|Software\\\\Microsoft\\\\OLAP Server|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog|System\\\\CurrentControlSet\\\\Services\\\\CertSvc|System\\\\CurrentControlSet\\\\Services\\\\WINS;\n```\n\n----------------------------------------\n\nTITLE: Checking Homegroup Joining Prevention\nDESCRIPTION: Verifies that the computer is prevented from joining a homegroup by checking if the DisableHomeGroup registry value is correctly set. This helps maintain network security by avoiding potentially insecure homegroup connections.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HomeGroup -> DisableHomeGroup -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HomeGroup -> !DisableHomeGroup;\n```\n\n----------------------------------------\n\nTITLE: Checking Simultaneous Internet Connections Policy in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled'. This setting helps enforce use of the Windows network location awareness setting and prevents simultaneous connections to different networks.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Public Profile Firewall State in Registry\nDESCRIPTION: Verifies that the Windows Firewall for Public Profile is enabled by checking registry values. The rule looks for a value of 0 in the EnableFirewall key, which indicates a non-compliant configuration.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Explorer Security Prompt for Windows Installer Scripts Setting\nDESCRIPTION: Registry checks to ensure Internet Explorer security prompts for Windows Installer scripts are not prevented, enforcing CIS Windows Server 2016 benchmark rule 18.9.74.3.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> SafeForScripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Interactive Login Check in OSSEC\nDESCRIPTION: Enforces CIS recommendation 1.5 by checking if the MySQL user has interactive login capabilities. The mysql user should have a shell set to /bin/false or /sbin/nologin.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 1.5: Disable Interactive Login] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:/etc/passwd -> r:^mysql && !r:\\.*/bin/false$|/sbin/nologin$;\n```\n\n----------------------------------------\n\nTITLE: Checking AutoRun Default Behavior in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands' in Windows registry. Ensures the NoAutorun value is set to 1 in the Explorer policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoAutorun -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoAutorun;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Script Block Logging Registry Setting in Windows\nDESCRIPTION: Verifies that 'Turn on PowerShell Script Block Logging' is disabled by checking if the EnableScriptBlockLogging registry value is set to 0 or does not exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Checking Local System ability to use computer identity for NTLM\nDESCRIPTION: Verifies that 'Network security: Allow Local System to use computer identity for NTLM' is enabled by checking the UseMachineId registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> UseMachineId -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !UseMachineId;\n```\n\n----------------------------------------\n\nTITLE: Verifying Automatic Sign-in After Restart Registry Setting in Windows\nDESCRIPTION: Checks that 'Sign-in last interactive user automatically after a system-initiated restart' is disabled by verifying the DisableAutomaticRestartSignOn registry value is set to 1 or exists.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableAutomaticRestartSignOn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableAutomaticRestartSignOn;\n```\n\n----------------------------------------\n\nTITLE: Checking Standard User Elevation Prompt Behavior Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests' by checking the ConsentPromptBehaviorUser registry value.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorUser;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote rsyslog Message Acceptance\nDESCRIPTION: Rules for verifying rsyslog configuration for accepting remote messages according to CIS benchmark 8.2.6. Ensures proper TCP input module configuration.\n\nLANGUAGE: ossec\nCODE:\n```\n#8.2.6 Accept Remote rsyslog Messages Only on Designated Log Hosts\n[CIS - Debian Linux 7/8 - 8.2.6 Accept Remote rsyslog Messages Only on Designated Log Hosts] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:$rsyslog_files -> !r:^\\$ModLoad imtcp.so;\nf:$rsyslog_files -> !r:^\\$InputTCPServerRun 514;\n```\n\n----------------------------------------\n\nTITLE: Checking remotely accessible registry paths configuration\nDESCRIPTION: Verifies that remotely accessible registry paths are properly configured according to CIS guidelines by checking the Machine registry value contains required paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedExactPaths -> Machine -> !r:System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion;\n```\n\n----------------------------------------\n\nTITLE: Checking CTRL+ALT+DEL Requirements in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'. Implements CIS Benchmark check 2.3.7.2 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.2: Ensure 'Interactive logon: Do not require CTRL+ALT+DEL' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableCAD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableCAD;\n```\n\n----------------------------------------\n\nTITLE: Validating Microsoft MAPS Membership Settings for Windows Defender\nDESCRIPTION: Ensures that joining Microsoft MAPS is disabled for Windows Defender. This check validates compliance with CIS benchmark item 18.9.69.3.1 by verifying the SpynetReporting registry value is set to 0, preventing data sharing with Microsoft.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking File Validation in Word\nDESCRIPTION: Registry check to ensure file validation is enabled in Microsoft Word. This feature validates files against known file formats and helps protect against potential security vulnerabilities.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\filevalidation -> enableonload -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\filevalidation -> !enableonload;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile State\nDESCRIPTION: Verifies that the Windows Firewall Private Profile is enabled as required by CIS benchmark 9.2.1. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Validating Terminal Services Password Prompt Setting\nDESCRIPTION: Ensures that Terminal Services always prompts for password upon connection by checking that the fPromptForPassword registry value is set to 1 or exists per CIS benchmark 18.9.52.3.9.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fPromptForPassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fPromptForPassword;\n```\n\n----------------------------------------\n\nTITLE: Auditing System Administrator Actions in Debian Linux\nDESCRIPTION: Configuration for monitoring sudo log file according to CIS Benchmark 8.1.16. This tracks all actions performed with sudo privileges, providing an audit trail of administrative activities.\n\nLANGUAGE: auditd\nCODE:\n```\n-w /var/log/sudo.log -p wa -k actions\n```\n\n----------------------------------------\n\nTITLE: Checking Allow Telemetry registry setting in OSSEC\nDESCRIPTION: Verifies that 'Allow Telemetry' is set to 'Enabled: 0 - Security [Enterprise Only]' by checking if the AllowTelemetry registry value equals 0 and that the key exists in the DataCollection registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> AllowTelemetry -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> !AllowTelemetry;\n```\n\n----------------------------------------\n\nTITLE: Checking AutoRun Default Behavior Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands' as per CIS benchmark 18.9.8.2. Checks if NoAutorun value exists and is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoAutorun -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoAutorun;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Machine Account Password Changes\nDESCRIPTION: Registry check to verify that machine account password changes are not disabled according to CIS benchmark 2.3.6.4, examining the DisablePasswordChange registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Netlogon\\Parameters -> DisablePasswordChange -> !0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Log Files Storage Location Check in OSSEC\nDESCRIPTION: Checks if log files are stored on non-system partitions per CIS recommendation 6.2. This prevents log files from filling up system partitions and causing denial of service.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.2: log files are maybe stored on systempartition] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/\\S*\\s*;\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/var/\\S*\\s*;\nf:$mysql-cnfs -> !r:^# && r:log_bin= && !r:\\s*/usr/\\S*\\s*;\nf:$mysql-cnfs -> r:log_bin\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled DNS Server (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if the DNS server (named) is enabled at boot time, which is against PCI-DSS requirement 2.2.2 unless specifically needed. The rule looks for named startup scripts in the rc directories.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - Disable standard boot services - DNS server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnamed$;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Session Limit Settings in Registry with OSSEC\nDESCRIPTION: Verifies that 'Restrict Remote Desktop Services users to a single Remote Desktop Services session' is enabled by checking if fSingleSessionPerUser is set to 1. This helps prevent resource exhaustion and improves security by limiting each user to a single session.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fSingleSessionPerUser -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fSingleSessionPerUser;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Outbound Connections in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile is set to allow outbound connections per CIS benchmark 9.1.3. The check confirms the DefaultOutboundAction value is set to 1 across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Configure SmartScreen Filter' Registry Setting\nDESCRIPTION: Registry check to ensure 'Configure SmartScreen Filter' is enabled per CIS benchmark 18.9.41.7. Verifies the EnabledV9 value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> EnabledV9 -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting rsync Service\nDESCRIPTION: Checks for enabled rsync service in runlevel configuration. Part of CIS SLES12 benchmark section 6.16.\n\nLANGUAGE: shell\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\drsyncd$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Dropped Packets Logging\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile logging configuration has dropped packets logging enabled. Verifies this setting in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking File and Registry Virtualization Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Virtualize file and registry write failures to per-user locations' is set to 'Enabled' by checking if the EnableVirtualization registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableVirtualization -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network server digital signature requirement\nDESCRIPTION: Registry check to ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'. Verifies the RequireSecuritySignature registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !RequireSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Notification Settings in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No'. Checks if the DisableNotifications registry value is set to 0 or is missing, which would indicate notifications are enabled (potentially insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> !DisableNotifications;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> !DisableNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge Search Suggestions Disable Registry Setting\nDESCRIPTION: Verifies that search suggestions in the Address bar of Microsoft Edge are disabled by checking the ShowSearchSuggestionsGlobal registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\SearchScopes -> ShowSearchSuggestionsGlobal -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\SearchScopes -> !ShowSearchSuggestionsGlobal;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Admin Approval Mode for All Administrators in Registry\nDESCRIPTION: Verifies that 'User Account Control: Run all administrators in Admin Approval Mode' is enabled. Checks if the EnableLUA registry value is set to 0, which would indicate the policy is disabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableLUA -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Use enhanced anti-spoofing when available registry setting in OSSEC\nDESCRIPTION: Verifies that 'Use enhanced anti-spoofing when available' is set to 'Enabled' by checking if the EnhancedAntiSpoofing registry value equals 1 in the FacialFeatures biometrics registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Biometrics\\FacialFeatures -> EnhancedAntiSpoofing -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Data Execution Prevention for Explorer Registry Setting\nDESCRIPTION: Verifies that Data Execution Prevention (DEP) for Explorer is enabled by checking if NoDataExecutionPrevention is not set to 0, which would disable DEP protection.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot-Start Driver Initialization Policy\nDESCRIPTION: Verifies that the Boot-Start Driver Initialization Policy is set to 'Good, unknown and bad but critical'. This ensures that only appropriate drivers are loaded during system boot.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Offer Configuration in Registry\nDESCRIPTION: Confirms that offers to update to the latest version of Windows are turned off by checking if the DisableOSUpgrade registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Checking Allow Microsoft accounts to be optional registry setting in OSSEC\nDESCRIPTION: Verifies that 'Allow Microsoft accounts to be optional' is set to 'Enabled' by checking if the MSAOptional registry value equals 1 and that the key exists in the System policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Encryption for Third-Party SMB Servers in Windows Server 2016\nDESCRIPTION: Verifies that 'Microsoft network client: Send unencrypted password to third-party SMB servers' is disabled. This rule checks the EnablePlainTextPassword registry value to prevent cleartext password transmission.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnablePlainTextPassword -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Restrict anonymous access to Named Pipes and Shares' setting\nDESCRIPTION: Registry check to ensure anonymous access to named pipes and shares is restricted, which reduces the attack surface by preventing unauthorized access.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RestrictNullSessAccess -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Notification Settings\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Settings: Display a notification' is set to 'Yes' as required by CIS benchmark 9.3.4 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Scheduled Install Day\nDESCRIPTION: Verifies that 'Configure Automatic Updates: Scheduled install day' is set to '0 - Every day' in the Windows Update registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> ScheduledInstallDay -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !ScheduledInstallDay;\n```\n\n----------------------------------------\n\nTITLE: Detecting Samba Services in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if Samba file sharing services are enabled. This implements CIS benchmark 3.13 by checking for samba and smb services in the boot configuration directories.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\n```\n\n----------------------------------------\n\nTITLE: Checking Unsafe Locations Protected View in Word\nDESCRIPTION: Registry check to ensure that Protected View is enabled for files from unsafe locations in Microsoft Word. This provides additional security by opening files from potentially dangerous locations in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> disableunsafelocationsinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> !disableunsafelocationsinpv;\n```\n\n----------------------------------------\n\nTITLE: Detecting Disabled TCP SYN Cookies in RHEL5\nDESCRIPTION: Checks if TCP SYN Cookies protection is disabled in the system. This CIS benchmark rule (4.2.8) verifies that the tcp_syncookies parameter is not set to 0 to prevent SYN flood attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/tcp_syncookies -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Infrared Monitor Service Setting\nDESCRIPTION: Verifies that 'Infrared monitor service (irmon)' is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\irmon -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\irmon -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Shutdown Without Logon Policy in Windows Registry\nDESCRIPTION: Verifies the 'Shutdown: Allow system to be shut down without having to log on' setting is disabled for security. Checks if the registry value is set to 1, which would indicate the policy is enabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ShutdownWithoutLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Client Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Enable Windows NTP Client' is set to 'Enabled' per CIS benchmark 18.8.44.1.1. The check verifies that the Enabled registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> Enabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> !Enabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying WinRM Client Digest Authentication Registry Setting in Windows\nDESCRIPTION: Checks that 'Disallow Digest authentication' for WinRM Client is enabled by verifying the AllowDigest registry value is set to 0 or does not exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowDigest -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> !AllowDigest;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Local Rules Registry Configuration\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Apply local firewall rules' is set to 'Yes (default)' by checking if the AllowLocalPolicyMerge registry value is set to 0 in both policy and local settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Reveal Button Setting in Windows Registry\nDESCRIPTION: OSSEC rule to verify that 'Do not display the password reveal button' is set to 'Enabled' in Windows registry. Ensures the DisablePasswordReveal value is set to 1 in the CredUI policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> DisablePasswordReveal -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> !DisablePasswordReveal;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log File Path Configuration\nDESCRIPTION: Ensures the Windows Firewall Domain Profile log file path is correctly set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' by checking registry values with regular expression patterns.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Slideshow Setting\nDESCRIPTION: Registry check to ensure lock screen slideshow is disabled. Verifies NoLockScreenSlideshow is set to 1 and exists in the Windows Personalization policy path.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenSlideshow -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenSlideshow;\n```\n\n----------------------------------------\n\nTITLE: Checking Domain Controller Authentication for Workstation Unlock in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if the Windows setting to require Domain Controller Authentication to unlock workstation is enabled, as required by CIS benchmark 2.3.7.8. It verifies the ForceUnlockLogon registry value.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.7.8 Ensure 'Interactive logon: Require Domain Controller Authentication to unlock workstation' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.8: Ensure 'Interactive logon: Require Domain Controller Authentication to unlock workstation' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ForceUnlockLogon -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> !ForceUnlockLogon;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Offer Registry Setting\nDESCRIPTION: Verifies that offers to update to the latest version of Windows are disabled by checking if DisableOSUpgrade is set to 1 and not missing, which prevents prompts to upgrade to newer Windows versions.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Checking PKU2U Authentication with Online Identities in Windows 10\nDESCRIPTION: Verifies that 'Network Security: Allow PKU2U authentication requests to this computer to use online identities' is set to 'Disabled' by checking that the AllowOnlineID registry value is set to 0.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\pku2u -> AllowOnlineID -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Location Setting Elevation Registry Settings\nDESCRIPTION: Validates that domain users are required to elevate when setting a network's location by checking the NC_StdDomainUserSetLocation registry value is set to 1.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Handwriting Error Reporting Settings\nDESCRIPTION: Verifies that 'Turn off handwriting recognition error reporting' is enabled by checking for PreventHandwritingErrorReports=1 in the registry. This prevents the system from sending handwriting recognition errors to Microsoft.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Policy Processing for Unchanged GPOs in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Configure registry policy processing: Process even if the Group Policy objects have not changed' is set to 'Enabled: TRUE'. This ensures registry policies are processed even when Group Policy objects haven't changed.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoGPOListChanges;\n```\n\n----------------------------------------\n\nTITLE: Checking Domain Controller Authentication for Workstation Unlock in Windows Server 2016\nDESCRIPTION: Verifies the 'Interactive logon: Require Domain Controller Authentication to unlock workstation' setting is enabled. This rule ensures the ForceUnlockLogon registry value is properly set to enhance security during workstation unlock operations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ForceUnlockLogon -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> !ForceUnlockLogon;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Shares that can be accessed anonymously' setting\nDESCRIPTION: Registry check to ensure no shares can be accessed anonymously, preventing unauthorized access to network shares without authentication.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionShares -> r:\\S*;\n```\n\n----------------------------------------\n\nTITLE: Validating rsyslog Service Activation\nDESCRIPTION: Rules for confirming that the rsyslog service is properly activated at runlevels 2-5 according to CIS benchmark 8.2.2. Ensures the service is set to start automatically.\n\nLANGUAGE: ossec\nCODE:\n```\n#8.2.2 Ensure the rsyslog Service is activated (RunLevel 2, 3, 4, 5; Priority 01)\n[CIS - Debian Linux 7/8 - 8.2.2 Ensure the rsyslog Service is activated (RunLevel 2, 3, 4, 5; Priority 01)] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/rc2.d/S01rsyslog;\nf:!/etc/rc3.d/S01rsyslog;\nf:!/etc/rc4.d/S01rsyslog;\nf:!/etc/rc5.d/S01rsyslog;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Configuration\nDESCRIPTION: Verifies that Windows Automatic Updates is enabled by checking the NoAutoUpdate registry value is not set to 1, or the key doesn't exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Checking Multicast Name Resolution for Windows Server\nDESCRIPTION: Verifies that multicast name resolution is disabled for security. Detects non-compliance when EnableMulticast is not set to 0 or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient -> EnableMulticast -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient -> !EnableMulticast;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Connection Sharing Settings in Windows Registry\nDESCRIPTION: Registry checks for ensuring Internet Connection Sharing is properly restricted on DNS domain networks and that domain users must elevate when setting a network's location.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.4.11.3 Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.11.3 Ensure 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_ShowSharedAccessUI -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_ShowSharedAccessUI;\n#\n#\n#18.4.11.4 Ensure 'Require domain users to elevate when setting a network's location' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.11.4 Ensure 'Require domain users to elevate when setting a network's location' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: Defining Rootkit Detection Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring the rootkit detection engine in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3.3\nrunrootcheck=\"Do you want to run the rootkit detection engine?\"\nnorootcheck=\"Not running rootcheck (rootkit detection)\"\nyesrootcheck=\"Running rootcheck (rootkit detection)\"\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Slideshow Settings in OSSEC\nDESCRIPTION: OSSEC rule that verifies the lock screen slideshow is disabled. It checks if NoLockScreenSlideshow is set to 1 or if the key doesn't exist in the Personalization policy registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenSlideshow -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenSlideshow;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP Data Retransmission Settings for IPv6\nDESCRIPTION: Verifies that 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 3. This rule checks the TCPIP6 Parameters registry to ensure retransmission attempts are properly limited.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: NIS Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify NIS server (ypserv) is disabled on RHEL5 systems. Checks for start scripts in runlevel directories, satisfying CIS requirement 2.1.6 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 2.1.5 - Disable standard boot services - NIS (server) Enabled {CIS: 2.1.6 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dypserv$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Firewall Rules\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile is not applying local firewall rules. Verifies AllowLocalPolicyMerge is not set to 0 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Offer Remote Assistance Configuration\nDESCRIPTION: OSSEC rule to verify that Offer Remote Assistance is disabled. The rule checks if the fAllowUnsolicited registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Firewall State\nDESCRIPTION: Ensures Windows Firewall Private Profile is enabled by verifying the EnableFirewall value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Password Manager Configuration in Registry\nDESCRIPTION: Verifies that the Microsoft Edge Password Manager is disabled by checking if the FormSuggest Passwords registry value is not set to 'no' or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> FormSuggest Passwords -> !no;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !FormSuggest Passwords;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Restart Settings\nDESCRIPTION: Verifies that auto-restart with logged on users for scheduled updates is enabled by checking the NoAutoRebootWithLoggedOnUsers registry key is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoRebootWithLoggedOnUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Do not allow passwords to be saved' Registry Setting\nDESCRIPTION: Registry check to ensure 'Do not allow passwords to be saved' is enabled per CIS benchmark 18.9.52.2. Verifies the DisablePasswordSaving value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !DisablePasswordSaving;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Broadcast Request Handling in Network Configuration\nDESCRIPTION: Verifies if the system is configured to ignore ICMP broadcast requests. This test checks if icmp_echo_ignore_broadcasts is set to 0 (disabled), which could allow the system to respond to broadcast ping requests.\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Logon Registry Settings\nDESCRIPTION: Validates that automatic logon is disabled by checking the AutoAdminLogon registry value is set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Web Services in Wizards Settings\nDESCRIPTION: Verifies that 'Turn off Internet download for Web publishing and online ordering wizards' is enabled by checking for NoWebServices=1 in the registry. This prevents wizards from downloading content from Microsoft sites.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking System EventLog Behavior for Maximum Size in Windows Registry\nDESCRIPTION: Registry check to ensure that 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' as required by CIS benchmark 18.9.26.4.1. This prevents the system from automatically overwriting event logs.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.26.4.1 Ensure 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.26.4.1: Ensure 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Transcription Settings in Registry\nDESCRIPTION: Registry check to ensure 'Turn on PowerShell Transcription' is set to 'Disabled' per CIS benchmark 18.9.84.2. This prevents PowerShell from creating text-based transcripts of PowerShell sessions.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription -> EnableTranscripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Successful Connections Logging\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile is logging successful connections. Verifies LogSuccessfulConnections is not set to 0 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Windows IPv6 TCP Data Retransmission Check in OSSEC\nDESCRIPTION: Verifies the TCP IPv6 data retransmission value is correctly set to 3 retries by checking the TcpMaxDataRetransmissions registry value in the IPv6 parameters.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.3.10: Ensure 'MSS: (TcpMaxDataRetransmissions IPv6) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Verifying Application Event Log Size\nDESCRIPTION: Checks if the Application Event Log maximum size is set to at least 32,768 KB. This ensures sufficient log storage capacity for troubleshooting and security monitoring.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Settings for Windows Server\nDESCRIPTION: Verifies that the system is set to ignore NetBIOS name release requests except from WINS servers. Detects non-compliance when NoNameReleaseOnDemand is not set to 1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Simple TCP/IP Services Setting\nDESCRIPTION: Verifies that 'Simple TCP/IP Services (simptcp)' is disabled or not installed by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\simptcp -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Configuration for Windows Server\nDESCRIPTION: Verifies that ICMP redirects cannot override OSPF generated routes. Detects non-compliance when EnableICMPRedirect is set to 1 or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> EnableICMPRedirect -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !EnableICMPRedirect;\n```\n\n----------------------------------------\n\nTITLE: Checking Require pin for pairing registry setting in OSSEC\nDESCRIPTION: Verifies that 'Require pin for pairing' is set to 'Enabled' by checking if the RequirePinForPairing registry value doesn't equal 0 and that the key exists in the Connect registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Connect -> RequirePinForPairing -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Connect -> !RequirePinForPairing;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: DCOM Disabled Detection\nDESCRIPTION: Checks if the Distributed Component Object Model (DCOM) is disabled, which could impact system functionality or indicate security lockdown. References PCI-DSS section 10.6.1.\n\nLANGUAGE: ossec\nCODE:\n```\n[DCOM disabled {PCI_DSS: 10.6.1}] [any] []\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\OLE -> EnableDCOM -> N;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Network Server Settings in Windows 10\nDESCRIPTION: Registry checks to ensure server session timeout, digital signature requirements, and other network server security settings conform to CIS benchmarks.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.9.1 Ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s), but not 0'\n[CIS - Microsoft Windows 10 - 2.3.9.1 Ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s), but not 0'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !AutoDisconnect;\n#\n#\n#2.3.9.2 Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.9.2 Ensure 'Microsoft network server: Digitally sign communications (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !RequireSecuritySignature;\n#\n#\n#2.3.9.3 Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.9.3 Ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !EnableSecuritySignature;\n#\n#\n#2.3.9.4 Ensure 'Microsoft network server: Disconnect clients when logon hours expire' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.9.4 Ensure 'Microsoft network server: Disconnect clients when logon hours expire' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1;\n#\n#\n#2.3.9.5 Ensure 'Microsoft network server: Server SPN target name validation level' is set to 'Accept if provided by client' or higher\n[CIS - Microsoft Windows 10 - 2.3.9.5 Ensure 'Microsoft network server: Server SPN target name validation level' is set to 'Accept if provided by client' or higher] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> SMBServerNameHardeningLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !SMBServerNameHardeningLevel;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rules to check for NFS services enabled\nDESCRIPTION: Checks if NFS and NFS lock services are enabled in startup scripts by looking for S followed by numbers and nfs/nfslock.\n\nLANGUAGE: configuration\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\n```\n\n----------------------------------------\n\nTITLE: Checking Cortana Allowance\nDESCRIPTION: Verifies that 'Allow Cortana' is set to 'Disabled' (value equal to 0) in the Windows Search registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowCortana -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !AllowCortana;\n```\n\n----------------------------------------\n\nTITLE: Checking Background Refresh of Group Policy Settings\nDESCRIPTION: OSSEC rule to verify that background refresh of Group Policy is not turned off. The rule checks if the DisableBkGndGroupPolicy registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableBkGndGroupPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Firewall Rules Setting\nDESCRIPTION: Ensures Windows Firewall Private Profile is configured to apply local firewall rules by checking AllowLocalPolicyMerge value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Client Configuration in Registry\nDESCRIPTION: Validates that 'Enable Windows NTP Client' is set to 'Enabled' by confirming the Enabled registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> Enabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> !Enabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables Search Companion content file updates. Checks for the presence of the DisableContentFileUpdates registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Public Profile Local Connection Security Rules in Registry\nDESCRIPTION: Verifies that the Windows Firewall for Public Profile is set to not apply local connection security rules. The rule looks for a value of 0 in the AllowLocalIPsecPolicyMerge key, which indicates a non-compliant configuration.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Removable Partition /media without 'nosuid' Option in OSSEC\nDESCRIPTION: This rule checks if removable media mounted at /media in /etc/fstab lacks the 'nosuid' option. The rule identifies non-commented entries for /media without the nosuid mount option, which is required by CIS benchmark 7.2.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:/media && !r:nosuid;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Allow indexing of encrypted files' Registry Setting\nDESCRIPTION: Registry check to ensure 'Allow indexing of encrypted files' is disabled per CIS benchmark 18.9.54.4. Verifies the AllowIndexingEncryptedStoresOrItems value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowIndexingEncryptedStoresOrItems -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive Logon Cache Settings in Windows Registry\nDESCRIPTION: Checks whether 'Interactive logon: Number of previous logons to cache' is set to 4 or fewer. This rule verifies that CachedLogonsCount in the Winlogon registry key is not set to values higher than 4, which would be a security risk when domain controllers are unavailable.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> a;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> b;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> c;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> e;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> f;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> \\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> !CachedLogonsCount;\n```\n\n----------------------------------------\n\nTITLE: Detecting NFS Services in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if NFS and related services are enabled. This implements CIS benchmark 3.8 by checking for NFS and NFS lock services in the boot services configuration.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Update to Latest Version Offer Prevention\nDESCRIPTION: Checks that offers to update to the latest version of Windows are disabled by ensuring the DisableOSUpgrade registry value is set to 1 or exists per CIS benchmark 18.9.61.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Checking Screen Saver Grace Period for Windows Server\nDESCRIPTION: Verifies that the screen saver grace period is set to 5 seconds or fewer. Detects non-compliance when ScreenSaverGracePeriod exceeds 5 seconds.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> r:\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking OneDrive File Storage Prevention Registry Setting\nDESCRIPTION: Verifies that OneDrive for file storage is disabled by checking if DisableFileSyncNGSC is set to 1 and not missing, which prevents using OneDrive for file storage.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> DisableFileSyncNGSC -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> !DisableFileSyncNGSC;\n```\n\n----------------------------------------\n\nTITLE: Windows TCP Keep-Alive Time Check in OSSEC\nDESCRIPTION: Verifies the TCP/IP keep-alive interval is properly set to 300,000 milliseconds (5 minutes) by checking the KeepAliveTime registry value is set to 493e0 (hexadecimal).\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.3.5: Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n```\n\n----------------------------------------\n\nTITLE: Checking User Interface and Sign-in Settings\nDESCRIPTION: Registry checks for securing the sign-in experience, including disabling account details display, network selection UI, connected user enumeration, and PIN sign-in.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.8.25.1 Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.25.1 Ensure 'Block user from showing account details on sign-in' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> BlockUserFromShowingAccountDetailsOnSignin -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !BlockUserFromShowingAccountDetailsOnSignin;\n#\n#\n#18.8.25.2 Ensure 'Do not display network selection UI' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.25.2 Ensure 'Do not display network selection UI' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n#\n#\n#18.8.25.3 Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.25.3 Ensure 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontEnumerateConnectedUsers -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontEnumerateConnectedUsers;\n#\n#\n#18.8.25.4 Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.25.4 Ensure 'Enumerate local users on domain-joined computers' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnumerateLocalUsers -> !0;\n#\n#\n#18.8.25.5 Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.25.5 Ensure 'Turn off app notifications on the lock screen' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DisableLockScreenAppNotifications -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DisableLockScreenAppNotifications;\n#\n#\n#18.8.25.6 Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.25.6 Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Extension Installation\nDESCRIPTION: Registry check to ensure the Local Administrator Password Solution (LAPS) GPO Extension/CSE is installed. Verifies DllName exists in the Winlogon GPExtensions registry path.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions\\{D76B9641-3288-4f75-942D-087DE603E3EA} -> !DllName;\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Error Reporting Service Disabled Status\nDESCRIPTION: Checks that the Windows Error Reporting Service (WerSvc) is disabled by verifying its Start registry value is set to 4 or that the Start value exists. Implements CIS benchmark 5.33.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WerSvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WerSvc -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Detecting IMAP and POP3 Services\nDESCRIPTION: Checks for enabled IMAP and POP3 services in xinetd configuration. Part of CIS SLES12 benchmark section 6.11.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/cyrus-imapd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Notification Settings\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile has notifications enabled. Verifies DisableNotifications is not set to 0 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Saving Prevention for Terminal Services Registry Setting\nDESCRIPTION: Verifies that saving passwords for Terminal Services is disabled by checking if DisablePasswordSaving is set to 1 and not missing, which prevents users from saving credentials for RDP connections.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !DisablePasswordSaving;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Script Block Logging\nDESCRIPTION: Verifies that 'Turn on PowerShell Script Block Logging' is set to 'Disabled' (value equal to 0) in the PowerShell registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> EnableScriptBlockLogging -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\ScriptBlockLogging -> !EnableScriptBlockLogging;\n```\n\n----------------------------------------\n\nTITLE: Checking Domain User Elevation Requirement for Network Location Settings\nDESCRIPTION: OSSEC rule to verify that domain users are required to elevate privileges when setting a network's location. The rule checks if the NC_StdDomainUserSetLocation registry value is not set to 1 or is missing entirely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: Error Reporting Disabled Detection\nDESCRIPTION: Identifies when Windows error reporting features have been disabled, which could indicate attempts to hide system issues or malicious activity. References PCI-DSS section 10.6.1.\n\nLANGUAGE: ossec\nCODE:\n```\n[Error reporting disabled {PCI_DSS: 10.6.1}] [any] [http://windowsir.blogspot.com/2007/04/something-new-to-look-for.html]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> DoReport -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeKernelFaults -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeMicrosoftApps -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeWindowsApps -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> IncludeShutdownErrs -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\PCHealth\\ErrorReporting -> ShowUI -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Secure Channel Data Signing in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to verify 'Domain member: Digitally sign secure channel data (when possible)' is enabled. Implements CIS Benchmark check 2.3.6.3 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.3: Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SignSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Policy Background Processing Setting\nDESCRIPTION: OSSEC rule to verify that registry policy processing during periodic background processing is enabled. The rule checks if the NoBackgroundPolicy registry value is not set to 0 or is missing entirely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoBackgroundPolicy;\n```\n\n----------------------------------------\n\nTITLE: Configuring Platform-Specific Library Names\nDESCRIPTION: Sets platform-specific output naming conventions for the libraries, using 'libz' on Unix-like systems and adding version script for Linux.\n\nLANGUAGE: CMake\nCODE:\n```\nif(UNIX)\n    # On unix-like platforms the library is almost always called libz\n   set_target_properties(zlib zlibstatic PROPERTIES OUTPUT_NAME z)\n   if(NOT APPLE)\n     set_target_properties(zlib PROPERTIES LINK_FLAGS \"-Wl,--version-script,\\\"${CMAKE_CURRENT_SOURCE_DIR}/zlib.map\\\"\")\n   endif()\nelseif(BUILD_SHARED_LIBS AND WIN32)\n    # Creates zlib1.dll when building shared library version\n    set_target_properties(zlib PROPERTIES SUFFIX \"1.dll\")\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Partition /var without 'nodev' Option in OSSEC\nDESCRIPTION: This rule checks if the /var partition in /etc/fstab is mounted without the 'nodev' option. The rule verifies that non-commented ext2/ext3 entries for /var do not include the nodev mount option, which is a security vulnerability according to CIS benchmark 7.1.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/var && !r:nodev;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows SmartScreen Configuration in Registry\nDESCRIPTION: Registry check to ensure Windows SmartScreen is enabled. Implements CIS benchmark 18.9.30.2 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableSmartScreen;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Automatic Updates Configuration in Registry\nDESCRIPTION: Verifies that automatic download and installation of updates is enabled by checking if the AutoDownload registry value is not set to 4.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Bad Error Message Protection Configuration in Linux\nDESCRIPTION: Verifies that bad error message protection is properly enabled as per CIS-RHEL6 section 4.2.6. This check examines the kernel parameter that controls how the system handles bogus ICMP error responses for security compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_ignore_bogus_error_responses -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Account Optional Setting in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Allow Microsoft accounts to be optional' is set to 'Enabled' in Windows registry. Ensures the MSAOptional value is set to 1 in the System policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Elevation Prompt Behavior for Standard Users in Registry\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for standard users' is set to 'Automatically deny elevation requests'. Checks if the ConsentPromptBehaviorUser registry value is set to 1 or is missing, which would indicate improper configuration.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorUser;\n```\n\n----------------------------------------\n\nTITLE: Checking LDAP client signing requirements\nDESCRIPTION: Verifies that 'Network security: LDAP client signing requirements' is set to 'Negotiate signing' or higher by checking the LDAPClientIntegrity registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LDAP -> LDAPClientIntegrity -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Admin Approval Mode Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Run all administrators in Admin Approval Mode' is set to 'Enabled' by checking if the EnableLUA registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableLUA -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Access Restriction in Windows Registry\nDESCRIPTION: Validates the registry setting that disables access to the Windows Store. Checks for the presence of the NoUseStoreOpenWith registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Case Insensitivity Registry Configuration\nDESCRIPTION: Verifies that 'System objects: Require case insensitivity for non-Windows subsystems' is set to 'Enabled' by checking if the ObCaseInsensitive registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Kernel -> ObCaseInsensitive -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Local Accounts Security Model Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network access: Sharing and security model for local accounts' is set to 'Classic - local users authenticate as themselves' according to CIS benchmark 2.3.10.12.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> ForceGuest -> 1;\n```\n\n----------------------------------------\n\nTITLE: Detecting ICMP Broadcast Acceptance in RHEL5\nDESCRIPTION: Checks if ICMP broadcast acceptance is enabled in the system. This CIS benchmark rule (4.2.5) verifies that the icmp_echo_ignore_broadcasts parameter is not set to 0 to prevent ICMP broadcast attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Consumer Experiences Setting in Windows 10\nDESCRIPTION: Verifies that 'Turn off Microsoft consumer experiences' is set to 'Enabled' by checking registry values related to DisableWindowsConsumerFeatures.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.13.1 Ensure 'Turn off Microsoft consumer experiences' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent -> DisableWindowsConsumerFeatures -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent -> !DisableWindowsConsumerFeatures;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows App Data Sharing Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Allow a Windows app to share application data between users' is set to 'Disabled' by verifying the AllowSharedLocalAppData registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.4.1 Ensure 'Allow a Windows app to share application data between users' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\AppModel\\StateManager -> AllowSharedLocalAppData -> !0;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for CTRL+ALT+DEL Requirement\nDESCRIPTION: Registry check to ensure that CTRL+ALT+DEL is required for logon according to CIS benchmark 2.3.7.2, checking the DisableCAD registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableCAD -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Settings in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is enabled for network security.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: Winpcap Packet Filter Driver Detection\nDESCRIPTION: Identifies the presence of the Winpcap packet filter driver, which could indicate packet sniffing capabilities on the system. References PCI-DSS section 10.6.1.\n\nLANGUAGE: ossec\nCODE:\n```\n[Winpcap packet filter driver found {PCI_DSS: 10.6.1}] [any] []\nf:%WINDIR%\\System32\\drivers\\npf.sys;\n```\n\n----------------------------------------\n\nTITLE: Validating logrotate Configuration\nDESCRIPTION: Rules for checking proper logrotate configuration according to CIS benchmark 8.4. Verifies that rsyslog rotation configuration exists and is properly set up.\n\nLANGUAGE: ossec\nCODE:\n```\n#8.4 Configure logrotate\n[CIS - Debian Linux 7/8 - 8.4 Configure logrotate] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/logrotate.d/rsyslog;\nf:/etc/logrotate.d/rsyslog -> !r:\\S+;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Access Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off access to the Store' is set to 'Enabled' by verifying that the NoUseStoreOpenWith registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.1 Ensure 'Turn off access to the Store' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Win32 API Calls from Office Macros Prevention\nDESCRIPTION: OSSEC audit rules to verify that Win32 API calls from Office macros are blocked. This security control prevents macros from accessing potentially dangerous Windows system APIs.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B;\n```\n\n----------------------------------------\n\nTITLE: Checking Partition /tmp without 'nodev' Option in OSSEC\nDESCRIPTION: This rule checks if the /tmp partition in /etc/fstab is mounted without the 'nodev' option. The rule verifies that non-commented ext2/ext3 entries for /tmp do not include the nodev mount option, which is a security vulnerability according to CIS benchmark 7.1.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/tmp && !r:nodev;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Unencrypted Traffic Registry Setting in Windows\nDESCRIPTION: Ensures that 'Allow unencrypted traffic' for WinRM Client is disabled by checking if the AllowUnencryptedTraffic registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Password Manager Configuration in Registry\nDESCRIPTION: Registry check to ensure that 'Configure Password Manager' is set to 'Disabled' as required by CIS benchmark 18.9.41.4. This prevents Microsoft Edge from saving user passwords.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.41.4 Ensure 'Configure Password Manager' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.41.4: Ensure 'Configure Password Manager' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> FormSuggest Passwords -> !no;\n```\n\n----------------------------------------\n\nTITLE: Checking Setup Event Log Maximum Size in Windows Registry\nDESCRIPTION: OSSEC rule to verify 'Setup: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater' in Windows registry. This complex rule checks for various size configurations that would be less than the required minimum size.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv4 Source Routing Protection in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if IPv4 source routing protection level is set to highest protection (value 2), which completely disables source routing to protect against packet spoofing.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking Remotely Accessible Registry Paths and Sub-paths in Windows 10\nDESCRIPTION: Verifies that 'Network access: Remotely accessible registry paths and sub-paths' contains only the approved paths by checking the Machine value under the Winreg AllowedPaths registry key.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> Machine -> !r:System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|Software\\\\Microsoft\\\\OLAP Server|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> !Machine;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Explorer Enclosures Download Prevention in Registry\nDESCRIPTION: Confirms that downloading of enclosures in Internet Explorer is prevented by checking if the DisableEnclosureDownload registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> DisableEnclosureDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> !DisableEnclosureDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking picture password sign-in\nDESCRIPTION: Verifies that picture password sign-in is turned off. This enforces the use of more secure authentication methods rather than potentially less secure picture passwords.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> BlockDomainPicturePassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !BlockDomainPicturePassword;\n```\n\n----------------------------------------\n\nTITLE: Checking Encrypted File Indexing\nDESCRIPTION: Verifies that 'Allow indexing of encrypted files' is set to 'Disabled' (value equal to 0) in the Windows Search registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowIndexingEncryptedStoresOrItems -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Anonymous Access to Shares Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network access: Shares that can be accessed anonymously' is set to 'None' according to CIS benchmark 2.3.10.11.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionShares -> r:\\S*;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH MaxAuthTries Setting\nDESCRIPTION: Rules for validating SSH MaxAuthTries settings according to CIS benchmark 9.3.5. Ensures maximum authentication attempts are limited to 4 or less to prevent brute force attacks.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.5 Set SSH MaxAuthTries to 4 or Less\n[CIS - Debian Linux 7/8 - 9.3.5 Set SSH MaxAuthTries to 4 or Less] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^MaxAuthTries\\s+\\d;\nf:/etc/ssh/sshd_config -> r:^MaxAuthTries\\s+\\d\\d+;\nf:/etc/ssh/sshd_config -> r:^MaxAuthTries\\s+5;\nf:/etc/ssh/sshd_config -> r:^MaxAuthTries\\s+6;\nf:/etc/ssh/sshd_config -> r:^MaxAuthTries\\s+7;\nf:/etc/ssh/sshd_config -> r:^MaxAuthTries\\s+8;\nf:/etc/ssh/sshd_config -> r:^MaxAuthTries\\s+9;\n```\n\n----------------------------------------\n\nTITLE: Checking Drive Redirection Prevention for Terminal Services Registry Setting\nDESCRIPTION: Verifies that drive redirection for Terminal Services is disabled by checking if fDisableCdm is set to 1 and not missing, which prevents users from accessing local drives during remote sessions.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCdm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCdm;\n```\n\n----------------------------------------\n\nTITLE: Defining Installation Type Selection Messages in Bash\nDESCRIPTION: Sets variables for messages related to selecting the installation type (server, agent, local) in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 1\ninstallscript=\"Installation Script\"\nsystem=\"System\"\nuser=\"User\"\nhost=\"Host\"\nhitanyorabort=\"Press ENTER to continue or Ctrl-C to abort.\"\nwhattoinstall=\"What kind of installation do you want (server, agent, local, hybrid or help)?\"\nserverchose=\"Server installation chosen\"\nclientchose=\"Agent(client) installation chosen\"\nlocalchose=\"Local installation chosen\"\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Inbound Connections Registry Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile blocks inbound connections by default. Validates registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Remotely accessible registry paths' configuration\nDESCRIPTION: Registry check to ensure only approved registry paths are remotely accessible, restricting potential unauthorized access to system settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedExactPaths -> Machine -> !r:System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Log File Path Configuration\nDESCRIPTION: Ensures Windows Firewall Private Profile log file path is correctly set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' by checking registry values with regular expression patterns.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Configuring ICQ Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting ICQ installation through registry entries. Includes PCI DSS compliance reference 10.6.1.\n\nLANGUAGE: conf\nCODE:\n```\n[Chat/IM - ICQ {PCI_DSS: 10.6.1}] [any] []\nr:HKEY_CURRENT_USER\\Software\\Mirabilis\\ICQ;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Allow user control over installs' Registry Setting\nDESCRIPTION: Registry check to ensure 'Allow user control over installs' is disabled per CIS benchmark 18.9.74.1. Verifies the EnableUserControl value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Basic Authentication Registry Setting in Windows\nDESCRIPTION: Verifies that 'Allow Basic authentication' for WinRM Service is disabled by checking if the AllowBasic registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network access anonymous user permissions\nDESCRIPTION: Verifies that 'Network access: Let Everyone permissions apply to anonymous users' is disabled by checking the EveryoneIncludesAnonymous registry value isn't set to 1 or 2.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Partition /opt without 'nodev' Option in OSSEC\nDESCRIPTION: This rule checks if the /opt partition in /etc/fstab is mounted without the 'nodev' option. The rule verifies that non-commented ext2/ext3 entries for /opt do not include the nodev mount option, which is a security vulnerability according to CIS benchmark 7.1.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/opt && !r:nodev;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Application Event Log Behavior\nDESCRIPTION: OSSEC rule that checks if 'Application: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' by verifying the Retention registry key is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Drive Redirection Prevention in Registry\nDESCRIPTION: Confirms that drive redirection in Terminal Services is disabled by checking if the fDisableCdma registry value is not set to 1 or if the fDisableCdm key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCdma -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCdm;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Slideshow Settings in Windows Server 2016\nDESCRIPTION: Registry checks to ensure lock screen slideshow is disabled. Validates that the NoLockScreenSlideshow registry key is set to 1 as required by CIS benchmark 18.1.1.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenSlideshow -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenSlideshow;\n```\n\n----------------------------------------\n\nTITLE: Checking AutoAdminLogon Settings in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if 'MSS: (AutoAdminLogon) Enable Automatic Logon' is set to 'Disabled' by verifying AutoAdminLogon is set to 0 in the Windows registry.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking RPC Locator Service Setting\nDESCRIPTION: Verifies that 'Remote Procedure Call (RPC) Locator (RpcLocator)' is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RpcLocator -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RpcLocator -> !Start;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Check for System Crash on Audit Failure\nDESCRIPTION: Registry check to verify that the system is not configured to shut down if unable to log security audits, as specified in CIS Benchmark item 2.3.2.2.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.2.2 Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'[CIS - Microsoft Windows 10 - 2.3.2.2 Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Connection Security Rules Setting\nDESCRIPTION: Verifies Windows Firewall Private Profile is configured to apply local connection security rules by checking AllowLocalIPsecPolicyMerge value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying NTP Configuration in SLES11\nDESCRIPTION: Checks if NTP is properly configured with appropriate restrictions and server definitions. Also verifies it runs with proper user privileges.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/ntp.conf -> r:restrict default kod nomodify notrap nopeer noquery && r:^server;\nf:/etc/sysconfig/ntpd -> r:OPTIONS=\"-u ntp:ntp -p /var/run/ntpd.pid\";\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Support Diagnostic Tool Settings\nDESCRIPTION: Verifies that 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is disabled by checking if DisableQueryRemoteServer is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> DisableQueryRemoteServer -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> !DisableQueryRemoteServer;\n```\n\n----------------------------------------\n\nTITLE: Checking RPC Client Authentication Requirements in Windows Registry\nDESCRIPTION: Validates the registry setting that restricts unauthenticated RPC clients. Checks for the presence of the RestrictRemoteClients registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> RestrictRemoteClients -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> !RestrictRemoteClients;\n```\n\n----------------------------------------\n\nTITLE: Checking Untrusted Font Blocking registry setting in OSSEC\nDESCRIPTION: Verifies that 'Untrusted Font Blocking' is set to 'Enabled: Block untrusted fonts and log events' by checking if the MitigationOptions_FontBocking registry value equals 1000000000000 in the MitigationOptions registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\MitigationOptions -> MitigationOptions_FontBocking -> !1000000000000;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Data Sharing Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables handwriting personalization data sharing. Checks for the presence of the PreventHandwritingDataSharing registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 95-97 Workbooks\nDESCRIPTION: Inspects registry values to ensure Excel 95-97 workbooks and templates are blocked in Microsoft Excel 2016. These older file formats can contain vulnerable features that present security risks.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl9597workbooksandtemplates -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl9597workbooksandtemplates;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Saving Prevention\nDESCRIPTION: Validates that saving passwords in Terminal Services is disabled by ensuring the DisablePasswordSaving registry value is set to 1 or exists per CIS benchmark 18.9.52.2.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !DisablePasswordSaving;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network security: Minimum session security for NTLM SSP clients' setting\nDESCRIPTION: Registry check to ensure NTLM SSP client session security requires NTLMv2 and 128-bit encryption, enhancing secure communications.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinClientSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinClientSec;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Local Firewall Rules Setting\nDESCRIPTION: Checks if the Windows Firewall Domain Profile is correctly configured to apply local firewall rules. The rule verifies registry keys in both policy and current configuration locations to ensure the AllowLocalPolicyMerge value is not set to 0.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Partition /home without 'nodev' Option in OSSEC\nDESCRIPTION: This rule checks if the /home partition in /etc/fstab is mounted without the 'nodev' option. The rule verifies that non-commented ext2/ext3 entries for /home do not include the nodev mount option, which is a security vulnerability according to CIS benchmark 7.1.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/home && !r:nodev ;\n```\n\n----------------------------------------\n\nTITLE: Checking Input Personalization Setting in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Allow input personalization' is set to 'Disabled' according to CIS benchmark 18.1.2.2. The rule identifies non-compliant configurations by detecting both incorrect registry values and missing registry keys.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.1.2.2 Ensure 'Allow input personalization' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.1.2.2 Ensure 'Allow input personalization' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization -> AllowInputPersonalization -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization -> !AllowInputPersonalization;\n```\n\n----------------------------------------\n\nTITLE: Checking Source Routing Configuration\nDESCRIPTION: Verifies that source routed packet acceptance is disabled. Part of CIS SLES12 benchmark section 7.2.1.\n\nLANGUAGE: shell\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer Scripts Security Prompt Setting\nDESCRIPTION: This rule verifies that 'Prevent Internet Explorer security prompt for Windows Installer scripts' is set to 'Disabled' by checking the SafeForScripting registry key is not set to 0, in compliance with CIS benchmark 18.9.74.3.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> SafeForScripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking FTP Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify FTP Server (vsftpd) is not enabled in run-level directories as per CIS Benchmark 6.9.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:vsftpd;\n```\n\n----------------------------------------\n\nTITLE: Detecting Disabled TCP SYN Cookies in RHEL7\nDESCRIPTION: OSSEC rule that checks if TCP SYN cookies are disabled, which would violate CIS benchmark 4.2.8 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.2.8 - Network parameters - SYN Cookies not enabled {CIS: 4.2.8 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/tcp_syncookies -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Command Line Inclusion in Process Creation Events\nDESCRIPTION: Verifies that command line inclusion in process creation events is disabled by checking if ProcessCreationIncludeCmdLine_Enabled is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit -> ProcessCreationIncludeCmdLine_Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Do not delete temp folders upon exit' Registry Setting\nDESCRIPTION: Registry check to ensure 'Do not delete temp folders upon exit' is disabled per CIS benchmark 18.9.52.3.11.1. Verifies the DeleteTempDirsOnExit value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DeleteTempDirsOnExit -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Complexity in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Password Settings: Password Complexity' is set to 'Enabled: Large letters + small letters + numbers + special characters' by checking the PasswordComplexity value is set to 4.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordComplexity -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Mobile Hotspot Service Status in Windows Registry\nDESCRIPTION: Verifies that the Windows Mobile Hotspot Service (icssvc) is set to 'Disabled' per CIS benchmark 5.36. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\icssvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\icssvc -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Windows Store Access Check in OSSEC\nDESCRIPTION: Verifies access to the Windows Store is disabled by checking if the NoUseStoreOpenWith registry value is set to 1 in the Explorer policy path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.8.20.1.1: Ensure 'Turn off access to the Store' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoUseStoreOpenWith -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoUseStoreOpenWith;\n```\n\n----------------------------------------\n\nTITLE: Detecting SNMP server in SLES11\nDESCRIPTION: Checks if the SNMP daemon service is enabled in the runlevel directories, which should be disabled if not needed for monitoring.\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables printing over HTTP. Checks for the presence of the DisableHTTPPrinting registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Router Advertisements in OSSEC\nDESCRIPTION: OSSEC rules to verify IPv6 Router Advertisements are disabled as per CIS Benchmark 7.3.1, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.all.accept_ra=1;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.all.accept_ra=0;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.default.accept_ra=1;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.default.accept_ra=0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled Kudzu Hardware Detection Service (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if the Kudzu hardware detection service is enabled at boot time, which can present a security risk. The rule looks for Kudzu startup scripts in the rc directories.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - Disable standard boot services - Kudzu hardware detection Enabled] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dkudzu$;\n```\n\n----------------------------------------\n\nTITLE: Detecting chargen Service in xinetd\nDESCRIPTION: Checks for enabled chargen service in xinetd configuration. Part of CIS SLES12 benchmark section 5.3.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/chargen -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Connection Security Rules Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile does not apply local connection security rules. Validates registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.6.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Shutdown: Allow system to be shut down without having to log on' setting\nDESCRIPTION: Registry check to ensure systems cannot be shut down without logging on first, preventing unauthorized shutdowns from the login screen.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ShutdownWithoutLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Virtualization Settings in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Virtualize file and registry write failures to per-user locations' is enabled. Checks if the EnableVirtualization registry value is set to 0, which would indicate the policy is disabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableVirtualization -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking IMAP and POP Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify IMAP and POP server (dovecot) is not enabled in run-level directories as per CIS Benchmark 6.11.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:dovecot;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify HTTP Server (apache2) is not enabled in run-level directories as per CIS Benchmark 6.10.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:apache2;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Warning Days\nDESCRIPTION: Verifies if appropriate password expiration warning days are configured in login.defs. This setting ensures users receive advance notice before their passwords expire, allowing them to change passwords in a timely manner.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/login.defs -> !r:^PASS_WARN_DAYS\\s+\\d+;\nf:/etc/login.defs -> !r:^# && r:PASS_WARN_DAYS\\s+1;\nf:/etc/login.defs -> !r:^# && r:PASS_WARN_DAYS\\s+2;\nf:/etc/login.defs -> !r:^# && r:PASS_WARN_DAYS\\s+3;\nf:/etc/login.defs -> !r:^# && r:PASS_WARN_DAYS\\s+4;\nf:/etc/login.defs -> !r:^# && r:PASS_WARN_DAYS\\s+5;\nf:/etc/login.defs -> !r:^# && r:PASS_WARN_DAYS\\s+6;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Client Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if the Windows NTP Client is enabled, as per CIS benchmark 18.8.44.1.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> Enabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> !Enabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying OCSP Stapling Configuration in Apache\nDESCRIPTION: Rules to check that OCSP Stapling is properly enabled, which improves SSL certificate validation performance and privacy.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/httpd/conf/httpd.conf -> !r:^loadmodule\\s+ssl;\nd:$mods-en -> !f:ssl.load;\nf:$ssl-confs -> !r:\\t*\\s*# && r:sslusestapling\\s+off;\nf:$ssl-confs -> !r:\\t*\\s*sslusestapling\\s+on;\nf:$ssl-confs -> !r:\\t*\\s*sslstaplingcache\\s+\\.+;\n```\n\n----------------------------------------\n\nTITLE: Detecting TFTP Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that checks if TFTP server is enabled through xinetd or systemd. This implements CIS benchmark 2.1.8 by examining the relevant configuration files for TFTP service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/tftp.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Detecting time-udp Service in xinetd\nDESCRIPTION: Checks for enabled time-udp service in xinetd configuration. Part of CIS SLES12 benchmark section 5.10.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/time-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Administrator Account Enumeration Setting in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Enumerate administrator accounts on elevation' is set to 'Disabled' in Windows registry. Ensures the EnumerateAdministrators value is set to 0 in the CredUI policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI -> EnumerateAdministrators -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous enumeration of SAM accounts restriction\nDESCRIPTION: Verifies that anonymous users are prevented from enumerating SAM accounts by checking that RestrictAnonymousSAM registry value is not set to 0.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymousSAM -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Successful Connections Logging in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile is set to log successful connections per CIS benchmark 9.1.8. The check confirms the LogSuccessfulConnections value is not set to 0 across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Shell Access Settings in Registry\nDESCRIPTION: This rule verifies that Remote Shell Access is disabled by checking if the AllowRemoteShellAccess registry key is set to 0. The rule triggers if the key is missing or not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> AllowRemoteShellAccess -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> !AllowRemoteShellAccess;\n```\n\n----------------------------------------\n\nTITLE: Verifying Secure Filesystem Mount Options in Red Hat Linux\nDESCRIPTION: Security checks to ensure partitions are mounted with appropriate security options. These rules verify that partitions like /var, /tmp, /opt, and /home have the 'nodev' option set to prevent execution of device files, and that removable media has both 'nodev' and 'nosuid' set.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/var && !r:nodev;\n\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/tmp && !r:nodev;\n\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/opt && !r:nodev;\n\nf:/etc/fstab -> !r:^# && r:ext2|ext3 && r:/home && !r:nodev ;\n\nf:/etc/fstab -> !r:^# && r:/media && !r:nodev;\n\nf:/etc/fstab -> !r:^# && r:/media && !r:nosuid;\n\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Checking IP Forwarding in SLES11\nDESCRIPTION: Verifies that IP forwarding is disabled in both IPv4 and IPv6 stacks for security. IP forwarding should only be enabled on systems acting as routers.\n\nLANGUAGE: regex\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Name\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Private: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' as required by CIS benchmark 9.3.7 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP Keep-Alive Time Configuration\nDESCRIPTION: Verifies that 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 300,000 (5 minutes). This rule checks the registry to ensure proper TCP keep-alive timing for network connections.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n```\n\n----------------------------------------\n\nTITLE: Defining Basic OSSEC Configuration Options in Portuguese\nDESCRIPTION: Sets up the basic yes/no responses and installation type options in Portuguese for the OSSEC HIDS installation script.\n\nLANGUAGE: Bash\nCODE:\n```\n# Configurao\nyes=\"s\"\nno=\"n\"\nyesmatch=\"s\"\nnomatch=\"n\"\nserver=\"servidor\"\nagent=\"cliente\"\nlocal=\"local\"\nhelp=\"ajuda\"\n```\n\n----------------------------------------\n\nTITLE: Checking Advertising ID Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off the advertising ID' is set to 'Enabled' per CIS benchmark 18.8.41.1. The check verifies that the DisabledByGroupPolicy registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> DisabledByGroupPolicy -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> !DisabledByGroupPolicy;\n```\n\n----------------------------------------\n\nTITLE: Verifying Terminal Services Client Connection Encryption Level\nDESCRIPTION: Checks that Terminal Services client connection encryption level is set to High Level by ensuring the MinEncryptionLevel registry value is set to 3 per CIS benchmark 18.9.52.3.9.3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MinEncryptionLevel -> !3;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows PushToInstall Service Disabled Status\nDESCRIPTION: Verifies that the Windows PushToInstall Service is disabled by checking if its Start registry value is set to 4 or that the Start value exists. Implements CIS benchmark 5.38.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PushToInstall -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PushToInstall -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Inbound Connections Setting in Windows Registry\nDESCRIPTION: Checks that 'Windows Firewall: Domain: Inbound connections' is set to 'Block' by verifying DefaultInboundAction registry value is not 0 in policy and current settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv4 Source Routing Protection in OSSEC\nDESCRIPTION: OSSEC rule that verifies IPv4 source routing protection is set to highest level. It checks if DisableIPSourceRouting is set to 2 or if the key doesn't exist in the Tcpip parameters registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Checking rsync Service Configuration in OSSEC\nDESCRIPTION: OSSEC rules to verify rsync service is not enabled as per CIS Benchmark 6.16, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/default/rsync -> !r:^# && r:RSYNC_ENABLE=true|inetd;\nf:/etc/default/rsync -> !r:^RSYNC_ENABLE=false;\n```\n\n----------------------------------------\n\nTITLE: Checking User-Mounted Removable Partitions in OSSEC\nDESCRIPTION: OSSEC rule to detect user-mounted removable partitions (CD-ROM and floppy) configurations allowed on the console, which could pose security risks by allowing users to mount potentially malicious media.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - X.X.X - User-mounted removable partition allowed on the console] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Checking Source Routed Packet Acceptance in OSSEC\nDESCRIPTION: OSSEC rules to verify Source Routed Packet Acceptance is disabled as per CIS Benchmark 7.2.1, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.all.accept_source_route=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.all.accept_source_route=0;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.default.accept_source_route=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.default.accept_source_route=0;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 TCP Data Retransmission Configuration\nDESCRIPTION: Verifies that IPv6 unacknowledged data retransmission limit is set to 3 by checking the TcpMaxDataRetransmissions registry value. Implements CIS benchmark 18.4.11.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Outbound Connections Setting in Windows Registry\nDESCRIPTION: Checks that 'Windows Firewall: Domain: Outbound connections' is set to 'Allow' by verifying DefaultOutboundAction registry value is not 1 in policy and current settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Detecting NIS Client in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if NIS client (ypbind) is enabled in the system. This implements CIS benchmark 2.1.5 by checking both legacy init scripts and systemd service files.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dypbind$;\nf:/usr/lib/systemd/system/ypbind.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: MySQL Error Log Configuration Check in OSSEC\nDESCRIPTION: Verifies that log_error is configured properly per CIS recommendation 6.1. The error log contains diagnostic information and errors that could indicate security issues.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.1: log-error is not set in my.cnf] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> r:^# && r:log_error\\s*=\\s*\\S+\\s*;\nf:$mysql-cnfs -> !r:log_error\\s*=\\s*\\S+\\s*;\nf:$mysql-cnfs -> r:log_error\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Auditing Successful File System Mounts in Debian Linux\nDESCRIPTION: Configuration for auditing successful file system mounts according to CIS Benchmark 8.1.13. It sets up monitoring for mount operations performed by non-system users to track when filesystems are mounted.\n\nLANGUAGE: auditd\nCODE:\n```\n-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=4294967295 -k mounts\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Connection Disable Registry Setting\nDESCRIPTION: Verifies that users cannot connect remotely using Remote Desktop Services by checking the fDenyTSConnections registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDenyTSConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Behavior\nDESCRIPTION: Ensures that the Application Event Log is configured to disable automatic log clearing when the log file reaches its maximum size by checking the Retention registry value.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> Retention -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for User Input Methods Settings\nDESCRIPTION: Verifies that 'Disallow copying of user input methods to the system account for sign-in' is enabled by checking for BlockUserInputMethodsForSignIn=1 in the registry. This prevents potential security issues with input method customizations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> BlockUserInputMethodsForSignIn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> !BlockUserInputMethodsForSignIn;\n```\n\n----------------------------------------\n\nTITLE: Checking Word Security File Block Settings for Word 95 Documents\nDESCRIPTION: Inspects registry values to confirm that Word 95 binary documents and templates are blocked in Microsoft Word 2016. Blocking these legacy formats helps prevent potential security exploits.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> word95files -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> !word95files;\n```\n\n----------------------------------------\n\nTITLE: Detecting discard-udp on xinetd in SLES11\nDESCRIPTION: Checks if discard-udp service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/discard-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Offer Remote Assistance\nDESCRIPTION: OSSEC rule that checks if 'Configure Offer Remote Assistance' is set to 'Disabled' by verifying the fAllowUnsolicited registry key is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Warning Threshold in Windows Registry\nDESCRIPTION: OSSEC rule to verify that the security event log warning threshold is set to 90% or less. The rule checks if the WarningLevel registry value is configured appropriately in the Windows event log security service.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Local Rules Setting\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Apply local firewall rules' is enabled by checking the AllowLocalPolicyMerge registry value in both policy and current configuration locations.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop PnP Device Redirection Disable Setting\nDESCRIPTION: Verifies that Plug and Play device redirection in Remote Desktop Services is disabled by checking the fDisablePNPRedir registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisablePNPRedir -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisablePNPRedir;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Remote Management Service Disabled Status\nDESCRIPTION: Verifies that the Windows Remote Management (WS-Management) service is disabled by checking if its Start registry value is set to 4 or that the Start value exists. Implements CIS benchmark 5.39.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WinRM -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WinRM -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Size Limit\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile logging size is 16,384 KB or greater. Uses regex patterns to match various size configurations in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check for martian packet logging\nDESCRIPTION: Checks if logging of martian packets (with impossible addresses) is enabled by verifying if the value is not set to 0.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/log_martians -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Redirect Acceptance in OSSEC\nDESCRIPTION: OSSEC rules to verify IPv6 Redirect Acceptance is disabled as per CIS Benchmark 7.3.2, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.all.accept_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.all.accept_redirects=0;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.default.accept_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.default.accept_redirects=0;\n```\n\n----------------------------------------\n\nTITLE: Checking RFC Source Route Validation Configuration\nDESCRIPTION: Rule to check if RFC-recommended source route validation is disabled. According to CIS SLES12 benchmark 7.2.7, this validation should be enabled (set to 1) for security.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/rp_filter -> 0;\nf:/proc/sys/net/ipv4/conf/default/rp_filter -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP SYN Cookies Configuration in Linux\nDESCRIPTION: Verifies that TCP SYN cookies are properly enabled as per CIS-RHEL6 section 4.2.8. This check examines the kernel parameter that controls SYN cookie protection against SYN flood attacks for security compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/proc/sys/net/ipv4/tcp_syncookies -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Sharing Service Setting\nDESCRIPTION: Verifies that 'Internet Connection Sharing (ICS) (SharedAccess)' is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SharedAccess -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking User Control Over Software Installations\nDESCRIPTION: OSSEC rule to verify that user control over software installations is disabled according to CIS benchmark 18.9.85.1. Checks if EnableUserControl is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.85.1 Ensure 'Allow user control over installs' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.85.1 Ensure 'Allow user control over installs' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Randomized Virtual Memory Placement in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that verifies randomized virtual memory region placement is enabled. This implements CIS benchmark 1.6.1 (also labeled 1.6.3) by checking if randomize_va_space is set to 2.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/proc/sys/kernel/randomize_va_space -> !r:^2$;\n```\n\n----------------------------------------\n\nTITLE: Checking Insider Builds Control in Windows 10\nDESCRIPTION: Verifies that 'Toggle user control over Insider builds' is set to 'Disabled' by checking registry values related to AllowBuildPreview.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.16.5 Ensure 'Toggle user control over Insider builds' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> AllowBuildPreview -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> !AllowBuildPreview;\n```\n\n----------------------------------------\n\nTITLE: Checking Cortana on Lock Screen Configuration in Registry\nDESCRIPTION: Confirms that Cortana is disabled on the lock screen by checking if the AllowCortanaAboveLock registry value is not set to 0 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowCortanaAboveLock -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !AllowCortanaAboveLock;\n```\n\n----------------------------------------\n\nTITLE: Checking Push To Install Service Disable Registry Setting\nDESCRIPTION: Verifies that the Push To Install service is disabled by checking the DisablePushToInstall registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PushToInstall -> DisablePushToInstall -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PushToInstall -> !DisablePushToInstall;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Client Connection Encryption Level in Registry\nDESCRIPTION: Verifies that Terminal Services client connection encryption level is set to high by checking if the MinEncryptionLevel registry value is not set to 3.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MinEncryptionLevel -> !3;\n```\n\n----------------------------------------\n\nTITLE: Windows IPv4 TCP Data Retransmission Check in OSSEC\nDESCRIPTION: Verifies the TCP IPv4 data retransmission value is correctly set to 3 retries by checking the TcpMaxDataRetransmissions registry value in the TCP/IP parameters.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.3.11: Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry Policy Background Processing in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Configure registry policy processing: Do not apply during periodic background processing' is set to 'Enabled: FALSE'. This ensures registry policies are applied during periodic background processing for security consistency.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoBackgroundPolicy;\n```\n\n----------------------------------------\n\nTITLE: Detecting daytime-udp on xinetd in SLES11\nDESCRIPTION: Checks if daytime-udp service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/daytime-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Inbound Connections in Registry\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Inbound connections' is set to 'Block (default)'. Checks if the DefaultInboundAction registry value is set to 0, which would indicate inbound connections are allowed (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Local Users Enumeration on Domain Computers\nDESCRIPTION: Ensures local users are not enumerated on domain-joined computers by verifying EnumerateLocalUsers is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnumerateLocalUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking COM Port Redirection Prevention in Remote Desktop Services\nDESCRIPTION: Registry checks to ensure COM port redirection is disabled in Remote Desktop Services, enforcing CIS Windows Server 2016 benchmark rule 18.9.52.3.3.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCcm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCcm;\n```\n\n----------------------------------------\n\nTITLE: Checking Suspicious Packet Logging in OSSEC\nDESCRIPTION: OSSEC rules to verify Suspicious Packet Logging is enabled as per CIS Benchmark 7.2.4, checking both for explicit disabling and lack of explicit enabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.all.log_martians=0;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.all.log_martians=1;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.default.log_martians=0;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.default.log_martians=1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Support Diagnostic Tool Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled' by verifying the DisableQueryRemoteServer registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.44.5.1 Ensure 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> DisableQueryRemoteServer -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> !DisableQueryRemoteServer;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Event Collector Service Disabled Status\nDESCRIPTION: Verifies that the Windows Event Collector (Wecsvc) is disabled by checking if its Start registry value is set to 4 or that the Start value exists. Implements CIS benchmark 5.34.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Wecsvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Wecsvc -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Log Size Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile logging has sufficient size limit. Uses regex to validate the log file size in registry keys from both policy and current configuration locations as required by CIS benchmark 9.3.8.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rules to check for IP forwarding enabled\nDESCRIPTION: Checks if IP forwarding is enabled for IPv4 and IPv6 by verifying if the value in proc files is set to 1.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Validating hosts.deny Configuration\nDESCRIPTION: Rules for checking proper configuration of /etc/hosts.deny according to CIS benchmark 7.4.4. Verifies the file exists and has proper deny rules for all hosts.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.4.4 Create /etc/hosts.deny\n[CIS - Debian Linux 7/8 - 7.4.4 Create /etc/hosts.deny] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/hosts.deny;\nf:/etc/hosts.deny -> !r:^ALL:\\s*ALL;\n```\n\n----------------------------------------\n\nTITLE: Checking Source Route Validation in OSSEC\nDESCRIPTION: OSSEC rules to verify RFC-recommended Source Route Validation is enabled as per CIS Benchmark 7.2.7, checking both for explicit disabling and lack of explicit enabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.all.rp_filter=0;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.all.rp_filter=1;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.default.rp_filter=0;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.default.rp_filter=1;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Prevent downloading of enclosures' Registry Setting\nDESCRIPTION: Registry check to ensure 'Prevent downloading of enclosures' is enabled per CIS benchmark 18.9.53.1. Verifies the DisableEnclosureDownload value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> DisableEnclosureDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> !DisableEnclosureDownload;\n```\n\n----------------------------------------\n\nTITLE: Detecting Tcpmux-server Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if tcpmux-server service is enabled through xinetd. This implements CIS benchmark 2.1.18 by checking the relevant xinetd configuration file for service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/tcpmux-server -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Sharing Policy in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Prohibit use of Internet Connection Sharing on your DNS domain network' is set to 'Enabled'. This prevents users from setting up unauthorized ICS services that could expose internal networks to outside threats.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_ShowSharedAccessUI -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_ShowSharedAccessUI;\n```\n\n----------------------------------------\n\nTITLE: MySQL Suspicious UDFs Check in OSSEC\nDESCRIPTION: Verifies that allow-suspicious-udfs is set to FALSE per CIS recommendation 4.3. This setting prevents loading of suspicious User Defined Functions that could potentially be exploited.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 4.3: 'allow-suspicious-udfs' Is Set in my.cnf'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:allow-suspicious-udfs\\.+true;\nf:$mysql-cnfs -> r:allow-suspicious-udfs\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Xbox Live Game Save Service Status in Windows Registry\nDESCRIPTION: Verifies that the Xbox Live Game Save service (XblGameSave) is set to 'Disabled' per CIS benchmark 5.45. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XblGameSave -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XblGameSave -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Temp Folder Deletion in Registry\nDESCRIPTION: Confirms that Terminal Services is configured to delete temp folders upon exit by checking if the DeleteTempDirsOnExit registry value is not set to 1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DeleteTempDirsOnExit -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Basic Authentication Settings\nDESCRIPTION: OSSEC rule to verify WinRM client is configured to disallow Basic authentication according to CIS benchmark 18.9.97.1.1. Checks if AllowBasic is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.97.1.1 Ensure 'Allow Basic authentication' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.97.1.1 Ensure 'Allow Basic authentication' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Search and Cortana Location Usage in Registry\nDESCRIPTION: Confirms that search and Cortana are not allowed to use location by checking if the AllowSearchToUseLocation registry value is not set to 0 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowSearchToUseLocation -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !AllowSearchToUseLocation;\n```\n\n----------------------------------------\n\nTITLE: Checking PIN Sign-in Registry Setting in Windows 10\nDESCRIPTION: Verifies that 'Turn on convenience PIN sign-in' is set to 'Disabled' by checking the AllowDomainPINLogon registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.27.7 Ensure 'Turn on convenience PIN sign-in' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Watson Events Configuration in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'DisableGenericRePorts' registry setting for Windows Defender. This rule checks for compliance with CIS recommendation 18.9.76.9.1, ensuring Watson events are configured properly.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting -> DisableGenericRePorts -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting -> !DisableGenericRePorts;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Empty Passwords Configuration\nDESCRIPTION: Rule to check if SSH permits empty passwords. According to CIS SLES12 benchmark 9.2.9, PermitEmptyPasswords should be set to no to prevent unauthorized access.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\nf:/etc/ssh/sshd_config -> r:^#\\s*PermitEmptyPasswords;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Successful Connections Logging\nDESCRIPTION: Verifies that the Windows Firewall Private Profile logging of successful connections is enabled as required by CIS benchmark 9.2.10. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC UIAccess Applications Elevation Settings\nDESCRIPTION: Verifies that 'User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop' is disabled by checking the EnableUIADesktopToggle registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging Path\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile has correct logging path. Uses regex to verify LogFilePath is set correctly in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Server Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Enable Windows NTP Server' is set to 'Disabled' by verifying the Enabled registry value is set to 0 under the W32Time NtpServer TimeProviders path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.49.1.2 Ensure 'Enable Windows NTP Server' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpServer -> Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Protocol Version Setting\nDESCRIPTION: Verifies if SSH is configured to use the insecure Protocol version 1. This test checks the SSH configuration file for any non-commented line enabling Protocol 1, which has known security vulnerabilities.\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn on convenience PIN sign-in registry setting in OSSEC\nDESCRIPTION: Verifies that 'Turn on convenience PIN sign-in' is set to 'Disabled' by checking if the AllowDomainPINLogon registry value equals 0 in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Inbound Connections\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile has inbound connections set to 'Block'. Verifies DefaultInboundAction is not set to 0 in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking DCCP Protocol Disabling\nDESCRIPTION: Rules for verifying that the DCCP protocol is properly disabled according to CIS benchmark 7.5.1. Checks for configuration in the CIS.conf file.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.5.1 Disable DCCP\n[CIS - Debian Linux 7/8 - 7.5.1 Disable DCCP] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install dccp /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows App Privacy Settings in Registry with OSSEC\nDESCRIPTION: Verifies that various Windows app permissions are set to 'Force Deny' by checking if each permission value is set to 2 in the registry. This restricts apps from accessing sensitive user information and hardware like location, camera, and contacts.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessAccountInfo -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessAccountInfo;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessCallHistory -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessCallHistory;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessContacts -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessContacts;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessEmail -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessEmail;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessLocation -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessLocation;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessMessaging -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessMessaging;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessMotion -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessMotion;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessCalendar -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessCalendar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessCamera -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessCamera;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessMicrophone -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessMicrophone;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessTrustedDevices -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessTrustedDevices;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessRadios -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessRadios;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsSyncWithDevices -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsSyncWithDevices;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessPhone -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessPhone;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> LetAppsAccessNotifications -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy -> !LetAppsAccessNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking Kerberos Encryption Types in Windows 10\nDESCRIPTION: Verifies that 'Network security: Configure encryption types allowed for Kerberos' is set to 'AES128_HMAC_SHA1, AES256_HMAC_SHA1, Future encryption types' by checking that the SupportedEncryptionTypes registry value is set to 2147483644.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters -> SupportedEncryptionTypes -> !2147483644;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Kerberos\\Parameters -> !SupportedEncryptionTypes;\n```\n\n----------------------------------------\n\nTITLE: Checking LILO Password Configuration in OSSEC\nDESCRIPTION: This rule checks if LILO bootloader has password protection configured in /etc/lilo.conf. The rule identifies when both 'restricted' and 'password=' settings are missing, which fails to meet CIS benchmark 8.8 requirements.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/lilo.conf -> !r:^# && !r:restricted;\nf:/etc/lilo.conf -> !r:^# && !r:password=;\n```\n\n----------------------------------------\n\nTITLE: Checking SafeDllSearchMode Settings in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'MSS: (SafeDllSearchMode) Enable Safe DLL search mode' is set to 'Enabled' for improved security by checking if the value is set to 0 (disabled).\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Record Events That Modify User/Group Information Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.5 that verifies if auditd is configured to record events that modify user and group information. It checks for audit rules monitoring critical identity files to detect unauthorized changes to user accounts.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.5 Record Events That Modify User/Group Information] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-w /etc/group -p wa -k identity;\nf:/etc/audit/audit.rules -> !r:^-w /etc/passwd -p wa -k identity;\nf:/etc/audit/audit.rules -> !r:^-w /etc/gshadow -p wa -k identity;\nf:/etc/audit/audit.rules -> !r:^-w /etc/shadow -p wa -k identity;\nf:/etc/audit/audit.rules -> !r:^-w /etc/security/opasswd -p wa -k identity;\n```\n\n----------------------------------------\n\nTITLE: Packaging cJSON for Linux Distribution\nDESCRIPTION: Commands to build and package cJSON for a Linux distribution. Configures with utils enabled, tests disabled, and a custom installation prefix.\n\nLANGUAGE: bash\nCODE:\n```\nmkdir build\ncd build\ncmake .. -DENABLE_CJSON_UTILS=On -DENABLE_CJSON_TEST=Off -DCMAKE_INSTALL_PREFIX=/usr\nmake\nmake DESTDIR=$pkgdir install\n```\n\n----------------------------------------\n\nTITLE: Checking Adobe Flash Click-to-Run Setting in Registry\nDESCRIPTION: Validates that the Adobe Flash Click-to-Run setting is enabled by checking if the FlashClickToRunMode registry value is not set to 1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Security -> FlashClickToRunMode -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking PIN Requirement for Pairing in Windows 10\nDESCRIPTION: Verifies that 'Require pin for pairing' is set to 'Enabled' by checking registry values related to RequirePinForPairing.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.14.1 Ensure 'Require pin for pairing' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Connect -> RequirePinForPairing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Connect -> !RequirePinForPairing;\n```\n\n----------------------------------------\n\nTITLE: Checking for Elevated Installation Privileges\nDESCRIPTION: OSSEC rule to ensure that Windows Installer does not always install with elevated privileges according to CIS benchmark 18.9.85.2. Verifies AlwaysInstallElevated is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.85.2 Ensure 'Always install with elevated privileges' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.85.2 Ensure 'Always install with elevated privileges' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> AlwaysInstallElevated -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking MSA Optional Registry Settings for Windows Server\nDESCRIPTION: Verifies registry settings to ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled' as per CIS benchmark 18.9.6.1. Checks if MSAOptional registry value exists and is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Bridge Configuration for Windows Server\nDESCRIPTION: Verifies that installation and configuration of Network Bridge is prohibited on the DNS domain network. Detects non-compliance when NC_AllowNetBridge_NLA is set to 1 or missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Detecting time Service in xinetd\nDESCRIPTION: Checks for enabled time service in xinetd configuration. Part of CIS SLES12 benchmark section 5.11.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/time -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Always install with elevated privileges' Registry Setting\nDESCRIPTION: Registry check to ensure 'Always install with elevated privileges' is disabled per CIS benchmark 18.9.74.2. Verifies the AlwaysInstallElevated value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> AlwaysInstallElevated -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager authentication level\nDESCRIPTION: Verifies that 'Network security: LAN Manager authentication level' is set to 'Send NTLMv2 response only. Refuse LM & NTLM' by checking the LmCompatibilityLevel registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 3;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 4;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !LmCompatibilityLevel;\n```\n\n----------------------------------------\n\nTITLE: Validating Disconnected Session Time Limits for Terminal Services\nDESCRIPTION: Ensures that disconnected Remote Desktop Services sessions have appropriate time limits set to 1 minute. This check validates compliance with CIS benchmark item 18.9.52.3.10.2 by verifying the MaxDisconnectionTime registry value is set to EA60 (1 minute).\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxDisconnectionTime;\n```\n\n----------------------------------------\n\nTITLE: Checking for User .netrc Files in Solaris 11\nDESCRIPTION: This rule searches for .netrc files in user home directories. These files may contain login credentials in plaintext, creating a security risk if not properly secured.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$home_dirs -> ^.netrc$;\n```\n\n----------------------------------------\n\nTITLE: Checking Secure Desktop Prompting Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Switch to the secure desktop when prompting for elevation' is set to 'Enabled' by checking if the PromptOnSecureDesktop registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> PromptOnSecureDesktop -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Telnet Server in xinetd and systemd\nDESCRIPTION: Checks for enabled telnet service in xinetd configuration and systemd service files. Part of CIS SLES12 benchmark section 5.1.7.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/telnet@.service -> r:ExecStart=-/usr/sbin/in.telnetd;\n```\n\n----------------------------------------\n\nTITLE: Checking Do not display the password reveal button registry setting in OSSEC\nDESCRIPTION: Verifies that 'Do not display the password reveal button' is set to 'Enabled' by checking if the DisablePasswordReveal registry value equals 1 and that the key exists in the CredUI registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> DisablePasswordReveal -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> !DisablePasswordReveal;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile LogFileSize in Registry\nDESCRIPTION: Registry check for Windows Firewall Domain profile logging size limit. Verifies that LogFileSize is 16384 KB or greater by checking various digit patterns in both policy and current settings locations.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Verifying at/cron Access Restrictions\nDESCRIPTION: Rules for checking that access to at and cron is properly restricted according to CIS benchmark 9.1.8. Ensures the existence of allow files for proper access control.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.1.8 Restrict at/cron to Authorized Users\n[CIS - Debian Linux 7/8 - 9.1.8 Restrict at/cron to Authorized Users] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/cron.allow;\nf:!/etc/at.allow;\n```\n\n----------------------------------------\n\nTITLE: MySQL Audit Log Statement Policy Check in OSSEC\nDESCRIPTION: Checks if audit_log_statement_policy is set to 'all' per CIS recommendation 6.10. This controls which statements are written to the audit log based on status.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.10: Ensure audit_log_statement_policy is set to all] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:audit_log_statement_policy\\.+errors;\nf:$mysql-cnfs -> !r:^# && r:audit_log_statement_policy\\.+none;\nf:$mysql-cnfs -> r:audit_log_statement_policy\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking NTLM SSP server minimum session security\nDESCRIPTION: Verifies that 'Network security: Minimum session security for NTLM SSP servers' is set to require NTLMv2 and 128-bit encryption by checking the NTLMMinServerSec registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> NTLMMinServerSec -> !537395200;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !NTLMMinServerSec;\n```\n\n----------------------------------------\n\nTITLE: Verifying Terminal Services Drive Redirection Prevention\nDESCRIPTION: Checks that drive redirection in Terminal Services is disabled by ensuring the fDisableCdm registry value is set to 1 or exists per CIS benchmark 18.9.52.3.3.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCdm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCdm;\n```\n\n----------------------------------------\n\nTITLE: Verifying Safe DLL Search Mode Settings\nDESCRIPTION: Checks if Safe DLL search mode is enabled by verifying the SafeDllSearchMode registry value is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager -> SafeDllSearchMode -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Access Limitations in sshd_config\nDESCRIPTION: Verifies if proper SSH access restrictions (AllowUsers, AllowGroups, DenyUsers, or DenyGroups) are configured in the SSH daemon configuration file. These settings limit which users or groups can connect via SSH, enhancing system security.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^AllowUsers\\s+\\w+|^AllowGroups\\s+\\w+|^DenyUsers\\s+\\w+|^DenyGroups\\s+\\w+;\n```\n\n----------------------------------------\n\nTITLE: Initializing Zlib CMake Project with Version Configuration\nDESCRIPTION: Sets up the CMake project for zlib with version 1.2.11 and configures basic project options including assembly implementation options for i686 and amd64 platforms.\n\nLANGUAGE: CMake\nCODE:\n```\ncmake_minimum_required(VERSION 2.4.4)\nset(CMAKE_ALLOW_LOOSE_LOOP_CONSTRUCTS ON)\n\nproject(zlib C)\n\nset(VERSION \"1.2.11\")\n\noption(ASM686 \"Enable building i686 assembly implementation\")\noption(AMD64 \"Enable building amd64 assembly implementation\")\n```\n\n----------------------------------------\n\nTITLE: Validating Windows Ink Workspace Suggested Apps Settings\nDESCRIPTION: Verifies that suggested apps in Windows Ink Workspace are disabled. This check ensures compliance with CIS benchmark item 18.9.73.1 by confirming the AllowSuggestedAppsInWindowsInkWorkspace registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> !AllowSuggestedAppsInWindowsInkWorkspace;\n```\n\n----------------------------------------\n\nTITLE: Checking block of account details display on sign-in\nDESCRIPTION: Verifies that users are blocked from showing account details on sign-in. This prevents exposure of potentially sensitive account information on the sign-in screen.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> BlockUserFromShowingAccountDetailsOnSignin -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !BlockUserFromShowingAccountDetailsOnSignin;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Services Idle Session Timeout in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'MaxIdleTime' registry setting for Remote Desktop Services idle session timeout. This rule checks for compliance with CIS recommendation 18.9.58.3.10.1, ensuring the timeout is set to 15 minutes or less.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba\\D;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbb\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbc\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbd\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbe\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbf\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbc\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbd\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbe\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbf\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dc\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dd\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:de\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:df\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:e\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:f\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:\\w\\w\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxIdleTime;\n```\n\n----------------------------------------\n\nTITLE: Detecting Accounts with Empty Passwords in OSSEC\nDESCRIPTION: This rule checks for user accounts with empty passwords in /etc/shadow file. The rule identifies entries with empty password fields (indicated by consecutive colons), which violates CIS benchmark 9.2 and PCI DSS requirement 10.2.5.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Detecting Accounts with Empty Passwords in OSSEC\nDESCRIPTION: This rule checks for user accounts with empty passwords in /etc/shadow file. The rule identifies entries with empty password fields (indicated by consecutive colons), which violates CIS benchmark 9.2 and PCI DSS requirement 10.2.5.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Checking Encrypted File Indexing Registry Setting\nDESCRIPTION: Verifies that indexing of encrypted files is disabled by checking if AllowIndexingEncryptedStoresOrItems is not set to 0, which prevents Windows Search from indexing encrypted files for security reasons.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowIndexingEncryptedStoresOrItems -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Warning Banner Configuration\nDESCRIPTION: Rule to verify a warning banner is enabled for the SSH service, as specified in CIS Solaris 11 benchmark section 8.2. This ensures legal notifications are presented to SSH users.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^Banner\\s*/etc/issue;\n```\n\n----------------------------------------\n\nTITLE: Checking PKU2U authentication settings\nDESCRIPTION: Verifies that 'Network Security: Allow PKU2U authentication requests to this computer to use online identities' is disabled by checking the AllowOnlineID registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\pku2u -> AllowOnlineID -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating SSH Protocol Version Setting\nDESCRIPTION: Rules for checking SSH protocol version settings according to CIS benchmark 9.3.1. Ensures SSH is configured to use only Protocol 2 for enhanced security.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.1 Set SSH Protocol to 2\n[CIS - Debian Linux 7/8 - 9.3.1 Set SSH Protocol to 2] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^# && r:protocol 1;\nf:/etc/ssh/sshd_config -> !r:^protocol 2$;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Restrictions for Local Accounts on Network Logons\nDESCRIPTION: OSSEC rule to verify that UAC restrictions are applied to local accounts on network logons. The rule checks if the LocalAccountTokenFilterPolicy registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> LocalAccountTokenFilterPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking User Input Methods for System Account Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled' by verifying the BlockUserInputMethodsForSignIn registry value is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.26.1 Ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> BlockUserInputMethodsForSignIn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> !BlockUserInputMethodsForSignIn;\n```\n\n----------------------------------------\n\nTITLE: Checking Input Personalization Setting\nDESCRIPTION: Registry check to ensure input personalization is disabled. Verifies AllowInputPersonalization is set to 0 and exists in the InputPersonalization policy path.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization -> AllowInputPersonalization -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization -> !AllowInputPersonalization;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off the offer to update to the latest version of Windows' Registry Setting\nDESCRIPTION: Registry check to ensure 'Turn off the offer to update to the latest version of Windows' is enabled per CIS benchmark 18.9.61.3. Verifies the DisableOSUpgrade value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Checking Admin Elevation Prompt Behavior Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode' is set to 'Prompt for consent on the secure desktop' by checking the ConsentPromptBehaviorAdmin registry value.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorAdmin;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check if X Windows is enabled\nDESCRIPTION: Checks if X Windows is enabled by verifying if runlevel 5 is set in the inittab file.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/inittab -> !r:^# && r:id:5;\n```\n\n----------------------------------------\n\nTITLE: Verifying PowerShell Transcription Registry Setting in Windows\nDESCRIPTION: Checks that 'Turn on PowerShell Transcription' is disabled by verifying the EnableTranscripting registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription -> EnableTranscripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Data Sharing Configuration in Registry\nDESCRIPTION: Verifies that 'Allow a Windows app to share application data between users' is set to 'Disabled' by confirming AllowSharedLocalAppData is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CurrentVersion\\AppModel\\StateManager -> AllowSharedLocalAppData -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Basic Authentication Settings in Registry\nDESCRIPTION: Registry check to ensure 'Allow Basic authentication' for WinRM service is set to 'Disabled' per CIS benchmark 18.9.86.2.1. This prevents WinRM service from accepting basic authentication which transmits credentials in clear text.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Fixed Huffman Code Lengths for DEFLATE\nDESCRIPTION: Specification of the fixed Huffman code lengths used for the literal/length alphabet in DEFLATE when BTYPE=01. Shows the bit lengths and actual codes for different value ranges.\n\nLANGUAGE: plain text\nCODE:\n```\n           Lit Value    Bits        Codes\n           ---------    ----        -----\n             0 - 143     8          00110000 through\n                                    10111111\n           144 - 255     9          110010000 through\n                                    111111111\n           256 - 279     7          0000000 through\n                                    0010111\n           280 - 287     8          11000000 through\n                                    11000111\n```\n\n----------------------------------------\n\nTITLE: Verifying hosts.allow Configuration\nDESCRIPTION: Rules for checking the existence and proper configuration of the /etc/hosts.allow file per CIS benchmark 7.4.2. Ensures the file exists and contains appropriate access rules.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.4.2 Create /etc/hosts.allow\n[CIS - Debian Linux 7/8 - 7.4.2 Create /etc/hosts.allow] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/hosts.allow;\nf:/etc/hosts.allow -> !r:^ALL:\\.*;\n```\n\n----------------------------------------\n\nTITLE: Verifying SSH IgnoreRhosts Configuration\nDESCRIPTION: Checks if SSH is configured to ignore .rhosts files. This test verifies if IgnoreRhosts is set to 'no', which is insecure and could allow unauthenticated access to the system.\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge SmartScreen for Files Settings in Registry with OSSEC\nDESCRIPTION: Verifies that 'Prevent bypassing SmartScreen prompts for files' is enabled by checking if PreventOverrideAppRepUnknown is set to 1. This helps protect users from downloading potentially malicious files.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> PreventOverrideAppRepUnknown -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> !PreventOverrideAppRepUnknown;\n```\n\n----------------------------------------\n\nTITLE: Checking background refresh of Group Policy\nDESCRIPTION: Verifies that the background refresh of Group Policy is enabled (not turned off). This ensures that policy updates are regularly applied without requiring manual intervention.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableBkGndGroupPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking remotely accessible registry paths\nDESCRIPTION: Verifies that 'Network access: Remotely accessible registry paths' is properly configured by checking the Machine registry value contains required paths.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedExactPaths -> Machine -> !r:System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion;\n```\n\n----------------------------------------\n\nTITLE: Detecting Insecure TLS Protocol Versions in Apache Configuration\nDESCRIPTION: Rules to ensure older insecure TLS/SSL protocols (SSLv2, SSLv3, TLSv1.0) are disabled.\n\nLANGUAGE: regex\nCODE:\n```\nf:$ssl-confs -> !r:^\\t*\\s*sslprotocol;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+all;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+\\.*tlsv1\\P\\s*;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+\\.*sslv2\\P\\s*;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+\\.*sslv3\\P\\s*;\n```\n\n----------------------------------------\n\nTITLE: Detecting Insecure TLS Protocol Versions in Apache Configuration\nDESCRIPTION: Rules to ensure older insecure TLS/SSL protocols (SSLv2, SSLv3, TLSv1.0) are disabled.\n\nLANGUAGE: regex\nCODE:\n```\nf:$ssl-confs -> !r:^\\t*\\s*sslprotocol;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+all;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+\\.*tlsv1\\P\\s*;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+\\.*sslv2\\P\\s*;\nf:$ssl-confs -> !r:^\\t*\\s*# && r:sslprotocol\\s+\\.*sslv3\\P\\s*;\n```\n\n----------------------------------------\n\nTITLE: Detecting Xinetd Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that checks if xinetd service is enabled on the system. This implements CIS benchmark 2.1.11 by examining systemd service files for xinetd execution configurations.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/usr/lib/systemd/system/xinetd.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Checking Solaris Host-based Authentication Configuration\nDESCRIPTION: Rule to verify that host-based authentication via pam_rhosts_auth is disabled for rlogin and rsh services, as specified in CIS Solaris 11 benchmark section 6.8.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/pam.conf -> !r:^rlogin\\s*\\t*auth sufficient\\s*\\t*pam_rhosts_auth.so.1;\nf:/etc/pam.conf -> !r:^rsh\\s*\\t*auth sufficient\\s*\\t*pam_rhosts_auth.so.1;\n```\n\n----------------------------------------\n\nTITLE: Checking for Legacy + Entries in group File\nDESCRIPTION: Detects legacy '+' entries in the group file, which could allow NIS entries and pose a security risk. These entries are considered insecure and should be removed.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/group -> !r:^# && r:^+:;\n```\n\n----------------------------------------\n\nTITLE: Checking security model for local accounts\nDESCRIPTION: Verifies that 'Network access: Sharing and security model for local accounts' is set to 'Classic' by checking the ForceGuest registry value isn't set to 1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> ForceGuest -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft MAPS Membership in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'SpynetReporting' registry setting for Windows Defender. This rule checks for compliance with CIS recommendation 18.9.76.3.2, ensuring that Microsoft MAPS membership is disabled.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking LocalSystem NULL Session Fallback Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: Allow LocalSystem NULL session fallback' is set to 'Disabled' according to CIS benchmark 2.3.11.2.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> allownullsessionfallback -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !allownullsessionfallback;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 4 Workbooks\nDESCRIPTION: Examines registry values to verify that Excel 4 workbooks are blocked in Microsoft Excel 2016. This security configuration prevents potentially malicious content in legacy Excel formats.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl4workbooks -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl4workbooks;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Basic Authentication Settings in Registry\nDESCRIPTION: Registry check to ensure 'Allow Basic authentication' for WinRM client is set to 'Disabled' per CIS benchmark 18.9.86.1.1. This prevents WinRM from using basic authentication which transmits credentials in clear text.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Allow Windows Ink Workspace' Registry Setting\nDESCRIPTION: Registry check to ensure 'Allow Windows Ink Workspace' is set appropriately per CIS benchmark 18.9.73.2. Verifies the AllowWindowsInkWorkspace value is set to 2 or is not present.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> AllowWindowsInkWorkspace -> 2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> !AllowWindowsInkWorkspace;\n```\n\n----------------------------------------\n\nTITLE: Checking Client Disconnection at Logon Hours Expiration in Windows Server 2016\nDESCRIPTION: Verifies that 'Microsoft network server: Disconnect clients when logon hours expire' is enabled. This checks the EnableForcedLogOff registry value to enforce session termination based on logon hour policies.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check for Apache web server enabled\nDESCRIPTION: Checks if Apache HTTP server is enabled in startup scripts by looking for S followed by numbers and httpd.\n\nLANGUAGE: configuration\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dhttpd$;\n```\n\n----------------------------------------\n\nTITLE: Checking Suspicious Packets Logging Configuration\nDESCRIPTION: Rule to check if logging of suspicious packets (martians) is disabled. According to CIS SLES12 benchmark 7.2.4, this setting should be enabled (set to 1) for security.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/log_martians -> 0;\n```\n\n----------------------------------------\n\nTITLE: Configuring RxToolBar Adware Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting RxToolBar adware through registry entries and files. Includes PCI DSS compliance reference 11.4 and reference URL to McAfee threat information.\n\nLANGUAGE: conf\nCODE:\n```\n# http://vil.nai.com/vil/content/v_135023.htm\n[Adware - RxToolBar {PCI_DSS: 11.4}] [any] [http://vil.nai.com/vil/content/v_135023.htm]\nr:HKEY_CURRENT_USER\\Software\\Infotechnics;\nr:HKEY_CURRENT_USER\\Software\\Infotechnics\\RX Toolbar;\nr:HKEY_CURRENT_USER\\Software\\RX Toolbar;\nr:HKEY_CLASSES_ROOT\\BarInfoUrl.TBInfo;\nr:HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\RX Toolbar;\nf:\\Program Files\\RXToolBar;\n```\n\n----------------------------------------\n\nTITLE: Checking Bad Error Message Protection in OSSEC\nDESCRIPTION: OSSEC rules to verify Bad Error Message Protection is enabled as per CIS Benchmark 7.2.6, checking both for explicit disabling and lack of explicit enabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.icmp_ignore_bogus_error_responses=0;\nf:/etc/sysctl.conf -> !r:^net.ipv4.icmp_ignore_bogus_error_responses=1;\n```\n\n----------------------------------------\n\nTITLE: Disable System on Audit Log Full Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.1.2 that verifies system behavior when audit logs are full. It checks that appropriate actions are configured in auditd.conf to ensure audit data is not lost and proper notification occurs.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.1.2 Disable System on Audit Log Full] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/auditd.conf;\nf:/etc/audit/auditd.conf -> !r:^space_left_action\\s*=\\s*email;\nf:/etc/audit/auditd.conf -> !r:^# && r:space_left_action\\s*=\\s*ignore|syslog|suspend|single|halt;\nf:/etc/audit/auditd.conf -> !r:^action_mail_acct\\s*=\\s*root;\nf:/etc/audit/auditd.conf -> !r:^admin_space_left_action\\s*=\\s*halt;\nf:/etc/audit/auditd.conf -> !r:^# && r:admin_space_left_action\\s*=\\s*ignore|syslog|email|suspend|single;\n```\n\n----------------------------------------\n\nTITLE: Checking Secure ICMP Redirect Acceptance in OSSEC\nDESCRIPTION: OSSEC rules to verify Secure ICMP Redirect Acceptance is disabled as per CIS Benchmark 7.2.3, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.all.secure_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.all.secure_redirects=0;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.default.secure_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.default.secure_redirects=0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Log Warnings Level Check in OSSEC\nDESCRIPTION: Ensures log_warnings is set to at least level 2 as recommended by CIS 6.3. Higher warning levels provide more detailed information about potential security issues.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 6.3: log warnings is set low] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*0;\nf:$mysql-cnfs -> !r:^# && r:log_warnings\\s*=\\s*1;\nf:$mysql-cnfs -> !r:log_warnings\\s*=\\s*\\d+;\nf:$mysql-cnfs -> r:log_warnings\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password Plugged In Settings\nDESCRIPTION: Verifies that 'Require a password when a computer wakes (plugged in)' is enabled by checking if ACSettingIndex registry value is set to 1 in the wake power settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking WDigest Authentication Registry Settings\nDESCRIPTION: Validates that WDigest Authentication is disabled by checking the UseLogonCredential registry value is set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Logging Path Setting\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Logging: Name' is correctly set to the system root path by checking the LogFilePath registry value in both policy and current configuration locations.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Log Analysis Configuration Message in Portuguese\nDESCRIPTION: Portuguese translation for the message displayed when adjusting log analysis configuration in OSSEC HIDS.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3.4/3.5\nreadlogs=\"Ajustando a configurao para analisar os seguintes logs:\"\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Empty Password Configuration\nDESCRIPTION: Detects if SSH is configured to permit empty passwords, which is insecure, as per CIS-RHEL6 section 6.2.9. This check examines the SSH daemon configuration to ensure empty passwords are properly prohibited for PCI DSS compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Checking Location Services Disable Registry Setting\nDESCRIPTION: Verifies that location services are disabled by checking the DisableLocation registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> DisableLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> !DisableLocation;\n```\n\n----------------------------------------\n\nTITLE: Configuring Assembly Optimizations for GCC\nDESCRIPTION: Sets up assembly optimizations for i686 and AMD64 platforms when using GCC, adding appropriate source files and compiler definitions.\n\nLANGUAGE: CMake\nCODE:\n```\nif(CMAKE_COMPILER_IS_GNUCC)\n    if(ASM686)\n        set(ZLIB_ASMS contrib/asm686/match.S)\n    elseif (AMD64)\n        set(ZLIB_ASMS contrib/amd64/amd64-match.S)\n    endif ()\n\n\tif(ZLIB_ASMS)\n\t\tadd_definitions(-DASMV)\n\t\tset_source_files_properties(${ZLIB_ASMS} PROPERTIES LANGUAGE C COMPILE_FLAGS -DNO_UNDERLINE)\n\tendif()\nendif()\n```\n\n----------------------------------------\n\nTITLE: Verifying Internet Explorer Enclosures Download Prevention\nDESCRIPTION: Checks that downloading of enclosures in Internet Explorer is prevented by ensuring the DisableEnclosureDownload registry value is set to 1 or exists per CIS benchmark 18.9.53.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> DisableEnclosureDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> !DisableEnclosureDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Expiration Warning Settings in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if the Windows password expiration warning is set to a value between 5 and 14 days, as required by CIS benchmark 2.3.7.7. It verifies the PasswordExpiryWarning registry value.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.7.7 Ensure 'Interactive logon: Prompt user to change password before expiration' is set to 'between 5 and 14 days'\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.7: Ensure 'Interactive logon: Prompt user to change password before expiration' is set to 'between 5 and 14 days'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 2;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 3;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 4;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0F;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking System Shutdown Without Logon Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Shutdown: Allow system to be shut down without having to log on' is set to 'Disabled' according to CIS benchmark 2.3.13.1.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ShutdownWithoutLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network client optional digital signature\nDESCRIPTION: Registry check to ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'. Verifies the EnableSecuritySignature registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnableSecuritySignature -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Server Digital Signature Support in Windows Server 2016\nDESCRIPTION: Ensures that 'Microsoft network server: Digitally sign communications (if client agrees)' is enabled. This validates the EnableSecuritySignature registry value to promote secure communications when supported by clients.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !EnableSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled PostgreSQL Server in OSSEC\nDESCRIPTION: OSSEC rule that checks if PostgreSQL database server is enabled at boot time. This check satisfies PCI-DSS requirement 2.2.2 which requires disabling unnecessary services.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - Disable standard boot services - PostgreSQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\n```\n\n----------------------------------------\n\nTITLE: Checking PerfTrack Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Enable/Disable PerfTrack' is set to 'Disabled' per CIS benchmark 18.8.39.11.1. The check verifies that the ScenarioExecutionEnabled registry value is set to 0.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> !ScenarioExecutionEnabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network server SPN target name validation level\nDESCRIPTION: Verifies that SMB server name hardening level is not set to 0 or is present, ensuring proper Server Principal Name validation for improved security.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> SMBServerNameHardeningLevel -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !SMBServerNameHardeningLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Warning Threshold in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'MSS: (WarningLevel) Percentage threshold for the security event log at which the system will generate a warning' is set to '90% or less'. This setting ensures admins are alerted before the security log fills up.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking LPT Port Redirection Prevention in Remote Desktop Services\nDESCRIPTION: Registry checks to ensure LPT port redirection is disabled in Remote Desktop Services, enforcing CIS Windows Server 2016 benchmark rule 18.9.52.3.3.3.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableLPT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableLPT;\n```\n\n----------------------------------------\n\nTITLE: Checking IP Forwarding Configuration in OSSEC\nDESCRIPTION: OSSEC rules to verify IP Forwarding is disabled as per CIS Benchmark 7.1.1, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.ip_forward=1;\nf:/etc/sysctl.conf ->  !r:^net.ipv4.ip_forward=0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSDP Discovery Service Setting\nDESCRIPTION: Verifies that 'SSDP Discovery (SSDPSRV)' is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SSDPSRV -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SSDPSRV -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Publish to Web Task Registry Settings\nDESCRIPTION: Verifies that 'Turn off the \"Publish to Web\" task for files and folders' is enabled by checking if the NoPublishingWizard registry value is set to 1 in Explorer policies.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking UIAccess Applications Elevation Setting\nDESCRIPTION: Verifies that 'Allow UIAccess applications to prompt for elevation without using the secure desktop' is disabled by checking if EnableUIADesktopToggle registry value is not set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Registry Settings\nDESCRIPTION: Verifies that ICMP redirects cannot override OSPF generated routes by checking if EnableICMPRedirect is not set to 1 or is missing entirely.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> EnableICMPRedirect -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !EnableICMPRedirect;\n```\n\n----------------------------------------\n\nTITLE: Checking Avahi Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify Avahi Server is not enabled in run-level directories as per CIS Benchmark 6.2.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Notification Settings\nDESCRIPTION: Verifies that the Windows Firewall Private Profile is set to not display notifications as required by CIS benchmark 9.2.4. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rules to check for secure ICMP redirect acceptance\nDESCRIPTION: Checks if secure ICMP redirects are accepted by verifying if the values in proc files are set to 1.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/secure_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/secure_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge WebRTC Localhost IP Protection Registry Setting\nDESCRIPTION: Verifies that using Localhost IP address for WebRTC in Microsoft Edge is prevented by checking the HideLocalHostIP registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> HideLocalHostIP -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !HideLocalHostIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Camera Disable Registry Setting\nDESCRIPTION: Verifies that camera usage is disabled by checking the AllowCamera registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Camera -> AllowCamera -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Camera -> !AllowCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Local Admin Password Management in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Enable Local Admin Password Management' is set to 'Enabled' in the Windows registry for LAPS configuration.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> AdmPwdEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !AdmPwdEnabled;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Local Admin Password Management in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Enable Local Admin Password Management' is set to 'Enabled' in the Windows registry for LAPS configuration.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> AdmPwdEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !AdmPwdEnabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Command Line Process Creation Logging in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Include command line in process creation events' is set to 'Disabled'. This setting controls whether command line information is included in process creation events in the event log, which could potentially expose sensitive information.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit -> ProcessCreationIncludeCmdLine_Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Failed Validation Behavior in Excel\nDESCRIPTION: Registry check to ensure Excel is configured to block files that fail validation rather than opening them in Protected View. This increases security by preventing access to potentially malicious files that don't pass validation.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\filevalidation -> openinprotectedview -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\filevalidation -> !openinprotectedview;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Camera Setting\nDESCRIPTION: Registry check to ensure lock screen camera is disabled. Verifies NoLockScreenCamera is set to 1 and exists in the Windows Personalization policy path.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenCamera -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking Screen Saver Grace Period Settings\nDESCRIPTION: Verifies that the screen saver grace period is set to 5 seconds or less by checking if ScreenSaverGracePeriod is greater than 5.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> r:\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking Administrator Account Enumeration on Elevation in Windows 10\nDESCRIPTION: Verifies that 'Enumerate administrator accounts on elevation' is set to 'Disabled' by checking the EnumerateAdministrators registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.15.2 Ensure 'Enumerate administrator accounts on elevation' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\CredUI -> EnumerateAdministrators -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting VSFTP Server in xinetd\nDESCRIPTION: Checks for enabled VSFTP service in xinetd configuration. Part of CIS SLES12 benchmark section 6.9.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/vsftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Apps Disablement Setting\nDESCRIPTION: Registry checks to ensure all apps from Windows Store are disabled, enforcing CIS Windows Server 2016 benchmark rule 18.9.61.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableStoreApps -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableStoreApps;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Linux Audit Configuration for CIS Debian Benchmarks\nDESCRIPTION: This file contains OSSEC audit rules for checking compliance with CIS Debian Linux Benchmark v1.0. It defines various security checks across system configuration, services, and kernel parameters with specific pattern matching rules.\n\nLANGUAGE: bash\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018 OSSEC Project\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - p (process running)\n#             - d (any file inside the directory)\n#\n# Additional values:\n# For the registry , use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n\n# CIS Checks for Debian/Ubuntu\n# Based on Center for Internet Security Benchmark for Debian Linux v1.0\n\n# Main one. Only valid for Debian/Ubuntu.\n[CIS - Testing against the CIS Debian Linux Benchmark v1.0] [all required] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/debian_version;\nf:/proc/sys/kernel/ostype -> Linux;\n\n\n# Section 1.4 - Partition scheme.\n[CIS - Debian Linux - 1.4 - Robust partition scheme - /tmp is not on its own partition {CIS: 1.4 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/fstab -> !r:/tmp;\n\n[CIS - Debian Linux - 1.4 - Robust partition scheme - /opt is not on its own partition {CIS: 1.4 Debian Linux}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/opt;\nf:/etc/fstab -> !r:/opt;\n\n[CIS - Debian Linux - 1.4 - Robust partition scheme - /var is not on its own partition {CIS: 1.4 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/fstab -> !r:/var;\n\n\n# Section 2.3 - SSH configuration\n[CIS - Debian Linux - 2.3 - SSH Configuration - Protocol version 1 enabled {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n\n[CIS - Debian Linux - 2.3 - SSH Configuration - IgnoreRHosts disabled {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n\n[CIS - Debian Linux - 2.3 - SSH Configuration - Empty passwords permitted {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:^PermitEmptyPasswords\\.+yes;\n\n[CIS - Debian Linux - 2.3 - SSH Configuration - Host based authentication enabled {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n\n[CIS - Debian Linux - 2.3 - SSH Configuration - Root login allowed {CIS: 2.3 Debian Linux} {PCI_DSS: 4.1}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\n\n\n# Section 2.4 Enable system accounting\n#[CIS - Debian Linux - 2.4 - System Accounting - Sysstat not installed {CIS: 2.4 Debian Linux}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\n#f:!/etc/default/sysstat;\n#f:!/var/log/sysstat;\n\n#[CIS - Debian Linux - 2.4 - System Accounting - Sysstat not enabled {CIS: 2.4 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\n#f:!/etc/default/sysstat;\n#f:/etc/default/sysstat -> !r:^# && r:ENABLED=\"false\";\n\n\n# Section 2.5 Install and run Bastille\n#[CIS - Debian Linux - 2.5 - System harderning - Bastille is not installed {CIS: 2.5 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\n#f:!/etc/Bastille;\n\n\n# Section 2.6 Ensure sources.list Sanity\n[CIS - Debian Linux - 2.6 - Sources list sanity - Security updates not enabled {CIS: 2.6 Debian Linux} {PCI_DSS: 6.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:!/etc/apt/sources.list;\nf:!/etc/apt/sources.list -> !r:^# && r:http://security.debian|http://security.ubuntu;\n\n\n# Section 3 - Minimize inetd services\n[CIS - Debian Linux - 3.3 - Telnet enabled on inetd {CIS: 3.3 Debian Linux} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:telnet;\n\n[CIS - Debian Linux - 3.4 - FTP enabled on inetd {CIS: 3.4 Debian Linux} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:/ftp;\n\n[CIS - Debian Linux - 3.5 - rsh/rlogin/rcp enabled on inetd {CIS: 3.5 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:shell|login;\n\n[CIS - Debian Linux - 3.6 - tftpd enabled on inetd {CIS: 3.6 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:tftp;\n\n[CIS - Debian Linux - 3.7 - imap enabled on inetd {CIS: 3.7 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:imap;\n\n[CIS - Debian Linux - 3.8 - pop3 enabled on inetd {CIS: 3.8 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:pop;\n\n[CIS - Debian Linux - 3.9 - Ident enabled on inetd {CIS: 3.9 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inetd.conf -> !r:^# && r:ident;\n\n\n# Section 4 - Minimize boot services\n[CIS - Debian Linux - 4.1 - Disable inetd - Inetd enabled but no services running {CIS: 4.1 Debian Linux} {PCI_DSS: 2.2.2}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\np:inetd;\nf:!/etc/inetd.conf -> !r:^# && r:wait;\n\n[CIS - Debian Linux - 4.3 - GUI login enabled {CIS: 4.3 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/inittab -> !r:^# && r:id:5;\n\n[CIS - Debian Linux - 4.6 - Disable standard boot services - Samba Enabled {CIS: 4.6 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/samba;\n\n[CIS - Debian Linux - 4.7 - Disable standard boot services - NFS Enabled {CIS: 4.7 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/nfs-common;\nf:/etc/init.d/nfs-user-server;\nf:/etc/init.d/nfs-kernel-server;\n\n[CIS - Debian Linux - 4.9 - Disable standard boot services - NIS Enabled {CIS: 4.9 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/nis;\n\n[CIS - Debian Linux - 4.13 - Disable standard boot services - Web server Enabled {CIS: 4.13 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/apache;\nf:/etc/init.d/apache2;\n\n[CIS - Debian Linux - 4.15 - Disable standard boot services - DNS server Enabled {CIS: 4.15 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/bind;\n\n[CIS - Debian Linux - 4.16 - Disable standard boot services - MySQL server Enabled {CIS: 4.16 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/mysql;\n\n[CIS - Debian Linux - 4.16 - Disable standard boot services - PostgreSQL server Enabled {CIS: 4.16 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/postgresql;\n\n[CIS - Debian Linux - 4.17 - Disable standard boot services - Webmin Enabled {CIS: 4.17 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/webmin;\n\n[CIS - Debian Linux - 4.18 - Disable standard boot services - Squid Enabled {CIS: 4.18 Debian Linux} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/etc/init.d/squid;\n\n\n# Section 5 - Kernel tuning\n[CIS - Debian Linux - 5.1 - Network parameters - Source routing accepted {CIS: 5.1 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n\n[CIS - Debian Linux - 5.1 - Network parameters - ICMP broadcasts accepted {CIS: 5.1 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\n\n[CIS - Debian Linux - 5.2 - Network parameters - IP Forwarding enabled {CIS: 5.2 Debian Linux}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Debian_Benchmark_v1.0.pdf]\nf:/proc/sys/net/ipv4/ip_forward -> 1;\nf:/proc/sys/net/ipv6/ip_forward -> 1;\n```\n\n----------------------------------------\n\nTITLE: Defining PF Firewall Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring the PF firewall for active response in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Pf support\npfenable=\"Do you want to use the PF firewall in the active response?\"\nnopf=\"PF response disabled.\"\npftablename=\"Name of the PF table to use?\"\npfmessage=\"Add the following lines to the beginning of your PF rules\"\n```\n\n----------------------------------------\n\nTITLE: Detecting Empty Password Accounts in OSSEC\nDESCRIPTION: OSSEC rule to identify accounts with empty passwords in the /etc/shadow file. This checks for security vulnerabilities where accounts can be accessed without password authentication.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - X.X.X - Account with empty password present {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Basic Authentication Setting\nDESCRIPTION: Verifies that Basic authentication for WinRM Client is disabled by checking the AllowBasic registry value is not set to anything other than 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH IgnoreRhosts Configuration\nDESCRIPTION: Rule to check if SSH IgnoreRhosts is disabled. According to CIS SLES12 benchmark 9.2.6, IgnoreRhosts should be set to yes to improve security by ignoring .rhosts files.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Content Updates Registry Settings\nDESCRIPTION: Verifies that 'Turn off Search Companion content file updates' is enabled by checking if the DisableContentFileUpdates registry value is set to 1 in the SearchCompanion policies.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Broadcast Request Handling Configuration\nDESCRIPTION: Rule to check if ICMP broadcast requests are accepted. According to CIS SLES12 benchmark 7.2.5, this setting should be enabled (set to 1) to ignore broadcast requests for security.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_echo_ignore_broadcasts -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Network Bridge Installation Prohibition\nDESCRIPTION: Checks if installation and configuration of Network Bridge is prohibited on the DNS domain network by verifying NC_AllowNetBridge_NLA is not set to 1 or is missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Checking Device Authentication Certificate Settings\nDESCRIPTION: Verifies that 'Support device authentication using certificate' is set to 'Enabled: Automatic' by checking if DevicePKInitBehavior is 0 and DevicePKInitEnabled is 1 in kerberos parameters.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters -> DevicePKInitBehavior -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters -> DevicePKInitEnabled -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting talk-server on xinetd in SLES11\nDESCRIPTION: Checks if talk service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/talk -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rules to check for Samba services enabled\nDESCRIPTION: Checks if Samba services are enabled in startup scripts by looking for S followed by numbers and samba/smb.\n\nLANGUAGE: configuration\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\n```\n\n----------------------------------------\n\nTITLE: Checking Block Windows Store Apps with Windows Runtime API Registry Setting\nDESCRIPTION: Verifies that Windows Store apps with Windows Runtime API access from hosted content are blocked by checking the BlockHostedAppAccessWinRT registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> BlockHostedAppAccessWinRT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !BlockHostedAppAccessWinRT;\n```\n\n----------------------------------------\n\nTITLE: Checking Background Refresh of Group Policy in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Turn off background refresh of Group Policy' is set to 'Disabled'. This ensures Group Policy is refreshed at regular intervals, keeping security settings up to date.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableBkGndGroupPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Do not display network selection UI registry setting in OSSEC\nDESCRIPTION: Verifies that 'Do not display network selection UI' is set to 'Enabled' by checking if the DontDisplayNetworkSelectionUI registry value equals 1 and that the key exists in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n```\n\n----------------------------------------\n\nTITLE: Detecting IMAP and POP3 services in SLES11\nDESCRIPTION: Checks if IMAP (cyrus-imapd) and POP3 (dovecot) services are enabled in xinetd configuration, which should be disabled if not needed.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/cyrus-imapd -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/dovecot -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking UIAccess Elevation Prompt Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop' is set to 'Disabled' by checking if the EnableUIADesktopToggle registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Setup Event Log Behavior\nDESCRIPTION: OSSEC rule that checks if 'Setup: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' by verifying the Retention registry key is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Unauthenticated RPC Client Restrictions in Windows 10\nDESCRIPTION: Verifies that 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated' by checking the RestrictRemoteClients registry value is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.36.2 Ensure 'Restrict Unauthenticated RPC clients' is set to 'Enabled: Authenticated'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> RestrictRemoteClients -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting Apache Web Server\nDESCRIPTION: Checks for enabled Apache web server in runlevel configuration. Part of CIS SLES12 benchmark section 6.10.\n\nLANGUAGE: shell\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dapache2$;\n```\n\n----------------------------------------\n\nTITLE: Checking NFS and RPC Configuration in OSSEC\nDESCRIPTION: OSSEC rules to verify NFS and RPC services are not enabled in run-level directories as per CIS Benchmark 6.7.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:rpcbind;\nd:$rc_dirs -> S -> r:nfs-kernel-server;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Trusted Documents Settings in Registry\nDESCRIPTION: Registry checks to verify that trusted documents are disabled in Microsoft Excel 16.0. These rules ensure the disabletrusteddocuments and disablenetworktrusteddocuments registry values are set correctly for security compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\trusted documents -> disabletrusteddocuments -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\trusted documents -> !disabletrusteddocuments;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\trusted documents -> disablenetworktrusteddocuments -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\trusted documents -> !disablenetworktrusteddocuments;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Account Optional Setting in Windows 10\nDESCRIPTION: Verifies that 'Allow Microsoft accounts to be optional' is set to 'Enabled' by checking registry values related to MSAOptional.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.6.1 Ensure 'Allow Microsoft accounts to be optional' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking File Validation in Excel\nDESCRIPTION: Registry check to ensure file validation is enabled in Microsoft Excel. This feature validates files against known file formats and helps protect against potential security vulnerabilities.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\filevalidation -> enableonload -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\filevalidation -> !enableonload;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Settings in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'MSS: (NoNameReleaseOnDemand) Allow the computer to ignore NetBIOS name release requests except from WINS servers' is set to 'Enabled'. This setting helps prevent NetBIOS name release attacks.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: Creating a Custom Rule File\nDESCRIPTION: Example of a custom rule definition in XML format that bypasses SSH public key authentication alerts.\n\nLANGUAGE: xml\nCODE:\n```\n<group name=\"syslog,scans\">\n <rule id=\"9000\" level=\"0\">\n      <regex>Accepted publickey</regex>\n      <description>Accepted publickey bypass</description>\n </rule>\n</group>\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Microsoft.com Referral Settings\nDESCRIPTION: Verifies that 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is enabled by checking if the ExitOnMSICW registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Detecting X11 Windows System\nDESCRIPTION: Checks for enabled X11 graphical interface via systemd default target and running gdm-x-session process. Part of CIS SLES12 benchmark section 6.1.\n\nLANGUAGE: shell\nCODE:\n```\nf:/usr/lib/systemd/system/default.target -> r:Graphical;\np:gdm-x-session;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Consent Registry Setting\nDESCRIPTION: Verifies that default consent for Windows Error Reporting is set to 'Always ask before sending data' by checking if DefaultConsent is not set to 1, which ensures users are prompted before sending error data to Microsoft.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\Consent -> DefaultConsent -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Connectivity During Standby (Battery) in Windows 10\nDESCRIPTION: Verifies that 'Allow network connectivity during connected-standby (on battery)' is set to 'Disabled' by checking registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.33.6.1 Ensure 'Allow network connectivity during connected-standby (on battery)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> !DCSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Checking World Wide Web Publishing Service Status in Windows Registry\nDESCRIPTION: Verifies that the World Wide Web Publishing Service (W3SVC) is set to 'Disabled' or 'Not Installed' per CIS benchmark 5.41. The check confirms the Start value is set to 4.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\W3SVC -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: TFTP Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify TFTP server (tftpd) is disabled on RHEL5 systems. Examines /etc/xinetd.d/tftpd to ensure the service is properly disabled, meeting CIS requirement 2.1.8 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 2.1.8 - tftpd enabled on xinetd {CIS: 2.1.8 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic User Sign-in Settings\nDESCRIPTION: OSSEC rule to ensure automatic sign-in after system-initiated restarts is disabled according to CIS benchmark 18.9.86.1. Verifies if DisableAutomaticRestartSignOn is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.86.1 Ensure 'Sign-in last interactive user automatically after a system-initiated restart' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.86.1 Ensure 'Sign-in last interactive user automatically after a system-initiated restart' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableAutomaticRestartSignOn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableAutomaticRestartSignOn;\n```\n\n----------------------------------------\n\nTITLE: Checking Advertising ID Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off the advertising ID' is set to 'Enabled' by verifying that the DisabledByGroupPolicy registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.46.1 Ensure 'Turn off the advertising ID' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> DisabledByGroupPolicy -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> !DisabledByGroupPolicy;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Application Status in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'RemoveWindowsStore' registry setting. This rule checks for compliance with CIS recommendation 18.9.68.4, ensuring the Windows Store application is turned off.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> RemoveWindowsStore -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !RemoveWindowsStore;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Reveal Button Setting in Windows 10\nDESCRIPTION: Verifies that 'Do not display the password reveal button' is set to 'Enabled' by checking registry values related to DisablePasswordReveal.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.15.1 Ensure 'Do not display the password reveal button' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> DisablePasswordReveal -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredUI -> !DisablePasswordReveal;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network client digital signature requirement\nDESCRIPTION: Registry check to ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'. Verifies the RequireSecuritySignature registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> !RequireSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network client digital signature requirement\nDESCRIPTION: Registry check to ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'. Verifies the RequireSecuritySignature registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> !RequireSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Inbound Connections Registry Configuration\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Inbound connections' is set to 'Block (default)' by checking if the DefaultInboundAction registry value is set to 0 in both policy and local settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Shell Protocol Protected Mode Registry Setting\nDESCRIPTION: Verifies that shell protocol protected mode is enabled by checking if PreXPSP2ShellProtocolBehavior is not set to 0, which would disable this protection.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> PreXPSP2ShellProtocolBehavior -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Solicited Remote Assistance Configuration in Windows 10\nDESCRIPTION: Verifies that 'Configure Solicited Remote Assistance' is set to 'Disabled' by checking registry values related to fAllowToGetHelp.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.35.2 Ensure 'Configure Solicited Remote Assistance' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP SYN Cookies Configuration\nDESCRIPTION: Rule to check if TCP SYN cookies are disabled. According to CIS SLES12 benchmark 7.2.8, SYN cookies should be enabled (set to 1) for protection against SYN flood attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/tcp_syncookies -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off printing over HTTP' is set to 'Enabled' per CIS benchmark 18.8.20.1.7. The check verifies that the DisableHTTPPrinting registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Defining RC Scripts Location Variable for Boot Services Checks\nDESCRIPTION: Sets a variable containing the paths to the run level directories that contain service startup scripts. This enables checking for improperly enabled services across multiple run levels.\n\nLANGUAGE: bash\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Acceptance in OSSEC\nDESCRIPTION: OSSEC rules to verify ICMP Redirect Acceptance is disabled as per CIS Benchmark 7.2.2, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.all.accept_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.all.accept_redirects=0;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.default.accept_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.default.accept_redirects=0;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Microsoft Accounts Optional\nDESCRIPTION: OSSEC rule that checks if 'Allow Microsoft accounts to be optional' is set to 'Enabled' by verifying the MSAOptional registry key is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> MSAOptional -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !MSAOptional;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile State Registry Settings in Windows Server 2016\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile is enabled. Validates registry keys in both policy and current configuration locations to verify the firewall is turned on as required by CIS benchmark 9.3.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Accounts with Empty Passwords (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check for accounts with empty passwords, which is a security risk and against PCI-DSS requirement 10.2.5. The rule checks the /etc/shadow file for entries with an empty password field.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - Account with empty password present {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Recognition Error Reporting Registry Settings\nDESCRIPTION: Verifies that 'Turn off handwriting recognition error reporting' is enabled by checking if the PreventHandwritingErrorReports registry value is set to 1 in the HandwritingErrorReports key.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Detecting VSFTP Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if VSFTP server is enabled through xinetd. This implements CIS benchmark 3.10 by checking the vsftpd configuration in xinetd.d directory.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/vsftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Basic Authentication Registry Setting in Windows\nDESCRIPTION: Verifies that 'Allow Basic authentication' for WinRM Client is disabled by checking if the AllowBasic registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Insider Builds Control Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Toggle user control over Insider builds' is set to 'Disabled' as per CIS benchmark 18.9.16.4. Checks if AllowBuildPreview value exists and is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> AllowBuildPreview -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> !AllowBuildPreview;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Node Type for Windows Server\nDESCRIPTION: Verifies that NetBIOS node type is set to P-node (NodeType = 2) to improve security. Detects non-compliance when NodeType is not set to 2 or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NetBT\\Parameters -> NodeType -> !2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NetBT\\Parameters -> !NodeType;\n```\n\n----------------------------------------\n\nTITLE: Checking for User .forward Files\nDESCRIPTION: Detects the presence of .forward files in user home directories. These files can be used to automatically redirect email and potentially leak sensitive information.\n\nLANGUAGE: plaintext\nCODE:\n```\nd:$home_dirs -> r:^.forward$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled' by verifying that the CEIP registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.12 Ensure 'Turn off the Windows Messenger Customer Experience Improvement Program' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 95 Workbooks\nDESCRIPTION: Checks registry values to confirm that Excel 95 workbooks are blocked in Microsoft Excel 2016. Blocking these legacy formats helps mitigate security risks from outdated file types.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl95workbooks -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl95workbooks;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Preview Builds Management Settings\nDESCRIPTION: Verifies that preview builds are disabled by checking appropriate registry keys ManagePreviewBuilds and ManagePreviewBuildsPolicyValue.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> ManagePreviewBuilds -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !ManagePreviewBuilds;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> ManagePreviewBuildsPolicyValue -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !ManagePreviewBuildsPolicyValue;\n```\n\n----------------------------------------\n\nTITLE: Detecting Avahi daemon\nDESCRIPTION: Checks for running Avahi daemon process. Part of CIS SLES12 benchmark section 6.2.\n\nLANGUAGE: shell\nCODE:\n```\np:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Elevation Prompt Behavior for Administrators in Registry\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode' is set to 'Prompt for consent on the secure desktop'. Checks if the ConsentPromptBehaviorAdmin registry value is set to 0 or 1 or is missing.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorAdmin;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Prompt for Terminal Services Registry Setting\nDESCRIPTION: Verifies that password prompting upon connection for Terminal Services is enabled by checking if fPromptForPassword is set to 1 and not missing, which requires users to enter credentials when connecting.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fPromptForPassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fPromptForPassword;\n```\n\n----------------------------------------\n\nTITLE: Checking process creation events command line inclusion\nDESCRIPTION: Verifies that Windows is configured to not include command line information in process creation events. This helps protect sensitive command-line arguments from being exposed in event logs.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit -> ProcessCreationIncludeCmdLine_Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Failed Login Attempt Delay\nDESCRIPTION: Rule to check if the delay between failed login attempts is set to 4 seconds, as specified in CIS Solaris 11 benchmark section 6.10. This helps prevent brute force attacks.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/default/login -> !r:^SLEEPTIME\\p4;\nf:/etc/default/login -> !r:^# && r:SLEEPTIME\\p4\\d;\n```\n\n----------------------------------------\n\nTITLE: Checking File and Registry Write Failures Virtualization Setting\nDESCRIPTION: Verifies that 'Virtualize file and registry write failures to per-user locations' is enabled by checking if EnableVirtualization registry value is set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableVirtualization -> 0;\n```\n\n----------------------------------------\n\nTITLE: Running Nmap Scan with OSSEC Integration\nDESCRIPTION: Example Nmap command that scans a network range and appends the results to the output file monitored by OSSEC. The scan performs both TCP (-sT) and UDP (-sU) scanning and outputs in grepable format (-oG).\n\nLANGUAGE: bash\nCODE:\n```\nnmap --append_output -sU -sT -oG /var/log/nmap-out.log 192.168.2.0-255\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Handwriting Data Sharing Settings\nDESCRIPTION: Verifies that 'Turn off handwriting personalization data sharing' is enabled by checking for PreventHandwritingDataSharing=1 in the registry. This prevents the system from sending handwriting recognition data to Microsoft.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Verifying GNOME Screen Lock Configuration\nDESCRIPTION: Rule to check for proper default screen lock configuration for GNOME users, as specified in CIS Solaris 11 benchmark section 6.12. This ensures workstations are locked after periods of inactivity.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/usr/share/X11/app-defaults/XScreensaver -> !r:^*timeout:\\s*\\t*0:10:00;\nf:/usr/share/X11/app-defaults/XScreensaver -> !r:^*locktimeout:\\s*\\t*0:00:00;\nf:/usr/share/X11/app-defaults/XScreensaver -> !r:^*lock:\\s*\\t*true;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Notification Settings\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile notification settings are disabled. Verifies this setting in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Secure Desktop for Elevation Prompts in Registry\nDESCRIPTION: Verifies that 'User Account Control: Switch to the secure desktop when prompting for elevation' is enabled. Checks if the PromptOnSecureDesktop registry value is set to 0, which would indicate the policy is disabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> PromptOnSecureDesktop -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Pop-up Blocker Configuration in Registry\nDESCRIPTION: Validates that 'Configure Pop-up Blocker' is set to 'Enabled' by confirming AllowPopups does not have value 'yes' in the registry.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> AllowPopups -> !r:yes;\n```\n\n----------------------------------------\n\nTITLE: Detecting Avahi Daemon in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if Avahi daemon is running on the system. This implements CIS benchmark 3.3 by checking for the avahi-daemon process in the running processes list.\n\nLANGUAGE: ossec\nCODE:\n```\np:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Expiration Policy in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Do not allow password expiration time longer than required by policy' is set to 'Enabled' in the Windows registry for LAPS configuration.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PwdExpirationProtectionEnabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PwdExpirationProtectionEnabled;\n```\n\n----------------------------------------\n\nTITLE: Detecting Source Routing Acceptance in RHEL7\nDESCRIPTION: OSSEC rule that checks if source routed packet acceptance is enabled, which would violate CIS benchmark 4.2.1 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.2.1 - Network parameters - Source routing accepted {CIS: 4.2.1 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Detecting Source Routing Acceptance in RHEL7\nDESCRIPTION: OSSEC rule that checks if source routed packet acceptance is enabled, which would violate CIS benchmark 4.2.1 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.2.1 - Network parameters - Source routing accepted {CIS: 4.2.1 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Default File Block Behavior Settings\nDESCRIPTION: Verifies registry values to ensure the default file block behavior in Excel 2016 is set to prevent blocked files from being opened. This configuration provides stronger security by preventing access to potentially harmful files.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> openinprotectedview -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !openinprotectedview;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Creation Requirements\nDESCRIPTION: Rules for validating password creation requirements using pam_cracklib according to CIS benchmark 9.2.1. Verifies proper password complexity settings.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.2.1 Set Password Creation Requirement Parameters Using pam_cracklib\n[CIS - Debian Linux 7/8 - 9.2.1 Set Password Creation Requirement Parameters Using pam_cracklib] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/pam.d/common-password -> !r:password required pam_cracklib.so retry=\\d minlen=\\d\\d+ dcredit=-\\d+ ucredit=-\\d+ ocredit=-\\d+ lcredit=-\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Firewall Rules Application\nDESCRIPTION: Verifies that the Windows Firewall Private Profile is set to apply local firewall rules as required by CIS benchmark 9.2.5. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalPolicyMerge -> 0; \nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled' by verifying that the ExitOnMSICW registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.22.1.5 Ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Dial-up Password Saving Prevention\nDESCRIPTION: Verifies that saving of dial-up passwords is prevented by checking if the DisableSavePassword registry value is set to 1. Implements CIS benchmark 18.4.4.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RasMan\\Parameters -> DisableSavePassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RasMan\\Parameters -> !DisableSavePassword;\n```\n\n----------------------------------------\n\nTITLE: Detecting IMAP Services in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if IMAP services are enabled through xinetd. This implements part of CIS benchmark 3.12 by checking the cyrus-imapd configuration in xinetd.d directory.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/cyrus-imapd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Connect Now Wizards Access\nDESCRIPTION: Verifies that 'Prohibit access of the Windows Connect Now wizards' is enabled. This rule checks that the DisableWcnUi registry value is set to 1 to prevent users from accessing Windows Connect Now wizards.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> DisableWcnUi -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> !DisableWcnUi;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge InPrivate Browsing Disable Registry Setting\nDESCRIPTION: Verifies that InPrivate Browsing in Microsoft Edge is disabled by checking the AllowInPrivate registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> AllowInPrivate -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !AllowInPrivate;\n```\n\n----------------------------------------\n\nTITLE: Verifying User Control Over Installs Registry Setting in Windows\nDESCRIPTION: Checks that 'Allow user control over installs' is disabled by verifying the EnableUserControl registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Multicast Name Resolution Registry Settings\nDESCRIPTION: Validates that multicast name resolution is disabled by checking the EnableMulticast registry value is set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient -> EnableMulticast -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\DNSClient -> !EnableMulticast;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for dBase Files Blocking in Excel\nDESCRIPTION: OSSEC audit rules to verify that dBase III/IV files are blocked in Microsoft Excel. This prevents potentially malicious dBase files from being opened in Excel.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> dbasefiles -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !dbasefiles;\n```\n\n----------------------------------------\n\nTITLE: Checking Publish to Web Task Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off the \"Publish to Web\" task for files and folders' is set to 'Enabled' per CIS benchmark 18.8.20.1.11. The check verifies that the NoPublishingWizard registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Detecting echo-udp on xinetd in SLES11\nDESCRIPTION: Checks if echo-udp service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/echo-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Protocol Version Configuration\nDESCRIPTION: Rule to check if SSH Protocol version 1 is enabled. According to CIS SLES12 benchmark 9.2.1, only Protocol version 2 should be used as version 1 has security vulnerabilities.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Log Size\nDESCRIPTION: Registry check to ensure Windows Firewall Public profile log size is at least 16384 KB. Uses regex patterns to verify LogFileSize meets minimum requirements in both policy and current configuration paths.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Outbound Connections\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile outbound connections are set to Allow. Verifies this setting in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Copying a Rule File for Customization\nDESCRIPTION: Command to copy a rule file from the repository to the signatures directory for customization.\n\nLANGUAGE: bash\nCODE:\n```\ncp repository/attack_rules.xml signatures/XXattack_rules.xml\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Apps Runtime API Access Block in Registry\nDESCRIPTION: Verifies that 'Block launching Windows Store apps with Windows Runtime API access from hosted content' is enabled by confirming BlockHostedAppAccessWinRT is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> BlockHostedAppAccessWinRT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !BlockHostedAppAccessWinRT;\n```\n\n----------------------------------------\n\nTITLE: Checking Daemon Umask Settings in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule that verifies the system-wide daemon umask setting. This implements CIS benchmark 3.1 by checking if the umask is set to 027 in the init configuration file.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/sysconfig/init -> !r:^# && r:^umask && <:umask 027;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS Password Length in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Password Settings: Password Length' is set to 'Enabled: 15 or more' by checking the PasswordLength value to ensure it meets minimum requirements.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:a;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:b;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:c;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> PasswordLength -> r:e;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft Services\\AdmPwd -> !PasswordLength;\n```\n\n----------------------------------------\n\nTITLE: Checking Do not show feedback notifications registry setting in OSSEC\nDESCRIPTION: Verifies that 'Do not show feedback notifications' is set to 'Enabled' by checking if the DoNotShowFeedbackNotifications registry value equals 1 and that the key exists in the DataCollection registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> DoNotShowFeedbackNotifications -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> !DoNotShowFeedbackNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 4 Macrosheets\nDESCRIPTION: Checks registry values to ensure Excel 4 macrosheets and add-in files are blocked in Microsoft Excel 2016. Excel 4 macros can present significant security risks if not properly restricted.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl4macros -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl4macros;\n```\n\n----------------------------------------\n\nTITLE: Record Events That Modify the System's Network Environment Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.6 that checks if auditd is configured to record events that modify the system's network environment. It verifies audit rules exist to monitor network configuration changes that could indicate security issues.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.6 Record Events That Modify the System's Network Environment] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-a exit,always -F arch=b32 -S sethostname -S setdomainname -k system-locale;\nf:/etc/audit/audit.rules -> !r:^-w /etc/issue -p wa -k system-locale;\nf:/etc/audit/audit.rules -> !r:^-w /etc/issue.net -p wa -k system-locale;\nf:/etc/audit/audit.rules -> !r:^-w /etc/hosts -p wa -k system-locale;\nf:/etc/audit/audit.rules -> !r:^-w /etc/network -p wa -k system-locale;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Disabled Status\nDESCRIPTION: Verifies that IPv6 is disabled by checking if the DisabledComponents registry value is set to 0xff (255). Implements CIS benchmark 18.5.19.2.1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> DisabledComponents -> !ff;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !DisabledComponents;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables the Windows Customer Experience Improvement Program. Checks for the presence of the CEIPEnable registry key and verifies it has the value of 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Autoplay Disabled for All Drives in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Turn off Autoplay' is set to 'Enabled: All drives' in Windows registry. Ensures the NoDriveTypeAutoRun value is set to ff (hexadecimal) in the Explorer policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> NoDriveTypeAutoRun -> !ff;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> !NoDriveTypeAutoRun;\n```\n\n----------------------------------------\n\nTITLE: Checking UIAccess Application Secure Location Registry Configuration\nDESCRIPTION: Verifies that 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled' by checking if the EnableSecureUIAPaths registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableSecureUIAPaths -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registration Wizard Control Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled' by verifying that the NoRegistration registry value is set to 1 under HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.8 Ensure 'Turn off Registration if URL connection is referring to Microsoft.com' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Check for Audit Policy Subcategory Settings\nDESCRIPTION: Registry check to ensure audit policy subcategory settings override audit policy category settings as required by CIS Benchmark item 2.3.2.1.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.2.1 Ensure 'Audit: Force audit policy subcategory settings to override audit policy category settings' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.2.1 Ensure 'Audit: Force audit policy subcategory settings to override audit policy category settings' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> SCENoApplyLegacyAuditPolicy -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Registry Settings\nDESCRIPTION: Validates that the computer is configured to ignore NetBIOS name release requests except from WINS servers by checking the NoNameReleaseOnDemand registry value is set to 1.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Word Default File Block Behavior Settings\nDESCRIPTION: Examines registry values to verify that the default file block behavior in Word 2016 is set to prevent blocked files from being opened. This configuration increases security by blocking access to potentially harmful documents.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> openinprotectedview -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> !openinprotectedview;\n```\n\n----------------------------------------\n\nTITLE: RHEL5 OS Version Verification Checks\nDESCRIPTION: Verifies the target system is running Red Hat Enterprise Linux 5 or compatible distributions like CentOS 5, Cloud 5, Oracle 5, or Better Linux 5 by checking the content of /etc/redhat-release file.\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/redhat-release -> r:^Red Hat Enterprise Linux \\S+ release 5;\nf:/etc/redhat-release -> r:^CentOS && r:release 5;\nf:/etc/redhat-release -> r:^Cloud && r:release 5;\nf:/etc/redhat-release -> r:^Oracle && r:release 5;\nf:/etc/redhat-release -> r:^Better && r:release 5;\n```\n\n----------------------------------------\n\nTITLE: Detecting Disabled RFC-recommended Source Route Validation in RHEL5\nDESCRIPTION: Checks if RFC-recommended source route validation is disabled in the system. This CIS benchmark rule (4.2.7) verifies that the rp_filter parameters are not set to 0 to prevent IP spoofing attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/rp_filter -> 0;\nf:/proc/sys/net/ipv4/conf/default/rp_filter -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Inbound Connections in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile is set to block inbound connections per CIS benchmark 9.1.2. The check confirms the DefaultInboundAction value is not set to 0 across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC UIAccess Applications Setting in Windows Registry\nDESCRIPTION: Checks that 'User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop' is set to 'Disabled' by verifying EnableUIADesktopToggle registry value is not 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Logging Path Setting in Windows Registry\nDESCRIPTION: Checks that 'Windows Firewall: Domain: Logging: Name' is set to the correct path by verifying LogFilePath registry value matches the required pattern in policy and current settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Unencrypted Traffic\nDESCRIPTION: Verifies that 'Allow unencrypted traffic' is set to 'Disabled' (value equal to 0) in the WinRM Client registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Device Authentication Settings\nDESCRIPTION: Verifies that 'Support device authentication using certificate' is set to 'Enabled: Automatic' by checking for DevicePKInitBehavior=0 and DevicePKInitEnabled=1 in the registry. This ensures proper device certificate authentication.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters -> DevicePKInitBehavior -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters -> DevicePKInitEnabled -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled DNS Server in OSSEC\nDESCRIPTION: OSSEC rule that checks if DNS server (named) is enabled at boot time. This check satisfies PCI-DSS requirement 2.2.2 which requires disabling unnecessary services.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - Disable standard boot services - DNS server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnamed$;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Settings in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'MSS: (EnableICMPRedirect) Allow ICMP redirects to override OSPF generated routes' is set to 'Disabled' by checking if the value is 1 or doesn't exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> EnableICMPRedirect -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !EnableICMPRedirect;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 3 Macrosheets\nDESCRIPTION: Validates registry values to ensure Excel 3 macrosheets and add-in files are blocked in Microsoft Excel 2016. Blocking these older formats helps reduce the attack surface for potential exploits.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl3macros -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl3macros;\n```\n\n----------------------------------------\n\nTITLE: Disable Mounting of cramfs Filesystems Rule for OSSEC\nDESCRIPTION: CIS rule 2.18 that checks for the existence of /etc/modprobe.d/CIS.conf and verifies it contains a directive to disable mounting of cramfs filesystems for security hardening.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 2.18 Disable Mounting of cramfs Filesystems] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install cramfs /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Link-Layer Topology Discovery Responder Driver Security Check\nDESCRIPTION: Ensures that 'Turn on Responder (RSPNDR) driver' is set to 'Disabled' as specified in CIS benchmark 18.4.9.2 to reduce network attack surface.\n\nLANGUAGE: text\nCODE:\n```\n#18.4.9.2 Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.9.2 Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableRspndr -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitRspndrOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Online Tips Disabled Status in Windows Explorer\nDESCRIPTION: Verifies that Online Tips are disabled by checking if the AllowOnlineTips registry value is set to 0 or that the value exists. Implements CIS benchmark 18.1.3.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> AllowOnlineTips -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !AllowOnlineTips;\n```\n\n----------------------------------------\n\nTITLE: Checking Insecure Guest Logon Settings in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Enable insecure guest logons' is set to 'Disabled'. This setting prevents Windows from allowing insecure guest logons to an SMB server, which could expose sensitive data.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation -> AllowInsecureGuestAuth -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation -> !AllowInsecureGuestAuth;\n```\n\n----------------------------------------\n\nTITLE: Checking HomeGroup Provider Service Setting\nDESCRIPTION: Verifies that 'HomeGroup Provider (HomeGroupProvider)' service is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\HomeGroupProvider -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\HomeGroupProvider -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerPoint Default File Block Behavior Settings\nDESCRIPTION: Validates registry values to ensure the default file block behavior in PowerPoint 2016 is set to prevent blocked files from being opened. This setting enhances security by blocking access to potentially harmful presentations.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\fileblock -> openinprotectedview -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\fileblock -> !openinprotectedview;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Recognition Error Reporting Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off handwriting recognition error reporting' is set to 'Enabled' by verifying that the PreventHandwritingErrorReports registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.4 Ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking UPnP Device Host Service Status in Windows Registry\nDESCRIPTION: Verifies that the UPnP Device Host service (upnphost) is set to 'Disabled' per CIS benchmark 5.31. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\upnphost -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\upnphost -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Registry Settings\nDESCRIPTION: Validates that ICMP redirects are disabled by checking the EnableICMPRedirect registry value is not set to 1.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> EnableICMPRedirect -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !EnableICMPRedirect;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Zone Protected View in Excel\nDESCRIPTION: Registry check to ensure that Protected View is enabled for files from the Internet zone in Microsoft Excel. This provides additional protection by opening potentially dangerous files in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\protectedview -> disableinternetfilesinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\protectedview -> !disableinternetfilesinpv;\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Default Permissions Registry Configuration\nDESCRIPTION: Verifies that 'System objects: Strengthen default permissions of internal system objects' is set to 'Enabled' by checking if the ProtectionMode registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager -> ProtectionMode -> !1;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Apache User Account Shell\nDESCRIPTION: Audit rule that checks if the Apache user account has a valid shell, which is a security risk. Apache service accounts should have non-interactive shells like /bin/false or /sbin/nologin to prevent direct login.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 3.2: Apache User Account has got a valid shell] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:/etc/passwd -> r:/var/www && !r:\\.*/bin/false$|/sbin/nologin$;\n```\n\n----------------------------------------\n\nTITLE: Detecting Daytime-stream Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if daytime-stream service is enabled through xinetd. This implements CIS benchmark 2.1.15 by checking the relevant xinetd configuration file for service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/daytime-stream -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Verifying Setup Event Log Size\nDESCRIPTION: Checks if the Setup Event Log maximum size is set to at least 32,768 KB to ensure sufficient storage for system installation and configuration events.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC UIAccess Applications Secure Location Setting in Windows Registry\nDESCRIPTION: Checks that 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is set to 'Enabled' by verifying EnableSecureUIAPaths registry value is not 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableSecureUIAPaths -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft MAPS Disabled Registry Setting in Windows Defender\nDESCRIPTION: This rule checks that 'Join Microsoft MAPS' is set to 'Disabled' by verifying the SpynetReporting registry key is not set to 0, which would comply with CIS benchmark 18.9.69.3.1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for HTTP Print Driver Download Settings\nDESCRIPTION: Verifies that 'Turn off downloading of print drivers over HTTP' setting is enabled by checking for DisableWebPnPDownload=1 in the registry. This reduces the risk of users downloading and installing malicious print drivers.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to detect TFTP server enabled via xinetd\nDESCRIPTION: Checks if TFTP service is enabled in xinetd configuration by verifying if it's not commented out and has disable set to no.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking System Event Log Behavior in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'System: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' in Windows registry. Ensures the Retention value is set to 0 in the System Event Log policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for PowerPoint Add-ins Management\nDESCRIPTION: OSSEC audit rules to verify that unmanaged add-ins are blocked in PowerPoint. These settings help prevent unauthorized add-ins from running in PowerPoint presentations.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\resiliency -> restricttolist -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\resiliency -> !restricttolist;\n```\n\n----------------------------------------\n\nTITLE: Checking LimitRequestFields Directive in Apache Configuration\nDESCRIPTION: This code checks that the LimitRequestFields directive is set to 100 or less in Apache configuration files, per CIS benchmark section 10.2. This limits the number of HTTP headers in a request to prevent resource consumption attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^limitrequestfields\\s\\d\\d*;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d1;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d2;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d3;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d4;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d5;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d6;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d7;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d8;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+1\\d9;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+11\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+12\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+13\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+14\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+15\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+16\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+17\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+18\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+19\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+2\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+3\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+4\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+5\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+6\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+7\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+8\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+9\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfields\\s+\\d\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Install Service Disabled Status\nDESCRIPTION: Verifies that the Windows Store Install Service is disabled by checking if its Start registry value is set to 4 or that the Start value exists. Implements CIS benchmark 5.40.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\InstallService -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\InstallService -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Word Managed Add-ins Policy\nDESCRIPTION: OSSEC audit rules to verify that the list of managed add-ins policy is enabled for Word. This ensures that the managed add-ins list feature is active and enforcing add-in restrictions in Word.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\resiliency\\addinlist -> policyon -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\resiliency\\addinlist -> !policyon;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled NetFS Service in OSSEC\nDESCRIPTION: OSSEC rule that checks if NetFS service is enabled at boot time. This check satisfies PCI-DSS requirement 2.2.2 which requires disabling unnecessary network file system services.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - Disable standard boot services - NetFS Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Windows Handwriting Recognition Error Reporting Check in OSSEC\nDESCRIPTION: Verifies handwriting recognition error reporting is disabled by checking if the PreventHandwritingErrorReports registry value is set to 1 in the HandwritingErrorReports policy path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.8.20.1.4: Ensure 'Turn off handwriting recognition error reporting' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking Peer-to-Peer Networking Services Disabled Status\nDESCRIPTION: Verifies that Microsoft Peer-to-Peer Networking Services are disabled by checking if the Disabled registry value is set to 1. Implements CIS benchmark 18.5.10.2.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Xbox Game Monitoring Service Status in Windows Registry\nDESCRIPTION: Verifies that the Xbox Game Monitoring service (xbgm) is set to 'Disabled' per CIS benchmark 5.43. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\xbgm -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\xbgm -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking SEHOP Protection Setting in OSSEC\nDESCRIPTION: OSSEC rule that checks if 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled' according to CIS benchmark 18.3.4. The rule identifies non-compliant registry values in the kernel session manager.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.3.4 Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.3.4 Ensure 'Enable Structured Exception Handling Overwrite Protection (SEHOP)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\kernel -> DisableExceptionChainValidation -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\kernel -> !DisableExceptionChainValidation;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Options Restrictions in Apache\nDESCRIPTION: Audit rule that checks if Options directives are minimized for directories. The rule specifically looks for the 'Includes' option which can be a security risk as it enables server-side includes.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.3: Minimize Options for other directories] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:options\\sincludes;\nf:$main-conf -> !r:^# && r:options\\sincludes;\n```\n\n----------------------------------------\n\nTITLE: Checking LimitRequestFieldsize Directive in Apache Configuration\nDESCRIPTION: This code validates that the LimitRequestFieldsize directive is set to 1024 or less in Apache configuration files, as specified in CIS benchmark section 10.3. This prevents oversized HTTP header fields that could be used in attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^limitrequestfieldsize\\s+\\d\\d*;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d25;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d26;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d27;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d28;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d29;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d3\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d4\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d5\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d6\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d7\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d8\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+1\\d9\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+11\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+12\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+13\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+14\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+15\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+16\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+17\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+18\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+19\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+2\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+3\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+4\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+5\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+6\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+7\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+8\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+9\\d\\d\\d;\nf:$main-conf -> !r:^# && r:limitrequestfieldsize\\s+\\d\\d\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking for User .rhosts Files\nDESCRIPTION: Detects the presence of .rhosts files in user home directories. These files can allow remote command execution without password authentication and should be removed for security.\n\nLANGUAGE: plaintext\nCODE:\n```\nd:$home_dirs -> r:^.rhosts$;\n```\n\n----------------------------------------\n\nTITLE: Detecting Talk Server in xinetd and systemd\nDESCRIPTION: Checks for enabled talk service in xinetd configuration and systemd service files. Part of CIS SLES12 benchmark section 5.1.5.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/talk -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/ntalk.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Implementing CRC (Cyclic Redundancy Check) for GZIP in C\nDESCRIPTION: Sample C implementation of CRC (Cyclic Redundancy Check) for the GZIP format. The code provides functions to initialize a CRC table, update a running CRC with new data, and calculate a CRC for a buffer. This implementation is referenced in RFC 1952 as a practical example of CRC calculation.\n\nLANGUAGE: C\nCODE:\n```\n/* Table of CRCs of all 8-bit messages. */\nunsigned long crc_table[256];\n\n/* Flag: has the table been computed? Initially false. */\nint crc_table_computed = 0;\n\n/* Make the table for a fast CRC. */\nvoid make_crc_table(void)\n{\n  unsigned long c;\n  int n, k;\n  for (n = 0; n < 256; n++) {\n    c = (unsigned long) n;\n    for (k = 0; k < 8; k++) {\n      if (c & 1) {\n        c = 0xedb88320L ^ (c >> 1);\n      } else {\n        c = c >> 1;\n      }\n    }\n    crc_table[n] = c;\n  }\n  crc_table_computed = 1;\n}\n```\n\nLANGUAGE: C\nCODE:\n```\n/*\n   Update a running crc with the bytes buf[0..len-1] and return\n the updated crc. The crc should be initialized to zero. Pre- and\n post-conditioning (one's complement) is performed within this\n function so it shouldn't be done by the caller. Usage example:\n\n   unsigned long crc = 0L;\n\n   while (read_buffer(buffer, length) != EOF) {\n     crc = update_crc(crc, buffer, length);\n   }\n   if (crc != original_crc) error();\n*/\nunsigned long update_crc(unsigned long crc,\n                unsigned char *buf, int len)\n{\n  unsigned long c = crc ^ 0xffffffffL;\n  int n;\n\n  if (!crc_table_computed)\n    make_crc_table();\n  for (n = 0; n < len; n++) {\n    c = crc_table[(c ^ buf[n]) & 0xff] ^ (c >> 8);\n  }\n  return c ^ 0xffffffffL;\n}\n```\n\nLANGUAGE: C\nCODE:\n```\n/* Return the CRC of the bytes buf[0..len-1]. */\nunsigned long crc(unsigned char *buf, int len)\n{\n  return update_crc(0L, buf, len);\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Password Requirements for Wake when Plugged In in Windows Registry\nDESCRIPTION: Validates the registry setting that requires a password when a computer wakes when plugged in. Checks for the presence of the ACSettingIndex registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> !ACSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Secure RPC Communication in Registry\nDESCRIPTION: Confirms that Terminal Services requires secure RPC communication by checking if the fEncryptRPCTraffic registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fEncryptRPCTraffic -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fEncryptRPCTraffic;\n```\n\n----------------------------------------\n\nTITLE: Windows Connect Now Wireless Settings Check in OSSEC\nDESCRIPTION: Verifies Windows Connect Now wireless configuration functionality is disabled by checking multiple registry values related to different WCN Registrars.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.4.20.1: Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> EnableRegistrars -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !EnableRegistrars;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableUPnPRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableUPnPRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableInBand802DOT11Registrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableInBand802DOT11Registrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableFlashConfigRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableFlashConfigRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableWPDRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableWPDRegistrar;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled DNS Server in OSSEC\nDESCRIPTION: OSSEC rule to check if DNS server (named) is enabled at boot time, which should be disabled unless specifically required for system functionality, in compliance with PCI DSS 2.2.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - X.X.X - Disable standard boot services - DNS server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnamed$;\n```\n\n----------------------------------------\n\nTITLE: Validating Indexing of Encrypted Files Setting\nDESCRIPTION: Ensures that indexing of encrypted files is disabled by checking that the AllowIndexingEncryptedStoresOrItems registry value is set to 0 per CIS benchmark 18.9.54.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowIndexingEncryptedStoresOrItems -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking for Legacy + Entries in shadow File\nDESCRIPTION: Detects legacy '+' entries in the shadow file, which could allow NIS entries and pose a security risk. These entries are considered insecure and should be removed.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/shadow -> !r:^# && r:^+:;\n```\n\n----------------------------------------\n\nTITLE: Configuring Apache Error Log Level Detection Rules\nDESCRIPTION: Rules to verify Apache error log is set to at least 'notice' level, ensuring important operational events are logged correctly.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^# && r:loglevel\\snotice\\score\\p && r:warn|emerg|alert|crit|error|notice;\nf:$main-conf -> !r:loglevel\\snotice\\score\\p && !r:info|debug;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Office Executable Content Creation Prevention\nDESCRIPTION: OSSEC audit rules to verify that Office applications are blocked from creating executable content. This security setting prevents Office from generating potentially malicious executable files.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 3B576869-A4EC-4529-8536-B80A7769E899 -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !3B576869-A4EC-4529-8536-B80A7769E899;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Automatic Updates Settings\nDESCRIPTION: Verifies that Automatic Updates are enabled by checking the NoAutoUpdate registry key is not set to 1 or doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Elevation Prompt Behavior for Standard Users\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for standard users' is set to automatically deny elevation requests by checking the ConsentPromptBehaviorUser registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorUser;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Removable Media Format Permissions\nDESCRIPTION: Verifies the 'Devices: Allowed to format and eject removable media' policy is set to 'Administrators' in Windows Server 2016. Checks if the AllocateDASD registry value is correctly configured.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.4.1 Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Acceptance in SLES11\nDESCRIPTION: Verifies that ICMP redirect acceptance is disabled in both default and all interfaces to prevent potential routing-based attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/accept_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP Keep-Alive Time Configuration\nDESCRIPTION: Verifies that TCP keep-alive packets are sent every 5 minutes (300,000 milliseconds) by checking if the KeepAliveTime registry value is set to 0x493e0. Implements CIS benchmark 18.4.6.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Notifications in Windows Registry\nDESCRIPTION: Verifies that Windows Firewall notifications are disabled for the Domain Profile per CIS benchmark 9.1.4. The check confirms the DisableNotifications value is not set to 0 or is missing across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> !DisableNotifications;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> !DisableNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking SMB v1 Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Configure SMB v1 server' is set to 'Disabled' according to CIS benchmark 18.3.3. The rule checks for non-compliant registry values in the LanmanServer parameters.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.3.3 Ensure 'Configure SMB v1 server' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.3.3 Ensure 'Configure SMB v1 server' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters -> SMB1 -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters -> !SMB1;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Apache User Manual\nDESCRIPTION: Audit rule that checks if the Apache user manual is installed. The manual should be removed in production environments as it may provide information useful for attackers.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.4.2: Remove the Apache user manual] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:/etc/httpd/conf.d -> manual.conf; \nd:/etc/apache2/conf-enabled -> apache2-doc.conf;\n```\n\n----------------------------------------\n\nTITLE: Checking Idle Session Time Limit Settings in Registry\nDESCRIPTION: This rule verifies that the time limit for active but idle Remote Desktop Services sessions is set to 15 minutes or less by checking various possible hexadecimal values in the MaxIdleTime registry key. The rule triggers if the key is missing or set to a value exceeding 15 minutes.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba\\D;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbb\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbc\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbd\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbe\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbf\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbc\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbd\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbe\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbf\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dc\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dd\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:de\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:df\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:e\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:f\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:\\w\\w\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxIdleTime;\n```\n\n----------------------------------------\n\nTITLE: Checking Camera Usage Settings in Registry with OSSEC\nDESCRIPTION: Verifies that 'Allow Use of Camera' is disabled by checking if AllowCamera is set to 0. This helps prevent unauthorized access to the camera and protects user privacy.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Camera -> AllowCamera -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Camera -> !AllowCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Client Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Enable Windows NTP Client' is set to 'Enabled' by verifying the Enabled registry value is set to 1 under the W32Time NtpClient TimeProviders path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.49.1.1 Ensure 'Enable Windows NTP Client' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> Enabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpClient -> !Enabled;\n```\n\n----------------------------------------\n\nTITLE: Defining Apache Configuration File Variables for OSSEC Audit\nDESCRIPTION: Sets up variables pointing to common Apache configuration file paths on different Linux distributions to be used in the subsequent security checks.\n\nLANGUAGE: bash\nCODE:\n```\n$main-conf=/etc/apache2/apache2.conf,/etc/httpd/conf/httpd.conf;\n$conf-dirs=/etc/apache2/conf-enabled,/etc/apache2/mods-enabled,/etc/apache2/sites-enabled,/etc/httpd/conf.d,/etc/httpd/modsecurity.d;\n$ssl-confs=/etc/apache2/mods-enabled/ssl.conf,/etc/httpd/conf.d/ssl.conf;\n$mods-en=/etc/apache2/mods-enabled;\n$request-confs=/etc/httpd/conf/httpd.conf,/etc/apache2/mods-enabled/reqtimeout.conf;\n$traceen=/etc/apache2/apache2.conf,/etc/httpd/conf/httpd.conf,/etc/apache2/conf-enabled/security.conf;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Settings in Windows Registry\nDESCRIPTION: Validates the registry settings that disable Windows Error Reporting. Checks for the presence of the Disabled and DoReport registry keys and verifies they have the correct values.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> DoReport -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> !DoReport;\n```\n\n----------------------------------------\n\nTITLE: Checking Untrusted Font Blocking Settings\nDESCRIPTION: Registry check to ensure untrusted fonts are blocked and events are logged for improved security against font-based exploits.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.8.26.1 Ensure 'Untrusted Font Blocking' is set to 'Enabled: Block untrusted fonts and log events'\n[CIS - Microsoft Windows Server 2016 - 18.8.26.1 Ensure 'Untrusted Font Blocking' is set to 'Enabled: Block untrusted fonts and log events'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\MitigationOptions -> MitigationOptions_FontBocking -> !1000000000000;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\MitigationOptions -> !MitigationOptions_FontBocking;\n```\n\n----------------------------------------\n\nTITLE: Checking enumeration of connected users on domain-joined computers\nDESCRIPTION: Verifies that Windows is configured to not enumerate connected users on domain-joined computers. This prevents information disclosure about who is using the system.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontEnumerateConnectedUsers -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontEnumerateConnectedUsers;\n```\n\n----------------------------------------\n\nTITLE: HTTP Proxy Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify Squid proxy server is disabled on RHEL5 systems. Checks for start scripts in runlevel directories, satisfying CIS requirement 3.14 and PCI DSS 2.2.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.14 - Disable standard boot services - Squid Enabled {CIS: 3.14 RHEL5} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dsquid$;\n```\n\n----------------------------------------\n\nTITLE: Verifying RSPNDR Driver Configuration\nDESCRIPTION: Checks that 'Turn on Responder (RSPNDR) driver' is disabled. This rule verifies multiple registry values to ensure the Link-Layer Topology Discovery Responder is disabled across all network types.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableRspndr -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitRspndrOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Enumerate local users on domain-joined computers registry setting in OSSEC\nDESCRIPTION: Verifies that 'Enumerate local users on domain-joined computers' is set to 'Disabled' by checking if the EnumerateLocalUsers registry value equals 0 in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnumerateLocalUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Password Environment Variable Check in OSSEC\nDESCRIPTION: Searches for MYSQL_PWD environment variable in user profiles which is insecure according to CIS recommendation 1.6. Using this variable exposes database passwords in process lists.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 1.6: 'MYSQL_PWD' Is in Use] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$enviroment_files -> r:\\.*MYSQL_PWD\\.*;\n```\n\n----------------------------------------\n\nTITLE: Checking System Event Log Behavior\nDESCRIPTION: Verifies that the System Event Log is set to not automatically clear when it reaches maximum size by checking the Retention value is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Background Refresh of Group Policy\nDESCRIPTION: Checks that background refresh of Group Policy is not turned off by ensuring DisableBkGndGroupPolicy is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableBkGndGroupPolicy -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Digest Authentication Setting\nDESCRIPTION: Verifies that Digest authentication for WinRM Client is disabled by checking the AllowDigest registry value is not set to anything other than 0, or the key doesn't exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowDigest -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> !AllowDigest;\n```\n\n----------------------------------------\n\nTITLE: Checking VMware ESX VM Hardware Security Settings\nDESCRIPTION: Security rules to verify that virtual machine hardware configurations follow security best practices. These checks include verifying disk persistence settings and ensuring unnecessary hardware like floppy drives, serial ports, and parallel ports are disabled.\n\nLANGUAGE: config\nCODE:\n```\nd:/vmfs/volumes -> .vmx$ -> r:^scsi\\d:\\d.mode && r:!independent-nonpersistent;\n\nd:/vmfs/volumes -> .vmx$ -> r:^floppy\\d+.present && r:!false;\n\nd:/vmfs/volumes -> .vmx$ -> r:^serial\\d+.present && r:!false;\n\nd:/vmfs/volumes -> .vmx$ -> r:^parallel\\d+.present && r:!false;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Feature Updates Deferral Settings\nDESCRIPTION: Verifies that Feature Updates are configured for Semi-Annual Channel with at least 180 days deferral by checking appropriate registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !DeferFeatureUpdates;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:10\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:11\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:12\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:13\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:14\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:15\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:16\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> r:17\\d;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferFeatureUpdatesPeriodInDays -> !r:\\d\\d\\d+;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !DeferFeatureUpdatesPeriodInDays;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> BranchReadinessLevel -> !32;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !BranchReadinessLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Path in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile log file path is set to the correct location per CIS benchmark 9.1.5. The check confirms the LogFilePath value points to the system32\\logfiles\\firewall directory.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Standard User Elevation Prompt Behavior Setting\nDESCRIPTION: Verifies that 'Behavior of the elevation prompt for standard users' is set to automatically deny elevation requests by checking ConsentPromptBehaviorUser registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorUser;\n```\n\n----------------------------------------\n\nTITLE: Non-compressed Block Format in DEFLATE\nDESCRIPTION: Specification of the format for non-compressed blocks (BTYPE=00) in the DEFLATE algorithm. Shows the byte structure with LEN (number of data bytes) followed by NLEN (one's complement of LEN) and the literal data.\n\nLANGUAGE: plain text\nCODE:\n```\n  0   1   2   3   4...\n+---+---+---+---+================================+\n|  LEN  | NLEN  |... LEN bytes of literal data...|\n+---+---+---+---+================================+\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Inbound Connections in OSSEC\nDESCRIPTION: OSSEC rule that verifies Windows Firewall Public profile inbound connections are set to Block (default). It checks if DefaultInboundAction is set to 0 (allow) in either policy or current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Displaying Error Message for Non-Root Users in OSSEC\nDESCRIPTION: This code snippet shows an error message (Error 0x2) displayed when a user attempts to run an OSSEC script without root privileges. The message clearly indicates that root permissions are required to execute the script.\n\nLANGUAGE: bash\nCODE:\n```\nError 0x2.\nYou must be root to use this script.\n```\n\n----------------------------------------\n\nTITLE: Verifying FTP Default File Creation Mask\nDESCRIPTION: Rule to check the default file creation mask for FTP users is set to a secure value (027), as specified in CIS Solaris 11 benchmark section 7.4. This ensures proper permissions for files uploaded via FTP.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/proftpd.conf -> !r:^umask\\s*027;\nf:/etc/proftpd.conf -> !r:^# && r:umask\\s*026;\nf:/etc/proftpd.conf -> !r:^# && r:umask\\s*022;\n```\n\n----------------------------------------\n\nTITLE: Checking Time Service Configuration in OSSEC\nDESCRIPTION: OSSEC rule to check that time service is not enabled in inetd.conf as per CIS Benchmark 5.6.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/inetd.conf -> !r:^# && r:time;\n```\n\n----------------------------------------\n\nTITLE: Checking Registration Wizard Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables Registration Wizard when URL is referring to Microsoft.com. Checks for the presence of the NoRegistration registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Autoplay for Non-Volume Devices Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled' as per CIS benchmark 18.9.8.1. Checks if NoAutoplayfornonVolume value exists and is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoAutoplayfornonVolume -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoAutoplayfornonVolume;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet download for Web publishing and ordering wizards\nDESCRIPTION: Verifies that Internet downloads for Web publishing and online ordering wizards are disabled. This prevents potentially risky connections to online services.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: X Windows Check in OSSEC\nDESCRIPTION: OSSEC rule to verify X11 is disabled on RHEL5 systems. Examines /etc/inittab to ensure X Windows (runlevel 5) is not the default, satisfying CIS requirement 3.3 and PCI DSS 2.2.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.3 - X11 not disabled {CIS: 3.3 RHEL5} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/inittab -> !r:^# && r:id:5;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Services Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables Internet downloads for Web publishing and online ordering wizards. Checks for the presence of the NoWebServices registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoWebServices -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoWebServices;\n```\n\n----------------------------------------\n\nTITLE: Checking User Input Methods Copy Prevention in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Disallow copying of user input methods to the system account for sign-in' is set to 'Enabled' per CIS benchmark 18.8.24.1. The check verifies that the BlockUserInputMethodsForSignIn registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> BlockUserInputMethodsForSignIn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> !BlockUserInputMethodsForSignIn;\n```\n\n----------------------------------------\n\nTITLE: Checking for Public Key Authentication in OSSEC Rootcheck\nDESCRIPTION: Ensures that public key authentication is enabled, which is considered more secure than password authentication as it uses asymmetric cryptography.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 4: No Public Key autentication {PCI_DSS: 2.2.4}] [any] [4]\nf:$sshd_file -> !r:^# && r:PubkeyAuthentication\\.+no;\nf:$sshd_file -> r:^#\\s*PubkeyAuthentication;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Outbound Connections Setting\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Outbound connections' is set to 'Allow' by checking the DefaultOutboundAction registry value in both policy and current configuration locations.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking registry policy processing during background processing\nDESCRIPTION: Verifies that Windows is configured to apply registry policies during periodic background processing. This ensures that policy settings are consistently applied.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoBackgroundPolicy;\n```\n\n----------------------------------------\n\nTITLE: Detecting Information Leakage via Default Apache Content\nDESCRIPTION: Rules to check that default content and directory indexing are disabled to prevent information leakage.\n\nLANGUAGE: regex\nCODE:\n```\nd:$conf-dirs -> conf -> !r:^\\t*\\s*# && r:include\\s*\\w*httpd-autoindex.conf;\nd:$conf-dirs -> conf -> !r:^\\t*\\s*# && r:alias\\s*/icons/\\s*\\.*;\n```\n\n----------------------------------------\n\nTITLE: Defining RC Scripts Location Variable in OSSEC Audit Configuration\nDESCRIPTION: Sets the variable $rc_dirs to specify the locations of run-level script directories that need to be checked in SUSE Linux Enterprise Server 11.\n\nLANGUAGE: bash\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive Logon Password Expiration Warning Settings in Windows Server 2016\nDESCRIPTION: Validates that the 'Interactive logon: Prompt user to change password before expiration' setting is properly configured between 5 and 14 days. This rule checks the PasswordExpiryWarning registry value to ensure it's not set to values outside the acceptable range.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 2;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 3;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 4;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> 0F;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> PasswordExpiryWarning -> r:\\w\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password Requirement (Battery) in Windows 10\nDESCRIPTION: Verifies that 'Require a password when a computer wakes (on battery)' is set to 'Enabled' by checking the DCSettingIndex registry value is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.33.6.5 Ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Log Size Limit in Registry\nDESCRIPTION: Verifies that the Windows Firewall for Private Profile has the log size limit set to at least 16,384 KB. Uses multiple regex patterns to match different numeric formats representing values less than the minimum required size.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking LDAP Client Signing Requirements in Windows 10\nDESCRIPTION: Verifies that 'Network security: LDAP client signing requirements' is set to 'Negotiate signing' or higher by checking that the LDAPClientIntegrity registry value is at least 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LDAP -> LDAPClientIntegrity -> !1;\n```\n\n----------------------------------------\n\nTITLE: Implementing File Compression and Decompression with Zlib in Visual Basic\nDESCRIPTION: Complete implementation of file compression and decompression functions using zlib. This example stores the original file size at the end of the compressed file to handle decompression without knowing the uncompressed size beforehand.\n\nLANGUAGE: Visual Basic\nCODE:\n```\nOption Explicit\nPrivate lngpvtPcnSml As Long 'Stores value for 'lngPercentSmaller'\nPrivate Const SUCCESS As Long = 0\nPrivate Const strFilExt As String = \".cpr\"\nPrivate Declare Function lngfncCpr Lib \"zlib.dll\" Alias \"compress2\" (ByRef\ndest As Any, ByRef destLen As Any, ByRef src As Any, ByVal srcLen As Long,\nByVal level As Integer) As Long\nPrivate Declare Function lngfncUcp Lib \"zlib.dll\" Alias \"uncompress\" (ByRef\ndest As Any, ByRef destLen As Any, ByRef src As Any, ByVal srcLen As Long)\nAs Long\n\nPublic Sub subCompressFile(ByVal strargOriFilPth As String, Optional ByVal\nstrargCprFilPth As String, Optional ByVal intLvl As Integer = 9)\n    Dim strCprPth As String\n    Dim lngOriSiz As Long\n    Dim lngCprSiz As Long\n    Dim bytaryOri() As Byte\n    Dim bytaryCpr() As Byte\n    lngOriSiz = FileLen(strargOriFilPth)\n    ReDim bytaryOri(lngOriSiz - 1)\n    Open strargOriFilPth For Binary Access Read As #1\n        Get #1, , bytaryOri()\n    Close #1\n    strCprPth = IIf(strargCprFilPth = \"\", strargOriFilPth, strargCprFilPth)\n'Select file path and name\n    strCprPth = strCprPth & IIf(Right(strCprPth, Len(strFilExt)) =\nstrFilExt, \"\", strFilExt) 'Add file extension if not exists\n    lngCprSiz = (lngOriSiz * 1.01) + 12 'Compression needs temporary a bit\nmore space then original file size\n    ReDim bytaryCpr(lngCprSiz - 1)\n    If lngfncCpr(bytaryCpr(0), lngCprSiz, bytaryOri(0), lngOriSiz, intLvl) =\nSUCCESS Then\n        lngpvtPcnSml = (1# - (lngCprSiz / lngOriSiz)) * 100\n        ReDim Preserve bytaryCpr(lngCprSiz - 1)\n        Open strCprPth For Binary Access Write As #1\n            Put #1, , bytaryCpr()\n            Put #1, , lngOriSiz 'Add the the original size value to the end\n(last 4 bytes)\n        Close #1\n    Else\n        MsgBox \"Compression error\"\n    End If\n    Erase bytaryCpr\n    Erase bytaryOri\nEnd Sub\n\nPublic Sub subUncompressFile(ByVal strargFilPth As String)\n    Dim bytaryCpr() As Byte\n    Dim bytaryOri() As Byte\n    Dim lngOriSiz As Long\n    Dim lngCprSiz As Long\n    Dim strOriPth As String\n    lngCprSiz = FileLen(strargFilPth)\n    ReDim bytaryCpr(lngCprSiz - 1)\n    Open strargFilPth For Binary Access Read As #1\n        Get #1, , bytaryCpr()\n    Close #1\n    'Read the original file size value:\n    lngOriSiz = bytaryCpr(lngCprSiz - 1) * (2 ^ 24) _\n              + bytaryCpr(lngCprSiz - 2) * (2 ^ 16) _\n              + bytaryCpr(lngCprSiz - 3) * (2 ^ 8) _\n              + bytaryCpr(lngCprSiz - 4)\n    ReDim Preserve bytaryCpr(lngCprSiz - 5) 'Cut of the original size value\n    ReDim bytaryOri(lngOriSiz - 1)\n    If lngfncUcp(bytaryOri(0), lngOriSiz, bytaryCpr(0), lngCprSiz) = SUCCESS\nThen\n        strOriPth = Left(strargFilPth, Len(strargFilPth) - Len(strFilExt))\n        Open strOriPth For Binary Access Write As #1\n            Put #1, , bytaryOri()\n        Close #1\n    Else\n        MsgBox \"Uncompression error\"\n    End If\n    Erase bytaryCpr\n    Erase bytaryOri\nEnd Sub\nPublic Property Get lngPercentSmaller() As Long\n    lngPercentSmaller = lngpvtPcnSml\nEnd Property\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile State Registry Configuration\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Firewall state' is set to 'On' by checking if the EnableFirewall registry value is set to 0 in both policy and local settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Bridge Installation Prohibition in Windows Registry\nDESCRIPTION: OSSEC rule to verify that installation and configuration of Network Bridge on DNS domain networks is prohibited. The rule checks if the NC_AllowNetBridge_NLA registry value is set to 1 or is missing entirely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service RunAs Credentials Storage Settings\nDESCRIPTION: Ensures WinRM is configured to not store RunAs credentials by verifying the DisableRunAs registry key is set to 1 or exists.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> DisableRunAs -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> !DisableRunAs;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Default CGI Content (printenv)\nDESCRIPTION: Audit rule that checks if the default CGI script 'printenv' is present. Default CGI scripts should be removed as they can expose environment variables and system information.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.5: Remove default CGI content printenv] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:/var/www/cgi-bin -> printenv;\nd:/usr/lib/cgi-bin -> printenv;\n```\n\n----------------------------------------\n\nTITLE: Checking TCP Data Retransmission Settings for IPv4\nDESCRIPTION: Verifies that 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 3. This rule checks the standard TCP/IP Parameters registry to ensure retransmission attempts are properly limited.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging Size\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Logging: Size limit (KB)' is set to '16384 KB or greater' as required by CIS benchmark 9.3.8 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Continue experiences on this device' setting\nDESCRIPTION: Verifies that the 'Continue experiences on this device' feature is disabled. This prevents potential data sharing between devices that could compromise security.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableCdp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableCdp;\n```\n\n----------------------------------------\n\nTITLE: Auditing Kernel Module Loading and Unloading in Debian Linux\nDESCRIPTION: Configuration for monitoring kernel module operations according to CIS Benchmark 8.1.17. This tracks the use of insmod, rmmod, modprobe commands and the init_module/delete_module syscalls to detect unauthorized kernel modifications.\n\nLANGUAGE: auditd\nCODE:\n```\n-w /sbin/insmod -p x -k modules\n```\n\nLANGUAGE: auditd\nCODE:\n```\n-w /sbin/rmmod -p x -k modules\n```\n\nLANGUAGE: auditd\nCODE:\n```\n-w /sbin/modprobe -p x -k modules\n```\n\nLANGUAGE: auditd\nCODE:\n```\n-a always,exit -F arch=b32 -S init_module -S delete_module -k modules\n```\n\n----------------------------------------\n\nTITLE: Checking Enclosure Download Prevention for Internet Explorer Registry Setting\nDESCRIPTION: Verifies that downloading of enclosures in Internet Explorer is disabled by checking if DisableEnclosureDownload is set to 1 and not missing, which prevents automatic downloading of enclosures in RSS feeds.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> DisableEnclosureDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Internet Explorer\\Feeds -> !DisableEnclosureDownload;\n```\n\n----------------------------------------\n\nTITLE: Configuring Second ICQ Detection Rule in OSSEC Linux Audit\nDESCRIPTION: Additional OSSEC rule for detecting ICQ installation through registry entries, using a different registry path. Includes PCI DSS compliance reference 10.6.1 and reference URL.\n\nLANGUAGE: conf\nCODE:\n```\n[Chat/IM - ICQ {PCI_DSS: 10.6.1}] [any] [http://www.icq.com]\nr:HKLM\\SOFTWARE\\Mirabilis\\ICQ;\n```\n\n----------------------------------------\n\nTITLE: Checking delegation of non-exportable credentials\nDESCRIPTION: Verifies that Windows is configured to allow remote hosts to delegate non-exportable credentials. This supports secure credential delegation in enterprise environments.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation -> AllowProtectedCreds -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CredentialsDelegation -> !AllowProtectedCreds;\n```\n\n----------------------------------------\n\nTITLE: Checking SmartScreen Bypass Prevention for Edge in Windows Registry\nDESCRIPTION: Registry checks to ensure Microsoft Edge's SmartScreen cannot be bypassed by users, which enforces CIS Windows Server 2016 benchmark rule 18.9.41.10.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> PreventOverride -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\PhishingFilter -> !PreventOverride;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Notification Settings in Windows Registry\nDESCRIPTION: Checks that 'Windows Firewall: Domain: Settings: Display a notification' is set to 'No' by verifying DisableNotifications registry value is not 0 or missing in policy and current settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> !DisableNotifications;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> !DisableNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Path in Registry\nDESCRIPTION: Registry check for Windows Firewall Private profile logging path. Verifies LogFilePath is set to the correct system directory for both policy and current settings locations.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Slideshow Setting in OSSEC\nDESCRIPTION: OSSEC rule that verifies if 'Prevent enabling lock screen slide show' is set to 'Enabled' according to CIS benchmark 18.1.1.2. The rule checks both for incorrect registry values and missing registry keys that would indicate non-compliance.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.1.1.2 Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 18.1.1.2 Ensure 'Prevent enabling lock screen slide show' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenSlideshow -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenSlideshow;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Bridge Installation Registry Settings\nDESCRIPTION: Validates that installation and configuration of Network Bridge is prohibited by checking the NC_AllowNetBridge_NLA registry value is not set to 1.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_AllowNetBridge_NLA -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_AllowNetBridge_NLA;\n```\n\n----------------------------------------\n\nTITLE: Verifying SSH X11 Forwarding Disablement\nDESCRIPTION: Rules for checking that SSH X11 forwarding is disabled according to CIS benchmark 9.3.4. Reduces attack surface by preventing X11 forwarding.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.4 Disable SSH X11 Forwarding\n[CIS - Debian Linux 7/8 - 9.3.4 Disable SSH X11 Forwarding] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^X11Forwarding\\s+no;\n```\n\n----------------------------------------\n\nTITLE: Defining Global Message Variables in Bash\nDESCRIPTION: Sets global message variables for the OSSEC HIDS installation process, including startup information and system initialization messages.\n\nLANGUAGE: bash\nCODE:\n```\n# Global\nmoreinfo=\"More information at: \"\nstarting=\"Starting OSSEC HIDS\"\nsystemis=\"System is\"\nmodifiedinit=\"Init script modified to start OSSEC HIDS during boot.\"\nnoboot=\"Unknown system. No init script added.\"\n```\n\n----------------------------------------\n\nTITLE: Detecting IP Send Redirects in RHEL7\nDESCRIPTION: OSSEC rule that checks if IP send redirects are enabled, which would violate CIS benchmark 4.1.2 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.1.2 - Network parameters - IP send redirects enabled {CIS: 4.1.2 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Daemon umask Check in OSSEC\nDESCRIPTION: OSSEC rule to verify that the default daemon umask is set to 027 or stricter in RHEL5 systems. Examines /etc/init.d/functions to ensure proper configuration, satisfying CIS requirement 3.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.2 - Set daemon umask - Default umask is higher than 027 {CIS: 3.2 RHEL5}] [all] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/init.d/functions -> !r:^# && r:^umask && <:umask 027;\n```\n\n----------------------------------------\n\nTITLE: Removing a Rule Link for Customization\nDESCRIPTION: Command to remove a symbolic link to a rule file that needs to be customized, where XX represents the two-digit prefix number.\n\nLANGUAGE: bash\nCODE:\n```\nunlink signatures/XXattack_rules.xml\n```\n\n----------------------------------------\n\nTITLE: Configuring Syslog Facility for Apache Error Log\nDESCRIPTION: Rule to check if Apache is configured to use syslog for error logging, which centralizes log management.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:errorlog\\s+\\p*syslog\\p\\.*\\p*;\n```\n\n----------------------------------------\n\nTITLE: Verifying Network Access Password Storage Settings\nDESCRIPTION: Checks that 'Network access: Do not allow storage of passwords and credentials for network authentication' is enabled. This rule ensures that DisableDomainCreds registry value is set to 1, preventing credential storage for network authentication.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> DisableDomainCreds -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !DisableDomainCreds;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop LPT Port Redirection Disable Setting\nDESCRIPTION: Verifies that LPT port redirection in Remote Desktop Services is disabled by checking the fDisableLPT registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableLPT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableLPT;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Logging of Dropped Packets in Registry\nDESCRIPTION: Checks if the Windows Firewall for Private Profile is configured to log dropped packets. The rule looks for a value of 0 in the LogDroppedPackets key, which indicates a non-compliant configuration.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Activate AppArmor Rule for OSSEC\nDESCRIPTION: CIS rule 4.5 that verifies if AppArmor is properly activated in the GRUB configuration. It checks for the required parameters in /etc/default/grub to ensure the system has mandatory access controls active at boot.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 4.5 Activate AppArmor] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/default/grub -> !r:apparmor=1 && !r:security=apparmor;\n```\n\n----------------------------------------\n\nTITLE: Checking User Input Methods Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disallows copying of user input methods to the system account for sign-in. Checks for the presence of the BlockUserInputMethodsForSignIn registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> BlockUserInputMethodsForSignIn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> !BlockUserInputMethodsForSignIn;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Notification Settings in Registry\nDESCRIPTION: Checks if the Windows Firewall for Private Profile is configured to not display notifications. The rule looks for a value of 0 in the DisableNotifications key, which indicates a non-compliant configuration.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining the cJSON Structure in C\nDESCRIPTION: The core cJSON struct definition that represents JSON data in memory. It contains pointers for linked list navigation, type flags, and various value fields to store different types of JSON data.\n\nLANGUAGE: c\nCODE:\n```\n/* The cJSON structure: */\ntypedef struct cJSON\n{\n    struct cJSON *next;\n    struct cJSON *prev;\n    struct cJSON *child;\n    int type;\n    char *valuestring;\n    /* writing to valueint is DEPRECATED, use cJSON_SetNumberValue instead */\n    int valueint;\n    double valuedouble;\n    char *string;\n} cJSON;\n```\n\n----------------------------------------\n\nTITLE: Configuring uTorrent Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting uTorrent P2P client through running processes. Includes PCI DSS compliance reference 10.6.1.\n\nLANGUAGE: conf\nCODE:\n```\n[P2P - UTorrent {PCI_DSS: 10.6.1}] [any] []\np:r:utorrent.exe;\n```\n\n----------------------------------------\n\nTITLE: Checking prohibition of non-domain networks when connected to domain network\nDESCRIPTION: Verifies that Windows is configured to prohibit connections to non-domain networks when connected to domain authenticated networks. This prevents potential data leakage across networks.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fBlockNonDomain -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> !fBlockNonDomain;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Turn off Automatic Download and Install of updates' Registry Setting\nDESCRIPTION: Registry check to ensure 'Turn off Automatic Download and Install of updates' is disabled per CIS benchmark 18.9.61.2. Verifies the AutoDownload value is set to 4.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Security Rules Registry Configuration\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Apply local connection security rules' is set to 'Yes (default)' by checking if the AllowLocalIPsecPolicyMerge registry value is set to 0 in both policy and local settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking PKU2U authentication requests setting\nDESCRIPTION: Verifies that PKU2U authentication requests to use online identities are disabled by checking that AllowOnlineID registry value is set to 0.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\pku2u -> AllowOnlineID -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Dropped Packets Logging in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile is set to log dropped packets per CIS benchmark 9.1.7. The check confirms the LogDroppedPackets value is not set to 0 across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Enhanced Anti-Spoofing for Facial Features in Windows 10\nDESCRIPTION: Verifies that 'Configure enhanced anti-spoofing' is set to 'Enabled' by checking registry values related to EnhancedAntiSpoofing.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.10.1.1 Ensure 'Configure enhanced anti-spoofing' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Biometrics\\FacialFeatures -> EnhancedAntiSpoofing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Biometrics\\FacialFeatures -> !EnhancedAntiSpoofing;\n```\n\n----------------------------------------\n\nTITLE: Checking Password Reuse Limitations\nDESCRIPTION: Rules for verifying password reuse limitations according to CIS benchmark 9.2.3. Ensures proper configuration to prevent password reuse.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.2.3 Limit Password Reuse\n[CIS - Debian Linux 7/8 - 9.2.3 Limit Password Reuse] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/pam.d/common-password -> !r:password [success=1 default=ignore] pam_unix.so obscure sha512 remember=\\d;\n```\n\n----------------------------------------\n\nTITLE: Checking Smart Card Removal Behavior in Windows 10\nDESCRIPTION: Registry checks to ensure the 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher. This validates the system properly locks when a smart card is removed.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.7.9 Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher\n[CIS - Microsoft Windows 10 - 2.3.7.9 Ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> ScRemoveOption -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> !ScRemoveOption;\n```\n\n----------------------------------------\n\nTITLE: Checking MSDT Interactive Communication Settings in Windows Registry\nDESCRIPTION: Verifies that 'Microsoft Support Diagnostic Tool: Turn on MSDT interactive communication with support provider' is disabled by confirming DisableQueryRemoteServer is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> DisableQueryRemoteServer -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> !DisableQueryRemoteServer;\n```\n\n----------------------------------------\n\nTITLE: Defining Compression Level Enumeration Types in Delphi\nDESCRIPTION: Shows the existing TCompressionLevel enumeration and a suggested improved version with the 'z' prefix to avoid conflicts with TColor-like symbols. This enumeration defines compression levels from none to maximum compression.\n\nLANGUAGE: Delphi\nCODE:\n```\nTCompressionLevel = (clNone, clFastest, clDefault, clMax);\n```\n\n----------------------------------------\n\nTITLE: Checking Warning Banners for Login Services\nDESCRIPTION: Ensures that warning banners exist for standard login services. These banners provide legal notices and should be configured to display to users before logging in to the system.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:!/etc/motd;\nf:!/etc/issue;\nf:!/etc/issue.net;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Convenience PIN Sign-in\nDESCRIPTION: OSSEC rule that checks if 'Turn on convenience PIN sign-in' is set to 'Disabled' by verifying the AllowDomainPINLogon registry key is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password Requirement (Plugged in) in Windows 10\nDESCRIPTION: Verifies that 'Require a password when a computer wakes (plugged in)' is set to 'Enabled' by checking the ACSettingIndex registry value is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.33.6.6 Ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Xbox Accessory Management Service Status in Windows Registry\nDESCRIPTION: Verifies that the Xbox Accessory Management Service (XboxGipSvc) is set to 'Disabled' per CIS benchmark 5.42. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XboxGipSvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XboxGipSvc -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking OS Information in Login Banners\nDESCRIPTION: Checks if OS information is included in login warning banners. System banners should not reveal OS information as this could provide valuable information to potential attackers.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/motd -> r:debian|gnu|linux;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Support Diagnostic Tool Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if the Microsoft Support Diagnostic Tool interactive communication with support provider is disabled, as per CIS benchmark 18.8.39.5.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> DisableQueryRemoteServer -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\ScriptedDiagnosticsProvider\\Policy -> !DisableQueryRemoteServer;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Outbound Connections Registry Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile allows outbound connections by default. Validates registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: GZIP Extra Field Structure\nDESCRIPTION: Diagram showing the structure of an optional extra field in the GZIP header, consisting of subfield ID bytes (SI1 and SI2), length (LEN), and subfield data.\n\nLANGUAGE: plain\nCODE:\n```\n            +---+---+---+---+==================================+\n            |SI1|SI2|  LEN  |... LEN bytes of subfield data ...|\n            +---+---+---+---+==================================+\n```\n\n----------------------------------------\n\nTITLE: Checking Xbox Live Networking Service Status in Windows Registry\nDESCRIPTION: Verifies that the Xbox Live Networking Service (XboxNetApiSvc) is set to 'Disabled' per CIS benchmark 4.46. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XboxNetApiSvce -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XboxNetApiSvce -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Interactive logon: Smart card removal behavior\nDESCRIPTION: Registry check to ensure 'Interactive logon: Smart card removal behavior' is set to 'Lock Workstation' or higher. Verifies the ScRemoveOption registry value is not set to 0 or missing.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> ScRemoveOption -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> !ScRemoveOption;\n```\n\n----------------------------------------\n\nTITLE: Detecting Echo-stream Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if echo-stream service is enabled through xinetd. This implements CIS benchmark 2.1.17 by checking the relevant xinetd configuration file for service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/echo-stream -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Network Client Security Signature Settings\nDESCRIPTION: Registry checks to enforce digital signature requirements for network client communications. These rules validate secure network communications are properly configured.\n\nLANGUAGE: ossec\nCODE:\n```\n#2.3.8.1 Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.8.1 Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> !RequireSecuritySignature;\n#\n#\n#2.3.8.2 Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.8.2 Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnableSecuritySignature -> !1;\n#\n#\n#2.3.8.3 Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 2.3.8.3 Ensure 'Microsoft network client: Send unencrypted password to third-party SMB servers' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnablePlainTextPassword -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Telemetry Settings in Windows 10\nDESCRIPTION: Verifies that 'Allow Telemetry' is set to 'Enabled: 0 - Security (Enterprise Only)' or 'Enabled: 1 - Basic' by checking the AllowTelemetry registry value is not set to 2 or 3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.16.1 Ensure 'Allow Telemetry' is set to 'Enabled: 0 - Security (Enterprise Only)' or 'Enabled: 1 - Basic'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> AllowTelemetry -> 2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> AllowTelemetry -> 3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> !AllowTelemetry;\n```\n\n----------------------------------------\n\nTITLE: Checking NTP Configuration in OSSEC\nDESCRIPTION: OSSEC rules to verify proper NTP configuration in /etc/ntp.conf as per CIS Benchmark 6.5, checking for proper access restrictions and server declarations.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/ntp.conf -> !r:^restrict -4 default kod nomodify notrap nopeer noquery;\nf:/etc/ntp.conf -> !r:^restrict -6 default kod nomodify notrap nopeer noquery;\nf:/etc/ntp.conf -> !r:^server\\s\\.+;\n```\n\n----------------------------------------\n\nTITLE: Checking Remotely Accessible Registry Paths in Windows 10\nDESCRIPTION: Verifies that 'Network access: Remotely accessible registry paths' contains only the approved paths by checking the Machine value under the Winreg AllowedExactPaths registry key.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedExactPaths -> Machine -> !r:System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedExactPaths -> !Machine;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Services Disconnected Session Timeout in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'MaxDisconnectionTime' registry setting for Remote Desktop Services disconnected sessions. This rule checks for compliance with CIS recommendation 18.9.58.3.10.2, ensuring the timeout is set to 1 minute.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxDisconnectionTime;\n```\n\n----------------------------------------\n\nTITLE: Checking LDAP Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify LDAP is not enabled by checking for LDAP-related init scripts as per CIS Benchmark 6.6.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:/etc/init.d -> r:ldap;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Selection UI Display Setting\nDESCRIPTION: Ensures the network selection UI is not displayed by verifying DontDisplayNetworkSelectionUI is set to 1 or exists.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Basic Authentication\nDESCRIPTION: Verifies that 'Allow Basic authentication' is set to 'Disabled' (value equal to 0) in the WinRM Client registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking HomeGroup Listener Service Setting\nDESCRIPTION: Verifies that 'HomeGroup Listener (HomeGroupListener)' service is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\HomeGroupListener -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\HomeGroupListener -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Default umask for Users\nDESCRIPTION: Verifies if proper umask settings are configured in system profile files. The recommended umask of 077 ensures that files created by users have restrictive default permissions, enhancing system security.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:$profiledfiles -> !r:^umask 077;\nf:/etc/bash.bashrc -> !r:^umask 077;\n```\n\n----------------------------------------\n\nTITLE: Checking LPT Port Redirection Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if LPT port redirection is disabled in Remote Desktop Services, as per CIS benchmark 18.9.52.3.3.3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableLPT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableLPT;\n```\n\n----------------------------------------\n\nTITLE: Checking Anonymous SAM Account Enumeration Settings in Windows Server 2016\nDESCRIPTION: Verifies that 'Network access: Do not allow anonymous enumeration of SAM accounts' is enabled. This checks the RestrictAnonymousSAM registry value to prevent unauthorized access to account information.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> RestrictAnonymousSAM -> 0;\n```\n\n----------------------------------------\n\nTITLE: Length Code Table for DEFLATE Compression\nDESCRIPTION: Table showing how length values (3-258) are encoded in the DEFLATE format. For each code (257-285), the table shows the extra bits required and the actual length values represented.\n\nLANGUAGE: plain text\nCODE:\n```\n         Extra               Extra               Extra\n    Code Bits Length(s) Code Bits Lengths   Code Bits Length(s)\n    ---- ---- ------     ---- ---- -------   ---- ---- -------\n     257   0     3       267   1   15,16     277   4   67-82\n     258   0     4       268   1   17,18     278   4   83-98\n     259   0     5       269   2   19-22     279   4   99-114\n     260   0     6       270   2   23-26     280   4  115-130\n     261   0     7       271   2   27-30     281   5  131-162\n     262   0     8       272   2   31-34     282   5  163-194\n     263   0     9       273   3   35-42     283   5  195-226\n     264   0    10       274   3   43-50     284   5  227-257\n     265   1  11,12      275   3   51-58     285   0    258\n     266   1  13,14      276   3   59-66\n```\n\n----------------------------------------\n\nTITLE: Detecting rsync service in SLES11\nDESCRIPTION: Checks if the rsync daemon service is enabled in the runlevel directories, which should be disabled if not needed for file transfers.\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\drsyncd$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Media Player Network Sharing Service Status in Windows Registry\nDESCRIPTION: Verifies that the Windows Media Player Network Sharing Service (WMPNetworkSvc) is set to 'Disabled' or 'Not Installed' per CIS benchmark 5.35. The check confirms the Start value is set to 4.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WMPNetworkSvc -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Continue experiences on this device' Settings in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Continue experiences on this device' is set to 'Disabled'. This prevents the device from receiving notifications and data from other Windows devices, which could potentially expose sensitive information.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableCdp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableCdp;\n```\n\n----------------------------------------\n\nTITLE: Detecting DHCP Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if DHCP server is enabled through systemd. This implements CIS benchmark 3.5 by checking the dhcpd service configuration for execution settings.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/usr/lib/systemd/system/dhcpd.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: MySQL Auto Create User Check in OSSEC\nDESCRIPTION: Ensures sql_mode contains NO_AUTO_CREATE_USER per CIS recommendation 7.4. This prevents GRANT statements from automatically creating new users without passwords.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 7.4: Ensure 'sql_mode' Contains 'NO_AUTO_CREATE_USER'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:no_auto_create_user\\s*$;\nf:$mysql-cnfs -> r:^# && r:\\s*no_auto_create_user\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Quality Updates Settings\nDESCRIPTION: Verifies that Quality Updates are enabled with 0 days deferral by checking the DeferQualityUpdates and DeferQualityUpdatesPeriodInDays registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferQualityUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !DeferQualityUpdates;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> DeferQualityUpdatesPeriodInDays -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate -> !DeferQualityUpdatesPeriodInDays;\n```\n\n----------------------------------------\n\nTITLE: Checking DHCP Server Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify DHCP Server is not enabled in run-level directories as per CIS Benchmark 6.4.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:disc-dhcp-server;\n```\n\n----------------------------------------\n\nTITLE: Checking Case Insensitivity for Non-Windows Subsystems in Windows 10\nDESCRIPTION: Verifies that 'System objects: Require case insensitivity for non-Windows subsystems' is set to 'Enabled' by checking that the ObCaseInsensitive registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Kernel -> ObCaseInsensitive -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Search Suggestions Configuration in Registry\nDESCRIPTION: Registry check to ensure that 'Configure search suggestions in Address bar' is set to 'Disabled' as required by CIS benchmark 18.9.41.6. This helps protect user privacy in Microsoft Edge.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.41.6 Ensure 'Configure search suggestions in Address bar' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.41.6: Ensure 'Configure search suggestions in Address bar' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\SearchScopes -> ShowSearchSuggestionsGlobal -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\SearchScopes -> !ShowSearchSuggestionsGlobal;\n```\n\n----------------------------------------\n\nTITLE: Checking Apache ServerToken Configuration\nDESCRIPTION: Rules to verify ServerToken is set to Prod or ProductOnly to minimize information disclosure about the server version.\n\nLANGUAGE: regex\nCODE:\n```\nd:$conf-dirs -> conf -> !r:^# && r:servertokens\\s+major;\nd:$conf-dirs -> conf -> !r:^# && r:servertokens\\s+minor;\nd:$conf-dirs -> conf -> !r:^# && r:servertokens\\s+min;\nd:$conf-dirs -> conf -> !r:^# && r:servertokens\\s+minimal;\nd:$conf-dirs -> conf -> !r:^# && r:servertokens\\s+os;\nd:$conf-dirs -> conf -> !r:^# && r:servertokens\\s+full;\n```\n\n----------------------------------------\n\nTITLE: Verifying WDigest Authentication Settings\nDESCRIPTION: Ensures WDigest Authentication is disabled by checking if UseLogonCredential is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecurityProviders\\WDigest -> UseLogonCredential -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Samba Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify Samba is not enabled in run-level directories as per CIS Benchmark 6.12.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nd:$rc_dirs -> S -> r:samba;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Access Anonymous Named Pipes Registry Configuration in Windows 10\nDESCRIPTION: Verifies that 'Network access: Named Pipes that can be accessed anonymously' is set to 'None' by checking that the NullSessionPipes registry key either doesn't exist or doesn't contain any values.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionPipes -> r:\\S*;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !NullSessionPipes;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerPoint Trusted Documents Settings in Registry\nDESCRIPTION: Registry checks to verify that trusted documents are disabled in Microsoft PowerPoint 16.0. These rules ensure the disabletrusteddocuments and disablenetworktrusteddocuments registry values are set correctly for security compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\trusted documents -> disabletrusteddocuments -> disabletrusteddocuments -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\trusted documents -> disabletrusteddocuments -> !disabletrusteddocuments;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\trusted documents -> disabletrusteddocuments -> disablenetworktrusteddocuments -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\trusted documents -> disabletrusteddocuments -> !disablenetworktrusteddocuments;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Path\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile logging path is set to the recommended value. Uses regex to validate the path format in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerShell Transcription Settings\nDESCRIPTION: OSSEC rule to ensure PowerShell Transcription is disabled according to CIS benchmark 18.9.95.2. Verifies EnableTranscripting is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.95.2 Ensure 'Turn on PowerShell Transcription' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 18.9.95.2 Ensure 'Turn on PowerShell Transcription' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PowerShell\\Transcription -> EnableTranscripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring Library Version Information\nDESCRIPTION: Sets the library version information for non-Cygwin platforms, encoding the full version into the shared library filename.\n\nLANGUAGE: CMake\nCODE:\n```\nif(NOT CYGWIN)\n    # This property causes shared libraries on Linux to have the full version\n    # encoded into their final filename.  We disable this on Cygwin because\n    # it causes cygz-${ZLIB_FULL_VERSION}.dll to be created when cygz.dll\n    # seems to be the default.\n    #\n    # This has no effect with MSVC, on that platform the version info for\n    # the DLL comes from the resource file win32/zlib1.rc\n    set_target_properties(zlib PROPERTIES VERSION ${ZLIB_FULL_VERSION})\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Default Permissions Registry Setting\nDESCRIPTION: Verifies that the 'Strengthen default permissions of internal system objects' setting is enabled by checking if the ProtectionMode registry value is set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager -> ProtectionMode -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Connection Security Rules in OSSEC\nDESCRIPTION: OSSEC rule that verifies Windows Firewall Public profile is not applying local connection security rules. It checks if AllowLocalIPsecPolicyMerge is set to 0 (disabled) in either policy or current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Per-Session Temp Folders for Terminal Services Registry Setting\nDESCRIPTION: Verifies that temporary folders per session for Terminal Services are enabled by checking if PerSessionTempDir is not set to 1, which enforces per-session temporary directories for better security isolation.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> PerSessionTempDir -> !1;\n```\n\n----------------------------------------\n\nTITLE: MySQL Password Storage Check in OSSEC\nDESCRIPTION: Verifies that passwords are not stored in the global configuration per CIS recommendation 7.3. Storing passwords in configuration files poses a significant security risk.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 7.3: Passwords are stored in global configuration] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:^\\s*password\\.*;\n```\n\n----------------------------------------\n\nTITLE: Checking Font Providers Disabled Status\nDESCRIPTION: Verifies that Font Providers are disabled by checking if the EnableFontProviders registry value is set to 0. Implements CIS benchmark 18.5.5.1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableFontProviders -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableFontProviders;\n```\n\n----------------------------------------\n\nTITLE: Checking KeepAlive Directive Configuration in Apache\nDESCRIPTION: Rules to verify the KeepAlive directive is enabled for better performance and connection handling.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^# && r:keepalive\\s+off;\nf:$main-conf -> !r:keepalive\\s+on;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Installation Detection Setting\nDESCRIPTION: Verifies that 'Detect application installations and prompt for elevation' is enabled by checking if EnableInstallerDetection registry value is set to 1.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableInstallerDetection -> 0;\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !EnableInstallerDetection;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Server Configuration in Registry\nDESCRIPTION: Verifies that 'Enable Windows NTP Server' is set to 'Disabled' by confirming the Enabled registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpServer -> Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Configuration for CIS Compliance\nDESCRIPTION: Rules for validating proper IPv6 disabling in sysctl.conf according to CIS benchmark 7.3.3. Checks for configuration parameters that disable IPv6 on all interfaces, default interfaces, and loopback.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.3.3 Disable IPv6\n[CIS - Debian Linux 7/8 - 7.3.3 Disable IPv6] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.all.disable_ipv6=0;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.all.disable_ipv6=1;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.default.disable_ipv6=0;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.default.disable_ipv6=1;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv6.conf.lo.disable_ipv6=0;\nf:/etc/sysctl.conf -> !r:^net.ipv6.conf.lo.disable_ipv6=1;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager hash storage\nDESCRIPTION: Verifies that 'Network security: Do not store LAN Manager hash value on next password change' is enabled by checking the NoLMHash registry value isn't set to 0.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> NoLMHash -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting chargen on xinetd in SLES11\nDESCRIPTION: Checks if chargen service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/chargen -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Check for Removable Media Formatting Permissions\nDESCRIPTION: Registry check to verify that only administrators and interactive users are allowed to format and eject removable media, according to CIS Benchmark item 2.3.4.1.\n\nLANGUAGE: bash\nCODE:\n```\n#2.3.4.1 Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators and Interactive Users'\n[CIS - Microsoft Windows 10 - 2.3.4.1 Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators and Interactive Users'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Outlook Attachments Protected View in PowerPoint\nDESCRIPTION: Registry check to ensure that Protected View is enabled for attachments opened from Outlook in Microsoft PowerPoint. This enhances security by opening email attachments in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\protectedview -> disableattachmentsinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\security\\protectedview -> !disableattachmentsinpv;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Location Elevation Policy in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'Require domain users to elevate when setting a network's location' is set to 'Enabled'. This setting requires standard domain users to elevate privileges when setting a network's location, preventing unauthorized network profile configuration.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_StdDomainUserSetLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_StdDomainUserSetLocation;\n```\n\n----------------------------------------\n\nTITLE: Assigning Huffman Code Values in DEFLATE Format\nDESCRIPTION: Algorithm to assign numerical values to Huffman codes based on their lengths. This process ensures codes with the same length have consecutive values and follows the DEFLATE format requirements for lexicographical ordering.\n\nLANGUAGE: C\nCODE:\n```\nfor (n = 0;  n <= max_code; n++) {\n    len = tree[n].Len;\n    if (len != 0) {\n        tree[n].Code = next_code[len];\n        next_code[len]++;\n    }\n}\n```\n\n----------------------------------------\n\nTITLE: Configuring Zlib Installation Directories\nDESCRIPTION: Defines the installation directories for binaries, libraries, headers, man pages, and pkgconfig files with default paths based on CMAKE_INSTALL_PREFIX.\n\nLANGUAGE: CMake\nCODE:\n```\nset(INSTALL_BIN_DIR \"${CMAKE_INSTALL_PREFIX}/bin\" CACHE PATH \"Installation directory for executables\")\nset(INSTALL_LIB_DIR \"${CMAKE_INSTALL_PREFIX}/lib\" CACHE PATH \"Installation directory for libraries\")\nset(INSTALL_INC_DIR \"${CMAKE_INSTALL_PREFIX}/include\" CACHE PATH \"Installation directory for headers\")\nset(INSTALL_MAN_DIR \"${CMAKE_INSTALL_PREFIX}/share/man\" CACHE PATH \"Installation directory for manual pages\")\nset(INSTALL_PKGCONFIG_DIR \"${CMAKE_INSTALL_PREFIX}/share/pkgconfig\" CACHE PATH \"Installation directory for pkgconfig (.pc) files\")\n```\n\n----------------------------------------\n\nTITLE: Checking for Enabled Kudzu Hardware Detection Service\nDESCRIPTION: Rule to detect if the Kudzu hardware detection service is enabled in the boot sequence. Unnecessary services should be disabled to reduce potential attack surface.\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dkudzu$;\n```\n\n----------------------------------------\n\nTITLE: Checking Sharing and Security Model for Local Accounts in Windows 10\nDESCRIPTION: Verifies that 'Network access: Sharing and security model for local accounts' is set to 'Classic - local users authenticate as themselves' by checking that the ForceGuest registry value is not set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> ForceGuest -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Update Automatic Updates Settings in Registry\nDESCRIPTION: Registry checks to ensure 'Configure Automatic Updates' is set to 'Enabled' per CIS benchmark 18.9.90.2. This ensures the system is configured to automatically check for Windows updates.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoUpdate -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> !NoAutoUpdate;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Rule Application in Registry\nDESCRIPTION: Registry checks for Windows Firewall Private profile rule application settings. Verifies AllowLocalPolicyMerge and AllowLocalIPsecPolicyMerge are correctly configured to apply local rules.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalPolicyMerge -> 0;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: MySQL Old Passwords Setting Check in OSSEC\nDESCRIPTION: Checks if old_passwords is not set to '1' or 'on' per CIS recommendation 7.1. Older password hashing algorithms are less secure and should not be used.\n\nLANGUAGE: bash\nCODE:\n```\n[CIS - MySQL Configuration - 7.1:Ensure 'old_passwords' is not set to '1' or 'on'] [any] [https://workbench.cisecurity.org/files/1310/download]\nf:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*1;\nf:$mysql-cnfs -> !r:^# && r:old_passwords\\s*=\\s*on;\nf:$mysql-cnfs -> !r:old_passwords\\s*=\\s*2;\nf:$mysql-cnfs -> r:old_passwords\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Connect Now Wireless Settings Configuration\nDESCRIPTION: Verifies that wireless settings configuration using Windows Connect Now is disabled by checking multiple registry values. Implements CIS benchmark 18.5.20.1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> EnableRegistrars -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !EnableRegistrars;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableUPnPRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableUPnPRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableInBand802DOT11Registrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableInBand802DOT11Registrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableFlashConfigRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableFlashConfigRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableWPDRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableWPDRegistrar;\n```\n\n----------------------------------------\n\nTITLE: Checking Make Hidden Markup Visible Setting in Word\nDESCRIPTION: Registry check to ensure that the 'Make hidden markup visible' setting is enabled in Microsoft Word. This setting helps protect against hidden content in Word documents by ensuring markup is visible when opening or saving files.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\options -> showmarkupopensave -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\options -> !showmarkupopensave;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Warning Level Registry Settings\nDESCRIPTION: Validates that the warning threshold for the security event log is set to 90% or less by checking the WarningLevel registry value is not above 90%.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Installation Process Messages in Portuguese\nDESCRIPTION: Portuguese translations for messages shown during the actual installation process of OSSEC HIDS.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 5\ninstalling=\"Instalando o sistema\"\nrunningmake=\"Executando o Makefile\"\n```\n\n----------------------------------------\n\nTITLE: Keep All Auditing Information Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.1.3 that checks if auditd is configured to retain all audit information. It verifies the max_log_file_action setting to ensure audit logs are preserved for security review and compliance purposes.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.1.3 Keep All Auditing Information] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/auditd.conf;\nf:/etc/audit/auditd.conf -> !r:^max_log_file_action\\s*=\\s*keep_logs;\nf:/etc/audit/auditd.conf -> !r:^# && r:max_log_file_action\\s*=\\s*ignore|syslog|suspend|rotate;\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous access to shares\nDESCRIPTION: Verifies that 'Network access: Shares that can be accessed anonymously' is set to None by checking the NullSessionShares registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionShares -> r:\\S*;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Secure Channel Data Encryption/Signing\nDESCRIPTION: Registry check to ensure that secure channel data is digitally encrypted or signed according to CIS benchmark 2.3.6.1, verifying the RequireSignOrSeal registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireSignOrSeal -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Command Line Inclusion in Process Creation Events\nDESCRIPTION: OSSEC rule to verify that command line data is not included in process creation events. The rule checks if the ProcessCreationIncludeCmdLine_Enabled registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\Audit -> ProcessCreationIncludeCmdLine_Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Calculating Adler-32 Checksum in C\nDESCRIPTION: Implementation of the adler32 function that calculates the Adler-32 checksum of a byte buffer. It initializes the checksum with 1 and calls update_adler32 to perform the calculation.\n\nLANGUAGE: C\nCODE:\n```\nunsigned long adler32(unsigned char *buf, int len)\n{\n  return update_adler32(1L, buf, len);\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Do not enumerate connected users on domain-joined computers registry setting in OSSEC\nDESCRIPTION: Verifies that 'Do not enumerate connected users on domain-joined computers' is set to 'Enabled' by checking if the DontEnumerateConnectedUsers registry value equals 1 and that the key exists in the specified registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontEnumerateConnectedUsers -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontEnumerateConnectedUsers;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft MAPS Reporting Override in Registry\nDESCRIPTION: Verifies that local setting override for reporting to Microsoft MAPS is disabled by checking if the LocalSettingOverrideSpynetReporting registry value is not set to 0.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> LocalSettingOverrideSpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Defining French Language Variables for OSSEC HIDS Installation\nDESCRIPTION: This bash script defines French language variables used throughout the OSSEC HIDS installation process. It includes translations for basic options, installation types, configuration prompts, and system messages required for the interactive installation workflow.\n\nLANGUAGE: bash\nCODE:\n```\n# Configuration \nyes=\"o\"\nno=\"n\"\nyesmatch=\"o\"\nnomatch=\"n\"\nagent=\"agent\"\nlocal=\"local\"\nserver=\"serveur\"\nhelp=\"aide\"\n\n# Global\nmoreinfo=\"Plus d'information sur: \"\nstarting=\"Dmarrage de OSSEC HIDS\"\nsystemis=\"Le Systme est\"\nmodifiedinit=\"Script d'initialisation modifi pour dmarrer OSSEC HIDS pendant le boot.\"\nnoboot=\"Systme inconnu. Aucun script d'initialisation ajout.\"\n\n# Part 1\ninstallscript=\"Script d'installation\"\nsystem=\"Systme\"\nuser=\"Utilisateur\"\nhost=\"Hte\"\nhitanyorabort=\"Appuyez sur Entre pour continuer ou Ctrl-C pour annuler.\"\nwhattoinstall=\"Quel type d'installation voulez-vous (serveur, agent, local ou aide) ?\"\nserverchose=\"Installation du serveur choisie\"\nclientchose=\"Installation de l'agent (client) choisie\"\nlocalchose=\"Installation en local choisie\"\n\n# Part 2\nsettingupenv=\"Dfinition de l'environnement d'installation\"\nwheretoinstall=\"Choisissez votre rpertoire d'installation de OSSEC HIDS\"\ninstallat=\"L'installation sera faite sur \"\ndeletedir=\"Le rpertoire d'installation existe dj. Doit-on le supprimer ?\"\n\n# Part 3\nconfiguring=\"Configuration de\"\nmailnotify=\"Voulez-vous une alerte par email ?\"\nnomail=\"Alerte par email dsactive\"\nwhatsemail=\"Quel est votre adresse email ?\"\nyoursmtp=\"Nous trouvons votre serveur SMTP sur\"\nusesmtp=\"Voulez-vous l'utiliser ?\"\nusingsmtp=\"Serveur SMTP utilis : \"\nwhatsmtp=\"Quel est l'adresse IP ou le nom d'hte de votre serveur SMTP ?\"\n\n# Part 3.1/agent\nserverip=\"Quelle est l'adresse IP de votre serveur OSSEC HIDS ?\"\nserveraddr=\"Quelle est l'adresse IP ou le nom d'hte de votre serveur OSSEC HIDS ?\"\naddingip=\"Ajout de l'IP du Serveur\"\naddingname=\"Ajout de le nom d'hte du Serveur\"\n\n\n# Part 3.2\nrunsyscheck=\"Voulez-vous dmarrer le dmon de vrification d'intgrit ?\"\nnosyscheck=\"Syscheck non lanc (dmon de vrification d'intgrit)\"\nyessyscheck=\"Lancement de syscheck (dmon de vrification d'intgrit)\"\n\n# Part 3.3\nrunrootcheck=\"Voulez-vous dmarrer le moteur de dtection de rootkit ?\"\nnorootcheck=\"Rootcheck non lanc (dtection de rootkit)\"\nyesrootcheck=\"Lancement de rootcheck (dtection de rootkit)\"\n\n# Part 3.4/server/local\nenable_ar=\"voulez-vous dmarrer la rponse active ?\"\nnoactive=\"Rponse active dsactive\"\nnohosts=\"contrle d'hte (host-deny) dsactiv\"\nyeshosts=\"contrle d'hte (host-deny) activ (local) pour les levels >= 6\"\nfirewallar=\"Voulez-vous activer la rponse pare-feu (firewall-drop) ?\"\nnofirewall=\"pare-feu (firewall-drop) dsactiv.\"\nyesfirewall=\"pare-feu (firewall-drop) activ (local) pour les levels >= 6\"\ndefaultwhitelist=\"liste blanche (white list) par dfaut pour la rponse active :\"\naddwhite=\"Voulez-vous d'autres adresses IP dans votre liste (white list) ?\"\nipswhite=\"IPs (spares par des espaces) : \"\n\n# Part 3.5/server/local\nsyslog=\"Voulez-vous activer fonctionnalit syslog (port udp 514) ?\" \nnosyslog=\"Fonctionnalit syslog dsactiv\"\nyessyslog=\"Fonctionnalit syslog activ\"\n\n# Part 3.4/3.5\nreadlogs=\"Mise en place de la configuration pour analyser les logs suivants :\"\n\n# Part 5\ninstalling=\"Installation du systme\"\nrunningmake=\"Excution du Makefile\"\n\n# Final\nconfigurationdone=\"Configuration correctement termine\"\ntostart=\"Pour dmarrer OSSEC HIDS\"\ntostop=\"Pour arrter OSSEC HIDS\"\nconfigat=\"La configuration peut tre visualise ou modifie dans\"\naddserveragent=\"Vous devez ajouter le(s) agent(s) avant qu'ils aient un accs autoris.\"\nrunma=\"Lancez 'manage_agent' pour les ajouter ou les supprimer\"\npresskey=\"Appuyez sur Entre pour continuer\"\n\n# Update\nwanttoupdate=\"Vous avez dj install OSSEC. Voulez-vous le mettre  jour ?\"\nunabletoupdate=\"Impossible de mettre  jour. Une nouvelle installation est ncessaire.\"\nupdatecompleted=\"Mise  jour complte.\"\nupdatefailed=\"Echec de la mise  jour.\"\nupdaterules=\"Voulez-vous mettre  jour les rgles ?\"\nupdatingrules=\"Mise  jour des rgles.\"\nnotupdatingrules=\"Rgles non mises  jour.\"\n\n# Pf support\npfenable=\"Voulez-vous utiliser le firewall PF dans la rponse active ?\"\nnopf=\"Rponse par PF dsactive.\"\npftablename=\"Nom de la table PF  utiliser ?\"\npfmessage=\"Ajouter les lignes suivantes au dbut de vos rgles\"\n```\n\n----------------------------------------\n\nTITLE: Checking GNOME Autologin Capabilities\nDESCRIPTION: Rule to ensure that GNOME autologin capabilities are removed, as specified in CIS Solaris 11 benchmark section 6.11. Autologin features bypass authentication and pose security risks.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/pam.conf -> !r:^# && r:gdm-autologin;\n```\n\n----------------------------------------\n\nTITLE: Checking su Command Restrictions\nDESCRIPTION: Verifies if the su command is properly restricted to authorized users via PAM configuration. This restriction helps prevent unauthorized privilege escalation by limiting who can use the su command.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/pam.d/su -> !r:auth required pam_wheel.so use_uid;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Connection Security Rules Application\nDESCRIPTION: Verifies that the Windows Firewall Private Profile is set to apply local connection security rules as required by CIS benchmark 9.2.6. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking WebRTC Localhost IP Prevention for Edge in Windows Registry\nDESCRIPTION: Registry checks to ensure Microsoft Edge is prevented from using Localhost IP addresses for WebRTC, enforcing CIS Windows Server 2016 benchmark rule 18.9.41.11.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> HideLocalHostIP -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !HideLocalHostIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge Address Bar Suggestions Disable Registry Setting\nDESCRIPTION: Verifies that Address bar drop-down list suggestions in Microsoft Edge are disabled by checking the ShowOneBox registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\ServiceUI -> ShowOneBox -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\ServiceUI -> !ShowOneBox;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Office Email and Webmail Security Settings\nDESCRIPTION: OSSEC audit rules to verify that executable content is blocked from email clients and webmail. This security check helps prevent malicious attachments from executing when received via email.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550 -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Sharing Registry Settings\nDESCRIPTION: Validates that use of Internet Connection Sharing is prohibited by checking the NC_ShowSharedAccessUI registry value is set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> NC_ShowSharedAccessUI -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Network Connections -> !NC_ShowSharedAccessUI;\n```\n\n----------------------------------------\n\nTITLE: Detecting SSH IgnoreRhosts Disabled in RHEL5\nDESCRIPTION: Checks if SSH IgnoreRhosts option is disabled in the system. This CIS benchmark rule (6.2.6) verifies that the IgnoreRhosts option is not set to 'no' in sshd_config to prevent rhosts-based authentication.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:IgnoreRhosts\\.+no;\n```\n\n----------------------------------------\n\nTITLE: Checking RDS Protocol Disabling\nDESCRIPTION: Rules for verifying that the RDS protocol is properly disabled according to CIS benchmark 7.5.3. Checks for configuration in the CIS.conf file.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.5.3 Disable RDS\n[CIS - Debian Linux 7/8 - 7.5.3 Disable RDS] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install rds /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Ink Workspace Configuration\nDESCRIPTION: OSSEC rule to verify that Windows Ink Workspace is configured according to CIS benchmark 18.9.84.2, requiring it to be 'Enabled: On, but disallow access above lock' (value 2) or disabled.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.84.2 Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: On, but disallow access above lock' OR 'Disabled' but not 'Enabled: On'\n[CIS - Microsoft Windows 10 - 18.9.84.2 Ensure 'Allow Windows Ink Workspace' is set to 'Enabled: On, but disallow access above lock' OR 'Disabled' but not 'Enabled: On'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> AllowWindowsInkWorkspace -> 2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> !AllowWindowsInkWorkspace;\n```\n\n----------------------------------------\n\nTITLE: Checking OneDrive Usage Prevention in Registry\nDESCRIPTION: Confirms that OneDrive file storage is prevented by checking if the DisableFileSyncNGSC registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> DisableFileSyncNGSC -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> !DisableFileSyncNGSC;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Application Installation Detection in Windows Registry\nDESCRIPTION: Verifies that 'User Account Control: Detect application installations and prompt for elevation' is enabled. Checks if the EnableInstallerDetection registry value is set to 0 or is missing, which would indicate the policy is not properly configured.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableInstallerDetection -> 0;\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !EnableInstallerDetection;\n```\n\n----------------------------------------\n\nTITLE: Configuring MinGW DLL Resources\nDESCRIPTION: Sets up DLL resource compilation for MinGW builds using windres, generating the zlib1rc.obj resource file.\n\nLANGUAGE: CMake\nCODE:\n```\nif(MINGW)\n    # This gets us DLL resource information when compiling on MinGW.\n    if(NOT CMAKE_RC_COMPILER)\n        set(CMAKE_RC_COMPILER windres.exe)\n    endif()\n\n    add_custom_command(OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/zlib1rc.obj\n                       COMMAND ${CMAKE_RC_COMPILER}\n                            -D GCC_WINDRES\n                            -I ${CMAKE_CURRENT_SOURCE_DIR}\n                            -I ${CMAKE_CURRENT_BINARY_DIR}\n                            -o ${CMAKE_CURRENT_BINARY_DIR}/zlib1rc.obj\n                            -i ${CMAKE_CURRENT_SOURCE_DIR}/win32/zlib1.rc)\n    set(ZLIB_DLL_SRCS ${CMAKE_CURRENT_BINARY_DIR}/zlib1rc.obj)\nendif(MINGW)\n```\n\n----------------------------------------\n\nTITLE: Checking Configure Offer Remote Assistance registry setting in OSSEC\nDESCRIPTION: Verifies that 'Configure Offer Remote Assistance' is set to 'Disabled' by checking if the fAllowUnsolicited registry value equals 0 in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating Windows Error Reporting Default Consent Setting\nDESCRIPTION: Ensures that Windows Error Reporting default consent is configured to always ask before sending data by checking that the DefaultConsent registry value is set to 1 per CIS benchmark 18.9.70.2.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting\\Consent -> DefaultConsent -> !1;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Update Process Messages in Portuguese\nDESCRIPTION: Portuguese translations for messages related to updating an existing OSSEC HIDS installation.\n\nLANGUAGE: Bash\nCODE:\n```\n# Update\nwanttoupdate=\"OSSEC ja esta instalado. Deseja atualiza-lo?\"\nunabletoupdate=\"Error na atualizacao. Sera necessario reinstala-lo.\"\nupdatecompleted=\"Atualizacao completada.\"\nupdatefailed=\"Erro na atualizacao.\"\nupdaterules=\"Voce deseja atualizar as regras?\"\nupdatingrules=\"Atualizando as regras.\"\nnotupdatingrules=\"Nao atualizando as regras.\"\n```\n\n----------------------------------------\n\nTITLE: Checking Mail Transfer Agent Configuration in OSSEC\nDESCRIPTION: OSSEC rule to verify Mail Transfer Agent (exim4) is configured for local-only mode as per CIS Benchmark 6.15.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/exim4/update-exim4.conf.conf -> r:^dc_local_interfaces= && !r:'127.0.0.1\\s*\\p\\s*::1'$|'::1\\s*\\p\\s*127.0.0.1'$|'127.0.0.1'$|'::1'$;\n```\n\n----------------------------------------\n\nTITLE: Checking for Additional UID 0 Accounts\nDESCRIPTION: Rule to verify no UID 0 accounts exist other than root, as specified in CIS Solaris 11 benchmark section 9.5. This prevents unauthorized accounts with superuser privileges.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/passwd -> !r:^root && r::\\.:\\d:\\.*;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Let Everyone permissions apply to anonymous users' setting\nDESCRIPTION: Registry check to ensure the 'EveryoneIncludesAnonymous' setting is disabled, which prevents anonymous users from receiving Everyone permissions.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Session Limits for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if Remote Desktop Services users are restricted to a single session, as per CIS benchmark 18.9.52.3.2.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fSingleSessionPerUser -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fSingleSessionPerUser;\n```\n\n----------------------------------------\n\nTITLE: Validating Watson Event Configuration for Windows Defender\nDESCRIPTION: Checks if Windows Defender's Watson event reporting is disabled. This is required by CIS benchmark item 18.9.69.8, which ensures that generic reports are not sent to Microsoft, protecting privacy and reducing data exposure.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting -> DisableGenericRePorts -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Reporting -> !DisableGenericRePorts;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge about:flags Page Block Registry Setting\nDESCRIPTION: Verifies that access to the about:flags page in Microsoft Edge is blocked by checking the PreventAccessToAboutFlagsInMicrosoftEdge registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> PreventAccessToAboutFlagsInMicrosoftEdge -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !PreventAccessToAboutFlagsInMicrosoftEdge;\n```\n\n----------------------------------------\n\nTITLE: Configuring SpyBuddy Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting SpyBuddy spyware through files, registry entries, and DLLs. Includes PCI DSS compliance reference 11.4 and reference URL to Symantec threat information.\n\nLANGUAGE: conf\nCODE:\n```\n# http://www.symantec.com/security_response/writeup.jsp?docid=2004-062611-4548-99&tabid=2\n[Spyware - SpyBuddy {PCI_DSS: 11.4}] [any] []\nf:\\Program Files\\ExploreAnywhere\\SpyBuddy\\sb32mon.exe;\nf:\\Program Files\\ExploreAnywhere\\SpyBuddy;\nf:\\Program Files\\ExploreAnywhere;\nf:%WINDIR%\\System32\\sysicept.dll;\nr:HKEY_LOCAL_MACHINE\\Software\\ExploreAnywhere Software\\SpyBuddy;\n```\n\n----------------------------------------\n\nTITLE: Checking minimization of simultaneous Internet connections\nDESCRIPTION: Validates that Windows is configured to minimize the number of simultaneous connections to the Internet or a Windows Domain. This reduces the attack surface by limiting network exposure.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking NTP Configuration\nDESCRIPTION: Verifies proper NTP configuration including restrictions and running as non-root user. Part of CIS SLES12 benchmark section 6.5.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/ntp.conf -> r:restrict default kod nomodify notrap nopeer noquery && r:^server;\nf:/etc/sysconfig/ntpd -> r:OPTIONS=\"-u ntp:ntp -p /var/run/ntpd.pid\";\n```\n\n----------------------------------------\n\nTITLE: Record Events That Modify the System's Mandatory Access Controls Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.7 that verifies if auditd is configured to record events that modify the system's mandatory access controls. It checks for audit rules that monitor changes to SELinux configurations.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.7 Record Events That Modify the System's Mandatory Access Controls] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-w /etc/selinux/ -p wa -k MAC-policy;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Saving Prevention in Registry\nDESCRIPTION: Verifies that saving passwords in Terminal Services is disabled by checking if the DisablePasswordSaving registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DisablePasswordSaving -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !DisablePasswordSaving;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Machine Account Password Change Refusal\nDESCRIPTION: Registry check to verify that the domain controller does not refuse machine account password changes according to CIS benchmark 2.3.5.3, examining the RefusePasswordChange registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RefusePasswordChange -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Everyone permissions application to anonymous users setting\nDESCRIPTION: Verifies that 'Everyone' permissions do not apply to anonymous users by checking that EveryoneIncludesAnonymous registry value is not set to 1 or 2.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> EveryoneIncludesAnonymous -> 2;\n```\n\n----------------------------------------\n\nTITLE: Defining Zlib Source Files and Headers\nDESCRIPTION: Lists all public and private headers and source files required to build zlib.\n\nLANGUAGE: CMake\nCODE:\n```\n#============================================================================\n# zlib\n#============================================================================\n\nset(ZLIB_PUBLIC_HDRS\n    ${CMAKE_CURRENT_BINARY_DIR}/zconf.h\n    zlib.h\n)\nset(ZLIB_PRIVATE_HDRS\n    crc32.h\n    deflate.h\n    gzguts.h\n    inffast.h\n    inffixed.h\n    inflate.h\n    inftrees.h\n    trees.h\n    zutil.h\n)\nset(ZLIB_SRCS\n    adler32.c\n    compress.c\n    crc32.c\n    deflate.c\n    gzclose.c\n    gzlib.c\n    gzread.c\n    gzwrite.c\n    inflate.c\n    infback.c\n    inftrees.c\n    inffast.c\n    trees.c\n    uncompr.c\n    zutil.c\n)\n```\n\n----------------------------------------\n\nTITLE: Checking Set the default behavior for AutoRun registry setting in OSSEC\nDESCRIPTION: Verifies that 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands' by checking if the NoAutorun registry value equals 1 and that the key exists in the Explorer policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoAutorun -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoAutorun;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Search Information Sharing Settings in Registry\nDESCRIPTION: This rule verifies that Windows Search information sharing is set to 'Anonymous info' by checking if the ConnectedSearchPrivacy registry key is set to 3. The rule triggers if the key is missing or not set to 3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> ConnectedSearchPrivacy -> !3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !ConnectedSearchPrivacy;\n```\n\n----------------------------------------\n\nTITLE: Referencing Script for Generating OSSEC Debian Packages\nDESCRIPTION: Mentions the generate_ossec.sh script used to build Debian packages for OSSEC-HIDS across multiple distributions and architectures. The script leverages Pbuilder to build packages and Reprepro to upload them to an APT repository.\n\nLANGUAGE: bash\nCODE:\n```\ngenerate_ossec.sh\n```\n\n----------------------------------------\n\nTITLE: Checking for User .forward Files in Solaris 11\nDESCRIPTION: This rule identifies .forward files in user home directories. These files can be used to automatically forward email, but may create security vulnerabilities if misconfigured.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$home_dirs -> ^.forward$;\n```\n\n----------------------------------------\n\nTITLE: Checking remotely accessible registry paths and sub-paths\nDESCRIPTION: Verifies that 'Network access: Remotely accessible registry paths and sub-paths' is properly configured by checking the Machine registry value contains all required paths.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> Machine -> !r:Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|Software\\\\Microsoft\\\\OLAP Server|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog|System\\\\CurrentControlSet\\\\Services\\\\CertSvc|System\\\\CurrentControlSet\\\\Services\\\\WINS;\n```\n\n----------------------------------------\n\nTITLE: Detecting Secure ICMP Redirect Acceptance in RHEL5\nDESCRIPTION: Checks if secure ICMP redirect acceptance is enabled in the system. This CIS benchmark rule (4.2.3) verifies that the secure_redirects parameters are not set to 1 to prevent secure ICMP redirect vulnerabilities.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/secure_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/secure_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store App API Access in Registry with OSSEC\nDESCRIPTION: Verifies that 'Block launching Windows Store apps with Windows Runtime API access from hosted content' is enabled by checking if BlockHostedAppAccessWinRT is set to 1. This prevents potential security vulnerabilities in hosted content.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> BlockHostedAppAccessWinRT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !BlockHostedAppAccessWinRT;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop COM Port Redirection Disable Setting\nDESCRIPTION: Verifies that COM port redirection in Remote Desktop Services is disabled by checking the fDisableCcm registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCcm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCcm;\n```\n\n----------------------------------------\n\nTITLE: Configuring Twain Tec Spyware Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting Twain Tec spyware through registry entries and DLL files. Includes PCI DSS compliance reference 11.4.\n\nLANGUAGE: conf\nCODE:\n```\n[Spyware - Twain Tec Spyware {PCI_DSS: 11.4}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\TwaintecDll.TwaintecDllObj.1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\twaintech;\nf:%WINDIR%\\twaintec.dll;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Connectivity During Standby (Plugged in) in Windows 10\nDESCRIPTION: Verifies that 'Allow network connectivity during connected-standby (plugged in)' is set to 'Disabled' by checking registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.33.6.2 Ensure 'Allow network connectivity during connected-standby (plugged in)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> !ACSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Detecting Dovecot Mail Server\nDESCRIPTION: Checks for enabled Dovecot service in xinetd configuration. Part of CIS SLES12 benchmark section 6.11.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/dovecot -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Interactive Boot Check in OSSEC\nDESCRIPTION: OSSEC rule to verify that interactive boot is disabled on RHEL5 systems. Scans /etc/sysconfig/init to ensure PROMPT is set to 'no', which satisfies CIS requirement 1.5.5 and PCI DSS 2.2.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 1.5.5 - Interactive Boot not disabled {CIS: 1.5.5 RHEL5} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/security/limits.conf -> !r:^# && !r:hard\\.+core\\.+0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Account Authentication\nDESCRIPTION: Ensures that consumer Microsoft account user authentication is blocked by verifying the DisableUserAuth registry value is correctly set. This restricts authentication to enterprise accounts for better security control.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftAccount -> DisableUserAuth -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftAccount -> !DisableUserAuth;\n```\n\n----------------------------------------\n\nTITLE: Detecting Apache web server in SLES11\nDESCRIPTION: Checks if the Apache web server service is enabled in the runlevel directories, which should be disabled if not needed.\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dapache2$;\n```\n\n----------------------------------------\n\nTITLE: Verifying Printer Driver Installation Restrictions in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to check that 'Devices: Prevent users from installing printer drivers' is enabled. Implements CIS Benchmark check 2.3.4.2 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.4.2: Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> AddPrinterDrivers -> !1;\n```\n\n----------------------------------------\n\nTITLE: Building cJSON with CMake Command\nDESCRIPTION: Commands for building cJSON using CMake with an out-of-tree build approach. This creates a build directory and runs CMake to generate the build files.\n\nLANGUAGE: bash\nCODE:\n```\nmkdir build\ncd build\ncmake ..\n```\n\n----------------------------------------\n\nTITLE: TCP Data Retransmission Security Check for IPv4\nDESCRIPTION: Verifies that 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3' per CIS benchmark 18.3.11.\n\nLANGUAGE: text\nCODE:\n```\n#18.3.11 Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'\n[CIS - Microsoft Windows Server 2016 - 18.3.11 Ensure 'MSS: (TcpMaxDataRetransmissions) How many times unacknowledged data is retransmitted' is set to 'Enabled: 3'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Checking Block user from showing account details on sign-in registry setting in OSSEC\nDESCRIPTION: Verifies that 'Block user from showing account details on sign-in' is set to 'Enabled' by checking if the BlockUserFromShowingAccountDetailsOnSignin registry value equals 1 in the HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> BlockUserFromShowingAccountDetailsOnSignin -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking LPT Port Redirection Security Settings in Registry\nDESCRIPTION: This rule ensures that LPT port redirection is disabled in Remote Desktop Services by verifying the fDisableLPT registry key is set to 1. The rule triggers if the key is missing or not set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableLPT -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableLPT;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to detect telnet server enabled via xinetd\nDESCRIPTION: Checks if telnet service is enabled in xinetd configuration by verifying if it's not commented out and has disable set to no.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Detecting Squid Proxy Server\nDESCRIPTION: Checks for enabled Squid proxy server in runlevel configuration. Part of CIS SLES12 benchmark section 6.13.\n\nLANGUAGE: shell\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsquid$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Push Notifications Service Disabled Status\nDESCRIPTION: Verifies that the Windows Push Notifications System Service (WpnService) is disabled by checking if its Start registry value is set to 4 or that the Start value exists. Implements CIS benchmark 5.37.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WpnService -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WpnService -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Detecting User-Mounted Removable Partitions (OSSEC Rule)\nDESCRIPTION: OSSEC rule to check if user-mounted removable partitions (CD-ROM and floppy) are allowed on the console, which can be a security risk. The rule checks the console.perms file for entries allowing these devices.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL7 - X.X.X - User-mounted removable partition allowed on the console] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Checking Store Application Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if the Store application is turned off, as per CIS benchmark 18.9.61.3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> RemoveWindowsStore -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !RemoveWindowsStore;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer Scripts Security in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'SafeForScripting' registry setting for Windows Installer. This rule checks for compliance with CIS recommendation 18.9.85.3, ensuring Internet Explorer security prompts for Windows Installer scripts are not prevented.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> SafeForScripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring Kazaa Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting Kazaa P2P client and associated adware through files, DLLs, and registry entries. Includes PCI DSS compliance reference 11.4.\n\nLANGUAGE: conf\nCODE:\n```\n[P2P/Adware - Kazaa {PCI_DSS: 11.4}] [any] []\nf:\\Program Files\\kazaa;\nf:\\Documents and Settings\\All Users\\Start Menu\\Programs\\kazaa;\nf:\\Documents and Settings\\All Users\\DESKTOP\\Kazaa Media Desktop.lnk;\nf:\\Documents and Settings\\All Users\\DESKTOP\\Kazaa Promotions.lnk;\nf:%WINDIR%\\System32\\Cd_clint.dll;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\KAZAA;\nr:HKEY_CURRENT_USER\\SOFTWARE\\KAZAA;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN\\KAZAA;\n```\n\n----------------------------------------\n\nTITLE: Checking Autoplay for Non-Volume Devices in Windows 10\nDESCRIPTION: Verifies that 'Disallow Autoplay for non-volume devices' is set to 'Enabled' by checking registry values related to NoAutoplayfornonVolume.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.8.1 Ensure 'Disallow Autoplay for non-volume devices' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoAutoplayfornonVolume -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> !NoAutoplayfornonVolume;\n```\n\n----------------------------------------\n\nTITLE: Checking Outlook Attachments Protected View in Excel\nDESCRIPTION: Registry check to ensure that Protected View is enabled for attachments opened from Outlook in Microsoft Excel. This enhances security by opening email attachments in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\protectedview -> disableattachmentsinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\protectedview -> !disableattachmentsinpv;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile State\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Firewall state' is set to 'On' by checking the EnableFirewall registry value in both policy and current configuration locations.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> EnableFirewall -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Feedback Notification Settings in Windows 10\nDESCRIPTION: Verifies that 'Do not show feedback notifications' is set to 'Enabled' by checking registry values related to DoNotShowFeedbackNotifications.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.16.4 Ensure 'Do not show feedback notifications' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> DoNotShowFeedbackNotifications -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> !DoNotShowFeedbackNotifications;\n```\n\n----------------------------------------\n\nTITLE: Checking Secure ICMP Redirect Acceptance Configuration\nDESCRIPTION: Rule to check if secure ICMP redirect acceptance is enabled. According to CIS SLES12 benchmark 7.2.3, these settings should be disabled (set to 0) for security.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/secure_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/secure_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Successful Connections Logging in OSSEC\nDESCRIPTION: OSSEC rule that verifies Windows Firewall Public profile is logging successful connections. It checks if LogSuccessfulConnections is set to 0 (disabled) in either policy or current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Basic Configuration Variables in Shell Script\nDESCRIPTION: Sets up basic configuration variables for the OSSEC installation script, defining yes/no values and installation types that will be used throughout the installation process.\n\nLANGUAGE: Shell\nCODE:\n```\n# Configuration\nyes=\"y\"\nno=\"n\"\nyesmatch=\"y\"\nnomatch=\"n\"\nagent=\"agent\"\nlocal=\"local\"\nserver=\"server\"\nhelp=\"help\"\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Printing Registry Settings\nDESCRIPTION: Verifies that 'Turn off printing over HTTP' is enabled by checking if the DisableHTTPPrinting registry value is set to 1 in the Windows NT Printers policies.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC UIAccess Applications Elevation Prompt Settings in Registry\nDESCRIPTION: Verifies that 'User Account Control: Allow UIAccess applications to prompt for elevation without using the secure desktop' is disabled. Checks if the EnableUIADesktopToggle registry value is set to 1, which would indicate the policy is enabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableUIADesktopToggle -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password Requirements (Battery) in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Require a password when a computer wakes (on battery)' is set to 'Enabled' per CIS benchmark 18.8.29.5.1. The check verifies that the DCSettingIndex registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting DHCP Server\nDESCRIPTION: Checks for enabled DHCP server in systemd service files. Part of CIS SLES12 benchmark section 6.4.\n\nLANGUAGE: shell\nCODE:\n```\nf:/usr/lib/systemd/system/dhcpd.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Verifying FTP User Restrictions\nDESCRIPTION: Rule to ensure that system accounts are restricted from using FTP, as specified in CIS Solaris 11 benchmark section 6.9. The rule checks if each system account is properly listed in the ftpusers file.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/ftpd/ftpusers -> !r:^root;\nf:/etc/ftpd/ftpusers -> !r:^daemon;\nf:/etc/ftpd/ftpusers -> !r:^bin;\nf:/etc/ftpd/ftpusers -> !r:^sys;\nf:/etc/ftpd/ftpusers -> !r:^adm;\nf:/etc/ftpd/ftpusers -> !r:^uucp;\nf:/etc/ftpd/ftpusers -> !r:^nuucp;\nf:/etc/ftpd/ftpusers -> !r:^smmsp;\nf:/etc/ftpd/ftpusers -> !r:^listen;\nf:/etc/ftpd/ftpusers -> !r:^gdm;\nf:/etc/ftpd/ftpusers -> !r:^lp;\nf:/etc/ftpd/ftpusers -> !r:^webservd;\nf:/etc/ftpd/ftpusers -> !r:^postgres;\nf:/etc/ftpd/ftpusers -> !r:^svctag;\nf:/etc/ftpd/ftpusers -> !r:^openldap;\nf:/etc/ftpd/ftpusers -> !r:^unknown;\nf:/etc/ftpd/ftpusers -> !r:^aiuser;\nf:/etc/ftpd/ftpusers -> !r:^nobody;\nf:/etc/ftpd/ftpusers -> !r:^nobody4;\nf:/etc/ftpd/ftpusers -> !r:^noaccess;\n```\n\n----------------------------------------\n\nTITLE: Checking Request Body Timeout Limits in Apache Configuration\nDESCRIPTION: This code checks Apache configuration files to ensure timeout limits are properly set for request bodies. It validates that the RequestReadTimeout directive for body timeouts is configured correctly according to CIS benchmark section 9.6.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/httpd/conf/httpd.conf -> !r:^loadmodule\\s+reqtimeout;\nd:$mods-en -> !f:reqtimeout.load;\nf:$request-confs -> !r:\\t*\\s*requestreadtimeout\\.+body\\p\\d\\d*;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p21;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p22;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p23;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p24;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p25;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p26;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p27;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p28;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p29;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p3\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p4\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p5\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p6\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p7\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p8\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p9\\d;\nf:$request-confs -> !r:^\\t*\\s*# && r:\\t*\\s*requestreadtimeout\\.+body\\p\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking KMS Client Online AVS Validation Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if KMS Client Online AVS Validation is turned off, as per CIS benchmark 18.9.59.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> NoGenTicket -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> !NoGenTicket;\n```\n\n----------------------------------------\n\nTITLE: Verifying Machine Account Password Changes in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'. Implements CIS Benchmark check 2.3.6.4 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.4: Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> DisablePasswordChange -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Extensions Configuration in Registry\nDESCRIPTION: Validates that 'Allow Extensions' for Microsoft Edge is set to 'Disabled' by confirming ExtensionsEnabled is set to 0 in the registry.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Extensions -> ExtensionsEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Extensions -> !ExtensionsEnabled;\n```\n\n----------------------------------------\n\nTITLE: Checking SNMP Service Disabled Status in Windows 10\nDESCRIPTION: Verifies that the SNMP service is disabled by checking if its Start registry value is set to 4. This implements CIS benchmark 5.29 for Windows 10.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SNMP -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Core Dumps Restriction Check in OSSEC\nDESCRIPTION: OSSEC rule to verify core dumps are restricted on RHEL5 systems. Examines /etc/security/limits.conf to ensure proper settings are in place, meeting CIS requirement 1.6.1 and PCI DSS 2.2.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 1.6.1 - Interactive Boot not disabled {CIS: 1.6.1 RHEL5} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/security/limits.conf -> !r:^# && !r:hard\\.+core\\.+0;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Name Release Request Settings\nDESCRIPTION: Ensures the computer ignores NetBIOS name release requests except from WINS servers by verifying NoNameReleaseOnDemand registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NetBT\\Parameters -> NoNameReleaseOnDemand -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft FTP Service Setting\nDESCRIPTION: Verifies that 'Microsoft FTP Service (FTPSVC)' is disabled or not installed by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\FTPSVC -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Sign-in after System Restart\nDESCRIPTION: Verifies that 'Sign-in last interactive user automatically after a system-initiated restart' is set to 'Disabled' (value equal to 1) in the System Policies registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DisableAutomaticRestartSignOn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DisableAutomaticRestartSignOn;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Outbound Connections in OSSEC\nDESCRIPTION: OSSEC rule that verifies Windows Firewall Public profile outbound connections are set to Allow (default). It checks if DefaultOutboundAction is set to 1 (block) in either policy or current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Installation Script Variables in Italian\nDESCRIPTION: This script defines variables containing Italian translations for the OSSEC installation process. The variables are organized into sections corresponding to different stages of the installation process, including configuration options, system setup, and post-installation instructions.\n\nLANGUAGE: Bash/Shell\nCODE:\n```\n# Configuration\nyes=\"s\"\nno=\"n\"\nyesmatch=\"s\"\nnomatch=\"n\"\nagent=\"agent\"\nlocal=\"local\"\nserver=\"server\"\nhelp=\"help\"\n\n# Global\nmoreinfo=\"Maggiori informazioni su: \"\nstarting=\"Avvio OSSEC HIDS\"\nsystemis=\"Il Sistema \"\nmodifiedinit=\"Script di Init modificato per eseguire OSSEC HIDS in fase di boot.\"\nnoboot=\"Sistema sconosciuto. Nessuno script di init aggiunto.\"\n\n# Part 1\ninstallscript=\"Script di installazione\"\nsystem=\"Sistema\"\nuser=\"User\"\nhost=\"Host\"\nhitanyorabort=\"Premi ENTER per continuare o Ctrl-C per abbandonare.\"\nwhattoinstall=\"Che tipo di installazione vuoi fare (server, agent, local o help)?\"\nserverchose=\"Scelta installazione Server\"\nclientchose=\"Scelta installazione Agent(client)\"\nlocalchose=\"Scelta installazione Local\"\n\n# Part 2\nsettingupenv=\"Configurazione dell'ambiente di installazione\"\nwheretoinstall=\"Scegli dove installare OSSEC HIDS\"\ninstallat=\"L'installazione verr effettuata in \"\ndeletedir=\"La directory di installazione  gi presente. La devo cancellare?\"\n\n# Part 3\nconfiguring=\"Configuro \"\nmailnotify=\"Vuoi attivare l'e-mail di notifica?\"\nnomail=\"E-mail di notifica disattivata\"\nwhatsemail=\"Qual' il tuo indirizzo e-mail?\"\nyoursmtp=\"Il tuo server SMTP \"\nusesmtp=\"Vuoi utilizzarlo?\"\nusingsmtp=\"Utilizzo il server SMTP: \"\nwhatsmtp=\"Qual' l'ip/host del tuo server SMTP?\"\n\n# Part 3.1/agent\nserverip=\"Qual' l'indirizzo IP del server  OSSEC HIDS?\"\nserveraddr=\"Qual' l'indirizzo IP/host del server  OSSEC HIDS?\"\naddingip=\"Aggiungo l'IP del Server\"\naddingname=\"Aggiunta di host nome del Server\"\n\n# Part 3.2\nrunsyscheck=\"Vuoi attivare il demone di controllo dell'integrit?\"\nnosyscheck=\"Syscheck (demone di controllo dell'integrit) disattivato\"\nyessyscheck=\"Syscheck (demone di controllo dell'integrit) attivato\"\n\n# Part 3.3\nrunrootcheck=\"Vuoi attivare il sistema di rilevamento dei rootkit?\"\nnorootcheck=\"Rootcheck (Sistema di rilevamento dei rootkit) disattivato\"\nyesrootcheck=\"Rootcheck (Sistema di rilevamento dei rootkit) attivato\"\n\n# Part 3.4/server/local\nenable_ar=\"Vuoi abilitare la risposta attiva?\"\nnoactive=\"Risposta attiva disabilitata\"\nnohosts=\"host-deny disattivato\"\nyeshosts=\"host-deny attivato (local) per i livelli >= 6\"\nfirewallar=\"Vuoi attivare la risposta firewall-drop?\"\nnofirewall=\"firewall-drop disattivata.\"\nyesfirewall=\"firewall-drop attivata (local) per i livelli >= 6\"\ndefaultwhitelist=\"White list di default per la risposta attiva:\"\naddwhite=\"Vuoi aggiungere altri indirizzi IP alla white list?\"\nipswhite=\"Indirizzi IP (separati da uno spazio): \"\n\n# Part 3.5/server/local\nsyslog=\"Vuoi attivare il syslog remoto (porta 514 udp)?\"\nnosyslog=\"Syslog remoto disattivato\"\nyessyslog=\"Syslog remoto attivato\"\n\n# Part 3.4/3.5\nreadlogs=\"Imposto la configurazione per l'analisi dei seguenti logs:\"\n\n# Part 5\ninstalling=\"Installo il sistema\"\nrunningmake=\"Eseguo il Makefile\"\n\n# Final\nconfigurationdone=\"Configurazione terminata correttamente\"\ntostart=\"Per avviare OSSEC HIDS\"\ntostop=\"Per arrestare OSSEC HIDS\"\nconfigat=\"La configurazione pu essere vista o modificata in\"\naddserveragent=\"E' necessario aggiungere gli agent(s) prima che siano autorizzati ad accedere al server.\"\nrunma=\"Utilizza 'manage_agents' per aggiungerli o rimuoverli\"\npresskey=\"Premi ENTER per continuare.\"\n\n# update\nwanttoupdate=\"OSSEC  gi stato installato. Vuoi aggiornarlo ?\"\nunabletoupdate=\"Impossibile eseguire l'aggiornamento. E' necessaria un'installazione completa.\"\nupdatecompleted=\"Aggiornamento completato.\"\nupdatefailed=\"Aggiornamento fallito.\"\nupdaterules=\"Si desidera aggiornare le regole ?\"\nupdatingrules=\"Aggiornamento delle regole in corso.\"\nnotupdatingrules=\"Nessun aggiornamento delle regole in corso.\"\n\n# Pf support\npfenable=\"Do you want to use the PF firewall in the active response?\"\nnopf=\"PF response disabled.\"\npftablename=\"Name of the PF table to use?\"\npfmessage=\"Add the following lines to the beginning of your rules\"\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Secure Channel Data Signing\nDESCRIPTION: Verifies the 'Domain member: Digitally sign secure channel data (when possible)' policy is enabled in Windows Server 2016. Checks if the SignSecureChannel registry value is correctly configured for secure domain communications.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.6.3 Ensure 'Domain member: Digitally sign secure channel data (when possible)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> SignSecureChannel -> 0;\n```\n\n----------------------------------------\n\nTITLE: Setting SSH Configuration File Variable in OSSEC Rootcheck\nDESCRIPTION: Defines the path to the SSH daemon configuration file that will be checked by the rootcheck rules.\n\nLANGUAGE: rootcheck\nCODE:\n```\n$sshd_file=/etc/ssh/sshd_config;\n```\n\n----------------------------------------\n\nTITLE: Windows Connect Now Wizards Access Check in OSSEC\nDESCRIPTION: Verifies access to Windows Connect Now wizards is prohibited by checking if the DisableWcnUi registry value is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.4.20.2: Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> DisableWcnUi -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> !DisableWcnUi;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables handwriting recognition error reporting. Checks for the presence of the PreventHandwritingErrorReports registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Verifying Bad Error Message Protection in Network Configuration\nDESCRIPTION: Checks if the system is configured to ignore bogus ICMP error responses. This test verifies if icmp_ignore_bogus_error_responses is set to 0 (disabled), which could make the system vulnerable to certain network attacks.\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_ignore_bogus_error_responses -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Removable Media Access Settings in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators'. Implements CIS Benchmark check 2.3.4.1 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.4.1: Ensure 'Devices: Allowed to format and eject removable media' is set to 'Administrators'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\WindowsNT\\CurrentVersion\\Winlogon -> AllocateDASD -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking logoff enforcement when logon hours expire\nDESCRIPTION: Verifies that 'Network security: Force logoff when logon hours expire' is enabled by checking the EnableForcedLogOff registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Error Reporting Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables handwriting recognition error reporting. Checks for the presence of the PreventHandwritingErrorReports registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> PreventHandwritingErrorReports -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\HandwritingErrorReports -> !PreventHandwritingErrorReports;\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Default Permissions in Windows Registry\nDESCRIPTION: Verifies that 'System objects: Strengthen default permissions of internal system objects (e.g. Symbolic Links)' is enabled. Checks if the ProtectionMode registry value is not set to 1, which would indicate the policy is not properly configured.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager -> ProtectionMode -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Camera Usage Permissions in Windows Registry\nDESCRIPTION: Validates that 'Allow Use of Camera' is set to 'Disabled' by confirming AllowCamera is set to 0 in the registry.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Camera -> AllowCamera -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Camera -> !AllowCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking Search Companion Content File Updates Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off Search Companion content file updates' is set to 'Enabled' by verifying that the DisableContentFileUpdates registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.9 Ensure 'Turn off Search Companion content file updates' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Backing up OSSEC Installation\nDESCRIPTION: Command to create a backup of the entire OSSEC directory before making changes.\n\nLANGUAGE: bash\nCODE:\n```\ntar -C /var -zcpvf ossec-orig.tar.gz ossec\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager authentication level configuration\nDESCRIPTION: Verifies that LAN Manager authentication level is set to 'Send NTLMv2 response only' and refuses LM & NTLM by checking the LmCompatibilityLevel registry value.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 3;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> LmCompatibilityLevel -> 4;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !LmCompatibilityLevel;\n```\n\n----------------------------------------\n\nTITLE: Checking LxssManager Service Setting\nDESCRIPTION: Verifies that 'LxssManager (LxssManager)' is disabled or not installed by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LxssManager -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking PIN for Pairing Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Require pin for pairing' is set to 'Enabled' as per CIS benchmark 18.9.14.1. Checks if RequirePinForPairing value exists and is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Connect -> RequirePinForPairing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Connect -> !RequirePinForPairing;\n```\n\n----------------------------------------\n\nTITLE: Checking COM Port Redirection Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if COM port redirection is disabled in Remote Desktop Services, as per CIS benchmark 18.9.52.3.3.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisableCcm -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisableCcm;\n```\n\n----------------------------------------\n\nTITLE: Defining Active Response Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring active response mechanisms, including host-deny and firewall-drop responses, in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3.4/server/local\nenable_ar=\"Do you want to enable active response?\"\nnoactive=\"Active response disabled\"\nnohosts=\"host-deny disabled\"\nyeshosts=\"host-deny enabled (local) for levels >= 6\"\nfirewallar=\"Do you want to enable the firewall-drop response?\"\nnofirewall=\"firewall-drop disabled.\"\nyesfirewall=\"firewall-drop enabled (local) for levels >= 6\"\ndefaultwhitelist=\"Default white list for the active response:\"\naddwhite=\"Do you want to add more IPs to the white list?\"\nipswhite=\"IPs (space separated): \"\n```\n\n----------------------------------------\n\nTITLE: Checking Data Execution Prevention for Explorer in Registry\nDESCRIPTION: Registry check to ensure that 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled' as required by CIS benchmark 18.9.30.3. This ensures Data Execution Prevention (DEP) is active for Windows Explorer.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.30.3 Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.30.3: Ensure 'Turn off Data Execution Prevention for Explorer' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Microsoft Account Blocking in OSSEC for Windows Server 2012 R2\nDESCRIPTION: Configures OSSEC to check registry settings to ensure 'Accounts: Block Microsoft accounts' is properly configured. This implements CIS Benchmark check 2.3.1.2 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.1.2: Ensure 'Accounts: Block Microsoft accounts' is set to 'Users can't add or log on with Microsoft accounts'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> NoConnectedUser -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !NoConnectedUser;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows NTP Server Settings for Windows Server 2012 R2\nDESCRIPTION: Registry check that verifies if the Windows NTP Server is disabled, as per CIS benchmark 18.8.44.1.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\W32Time\\TimeProviders\\NtpServer -> Enabled -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting time-udp on xinetd in SLES11\nDESCRIPTION: Checks if time-udp service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/time-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Single Session Restriction for Remote Desktop Services\nDESCRIPTION: Registry checks to ensure users are restricted to a single Remote Desktop Services session, enforcing CIS Windows Server 2016 benchmark rule 18.9.52.3.2.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fSingleSessionPerUser -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fSingleSessionPerUser;\n```\n\n----------------------------------------\n\nTITLE: Checking KMS Client Online AVS Validation Settings in Registry\nDESCRIPTION: This rule ensures that KMS Client Online AVS Validation is disabled by verifying the NoGenTicket registry key is set to 1. The rule triggers if the key is missing or not set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> NoGenTicket -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> !NoGenTicket;\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS AdmPwd GPO Extension Installation in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that verifies if LAPS AdmPwd GPO Extension/CSE is installed by checking for the existence of the DllName value in the specified registry key.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions\\{D76B9641-3288-4f75-942D-087DE603E3EA} -> !DllName;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Secure Locations for UIAccess Applications in Registry\nDESCRIPTION: Verifies that 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is enabled. Checks if the EnableSecureUIAPaths registry value is set to 0, which would indicate the policy is disabled (insecure configuration).\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableSecureUIAPaths -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Windows CEIP Settings\nDESCRIPTION: Verifies that 'Turn off Windows Customer Experience Improvement Program' is enabled by checking for CEIPEnable=0 in the registry. This prevents the system from sending usage data to Microsoft.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Device Authentication Certificate Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Support device authentication using certificate' is set to 'Enabled: Automatic' by verifying specific Kerberos parameter values in the registry.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.25.1 Ensure 'Support device authentication using certificate' is set to 'Enabled: Automatic'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters -> DevicePKInitBehavior -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System\\kerberos\\parameters -> DevicePKInitEnabled -> !1;\n```\n\n----------------------------------------\n\nTITLE: Disable Mounting of hfsplus Filesystems Rule for OSSEC\nDESCRIPTION: CIS rule 2.22 that checks for the existence of /etc/modprobe.d/CIS.conf and verifies it contains a directive to disable mounting of hfsplus filesystems for security hardening.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 2.22 Disable Mounting of hfsplus Filesystems] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install hfsplus /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Checking IIS Admin Service Setting\nDESCRIPTION: Verifies that 'IIS Admin Service (IISADMIN)' is disabled or not installed by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\IISADMIN -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking Admin Elevation Prompt Behavior Setting\nDESCRIPTION: Verifies that 'Behavior of the elevation prompt for administrators in Admin Approval Mode' is configured correctly by checking ConsentPromptBehaviorAdmin registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorAdmin;\n```\n\n----------------------------------------\n\nTITLE: Checking printing over HTTP\nDESCRIPTION: Verifies that printing over HTTP is disabled. This prevents potential security risks associated with sending print jobs over unsecured HTTP connections.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableHTTPPrinting -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableHTTPPrinting;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled MySQL Server in OSSEC\nDESCRIPTION: OSSEC rule to identify if MySQL database server is enabled at boot time, which should be disabled unless specifically required for system operation to reduce attack surface in accordance with PCI-DSS requirements.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - X.X.X - Disable standard boot services - MySQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nd:$rc_dirs -> ^S\\d\\dmysqld$;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Email Notification Configuration Messages in Portuguese\nDESCRIPTION: Portuguese translations for the section configuring email notification settings, including SMTP server configuration.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3\nconfiguring=\"Configurando o\"\nmailnotify=\"Deseja receber notificaes por e-mail?\"\nnomail=\"Notificao por e-mail desabilitada\"\nwhatsemail=\"Qual  o seu endereo de e-mail?\"\nyoursmtp=\"Seu servidor SMTP foi encontrado como\"\nusesmtp=\"Deseja us-lo?\"\nusingsmtp=\"Usando servidor SMTP: \"\nwhatsmtp=\"Qual  o ip/host de seu servidor SMTP?\"\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Prompt Configuration in Registry\nDESCRIPTION: Registry check to ensure that 'Always prompt for password upon connection' is set to 'Enabled' as required by CIS benchmark 18.9.52.3.9.1. This forces users to enter credentials when connecting via Remote Desktop.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.52.3.9.1 Ensure 'Always prompt for password upon connection' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.52.3.9.1: Ensure 'Always prompt for password upon connection' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fPromptForPassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fPromptForPassword;\n```\n\n----------------------------------------\n\nTITLE: Checking Outlook Attachments Protected View in Word\nDESCRIPTION: Registry check to ensure that Protected View is enabled for attachments opened from Outlook in Microsoft Word. This enhances security by opening email attachments in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> disableattachmentsinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> !disableattachmentsinpv;\n```\n\n----------------------------------------\n\nTITLE: Checking Outlook Attachments Protected View in Word\nDESCRIPTION: Registry check to ensure that Protected View is enabled for attachments opened from Outlook in Microsoft Word. This enhances security by opening email attachments in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> disableattachmentsinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> !disableattachmentsinpv;\n```\n\n----------------------------------------\n\nTITLE: Checking Online Prints Wizard Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables the \"Order Prints\" picture task. Checks for the presence of the NoOnlinePrintsWizard registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Creating the Nmap Output File\nDESCRIPTION: Command to create an empty file for Nmap output if it doesn't already exist. This file will store the grepable output from Nmap scans that OSSEC will monitor.\n\nLANGUAGE: bash\nCODE:\n```\ntouch /var/log/nmap-out.log\n```\n\n----------------------------------------\n\nTITLE: Detecting Lack of Suspicious Packet Logging in RHEL7\nDESCRIPTION: OSSEC rule that checks if martian packet logging is disabled, which would violate CIS benchmark 4.2.4 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.2.4 - Network parameters - martians not logged {CIS: 4.2.4 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/log_martians -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Shell Access in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'AllowRemoteShellAccess' registry setting for WinRM service. This rule checks for compliance with CIS recommendation 18.9.98.1, ensuring remote shell access is disabled.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> AllowRemoteShellAccess -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> !AllowRemoteShellAccess;\n```\n\n----------------------------------------\n\nTITLE: Verifying WinRM Service RunAs Credentials Storage Registry Setting in Windows\nDESCRIPTION: Checks that 'Disallow WinRM from storing RunAs credentials' is enabled by verifying the DisableRunAs registry value is set to 1 or exists.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> DisableRunAs -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> !DisableRunAs;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Outbound Connections\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Outbound connections' is set to 'Allow (default)' as required by CIS benchmark 9.3.3 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultOutboundAction -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Size Limit\nDESCRIPTION: Verifies that Windows Firewall Domain Profile log size limit is set to at least 16384 KB by checking registry values against various numeric patterns to ensure sufficient log capacity.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Search Companion Settings\nDESCRIPTION: Verifies that 'Turn off Search Companion content file updates' is enabled by checking for DisableContentFileUpdates=1 in the registry. This prevents the system from downloading updated content for Search Companion.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> DisableContentFileUpdates -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SearchCompanion -> !DisableContentFileUpdates;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge Adobe Flash Disable Registry Setting\nDESCRIPTION: Verifies that Adobe Flash in Microsoft Edge is disabled by checking the FlashPlayerEnabled registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Addons -> FlashPlayerEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Addons -> !FlashPlayerEnabled;\n```\n\n----------------------------------------\n\nTITLE: Handling Source Tree zconf.h for Out-of-Source Builds\nDESCRIPTION: Handles the case when a user has a zconf.h file in the source tree during an out-of-source build by renaming it to avoid conflicts with the generated file.\n\nLANGUAGE: CMake\nCODE:\n```\nif(NOT CMAKE_CURRENT_SOURCE_DIR STREQUAL CMAKE_CURRENT_BINARY_DIR)\n    # If we're doing an out of source build and the user has a zconf.h\n    # in their source tree...\n    if(EXISTS ${CMAKE_CURRENT_SOURCE_DIR}/zconf.h)\n        message(STATUS \"Renaming\")\n        message(STATUS \"    ${CMAKE_CURRENT_SOURCE_DIR}/zconf.h\")\n        message(STATUS \"to 'zconf.h.included' because this file is included with zlib\")\n        message(STATUS \"but CMake generates it automatically in the build directory.\")\n        file(RENAME ${CMAKE_CURRENT_SOURCE_DIR}/zconf.h ${CMAKE_CURRENT_SOURCE_DIR}/zconf.h.included)\n  endif()\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Inbound Connections Setting\nDESCRIPTION: Verifies Windows Firewall Private Profile is configured to block inbound connections by default by checking DefaultInboundAction value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote SAM Call Restrictions in Windows 10\nDESCRIPTION: Verifies that 'Network access: Restrict clients allowed to make remote calls to SAM' is set to 'Administrators: Remote Access: Allow' by checking the restrictremotesam registry value.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa -> restrictremotesam -> !r:O:BAG:BAD:\\(A;;RC;;;BA\\);\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge InPrivate Browsing Settings in Registry with OSSEC\nDESCRIPTION: Verifies that 'Allow InPrivate Browsing' for Microsoft Edge is disabled by checking if AllowInPrivate is set to 0. This helps ensure that browsing history is preserved for security monitoring and compliance purposes.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> AllowInPrivate -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !AllowInPrivate;\n```\n\n----------------------------------------\n\nTITLE: Checking Bad Error Message Protection Configuration\nDESCRIPTION: Rule to check if protection against bad error messages is disabled. According to CIS SLES12 benchmark 7.2.6, this protection should be enabled (set to 1) for security.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_ignore_bogus_error_responses -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Global OSSEC Messages in Portuguese\nDESCRIPTION: Provides Portuguese translations for global system messages used throughout the OSSEC installation process.\n\nLANGUAGE: Bash\nCODE:\n```\n# Global\nmoreinfo=\"Maiores informaes em: \"\nstarting=\"Iniciando o OSSEC HIDS\"\nsystemis=\"O Sistema \"\nmodifiedinit=\"O script de inicializao foi modificado para executar o OSSEC HIDS durante o boot.\"\nnoboot=\"Sistema desconhecido. Nenhum script de incializao foi adicionado.\"\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Temp Folder Deletion in Registry\nDESCRIPTION: Registry check to ensure that 'Do not delete temp folders upon exit' is set to 'Disabled' as required by CIS benchmark 18.9.52.3.11.1. This ensures temporary folders from Remote Desktop sessions are deleted for security.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.52.3.11.1 Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.9.52.3.11.1: Ensure 'Do not delete temp folders upon exit' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> DeleteTempDirsOnExit -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Download Mode Settings\nDESCRIPTION: Verifies that Windows 10 'Download Mode' is not set to 'Enabled: Internet' by checking the DODownloadMode registry value. This helps prevent unnecessary bandwidth usage and potential security issues.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeliveryOptimization -> DODownloadMode -> 3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeliveryOptimization -> !DODownloadMode;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer User Control Settings in Registry\nDESCRIPTION: Registry check to ensure 'Allow user control over installs' is set to 'Disabled' per CIS benchmark 18.9.74.1. This prevents standard users from changing installation options that should be enforced by administrators.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> EnableUserControl -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Squid Proxy Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if Squid HTTP proxy server is enabled. This implements CIS benchmark 3.14 by checking for squid service in the boot configuration directories.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsquid$;\n```\n\n----------------------------------------\n\nTITLE: Checking automatic Wi-Fi connections settings\nDESCRIPTION: Verifies that Windows is not configured to automatically connect to suggested open hotspots, networks shared by contacts, or hotspots offering paid services. This helps prevent connections to potentially insecure networks.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WcmSvc\\wifinetworkmanager\\config -> AutoConnectAllowedOEM -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\WcmSvc\\wifinetworkmanager\\config -> !AutoConnectAllowedOEM;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Local Connection Security Rules Setting\nDESCRIPTION: Verifies that Windows Firewall Domain Profile is set to apply local connection security rules by checking the AllowLocalIPsecPolicyMerge value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Strong Session Key Requirements in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to verify 'Domain member: Require strong (Windows 2000 or later) session key' is enabled. Implements CIS Benchmark check 2.3.6.6 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.6.6: Ensure 'Domain member: Require strong session key' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> RequireStrongKey -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Firewall Rules Application\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Settings: Apply local firewall rules' is set to 'No' as required by CIS benchmark 9.3.5 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Registry Settings\nDESCRIPTION: Verifies that 'Turn off the Windows Messenger Customer Experience Improvement Program' is enabled by checking if the CEIP registry value is set to 1 in the Messenger Client policies.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network server session idle time limit\nDESCRIPTION: Registry check to ensure 'Microsoft network server: Amount of idle time required before suspending session' is set to '15 or fewer minute(s), but not 0'. Uses multiple regex checks to verify the AutoDisconnect value is set properly.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !AutoDisconnect;\n```\n\n----------------------------------------\n\nTITLE: Detecting DHCP Server in SLES11\nDESCRIPTION: Checks if DHCP server services (dhcpd or dhcpd6) are enabled in the runlevel directories, which should be disabled on non-DHCP servers.\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dhcpd$;\nd:$rc_dirs -> ^S\\d\\dhcpd6$;\n```\n\n----------------------------------------\n\nTITLE: Checking LAN Manager Hash Storage Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: Do not store LAN Manager hash value on next password change' is set to 'Enabled' according to CIS benchmark 2.3.11.5.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> NoLMHash -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Registry Check Format for OSSEC Windows Audits\nDESCRIPTION: Header documentation explaining the syntax and format for OSSEC audit checks. It details how to specify different types of checks (files, registry, processes) and how to use comparison operators for value matching.\n\nLANGUAGE: bash\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018 OSSEC Project\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n```\n\n----------------------------------------\n\nTITLE: Compiling Assembly Code for 64-bit Zlib using Batch Commands\nDESCRIPTION: Batch command to compile assembly code for 64-bit systems. This needs to be run in the Visual Studio Command Prompt from the contrib\\masmx64 directory before building the solution.\n\nLANGUAGE: batch\nCODE:\n```\nbld_ml64.bat\n```\n\n----------------------------------------\n\nTITLE: Detecting Samba Services\nDESCRIPTION: Checks for enabled Samba services in runlevel configuration. Part of CIS SLES12 benchmark section 6.12.\n\nLANGUAGE: shell\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\n```\n\n----------------------------------------\n\nTITLE: Using OSSEC Report Tool Command Line Options\nDESCRIPTION: Basic command line options for the OSSEC report tool, showing the available flags for different report types.\n\nLANGUAGE: bash\nCODE:\n```\nossec_report_contrib.pl [-h|--help] # This text you read now\nossec_report_contrib.pl [-r|--report] # prints a report for each element\nossec_report_contrib.pl [-s|--summary] # prints a summary report\nossec_report_contrib.pl [-t|--top] #prints the top list\n```\n\n----------------------------------------\n\nTITLE: Checking Windows OS Upgrade Offers\nDESCRIPTION: Verifies that 'Turn off the offer to update to the latest version of Windows' is set to 'Enabled' (value equal to 1) in the Windows Store registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableOSUpgrade -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableOSUpgrade;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Remotely accessible registry paths and sub-paths' configuration\nDESCRIPTION: Registry check to ensure only approved registry paths and their sub-paths are remotely accessible, preventing unauthorized remote changes to critical system settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> Machine -> !r:Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|Software\\\\Microsoft\\\\OLAP Server|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog|System\\\\CurrentControlSet\\\\Services\\\\CertSvc|System\\\\CurrentControlSet\\\\Services\\\\WINS;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network access: Remotely accessible registry paths and sub-paths' configuration\nDESCRIPTION: Registry check to ensure only approved registry paths and their sub-paths are remotely accessible, preventing unauthorized remote changes to critical system settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedPaths -> Machine -> !r:Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Print|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows|System\\\\CurrentControlSet\\\\Control\\\\Print\\\\Printers|System\\\\CurrentControlSet\\\\Services\\\\Eventlog|Software\\\\Microsoft\\\\OLAP Server|System\\\\CurrentControlSet\\\\Control\\\\ContentIndex|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\UserConfig|System\\\\CurrentControlSet\\\\Control\\\\Terminal Server\\\\DefaultUserConfiguration|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Perflib|System\\\\CurrentControlSet\\\\Services\\\\SysmonLog|System\\\\CurrentControlSet\\\\Services\\\\CertSvc|System\\\\CurrentControlSet\\\\Services\\\\WINS;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Automatic Updates Setting\nDESCRIPTION: Validates that automatic download and install of updates for Windows Store apps is configured by ensuring the AutoDownload registry value is set to 4 per CIS benchmark 18.9.61.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Configuring Yahoo Messenger Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting Yahoo Messenger installation through files and registry entries. Includes PCI DSS compliance reference 10.6.1.\n\nLANGUAGE: conf\nCODE:\n```\n[Chat/IM - Yahoo {PCI_DSS: 10.6.1}] [any] []\nf:\\Documents and Settings\\All Users\\Start Menu\\Programs\\Yahoo! Messenger;\nr:HKLM\\SOFTWARE\\Yahoo;\n```\n\n----------------------------------------\n\nTITLE: SNMP Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify SNMP server is disabled on RHEL5 systems. Checks for start scripts in runlevel directories, satisfying CIS requirement 3.15 and PCI DSS 2.2.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.15 - Disable standard boot services - SNMPD process Enabled {CIS: 3.15 RHEL5} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Configuring AOL Instant Messenger Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting AOL Instant Messenger installation through registry entries, files, and processes. Includes PCI DSS compliance reference 10.6.1 and reference URL.\n\nLANGUAGE: conf\nCODE:\n```\n[Chat/IM - AOL {PCI_DSS: 10.6.1}] [any] [http://www.aol.com]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\America Online\\AOL Instant Messenger;\nr:HKEY_CLASSES_ROOT\\aim\\shell\\open\\command;\nr:HKEY_CLASSES_ROOT\\AIM.Protocol;\nr:HKEY_CLASSES_ROOT\\MIME\\Database\\Content Type\\application/x-aim;\nf:\\Program Files\\AIM95;\np:r:aim.exe;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Logging Path Registry Configuration\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Logging: Name' is set to '%SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log' by checking the LogFilePath registry value in both policy and local settings.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking System Shutdown on Audit Failure Settings in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to verify that 'Audit: Shut down system immediately if unable to log security audits' is disabled. Implements CIS Benchmark check 2.3.2.2 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.2.2: Ensure 'Audit: Shut down system immediately if unable to log security audits' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> CrashOnAuditFail -> 2;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Successful Connections Logging\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Logging: Log successful connections' is set to 'Yes' as required by CIS benchmark 9.3.10 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Wizard Microsoft.com Referrals in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is set to 'Enabled' per CIS benchmark 18.8.20.1.5. The check verifies that the ExitOnMSICW registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft network server optional digital signature\nDESCRIPTION: Registry check to ensure 'Microsoft network server: Digitally sign communications (if client agrees)' is set to 'Enabled'. Verifies the EnableSecuritySignature registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !EnableSecuritySignature;\n```\n\n----------------------------------------\n\nTITLE: Illustrating ZLIB Stream Structure in RFC 1950\nDESCRIPTION: Diagram showing the byte structure of a ZLIB compressed data stream, including the CMF (Compression Method and flags), FLG (Flags), optional DICTID, compressed data, and ADLER32 checksum.\n\nLANGUAGE: text\nCODE:\n```\n       0   1\n     +---+---+\n     |CMF|FLG|   (more-->)\n     +---+---+\n\n\n  (if FLG.FDICT set)\n\n       0   1   2   3\n     +---+---+---+---+\n     |     DICTID    |   (more-->)\n     +---+---+---+---+\n\n     +=====================+---+---+---+---+\n     |...compressed data...|    ADLER32    |\n     +=====================+---+---+---+---+\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Dropped Packets Logging\nDESCRIPTION: Verifies that the Windows Firewall Private Profile logging of dropped packets is enabled as required by CIS benchmark 9.2.9. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled NetFS Service in OSSEC\nDESCRIPTION: OSSEC rule to identify if NetFS service is enabled at boot time, which should be disabled unless specifically required for system operation to reduce attack surface in accordance with PCI-DSS requirements.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - X.X.X - Disable standard boot services - NetFS Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Update Download and Install Registry Setting\nDESCRIPTION: Verifies that automatic download and install of updates for Windows Store apps is disabled by checking if AutoDownload is not set to 4, which prevents Windows Store from automatically downloading and installing updates.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Detecting echo Service in xinetd\nDESCRIPTION: Checks for enabled echo service in xinetd configuration. Part of CIS SLES12 benchmark section 5.7.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/echo -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Compiling Rules into a Monolithic File\nDESCRIPTION: Command to compile all rule files into a single monolithic rules_ossec.xml file using the compile_alerts.pl script.\n\nLANGUAGE: bash\nCODE:\n```\nperl contrib/compile_alerts.pl --user-signatures /var/ossec/user_signatures --signatures \\\n/var/ossec/signatures --rules-config /var/ossec/etc/rules_config.xml > rules/rules_ossec.xml\n```\n\n----------------------------------------\n\nTITLE: Checking KMS Client Online AVS Validation Setting\nDESCRIPTION: Registry checks to ensure KMS Client Online AVS Validation is turned off, enforcing CIS Windows Server 2016 benchmark rule 18.9.59.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> NoGenTicket -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform -> !NoGenTicket;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender Email Scanning in Registry\nDESCRIPTION: Confirms that email scanning in Windows Defender is enabled by checking if the DisableEmailScanning registry value is not set to 0 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan -> DisableEmailScanning -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan -> !DisableEmailScanning;\n```\n\n----------------------------------------\n\nTITLE: Checking System Log File Size Configuration in Windows Registry\nDESCRIPTION: Validates that the System event log maximum size is configured to at least 32,768 KB as required by CIS benchmark 18.9.26.4.2. The check examines registry keys to ensure proper configuration or identify if the setting is missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for IP Address Based Request Denial\nDESCRIPTION: Audit rule that checks if IP address based requests are properly denied. Direct IP access to the web server should be restricted to force the use of hostnames, which helps prevent certain attack vectors.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.12: Deny IP Address Based Requests] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:/etc/httpd/conf/httpd.conf -> !r:loadmodule\\srewrite;\nd:$mods-en -> !f:rewrite.load;\nf:$main-conf -> !r:rewriteengine\\son;\nf:$main-conf -> !r:rewritecond && !r:%{HTTP_HOST} && !r:www\\\\.\\w+\\\\.\\w+ [NC]$;\nf:$main-conf -> !r:rewritecond && !r:%{REQUEST_URI} && !r:/error [NC]$; \nf:$main-conf -> !r:rewriterule && !r:.\\(.*\\) - [L,F]$;\n```\n\n----------------------------------------\n\nTITLE: Checking Security Event Log Warning Threshold for Windows Server\nDESCRIPTION: Verifies that the threshold for security event log warnings is set to 90% or less. Detects non-compliance when WarningLevel exceeds 90% or is missing.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5B;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5C;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5D;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5E;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> 5F;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> WarningLevel -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Eventlog\\Security -> !WarningLevel;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Excel Managed Add-ins Policy\nDESCRIPTION: OSSEC audit rules to verify that the list of managed add-ins policy is enabled for Excel. This ensures that the managed add-ins list feature is active and enforcing add-in restrictions.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\resiliency\\addinlist -> policyon -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\resiliency\\addinlist -> !policyon;\n```\n\n----------------------------------------\n\nTITLE: Windows IPv6 Disabled Check in OSSEC\nDESCRIPTION: Verifies IPv6 is disabled by checking if the DisabledComponents registry value is set to 0xff (255) in the TCPIP6 parameters.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.4.19.2.1: Disable IPv6 (Ensure TCPIP6 Parameter 'DisabledComponents' is set to '0xff (255)')] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> DisabledComponents -> !ff;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TCPIP6\\Parameters -> !DisabledComponents;\n```\n\n----------------------------------------\n\nTITLE: Checking Local Users Enumeration on Domain-Joined Computers\nDESCRIPTION: OSSEC rule to verify that local users are not enumerated on domain-joined computers. The rule checks if the EnumerateLocalUsers registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnumerateLocalUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Windows HTTP Print Driver Download Check in OSSEC\nDESCRIPTION: Verifies the downloading of print drivers over HTTP is disabled by checking if the DisableWebPnPDownload registry value is set to 1 in the Printers policy path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.8.20.1.2: Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking system shutdown without logon requirement\nDESCRIPTION: Verifies that 'Shutdown: Allow system to be shut down without having to log on' is disabled by checking the ShutdownWithoutLogon registry value isn't set to 1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ShutdownWithoutLogon -> 1;\n```\n\n----------------------------------------\n\nTITLE: Detecting chargen-udp on xinetd in SLES11\nDESCRIPTION: Checks if chargen-udp service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/chargen-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Detecting discard-udp Service in xinetd\nDESCRIPTION: Checks for enabled discard-udp service in xinetd configuration. Part of CIS SLES12 benchmark section 5.8.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/discard-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: XML Tags for PCRE2 Support in OSSEC Configuration\nDESCRIPTION: List of new XML tags introduced in OSSEC 3.3.0 to support PCRE2 pattern matching, replacing and extending the older regex functionality.\n\nLANGUAGE: xml\nCODE:\n```\n<pcre2>\n<match_pcre2>\n<program_name_pcre2>\n<prematch_pcre2>\n<srcgeoip_pcre2>\n<dstgeoip_pcre2>\n<srcport_pcre2>\n<dstport_pcre2>\n<user_pcre2>\n<url_pcre2>\n<id_pcre2>\n<status_pcre2>\n<hostname_pcre2>\n<extra_data_pcre2>\n```\n\n----------------------------------------\n\nTITLE: Detecting echo-udp Service in xinetd\nDESCRIPTION: Checks for enabled echo-udp service in xinetd configuration. Part of CIS SLES12 benchmark section 5.6.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/echo-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Creating Symbolic Links for Rules\nDESCRIPTION: Bash script to create numbered symbolic links to the original rule files in the signatures directory, allowing for ordered processing.\n\nLANGUAGE: bash\nCODE:\n```\nCOUNT=0; for i in `cat rules.txt`; do \n (( COUNT = COUNT + 1)) ;\n ln -s ../repository/$i `printf \"signatures/%02d%s\" $COUNT $i`;\ndone\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Office Code Injection Prevention\nDESCRIPTION: OSSEC audit rules to verify that Office applications are blocked from injecting code into other processes. This security control prevents Office from injecting code that could compromise other running applications.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84 -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: LM Authentication Weakness Detection\nDESCRIPTION: Identifies when weak LAN Manager authentication is permitted, creating potential password security vulnerabilities. References PCI-DSS sections 10.6.1 and 11.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[LM authentication allowed (weak passwords) {PCI_DSS: 10.6.1, 11.4}] [any] []\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\LSA -> LMCompatibilityLevel -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\LSA -> LMCompatibilityLevel -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Maximum Size in Windows Registry\nDESCRIPTION: OSSEC rule to verify 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater' in Windows registry. This complex rule checks for various size configurations that would be less than the required minimum size.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Configuring InternetOptimizer Spyware Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting InternetOptimizer spyware through registry entries. Includes PCI DSS compliance reference 11.4.\n\nLANGUAGE: conf\nCODE:\n```\n[Spyware - InternetOptimizer {PCI_DSS: 11.4}] [any] []\nr:HKLM\\SOFTWARE\\Avenue Media;\nr:HKEY_CLASSES_ROOT\\\\safesurfinghelper.iebho.1;\nr:HKEY_CLASSES_ROOT\\\\safesurfinghelper.iebho;\n```\n\n----------------------------------------\n\nTITLE: Checking Plug and Play Device Redirection Settings for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if Plug and Play device redirection is disabled in Remote Desktop Services, as per CIS benchmark 18.9.52.3.3.4.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisablePNPRedir -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisablePNPRedir;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check for core dump restrictions\nDESCRIPTION: Checks if core dumps are restricted in the limits.conf file by verifying hard core value is set to 0.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/security/limits.conf -> !r:^# && !r:hard\\.+core\\.+0;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - AutoRun Default Behavior\nDESCRIPTION: OSSEC rule that checks if 'Set the default behavior for AutoRun' is set to 'Enabled: Do not execute any autorun commands' by verifying the NoAutorun registry key is set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoAutorun -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoAutorun;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Installer Privilege Elevation Settings in Registry\nDESCRIPTION: Registry check to ensure 'Always install with elevated privileges' is set to 'Disabled' per CIS benchmark 18.9.74.2. This prevents potential security vulnerabilities from installations running with higher privileges than necessary.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> AlwaysInstallElevated -> !0;\n```\n\n----------------------------------------\n\nTITLE: Windows Peer-to-Peer Networking Services Check in OSSEC\nDESCRIPTION: Verifies Microsoft Peer-to-Peer Networking Services are disabled by checking if the Disabled registry value is set to 1 in the Peernet policy path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.4.10.2: Ensure 'Turn off Microsoft Peer-to-Peer Networking Services' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Elevation Prompt Behavior for Administrators\nDESCRIPTION: Verifies that 'User Account Control: Behavior of the elevation prompt for administrators in Admin Approval Mode' is properly configured by checking the ConsentPromptBehaviorAdmin registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> ConsentPromptBehaviorAdmin -> 1;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !ConsentPromptBehaviorAdmin;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for PowerPoint Managed Add-ins Policy\nDESCRIPTION: OSSEC audit rules to verify that the list of managed add-ins policy is enabled for PowerPoint. This ensures that only authorized add-ins can run in PowerPoint presentations.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\resiliency\\addinlist -> policyon -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\resiliency\\addinlist -> !policyon;\n```\n\n----------------------------------------\n\nTITLE: Detecting TFTP Server in xinetd and systemd\nDESCRIPTION: Checks for enabled tftp service in xinetd configuration and systemd service files. Part of CIS SLES12 benchmark section 5.1.8.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\nf:/usr/lib/systemd/system/tftp.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Installation Directory Selection Messages in Portuguese\nDESCRIPTION: Portuguese translations for prompts related to installation directory selection and configuration of the installation environment.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 2\nsettingupenv=\"Configurando o ambiente de instalao\"\nwheretoinstall=\"Escolha onde instalar o OSSEC HIDS\"\ninstallat=\"A instalao ser feita no diretrio\"\ndeletedir=\"O diretrio de instalao j existe. Deseja remov-lo?\"\n```\n\n----------------------------------------\n\nTITLE: Detecting daytime Service in xinetd\nDESCRIPTION: Checks for enabled daytime service in xinetd configuration. Part of CIS SLES12 benchmark section 5.5.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/daytime -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Moving Rules Configuration File\nDESCRIPTION: Command to move the rules_config.xml file to the etc directory.\n\nLANGUAGE: bash\nCODE:\n```\nmv rules/rules_config.xml etc/\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 3 Worksheets\nDESCRIPTION: Inspects registry values to verify that Excel 3 worksheets and add-in files are blocked in Microsoft Excel 2016. This security measure prevents potentially harmful legacy file formats from executing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl3worksheets -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl3worksheets;\n```\n\n----------------------------------------\n\nTITLE: Validating Windows SmartScreen Configuration in Registry\nDESCRIPTION: Checks that Windows SmartScreen is configured to require administrator approval before running downloaded unknown software as per CIS benchmark 18.9.30.2. Verifies the EnableSmartScreen value is set to 2 or exists.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableSmartScreen;\n```\n\n----------------------------------------\n\nTITLE: Validating Windows SmartScreen Configuration in Registry\nDESCRIPTION: Checks that Windows SmartScreen is configured to require administrator approval before running downloaded unknown software as per CIS benchmark 18.9.30.2. Verifies the EnableSmartScreen value is set to 2 or exists.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> EnableSmartScreen -> !2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !EnableSmartScreen;\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Behavior in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Application: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' in Windows registry. Ensures the Retention value is set to 0 in the Application Event Log policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Configuring LimeWire Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting LimeWire P2P client through registry entries and files. Includes PCI DSS compliance reference 11.4.\n\nLANGUAGE: conf\nCODE:\n```\n[P2P - LimeWire {PCI_DSS: 11.4}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Limewire;\nr:HKLM\\software\\microsoft\\windows\\currentversion\\run -> limeshop;\nf:\\Program Files\\limewire;\nf:\\Program Files\\limeshop;\n```\n\n----------------------------------------\n\nTITLE: Checking Disconnected Session Time Limit for Windows Server 2012 R2\nDESCRIPTION: Registry checks that verify if the time limit for disconnected Remote Desktop Services sessions is set to 1 minute, as per CIS benchmark 18.9.52.3.10.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxDisconnectionTime -> !EA60;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxDisconnectionTime;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Basic Authentication\nDESCRIPTION: Verifies that 'Allow Basic authentication' is set to 'Disabled' (value equal to 0) in the WinRM Service registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Group Policy Processing Without Changes Setting\nDESCRIPTION: Ensures registry policy processing occurs even if Group Policy objects haven't changed by verifying NoGPOListChanges is set to 0 or missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoGPOListChanges -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoGPOListChanges;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Client Unencrypted Traffic Settings in Registry\nDESCRIPTION: Registry check to ensure 'Allow unencrypted traffic' for WinRM client is set to 'Disabled' per CIS benchmark 18.9.86.1.2. This requires WinRM traffic to be encrypted which enhances security.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Client -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Edge Pop-up Blocker Enable Registry Setting\nDESCRIPTION: Verifies that the Pop-up Blocker in Microsoft Edge is enabled by checking the AllowPopups registry value is not set to 'yes'.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> AllowPopups -> !r:yes;\n```\n\n----------------------------------------\n\nTITLE: Verifying Registry Policy Processing Background Settings\nDESCRIPTION: Checks that registry policies are applied during periodic background processing by ensuring NoBackgroundPolicy is set to 0 or missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> NoBackgroundPolicy -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Group Policy\\{35378EAC-683F-11D2-A89A-00C04FBBCFA2} -> !NoBackgroundPolicy;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Network Client Security Signature Settings\nDESCRIPTION: Validates Microsoft network client security signature settings according to CIS benchmarks 2.3.8.1 and 2.3.8.2. The rules check that digital signing is required and enabled for network communications.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.8.1 Ensure 'Microsoft network client: Digitally sign communications (always)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> RequireSecuritySignature -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> !RequireSecuritySignature;\n```\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.8.2 Ensure 'Microsoft network client: Digitally sign communications (if server agrees)' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanmanWorkstation\\Parameters -> EnableSecuritySignature -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking for Enabled DNS Server\nDESCRIPTION: Rule to detect if the DNS server (named) is enabled in the boot sequence. This should be disabled unless required, in compliance with PCI-DSS requirement 2.2.2 to disable unnecessary services.\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnamed$;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to detect Avahi daemon running\nDESCRIPTION: Checks if the Avahi daemon (for zero-configuration networking) is running on the system.\n\nLANGUAGE: configuration\nCODE:\n```\np:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Checking for Enabled NetFS Service\nDESCRIPTION: Rule to detect if the NetFS service is enabled in the boot sequence. Network file sharing services should be disabled unless required, in compliance with PCI-DSS requirement 2.2.2 to disable unnecessary services.\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Script to Automate Version Bumping\nDESCRIPTION: Reference to a version bump script that simplifies the process of incrementing version numbers in the OSSEC project.\n\nLANGUAGE: bash\nCODE:\n```\nversion_bump.sh Quick script to make version bumping easier\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Zone Protected View in Word\nDESCRIPTION: Registry check to ensure that Protected View is enabled for files from the Internet zone in Microsoft Word. This provides additional protection by opening potentially dangerous files in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> disableinternetfilesinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\protectedview -> disableinternetfilesinpv;\n```\n\n----------------------------------------\n\nTITLE: Detecting Disabled Bad Error Message Protection in RHEL5\nDESCRIPTION: Checks if protection against bad error messages is disabled in the system. This CIS benchmark rule (4.2.6) verifies that the icmp_ignore_bogus_error_responses parameter is not set to 0 to prevent ICMP error-based attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/icmp_ignore_bogus_error_responses -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking RPC Endpoint Mapper Client Authentication\nDESCRIPTION: OSSEC rule to verify that RPC Endpoint Mapper Client Authentication is enabled. The rule checks if the EnableAuthEpResolution registry value is not set to 1 or is missing entirely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> EnableAuthEpResolution -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> !EnableAuthEpResolution;\n```\n\n----------------------------------------\n\nTITLE: Checking for Maximum Authentication Attempts in OSSEC Rootcheck\nDESCRIPTION: Verifies if the SSH daemon is configured with the recommended maximum of 3 authentication attempts, which helps protect against brute force attacks.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 9: Wrong Maximum number of authentication attempts {PCI_DSS: 2.2.4}] [any] [9]\nf:$sshd_file -> !r:^# && r:MaxAuthTries && !r:3\\s*$;\nf:$sshd_file -> r:^#\\s*MaxAuthTries;\nf:$sshd_file -> !r:MaxAuthTries;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Windows Error Reporting Settings\nDESCRIPTION: Verifies that 'Turn off Windows Error Reporting' is enabled by checking for Disabled=0 and DoReport=1 in the registry. This prevents the system from sending error reports to Microsoft.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> DoReport -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> !DoReport;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Log Size Limit in OSSEC\nDESCRIPTION: OSSEC rule that verifies Windows Firewall Public profile log size limit is at least 16384 KB. It uses multiple regex patterns to check LogFileSize values of different lengths in either policy or current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Verifying Windows Connect Now Wireless Settings Configuration\nDESCRIPTION: Checks that 'Configuration of wireless settings using Windows Connect Now' is disabled. This rule verifies multiple registry values to ensure Windows Connect Now Registrars are disabled for security compliance.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> EnableRegistrars -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !EnableRegistrars;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableUPnPRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableUPnPRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableInBand802DOT11Registrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableInBand802DOT11Registrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableFlashConfigRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableFlashConfigRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableWPDRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableWPDRegistrar;\n```\n\n----------------------------------------\n\nTITLE: Checking Telemetry Authenticated Proxy Setting\nDESCRIPTION: Verifies that the authenticated proxy usage for Connected User Experience and Telemetry service is disabled by checking the DisableEnterpriseAuthProxy value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> DisableEnterpriseAuthProxy -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection -> !DisableEnterpriseAuthProxy;\n```\n\n----------------------------------------\n\nTITLE: Checking Memory Dumps for OS Error Reports Registry Setting in Windows\nDESCRIPTION: Verifies that 'Automatically send memory dumps for OS-generated error reports' is disabled by checking if the AutoApproveOSDumps registry value is set to 0 or does not exist.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> AutoApproveOSDumps -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !AutoApproveOSDumps;\n```\n\n----------------------------------------\n\nTITLE: Checking logoff enforcement when logon hours expire\nDESCRIPTION: Verifies that users are forced to log off when their logon hours expire by checking that EnableForcedLogOff registry value is set to 1.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking for Enabled Database Services\nDESCRIPTION: Rules to detect if database services (PostgreSQL and MySQL) are enabled in the boot sequence. These should be disabled unless required, in compliance with PCI-DSS requirement 2.2.2 to disable unnecessary services.\n\nLANGUAGE: bash\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\nd:$rc_dirs -> ^S\\d\\dmysqld$;\n```\n\n----------------------------------------\n\nTITLE: Validating Remote Shell Access Settings\nDESCRIPTION: Checks if Remote Shell Access is disabled. This is required by CIS benchmark item 18.9.87.1, which ensures that Windows Remote Shell (WinRS) is disabled to prevent remote command execution and reduce attack surface.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> AllowRemoteShellAccess -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> !AllowRemoteShellAccess;\n```\n\n----------------------------------------\n\nTITLE: Detecting Squid proxy server in SLES11\nDESCRIPTION: Checks if the Squid proxy server service is enabled in the runlevel directories, which should be disabled if not needed.\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsquid$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables the Windows Messenger Customer Experience Improvement Program. Checks for the presence of the CEIP registry key and verifies it has the value of 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Verifying ServerSignature Configuration in Apache\nDESCRIPTION: Rules to check that ServerSignature is turned off to prevent revealing server version information in error pages.\n\nLANGUAGE: regex\nCODE:\n```\nd:$conf-dirs -> conf -> !r:^# && r:serversignature\\s+email;\nd:$conf-dirs -> conf -> !r:^# && r:serversignature\\s+on;\n```\n\n----------------------------------------\n\nTITLE: Configuring BitTorrent Detection Rule in OSSEC Linux Audit\nDESCRIPTION: OSSEC rule for detecting BitTorrent P2P client through files and registry entries. Includes PCI DSS compliance reference 10.6.1 and reference URL.\n\nLANGUAGE: conf\nCODE:\n```\n# http://btfaq.com/serve/cache/18.html\n[P2P - BitTorrent {PCI_DSS: 10.6.1}] [any] [http://btfaq.com/serve/cache/18.html]\nf:\\Program Files\\BitTorrent;\nr:HKEY_CLASSES_ROOT\\.torrent;\nr:HKEY_CLASSES_ROOT\\MIME\\Database\\Content Type\\application/x-bittorrent;\nr:HKEY_CLASSES_ROOT\\bittorrent;\nr:HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\BitTorrent;\n```\n\n----------------------------------------\n\nTITLE: Checking IPv6 Source Routing Protection in Windows Registry with OSSEC\nDESCRIPTION: OSSEC rule that checks if IPv6 source routing protection level is set to highest protection (value 2), which completely disables source routing to protect against packet spoofing.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> DisableIPSourceRouting -> !2;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip6\\Parameters -> !DisableIPSourceRouting;\n```\n\n----------------------------------------\n\nTITLE: Defining Update Process Messages in Bash\nDESCRIPTION: Sets variables for messages related to updating an existing OSSEC HIDS installation, including rule updates.\n\nLANGUAGE: bash\nCODE:\n```\n# Update\nwanttoupdate=\"You already have OSSEC installed. Do you want to update it?\"\nunabletoupdate=\"Unable to perform update. A full new install will be required.\"\nupdatecompleted=\"Update completed.\"\nupdatefailed=\"Update failed.\"\nupdaterules=\"Do you want to update the rules?\"\nupdatingrules=\"Updating rules.\"\nnotupdatingrules=\"Not updating rules.\"\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Public Profile Local Firewall Rules Application in Registry\nDESCRIPTION: Validates that the Windows Firewall for Public Profile is configured to not apply local firewall rules. The rule checks for a value of 0 in the AllowLocalPolicyMerge key, indicating non-compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Logging Path in OSSEC\nDESCRIPTION: OSSEC rule that verifies Windows Firewall Public profile logging path is set correctly. It uses regex to check if LogFilePath matches the expected system path pattern in either policy or current configuration registry paths.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Messenger CEIP Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables the Windows Messenger Customer Experience Improvement Program. Checks for the presence of the CEIP registry key and verifies it has the value of 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> CEIP -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Messenger\\Client -> !CEIP;\n```\n\n----------------------------------------\n\nTITLE: Checking Handwriting Personalization Data Sharing Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off handwriting personalization data sharing' is set to 'Enabled' by verifying that the PreventHandwritingDataSharing registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.3 Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Unencrypted Traffic Registry Setting in Windows\nDESCRIPTION: Ensures that 'Allow unencrypted traffic' for WinRM Service is disabled by checking if the AllowUnencryptedTraffic registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowUnencryptedTraffic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Unsafe Locations Protected View in Excel\nDESCRIPTION: Registry check to ensure that Protected View is enabled for files from unsafe locations in Microsoft Excel. This provides additional security by opening files from potentially dangerous locations in a restricted environment.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\protectedview -> disableunsafelocationsinpv -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\protectedview -> !disableunsafelocationsinpv;\n```\n\n----------------------------------------\n\nTITLE: Verifying TCP SYN Cookies Configuration\nDESCRIPTION: Checks if TCP SYN cookies are enabled in the system. This test verifies if tcp_syncookies is set to 0 (disabled), which could make the system vulnerable to SYN flood attacks.\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/tcp_syncookies -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot-Start Driver Initialization Policy\nDESCRIPTION: Ensures Boot-Start Driver Initialization Policy is set to 'Good, unknown and bad but critical' by verifying DriverLoadPolicy is set to 3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Detecting Echo-dgram Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if echo-dgram service is enabled through xinetd. This implements CIS benchmark 2.1.16 by checking the relevant xinetd configuration file for service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/echo-dgram -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH PermitEmptyPasswords Setting\nDESCRIPTION: Rules for validating SSH PermitEmptyPasswords settings according to CIS benchmark 9.3.9. Ensures empty passwords are not permitted for SSH authentication.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.9 Set SSH PermitEmptyPasswords to No\n[CIS - Debian Linux 7/8 - 9.3.9 Set SSH PermitEmptyPasswords to No] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitEmptyPasswords\\s+yes;\nf:/etc/ssh/sshd_config -> !r:^PermitEmptyPasswords\\s+no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Size Compliance\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile log file size is set to at least 16384 KB as required by CIS benchmark 9.1.8. The rule checks various registry paths and values to ensure compliance.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Logging Size\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Private: Logging: Size limit (KB)' is set to '16384 KB or greater' as required by CIS benchmark 9.2.8 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Defining System Installation Messages in Bash\nDESCRIPTION: Sets variables for messages related to the system installation phase in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 5\ninstalling=\"Installing the system\"\nrunningmake=\"Running the Makefile\"\n```\n\n----------------------------------------\n\nTITLE: Checking Router Discovery Configuration\nDESCRIPTION: Verifies that IRDP router discovery is disabled by checking if the PerformRouterDiscovery registry value is set to 0. Implements CIS benchmark 18.4.8.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> PerformRouterDiscovery  -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !PerformRouterDiscovery;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Log File Path\nDESCRIPTION: Verifies that the Windows Firewall Private Profile log file path is set to %SYSTEMROOT%\\System32\\logfiles\\firewall\\*.log as required by CIS benchmark 9.2.7. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Checking Order Prints Task Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off the \"Order Prints\" picture task' is set to 'Enabled' per CIS benchmark 18.8.20.1.10. The check verifies that the NoOnlinePrintsWizard registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoOnlinePrintsWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoOnlinePrintsWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Connect Now Wizard Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled' by verifying that the DisableWcnUi registry value is set to 1 under HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.5.20.2 Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> DisableWcnUi -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> !DisableWcnUi;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Updates Auto-Restart Registry Setting\nDESCRIPTION: Ensures that 'No auto-restart with logged on users for scheduled automatic updates installations' is disabled by checking if the NoAutoRebootWithLoggedOnUsers registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU -> NoAutoRebootWithLoggedOnUsers -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking PowerPoint Settings for Making Hidden Markup Visible\nDESCRIPTION: Checks registry values to ensure that the 'Make hidden markup visible' setting is enabled in Microsoft PowerPoint 2016. This setting increases transparency by revealing potentially hidden content in presentations.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\options -> markupopensave -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\powerpoint\\options -> !markupopensave;\n```\n\n----------------------------------------\n\nTITLE: Detecting X11 enabled in SLES11\nDESCRIPTION: Checks if X Windows is enabled by looking for a default runlevel of 5 in the inittab file, which would start a graphical environment.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/inittab -> !r:^# && r:id:5;\n```\n\n----------------------------------------\n\nTITLE: Checking Setup EventLog Maximum Log File Size in Windows Registry\nDESCRIPTION: Registry check to ensure that the 'Setup: Specify the maximum log file size (KB)' is set to 32,768 KB or greater as required by CIS benchmark 18.9.26.3.2. The rule checks for valid registry values or flags missing configurations.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.26.3.2 Ensure 'Setup: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'\n[CIS - Microsoft Windows Server 2016 - 18.9.26.3.2: Ensure 'Setup: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Detecting Daytime-dgram Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if daytime-dgram service is enabled through xinetd. This implements CIS benchmark 2.1.14 by checking the relevant xinetd configuration file for service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/daytime-dgram -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Minimum Password Change Days\nDESCRIPTION: Verifies if appropriate minimum password change interval is configured in login.defs. This setting prevents users from changing passwords too frequently, which could be a sign of password sharing or other suspicious behavior.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/login.defs -> !r:^PASS_MIN_DAYS\\s+\\d+;\nf:/etc/login.defs -> !r:^# && r:PASS_MIN_DAYS\\s+1;\nf:/etc/login.defs -> !r:^# && r:PASS_MIN_DAYS\\s+2;\nf:/etc/login.defs -> !r:^# && r:PASS_MIN_DAYS\\s+3;\nf:/etc/login.defs -> !r:^# && r:PASS_MIN_DAYS\\s+4;\nf:/etc/login.defs -> !r:^# && r:PASS_MIN_DAYS\\s+5;\nf:/etc/login.defs -> !r:^# && r:PASS_MIN_DAYS\\s+6;\n```\n\n----------------------------------------\n\nTITLE: Checking HTTP Print Driver Download Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables downloading of print drivers over HTTP. Checks for the presence of the DisableWebPnPDownload registry key and verifies it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Successful Connections Setting\nDESCRIPTION: Verifies Windows Firewall Domain Profile is configured to log successful connections by checking that LogSuccessfulConnections value is not set to 0 in registry locations.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Basic Configuration Variables in Bash\nDESCRIPTION: Defines basic configuration variables for the OSSEC HIDS installation script, including yes/no responses and installation types.\n\nLANGUAGE: bash\nCODE:\n```\n# Configuration\nyes=\"y\"\nno=\"n\"\nyesmatch=\"y\"\nnomatch=\"n\"\nagent=\"agent\"\nlocal=\"local\"\nserver=\"server\"\nhelp=\"help\"\n```\n\n----------------------------------------\n\nTITLE: Building with Microsoft C and MASM\nDESCRIPTION: Command to build zlib with ASM optimizations using Microsoft C compiler and MASM assembler. Enables assembly versions of matching and inflation functions.\n\nLANGUAGE: Makefile\nCODE:\n```\nnmake -f win32/Makefile.msc LOC=\"-DASMV -DASMINF\" OBJA=\"match686.obj inffas32.obj\"\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Connection Security Rules Setting\nDESCRIPTION: Verifies that 'Windows Firewall: Domain: Settings: Apply local connection security rules' is enabled by checking the AllowLocalIPsecPolicyMerge registry value in both policy and current configuration locations.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Desktop Session Restrictions in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Restrict Remote Desktop Services users to a single Remote Desktop Services session' is set to 'Enabled' per CIS benchmark 18.9.52.3.2.1. The check verifies that the fSingleSessionPerUser registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fSingleSessionPerUser -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fSingleSessionPerUser;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Windows 10 Security Settings\nDESCRIPTION: This configuration defines OSSEC registry checks for Windows 10 security settings according to CIS Benchmark v1.4.0. Each check verifies that specific registry keys exist with the correct values, ensuring services are properly configured or disabled for security purposes.\n\nLANGUAGE: ossec-conf\nCODE:\n```\n# OSSEC Linux Audit - (C) 2018 OSSEC Project\n#\n# Released under the same license as OSSEC.\n# More details at the LICENSE file included with OSSEC or online\n# at: https://github.com/ossec/ossec-hids/blob/master/LICENSE\n#\n# [Application name] [any or all] [reference]\n# type:<entry name>;\n#\n# Type can be:\n#             - f (for file or directory)\n#             - r (registry entry)\n#             - p (process running)\n#\n# Additional values:\n# For the registry and for directories, use \"->\" to look for a specific entry and another\n# \"->\" to look for the value.\n# Also, use \" -> r:^\\. -> ...\" to search all files in a directory\n# For files, use \"->\" to look for a specific value in the file.\n#\n# Values can be preceeded by: =: (for equal) - default\n#                             r: (for ossec regexes)\n#                             >: (for strcmp greater)\n#                             <: (for strcmp  lower)\n# Multiple patterns can be specified by using \" && \" between them.\n# (All of them must match for it to return true).\n\n# CIS Checks for Windows 10\n# Based on Center for Internet Security Benchmark v1.4.0 for Microsoft Windows 10 Release 1709 (https://workbench.cisecurity.org/benchmarks/766)\n#\n#\n#2.3.4.2 Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'\n[CIS - Microsoft Windows 10 - 2.3.4.2 Ensure 'Devices: Prevent users from installing printer drivers' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> AddPrinterDrivers -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> !AddPrinterDrivers;\n#\n#\n#2.3.7.7 Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)'\n[CIS - Microsoft Windows 10 - 2.3.7.7 Ensure 'Interactive logon: Number of previous logons to cache (in case domain controller is not available)' is set to '4 or fewer logon(s)'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> CachedLogonsCount -> !4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> !CachedLogonsCount;\n#\n#\n#2.3.14.1 Ensure 'System cryptography: Force strong key protection for user keys stored on the computer' is set to 'User is prompted when the key is first used' or higher\n[CIS - Microsoft Windows 10 - 2.3.14.1 Ensure 'System cryptography: Force strong key protection for user keys stored on the computer' is set to 'User is prompted when the key is first used' or higher] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Cryptography -> ForceKeyProtection -> 0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Cryptography -> !ForceKeyProtection;\n#\n#\n#5.1 Ensure 'Bluetooth Handsfree Service (BthHFSrv)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.1 Ensure 'Bluetooth Handsfree Service (BthHFSrv)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\BthHFSrv -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\BthHFSrv -> !Start;\n#\n#\n#5.2 Ensure 'Bluetooth Support Service (bthserv)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.2 Ensure 'Bluetooth Support Service (bthserv)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\bthserv -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\bthserv -> !Start;\n#\n#\n#5.4 Ensure 'Downloaded Maps Manager (MapsBroker)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.4 Ensure 'Downloaded Maps Manager (MapsBroker)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MapsBroker -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MapsBroker -> !Start;\n#\n#\n#5.5 Ensure 'Geolocation Service (lfsvc)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.5 Ensure 'Geolocation Service (lfsvc)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\lfsvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\lfsvc -> !Start;\n#\n#\n#5.11 Ensure 'Link-Layer Topology Discovery Mapper (lltdsvc)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.11 Ensure 'Link-Layer Topology Discovery Mapper (lltdsvc)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\lltdsvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\lltdsvc -> !Start;\n#\n#\n#5.14 Ensure 'Microsoft iSCSI Initiator Service (MSiSCSI)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.14 Ensure 'Microsoft iSCSI Initiator Service (MSiSCSI)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSiSCSI -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\MSiSCSI -> !Start;\n#\n#\n#5.15 Ensure 'Peer Name Resolution Protocol (PNRPsvc)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.15 Ensure 'Peer Name Resolution Protocol (PNRPsvc)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PNRPsvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PNRPsvc -> !Start;\n#\n#\n#5.16 Ensure 'Peer Networking Grouping (p2psvc)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.16 Ensure 'Peer Networking Grouping (p2psvc)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\p2psvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\p2psvc -> !Start;\n#\n#\n#5.17 Ensure 'Peer Networking Identity Manager (p2pimsvc)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.17 Ensure 'Peer Networking Identity Manager (p2pimsvc)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\p2pimsvc -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\p2pimsvc -> !Start;\n#\n#\n#5.18 Ensure 'PNRP Machine Name Publication Service (PNRPAutoReg)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.18 Ensure 'PNRP Machine Name Publication Service (PNRPAutoReg)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PNRPAutoReg -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\PNRPAutoReg -> !Start;\n#\n#\n#5.19 Ensure 'Problem Reports and Solutions Control Panel Support (wercplsupport)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.19 Ensure 'Problem Reports and Solutions Control Panel Support (wercplsupport)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\wercplsupport -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\wercplsupport -> !Start;\n#\n#\n#5.20 Ensure 'Remote Access Auto Connection Manager (RasAuto)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.20 Ensure 'Remote Access Auto Connection Manager (RasAuto)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RasAuto -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RasAuto -> !Start;\n#\n#\n#5.21 Ensure 'Remote Desktop Configuration (SessionEnv)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.21 Ensure 'Remote Desktop Configuration (SessionEnv)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SessionEnv -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SessionEnv -> !Start;\n#\n#\n#5.22 Ensure 'Remote Desktop Services (TermService)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.22 Ensure 'Remote Desktop Services (TermService)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TermService -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TermService -> !Start;\n#\n#\n#5.23 Ensure 'Remote Desktop Services UserMode Port Redirector (UmRdpService)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.23 Ensure 'Remote Desktop Services UserMode Port Redirector (UmRdpService)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\UmRdpService -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\UmRdpService -> !Start;\n#\n#\n#5.25 Ensure 'Remote Registry (RemoteRegistry)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.25 Ensure 'Remote Registry (RemoteRegistry)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RemoteRegistry -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RemoteRegistry -> !Start;\n#\n#\n#5.27 Ensure 'Server (LanmanServer)' is set to 'Disabled'\n[CIS - Microsoft Windows 10 - 5.27 Ensure 'Server (LanmanServer)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer -> !Start;\n#\n```\n\n----------------------------------------\n\nTITLE: Windows Router Discovery Check in OSSEC\nDESCRIPTION: Checks if IRDP (Internet Router Discovery Protocol) is disabled by verifying the PerformRouterDiscovery registry value is set to 0, preventing potential DoS attacks.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.3.7: Ensure 'MSS: (PerformRouterDiscovery) Allow IRDP to detect and configure Default Gateway addresses (could lead to DoS)' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> PerformRouterDiscovery  -> !0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !PerformRouterDiscovery;\n```\n\n----------------------------------------\n\nTITLE: Checking System NTLM Identity Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network security: Allow Local System to use computer identity for NTLM' is set to 'Enabled' according to CIS benchmark 2.3.11.1.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> UseMachineId -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !UseMachineId;\n```\n\n----------------------------------------\n\nTITLE: Verifying Telnet Banner Setting\nDESCRIPTION: Rule to check that the telnet banner setting is null, as specified in CIS Solaris 11 benchmark section 8.5. This prevents information disclosure through telnet banners.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/default/telnetd -> !r:^# && r:BANNER=\\.;\nf:/etc/default/telnetd -> !r:BANNER=$;\n```\n\n----------------------------------------\n\nTITLE: Checking SSH LogLevel Setting\nDESCRIPTION: Rules for verifying SSH LogLevel settings according to CIS benchmark 9.3.2. Ensures logging is set to INFO level for proper security event tracking.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.3.2 Set LogLevel to INFO\n[CIS - Debian Linux 7/8 - 9.3.2 Set LogLevel to INFO] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/ssh/sshd_config -> !r:^LogLevel\\s+INFO;\n```\n\n----------------------------------------\n\nTITLE: Detecting User-mounted Removable Media Permissions in OSSEC\nDESCRIPTION: OSSEC rule that checks if user-mounted removable partitions (CD-ROM and floppy) are allowed on the console, which may present security risks.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - User-mounted removable partition allowed on the console] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Checking for Legacy + Entries in passwd File\nDESCRIPTION: Detects legacy '+' entries in the passwd file, which could allow NIS entries and pose a security risk. These entries are considered insecure and should be removed.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/passwd -> !r:^# && r:^+:;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Application Event Log Max Size\nDESCRIPTION: OSSEC rule that checks if 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater' by verifying the MaxSize registry key.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Application Event Log Max Size\nDESCRIPTION: OSSEC rule that checks if 'Application: Specify the maximum log file size (KB)' is set to 'Enabled: 32,768 or greater' by verifying the MaxSize registry key.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Verifying Last User Display Settings in OSSEC for Windows Server 2012 R2\nDESCRIPTION: OSSEC rule to check that 'Interactive logon: Do not display last user name' is enabled. Implements CIS Benchmark check 2.3.7.1 for Windows Server 2012 R2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 2.3.7.1: Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DontDisplayLastUserName;\n```\n\n----------------------------------------\n\nTITLE: Configuring OSSEC XML for Nmap Output Integration\nDESCRIPTION: This XML configuration snippet shows how to add a Nmap grepable output file to the OSSEC configuration (ossec.conf). It defines the log format as 'nmapg' and specifies the location of the Nmap output file.\n\nLANGUAGE: xml\nCODE:\n```\n<ossec_config>\n  <localfile>\n    <log_format>nmapg</log_format>\n    <location>/var/log/nmap-out.log</location>\n  </localfile>\n</ossec_config>\n```\n\n----------------------------------------\n\nTITLE: Checking LAPS AdmPwd GPO Extension Installation in OSSEC\nDESCRIPTION: OSSEC rule that verifies if the LAPS AdmPwd GPO Extension/CSE is installed according to CIS benchmark 18.2.1. The rule checks for the absence of the DllName registry value which would indicate non-compliance.\n\nLANGUAGE: ossec\nCODE:\n```\n#\n#\n#18.2.1 Ensure LAPS AdmPwd GPO Extension / CSE is installed\n[CIS - Microsoft Windows 10 - 18.2.1 Ensure LAPS AdmPwd GPO Extension / CSE is installed] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\GPExtensions\\{D76B9641-3288-4f75-942D-087DE603E3EA} -> !DllName;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC UIAccess Applications Secure Locations Setting\nDESCRIPTION: Verifies that 'User Account Control: Only elevate UIAccess applications that are installed in secure locations' is enabled by checking the EnableSecureUIAPaths registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableSecureUIAPaths -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Registration Wizard Settings\nDESCRIPTION: Verifies that 'Turn off Registration if URL connection is referring to Microsoft.com' is enabled by checking for NoRegistration=1 in the registry. This prevents the system from automatically registering with Microsoft.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Detecting discard Service in xinetd\nDESCRIPTION: Checks for enabled discard service in xinetd configuration. Part of CIS SLES12 benchmark section 5.9.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/discard -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Windows LLTDIO Driver Check in OSSEC\nDESCRIPTION: Verifies the Link-Layer Topology Discovery Mapper I/O driver is disabled by checking multiple registry values that control its functionality on different network types.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.4.9.1: Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableLLTDIO -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitLLTDIOOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Secure ICMP Redirect Acceptance in RHEL7\nDESCRIPTION: OSSEC rule that checks if secure ICMP redirects are accepted, which would violate CIS benchmark 4.2.3 for RHEL7 and PCI-DSS requirement 2.2.4.\n\nLANGUAGE: config\nCODE:\n```\n[CIS - RHEL7 - 4.2.3 - Network parameters - ICMP secure redirects accepted {CIS: 4.2.3 RHEL7} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_7_Benchmark_v1.1.0.pdf]\nf:/proc/sys/net/ipv4/conf/all/secure_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/secure_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check for source routing acceptance\nDESCRIPTION: Checks if source routed packets are accepted by verifying if the value in proc file is set to 1.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Active Response Configuration Messages in Portuguese\nDESCRIPTION: Portuguese translations for configuring the active response system, including host-deny and firewall-drop options.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3.4/servidor/local\nenable_ar=\"Deseja habilitar o sistema de respostas automticas?\"\nnoactive=\"Sistema de respostas automticas desabilitado\"\nnohosts=\"host-deny desabilitado\"\nyeshosts=\"host-deny habilitado (local) para niveis >= 6\"\nfirewallar=\"Deseja habilitar o firewall-drop?\"\nnofirewall=\"firewall-drop desabilitado.\"\nyesfirewall=\"firewall-drop habilitado (local) para nveis >= 6\"\ndefaultwhitelist=\"Lista de endereos que no sero bloqueados pela resposta automtica:\" \naddwhite=\"Deseja adicionar mais algum endereo a essa lista?\"\nipswhite=\"Endereos de IP (separados por espao): \"\n```\n\n----------------------------------------\n\nTITLE: OSSEC rules to check for IP redirect sending enabled\nDESCRIPTION: Checks if IP redirects sending is enabled by verifying if the values in proc files are not set to 0.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Setting RC Directory Files Variable for OSSEC Linux Audit\nDESCRIPTION: Defines a variable '$rc_dirfiles' that contains paths to all RC directory files which are used in system startup. This variable can be referenced in subsequent audit rules to check for proper system initialization configurations.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n$rc_dirfiles=/etc/rc0.d/*,/etc/rc1.d/*,/etc/rc2.d/*,/etc/rc3.d/*,/etc/rc4.d/*,/etc/rc5.d/*,/etc/rc6.d/*,/etc/rc7.d/*,/etc/rc8.d/*,/etc/rc9.d/*,/etc/rca.d/*,/etc/rcb.d/*,/etc/rcc.d/*,/etc/rcs.d/*,/etc/rcS.d/*;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Log Size in Windows Registry\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile log file size is set to at least 16,384 KB per CIS benchmark 9.1.6. The check confirms the LogFileSize value is within acceptable ranges across both policy and service registry keys.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Checking OneDrive File Storage on Windows 8.1 Registry Setting\nDESCRIPTION: Verifies that OneDrive for file storage on Windows 8.1 is disabled by checking if DisableFileSync is set to 1 and not missing, which prevents using OneDrive for file storage specifically on Windows 8.1 systems.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Skydrive -> DisableFileSync -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Skydrive -> !DisableFileSync;\n```\n\n----------------------------------------\n\nTITLE: Building and Printing JSON Objects in C with cJSON\nDESCRIPTION: A complete function that builds a JSON object representing a monitor with multiple resolutions and prints it to a string. It demonstrates manual object creation, adding items to objects and arrays, and proper error handling including memory cleanup.\n\nLANGUAGE: c\nCODE:\n```\n//create a monitor with a list of supported resolutions\nchar* create_monitor(void)\n{\n    const unsigned int resolution_numbers[3][2] = {\n        {1280, 720},\n        {1920, 1080},\n        {3840, 2160}\n    };\n    char *string = NULL;\n    cJSON *name = NULL;\n    cJSON *resolutions = NULL;\n    cJSON *resolution = NULL;\n    cJSON *width = NULL;\n    cJSON *height = NULL;\n    size_t index = 0;\n\n    cJSON *monitor = cJSON_CreateObject();\n    if (monitor == NULL)\n    {\n        goto end;\n    }\n\n    name = cJSON_CreateString(\"Awesome 4K\");\n    if (name == NULL)\n    {\n        goto end;\n    }\n    /* after creation was successful, immediately add it to the monitor,\n     * thereby transfering ownership of the pointer to it */\n    cJSON_AddItemToObject(monitor, \"name\", name);\n\n    resolutions = cJSON_CreateArray();\n    if (resolutions == NULL)\n    {\n        goto end;\n    }\n    cJSON_AddItemToObject(monitor, \"resolutions\", resolutions);\n\n    for (index = 0; index < (sizeof(resolution_numbers) / (2 * sizeof(int))); ++index)\n    {\n        resolution = cJSON_CreateObject();\n        if (resolution == NULL)\n        {\n            goto end;\n        }\n        cJSON_AddItemToArray(resolutions, resolution);\n\n        width = cJSON_CreateNumber(resolution_numbers[index][0]);\n        if (width == NULL)\n        {\n            goto end;\n        }\n        cJSON_AddItemToObject(resolution, \"width\", width);\n\n        height = cJSON_CreateNumber(resolution_numbers[index][1]);\n        if (height == NULL)\n        {\n            goto end;\n        }\n        cJSON_AddItemToObject(resolution, \"height\", height);\n    }\n\n    string = cJSON_Print(monitor);\n    if (string == NULL)\n    {\n        fprintf(stderr, \"Failed to print monitor.\\n\");\n    }\n\nend:\n    cJSON_Delete(monitor);\n    return string;\n}\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Successful Connections Logging\nDESCRIPTION: Verifies that the Windows Firewall Domain Profile logging of successful connections is enabled as required by CIS benchmark 9.1.10. The rule checks registry values in both policy and current settings locations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking LocalSystem NULL session fallback\nDESCRIPTION: Verifies that 'Network security: Allow LocalSystem NULL session fallback' is disabled by checking the allownullsessionfallback registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> allownullsessionfallback -> 1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\MSV1_0 -> !allownullsessionfallback;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Battery Connected-Standby Network Settings\nDESCRIPTION: Verifies that 'Allow network connectivity during connected-standby (on battery)' is disabled by checking for DCSettingIndex=0 in the registry. This prevents network access during low-power states on battery power.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> DCSettingIndex -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> !DCSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Checking for User-mounted Removable Partitions on Console\nDESCRIPTION: Rules to detect if user-mounted removable partitions (CD-ROM and floppy) are allowed on the console, which could present security risks by giving regular users physical access to sensitive data or allowing unauthorized data export.\n\nLANGUAGE: bash\nCODE:\n```\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: Checking Location Services Configuration in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Turn off location' is set to 'Enabled' per CIS benchmark 18.9.37.1. The check verifies that the DisableLocation registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> DisableLocation -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LocationAndSensors -> !DisableLocation;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for JavaScript and VBScript Download Execution Prevention\nDESCRIPTION: OSSEC audit rules to verify that JavaScript and VBScript are blocked from launching downloaded executable content. This security setting helps prevent malicious scripts from downloading and executing harmful files.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> D3E037E1-3EB8-44C8-A917-57927947596D -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !D3E037E1-3EB8-44C8-A917-57927947596D;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to detect VSFTPD enabled via xinetd\nDESCRIPTION: Checks if VSFTPD service is enabled in xinetd configuration by verifying if it's not commented out and has disable set to no.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/xinetd.d/vsftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Talk Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify talk server is disabled on RHEL5 systems. Examines /etc/xinetd.d/talk to ensure the service is properly disabled, satisfying CIS requirement 2.1.10 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 2.1.10 - talk enabled on xinetd {CIS: 2.1.10 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/talk -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to detect POP3 (dovecot) enabled via xinetd\nDESCRIPTION: Checks if dovecot POP3 service is enabled in xinetd configuration by verifying if it's not commented out and has disable set to no.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/xinetd.d/dovecot -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Disable Mounting of squashfs Filesystems Rule for OSSEC\nDESCRIPTION: CIS rule 2.23 that checks for the existence of /etc/modprobe.d/CIS.conf and verifies it contains a directive to disable mounting of squashfs filesystems for security hardening.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 2.23 Disable Mounting of squashfs Filesystems] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install squashfs /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Log Format Configuration for Audit Log Support\nDESCRIPTION: XML configuration tag to enable native audit.log support in OSSEC.\n\nLANGUAGE: xml\nCODE:\n```\n<log_format>audit</log_format>\n```\n\n----------------------------------------\n\nTITLE: Checking System Event Log Maximum Size Registry Setting\nDESCRIPTION: Verifies that the System Event Log maximum file size is set to at least 32,768 KB. This check uses regular expressions to match various digit patterns in the MaxSize value to ensure it's large enough, or checks if the value is missing.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:0\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:4\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:5\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:6\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> MaxSize -> r:7\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\System -> !MaxSize;\n```\n\n----------------------------------------\n\nTITLE: Declaring Zlib Functions in Visual Basic with Win16/Win32 Conditional Compilation\nDESCRIPTION: Function declarations for zlib compression library with conditional compilation directives for Win16 and Win32. Includes declarations for compress, uncompress, gzopen, gzwrite, gzread, and gzclose functions.\n\nLANGUAGE: Visual Basic\nCODE:\n```\n#If Win16 Then   'Use Win16 calls.\nDeclare Function compress Lib \"ZLIB.DLL\" (ByVal compr As\n        String, comprLen As Any, ByVal buf As String, ByVal buflen\n        As Long) As Integer\nDeclare Function uncompress Lib \"ZLIB.DLL\" (ByVal uncompr\n        As String, uncomprLen As Any, ByVal compr As String, ByVal\n        lcompr As Long) As Integer\nDeclare Function gzopen Lib \"ZLIB.DLL\" (ByVal filePath As\n        String, ByVal mode As String) As Long\nDeclare Function gzread Lib \"ZLIB.DLL\" (ByVal file As\n        Long, ByVal uncompr As String, ByVal uncomprLen As Integer)\n        As Integer\nDeclare Function gzwrite Lib \"ZLIB.DLL\" (ByVal file As\n        Long, ByVal uncompr As String, ByVal uncomprLen As Integer)\n        As Integer\nDeclare Function gzclose Lib \"ZLIB.DLL\" (ByVal file As\n        Long) As Integer\n#Else\nDeclare Function compress Lib \"ZLIB32.DLL\"\n        (ByVal compr As String, comprLen As Any, ByVal buf As\n        String, ByVal buflen As Long) As Integer\nDeclare Function uncompress Lib \"ZLIB32.DLL\"\n        (ByVal uncompr As String, uncomprLen As Any, ByVal compr As\n        String, ByVal lcompr As Long) As Long\nDeclare Function gzopen Lib \"ZLIB32.DLL\"\n        (ByVal file As String, ByVal mode As String) As Long\nDeclare Function gzread Lib \"ZLIB32.DLL\"\n        (ByVal file As Long, ByVal uncompr As String, ByVal\n        uncomprLen As Long) As Long\nDeclare Function gzwrite Lib \"ZLIB32.DLL\"\n        (ByVal file As Long, ByVal uncompr As String, ByVal\n        uncomprLen As Long) As Long\nDeclare Function gzclose Lib \"ZLIB32.DLL\"\n        (ByVal file As Long) As Long\n#End If\n```\n\n----------------------------------------\n\nTITLE: Validating Idle Session Time Limits for Remote Desktop Services\nDESCRIPTION: Verifies that active but idle Remote Desktop Services sessions have appropriate time limits set (15 minutes or less). This check ensures compliance with CIS benchmark item 18.9.52.3.10.1 by checking various registry values that represent different time settings.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba\\D;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbb\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbc\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbd\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbe\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbf\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbc\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbd\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbe\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbf\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dc\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dd\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:de\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:df\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:e\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:f\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:\\w\\w\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxIdleTime;\n```\n\n----------------------------------------\n\nTITLE: Checking for User .rhosts Files in Solaris 11\nDESCRIPTION: This rule checks for the presence of .rhosts files in user home directories. These files can create security vulnerabilities by allowing remote login without password authentication.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$home_dirs -> ^.rhosts$;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Flags Access Settings in Registry with OSSEC\nDESCRIPTION: Verifies that 'Prevent access to the about:flags page in Microsoft Edge' is enabled by checking if PreventAccessToAboutFlagsInMicrosoftEdge is set to 1. This prevents users from enabling experimental features that might pose security risks.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> PreventAccessToAboutFlagsInMicrosoftEdge -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !PreventAccessToAboutFlagsInMicrosoftEdge;\n```\n\n----------------------------------------\n\nTITLE: Detecting time on xinetd in SLES11\nDESCRIPTION: Checks if time service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/time -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Plug and Play Device Redirection Settings in Registry\nDESCRIPTION: This rule verifies that Plug and Play device redirection is disabled in Remote Desktop Services by ensuring the fDisablePNPRedir registry key is set to 1. The rule triggers if the key is missing or not set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisablePNPRedir -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisablePNPRedir;\n```\n\n----------------------------------------\n\nTITLE: Checking Removable Partition /media without 'nodev' Option in OSSEC\nDESCRIPTION: This rule checks if removable media mounted at /media in /etc/fstab lacks the 'nodev' option. The rule identifies non-commented entries for /media without the nodev mount option, which is required by CIS benchmark 7.2.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/fstab -> !r:^# && r:/media && !r:nodev;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check if ExecShield is enabled\nDESCRIPTION: Verifies that the ExecShield kernel protection mechanism is enabled by checking if the value in exec-shield is not 0.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/proc/sys/kernel/exec-shield -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Integrity Check Configuration Messages in Portuguese\nDESCRIPTION: Portuguese translations for enabling or disabling the integrity checking system (syscheck) in OSSEC HIDS.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3.2\nrunsyscheck=\"Deseja habilitar o sistema de verificao de integridade?\"\nnosyscheck=\"Syscheck (Sistema de verificao de integridade) desabilitado\"\nyessyscheck=\"Syscheck (Sistema de verificao de integridade) habilitado\"\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to detect NIS client enabled\nDESCRIPTION: Checks if NIS client service (ypbind) is enabled in startup scripts by looking for S followed by numbers and ypbind.\n\nLANGUAGE: configuration\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dypbind$;\n```\n\n----------------------------------------\n\nTITLE: Record Events That Modify Date and Time Information Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.4 that checks if auditd is configured to record events that modify system date and time settings. It verifies audit rules to track temporal modifications which could indicate tampering.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7 - 8.1.4 Record Events That Modify Date and Time Information] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-a always,exit -F arch=b32 -S adjtimex -S settimeofday -S stime -k time-change;\nf:/etc/audit/audit.rules -> !r:^-a always,exit -F arch=b32 -S clock_settime -k time-change;\nf:/etc/audit/audit.rules -> !r:^-w /etc/localtime -p wa -k time-change;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password Requirements (Plugged In) in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled' per CIS benchmark 18.8.29.5.2. The check verifies that the ACSettingIndex registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Wake Password Requirements (Plugged In) in Windows Registry\nDESCRIPTION: Registry checks to ensure 'Require a password when a computer wakes (plugged in)' is set to 'Enabled' per CIS benchmark 18.8.29.5.2. The check verifies that the ACSettingIndex registry value is set to 1.\n\nLANGUAGE: Registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> ACSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: CIS Benchmark Registry Check - Solicited Remote Assistance\nDESCRIPTION: OSSEC rule that checks if 'Configure Solicited Remote Assistance' is set to 'Disabled' by verifying the fAllowToGetHelp registry key is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Suggested Improved Compression Level Enumeration with Z-prefix in Delphi\nDESCRIPTION: Shows a suggested improved version of the compression level enumeration with the 'z' prefix to avoid conflicts with TColor-like symbols. This represents an alternative implementation that wasn't part of the original code.\n\nLANGUAGE: Delphi\nCODE:\n```\nTCompressionLevel = (zcNone, zcFastest, zcDefault, zcMax);\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Public Profile Notification Settings in Registry\nDESCRIPTION: Checks if the Windows Firewall for Public Profile is configured to not display notifications. The rule looks for a value of 0 in the DisableNotifications key, which indicates a non-compliant configuration.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Root PATH Integrity\nDESCRIPTION: Rule to ensure the root PATH has proper integrity, as specified in CIS Solaris 11 benchmark section 9.6. This prevents malicious programs from being executed by the root user.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/profile -> r:.;\nf:/etc/environment -> r:.;\nf:/.profile -> r:.;\nf:/.bash_profile -> r:.;\nf:/.bashrc -> r:.;\nf:/etc/profile -> r:::;\nf:/etc/environment -> r:::;\nf:/.profile -> r:::;\nf:/.bash_profile -> r:::;\nf:/.bashrc -> r:::;\nf:/etc/profile -> r::$;\nf:/etc/environment -> r::$;\nf:/.profile -> r::$;\nf:/.bash_profile -> r::$;\nf:/.bashrc -> r::$;\n```\n\n----------------------------------------\n\nTITLE: Defining RC Scripts Directory Variables in OSSEC Audit\nDESCRIPTION: Sets a variable for the location of RC script directories which will be used in subsequent security checks. This helps identify enabled services across different runlevels.\n\nLANGUAGE: bash\nCODE:\n```\n$rc_dirs=/etc/rc.d/rc2.d,/etc/rc.d/rc3.d,/etc/rc.d/rc4.d,/etc/rc.d/rc5.d;\n```\n\n----------------------------------------\n\nTITLE: Detecting daytime on xinetd in SLES11\nDESCRIPTION: Checks if daytime service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/daytime -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Remote Server Management Settings in Registry\nDESCRIPTION: This rule ensures that remote server management through WinRM is disabled by verifying the AllowAutoConfig registry key is set to 0. The rule triggers if the key is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowAutoConfig -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Inbound Connections in Registry\nDESCRIPTION: Validates that the Windows Firewall for Private Profile is set to block inbound connections by default. The rule checks for a value of 0 in the DefaultInboundAction key, indicating non-compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Verifying Apache TimeOut Configuration\nDESCRIPTION: Rules to ensure the TimeOut directive is set to 10 seconds or less to mitigate denial of service attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:$main-conf -> !r:^# && r:timeout\\s+9\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+8\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+7\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+6\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+5\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+4\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+3\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+2\\d;\nf:$main-conf -> !r:^# && r:timeout\\s+11;\nf:$main-conf -> !r:^# && r:timeout\\s+12;\nf:$main-conf -> !r:^# && r:timeout\\s+13;\nf:$main-conf -> !r:^# && r:timeout\\s+14;\nf:$main-conf -> !r:^# && r:timeout\\s+15;\nf:$main-conf -> !r:^# && r:timeout\\s+16;\nf:$main-conf -> !r:^# && r:timeout\\s+17;\nf:$main-conf -> !r:^# && r:timeout\\s+18;\nf:$main-conf -> !r:^# && r:timeout\\s+19;\nf:$main-conf -> !r:^timeout\\s+\\d\\d*;\nf:$main-conf -> !r:^# && r:timeout\\s+\\d\\d\\d+;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Cookie Configuration in Registry\nDESCRIPTION: Validates that Microsoft Edge is configured to block 3rd-party cookies by checking if the Cookies registry value is set to 2 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> Cookies -> 2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !Cookies;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rules to detect rsh/rlogin/rcp services enabled via xinetd\nDESCRIPTION: Checks if remote shell services are enabled in xinetd configuration by looking for disable set to no in multiple service files.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/xinetd.d/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/shell -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Avahi Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify Avahi daemon is disabled on RHEL5 systems. Checks for running avahi-daemon process, satisfying CIS requirement 3.1.1 and PCI DSS 2.2.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.1.1 - Avahi daemon not disabled {CIS: 3.1.1 RHEL5} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\np:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Publishing Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables the \"Publish to Web\" task for files and folders. Checks for the presence of the NoPublishingWizard registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Web Publishing Settings in Windows Registry\nDESCRIPTION: Validates the registry setting that disables the \"Publish to Web\" task for files and folders. Checks for the presence of the NoPublishingWizard registry key and ensures it has the value of 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> NoPublishingWizard -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer -> !NoPublishingWizard;\n```\n\n----------------------------------------\n\nTITLE: Checking Lock Screen Camera Settings in OSSEC\nDESCRIPTION: OSSEC rule that verifies the lock screen camera is disabled. It checks if NoLockScreenCamera is set to 1 or if the key doesn't exist in the Personalization policy registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> NoLockScreenCamera -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization -> !NoLockScreenCamera;\n```\n\n----------------------------------------\n\nTITLE: Checking Automatic Logon Settings in OSSEC\nDESCRIPTION: OSSEC rule that verifies automatic logon is disabled. It checks if AutoAdminLogon is not set to 0 (disabled) in the Windows login registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> AutoAdminLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting SNMP Server\nDESCRIPTION: Checks for enabled SNMP server in runlevel configuration. Part of CIS SLES12 benchmark section 6.14.\n\nLANGUAGE: shell\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Detecting NFS Services\nDESCRIPTION: Checks for enabled NFS and NFSlock services in runlevel configuration. Part of CIS SLES12 benchmark section 6.7.\n\nLANGUAGE: shell\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dnfs$;\nd:$rc_dirs -> ^S\\d\\dnfslock$;\n```\n\n----------------------------------------\n\nTITLE: Detecting tftp-server on xinetd in SLES11\nDESCRIPTION: Checks if tftp service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/tftpd -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot-Start Driver Initialization Policy\nDESCRIPTION: OSSEC rule to verify that the Boot-Start Driver Initialization Policy is set to 'Good, unknown and bad but critical'. The rule checks if the DriverLoadPolicy registry value is not set to 3.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Checking Setup Event Log Behavior in Windows Registry\nDESCRIPTION: OSSEC rule to check if 'Setup: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' in Windows registry. Ensures the Retention value is set to 0 in the Setup Event Log policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Office Common Privacy Settings in Registry\nDESCRIPTION: Registry checks to verify privacy settings in Microsoft Office 16.0 common components. These rules ensure feedback, telemetry, and data collection features are properly disabled according to security recommendations.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\feedback -> \tincludescreenshot -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\feedback ->  !includescreenshot;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common -> updatereliabilitydata -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common -> !updatereliabilitydata;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\general -> shownfirstrunoptin -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\general -> !shownfirstrunoptin;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common -> qmenable -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common -> !qmenable;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\feedback -> enabled -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\feedback -> !enabled;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common -> sendcustomerdata -> !0;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common -> !sendcustomerdata;\n```\n\n----------------------------------------\n\nTITLE: Checking System Headers and Large File Support\nDESCRIPTION: Performs system checks for required headers (sys/types.h, stdint.h, stddef.h) and tests for large file support functionality with off64_t type.\n\nLANGUAGE: CMake\nCODE:\n```\ninclude(CheckTypeSize)\ninclude(CheckFunctionExists)\ninclude(CheckIncludeFile)\ninclude(CheckCSourceCompiles)\nenable_testing()\n\ncheck_include_file(sys/types.h HAVE_SYS_TYPES_H)\ncheck_include_file(stdint.h    HAVE_STDINT_H)\ncheck_include_file(stddef.h    HAVE_STDDEF_H)\n\n#\n# Check to see if we have large file support\n#\nset(CMAKE_REQUIRED_DEFINITIONS -D_LARGEFILE64_SOURCE=1)\n# We add these other definitions here because CheckTypeSize.cmake\n# in CMake 2.4.x does not automatically do so and we want\n# compatibility with CMake 2.4.x.\nif(HAVE_SYS_TYPES_H)\n    list(APPEND CMAKE_REQUIRED_DEFINITIONS -DHAVE_SYS_TYPES_H)\nendif()\nif(HAVE_STDINT_H)\n    list(APPEND CMAKE_REQUIRED_DEFINITIONS -DHAVE_STDINT_H)\nendif()\nif(HAVE_STDDEF_H)\n    list(APPEND CMAKE_REQUIRED_DEFINITIONS -DHAVE_STDDEF_H)\nendif()\ncheck_type_size(off64_t OFF64_T)\nif(HAVE_OFF64_T)\n   add_definitions(-D_LARGEFILE64_SOURCE=1)\nendif()\nset(CMAKE_REQUIRED_DEFINITIONS) # clear variable\n```\n\n----------------------------------------\n\nTITLE: Checking for User-mounted Removable Media Permissions in OSSEC\nDESCRIPTION: OSSEC rule that checks if user-mounted removable partitions (CD-ROM and floppy) are allowed on the console, which could pose security risks if not properly controlled.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - X.X.X - User-mounted removable partition allowed on the console] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/security/console.perms -> r:^<console>  \\d+ <cdrom>;\nf:/etc/security/console.perms -> r:^<console>  \\d+ <floppy>;\n```\n\n----------------------------------------\n\nTITLE: IMAP and POP3 Services Check in OSSEC\nDESCRIPTION: OSSEC rule to verify IMAP and POP3 services are disabled on RHEL5 systems. Examines xinetd configuration files to ensure these services are properly disabled, satisfying CIS requirement 3.12 and PCI DSS 2.2.2.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 3.12 - imap enabled on xinetd {CIS: 3.12 RHEL5} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/cyrus-imapd -> !r:^# && r:disable && r:no;\n\n[CIS - RHEL5 - 3.12 - pop3 enabled on xinetd {CIS: 3.12 RHEL5} {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/dovecot -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Collect Discretionary Access Control Permission Modification Events Rule for OSSEC\nDESCRIPTION: CIS rule 8.1.10 that checks if auditd is configured to collect discretionary access control permission modification events. It verifies audit rules exist to monitor changes to file permissions that could indicate privilege escalation.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 8.1.10 Collect Discretionary Access Control Permission Modification Events] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/audit;\nf:!/etc/audit/audit.rules;\nf:/etc/audit/audit.rules -> !r:^-a always,exit -F arch=b32 -S chmod -S fchmod -S fchmodat -F auid>=1000 \\\\;\nf:/etc/audit/audit.rules -> !r:^-F auid!=4294967295 -k perm_mod;\nf:/etc/audit/audit.rules -> !r:^-a always,exit -F arch=b32 -S chown -S fchown -S fchownat -S lchown -F auid>=1000 \\\\;\nf:/etc/audit/audit.rules -> !r:^-F auid!=4294967295 -k perm_mod;\nf:/etc/audit/audit.rules -> !r:^-a always,exit -F arch=b32 -S setxattr -S lsetxattr -S fsetxattr -S removexattr -S \\\\;\nf:/etc/audit/audit.rules -> !r:^lremovexattr -S fremovexattr -F auid>=1000 -F auid!=4294967295 -k perm_mod;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Application Installation Detection Setting\nDESCRIPTION: Verifies that 'User Account Control: Detect application installations and prompt for elevation' is enabled by checking the EnableInstallerDetection registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableInstallerDetection -> 0;\nr:HKEY_LOCAL_MACHINE\\MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !EnableInstallerDetection;\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Default Permissions in Windows Registry\nDESCRIPTION: Verifies that 'System objects: Strengthen default permissions of internal system objects' is enabled by checking the ProtectionMode registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager -> ProtectionMode -> !1;\n```\n\n----------------------------------------\n\nTITLE: Detecting xinetd Service in systemd\nDESCRIPTION: Checks for enabled xinetd service in systemd service files. Part of CIS SLES12 benchmark section 5.1.9.\n\nLANGUAGE: shell\nCODE:\n```\nf:/usr/lib/systemd/system/xinetd.service -> r:Exec;\n```\n\n----------------------------------------\n\nTITLE: Detecting Non-root Accounts with UID 0 in OSSEC\nDESCRIPTION: OSSEC rule to identify non-root accounts with UID 0 in the /etc/passwd file. This checks for privilege escalation risks where regular accounts might have been given root-level access (UID 0) which violates security best practices.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - 13.5 - Non-root account with uid 0 {CIS: 13.5 SLES12} {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nf:/etc/passwd -> !r:^# && !r:^root: && r:^\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Detecting Improper master_info_repository Settings in MySQL Configuration\nDESCRIPTION: A set of regex patterns that check MySQL configuration files to ensure 'master_info_repository' is set to 'Table' rather than 'File' as recommended by CIS MySQL benchmark 9.2. The patterns identify commented-out settings, explicitly incorrect settings, and missing values.\n\nLANGUAGE: regex\nCODE:\n```\nf:$mysql-cnfs -> !r:^# && r:master_info_repository\\s*=\\s*file;\n```\n\nLANGUAGE: regex\nCODE:\n```\nf:$mysql-cnfs -> !r:master_info_repository\\s*=\\s*table;\n```\n\nLANGUAGE: regex\nCODE:\n```\nf:$mysql-cnfs -> r:master_info_repository\\s*$;\n```\n\n----------------------------------------\n\nTITLE: Checking Convenience PIN Sign-in Settings\nDESCRIPTION: OSSEC rule to verify that convenience PIN sign-in is disabled. The rule checks if the AllowDomainPINLogon registry value is not set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> AllowDomainPINLogon -> !0;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled PostgreSQL Server in OSSEC\nDESCRIPTION: OSSEC rule to identify if PostgreSQL database server is enabled at boot time, which should be disabled unless specifically required for system operation to reduce attack surface in accordance with PCI-DSS requirements.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - X.X.X - Disable standard boot services - PostgreSQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 4 Worksheets\nDESCRIPTION: Validates registry values to ensure Excel 4 worksheets are blocked in Microsoft Excel 2016. This setting helps protect against potential security vulnerabilities in older Excel file formats.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl4worksheets -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl4worksheets;\n```\n\n----------------------------------------\n\nTITLE: Checking Routing and Remote Access Service Setting\nDESCRIPTION: Verifies that 'Routing and Remote Access (RemoteAccess)' is disabled by checking if Start registry value is set to 4.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RemoteAccess -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RemoteAccess -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Detecting Empty Password Accounts in OSSEC\nDESCRIPTION: OSSEC rule that identifies accounts with empty passwords in /etc/shadow file. This check helps identify accounts that could be easily compromised due to lack of password protection.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - X.X.X - Account with empty password present  {PCI_DSS: 10.2.5}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/shadow -> r:^\\w+::;\n```\n\n----------------------------------------\n\nTITLE: Detecting ICMP Redirect Acceptance in RHEL5\nDESCRIPTION: Checks if ICMP redirect acceptance is enabled in the system. This CIS benchmark rule (4.2.2) verifies that the accept_redirects parameters are not set to 1 to prevent ICMP redirect attacks.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/accept_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Simultaneous Internet Connections Minimization Setting\nDESCRIPTION: OSSEC rule to verify that the policy to minimize simultaneous connections to the Internet or Windows Domain is enabled. The rule checks if the fMinimizeConnections registry value is not set to 1.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Idle Session Time Limits in Remote Desktop Services\nDESCRIPTION: Registry checks to ensure idle Remote Desktop sessions have an appropriate time limit set (15 minutes or less), enforcing CIS Windows Server 2016 benchmark rule 18.9.52.3.10.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba3;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba4;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba5;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbba\\D;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbb\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbc\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbd\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbe\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbbf\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbc\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbd\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbe\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dbf\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dc\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:dd\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:de\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:df\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:e\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:f\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MaxIdleTime -> r:\\w\\w\\w\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !MaxIdleTime;\n```\n\n----------------------------------------\n\nTITLE: Checking Autoplay Disabled for All Drives in Windows 10\nDESCRIPTION: Verifies that 'Turn off Autoplay' is set to 'Enabled: All drives' by checking registry values related to NoDriveTypeAutoRun.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.9.8.3 Ensure 'Turn off Autoplay' is set to 'Enabled: All drives'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> NoDriveTypeAutoRun -> !ff;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> !NoDriveTypeAutoRun;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled PostgreSQL Server in OSSEC\nDESCRIPTION: OSSEC rule to identify if PostgreSQL database server is enabled at boot time, which should be disabled unless specifically required by the system, following the principle of least functionality.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - X.X.X - Disable standard boot services - PostgreSQL server Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dpostgresql$;\n```\n\n----------------------------------------\n\nTITLE: Detecting telnet-server on xinetd in SLES11\nDESCRIPTION: Checks if telnet service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/telnet -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Building Zlib Using VCBuild Command Line\nDESCRIPTION: Command line instruction for building the Zlib solution using VCBuild tool. This command rebuilds the solution for the Win32 platform in Release configuration.\n\nLANGUAGE: batch\nCODE:\n```\nvcbuild /rebuild contrib\\vstudio\\vc9\\zlibvc.sln \"Release|Win32\"\n```\n\n----------------------------------------\n\nTITLE: Checking Configure Solicited Remote Assistance registry setting in OSSEC\nDESCRIPTION: Verifies that 'Configure Solicited Remote Assistance' is set to 'Disabled' by checking if the fAllowToGetHelp registry value equals 0 and that the key exists in the Terminal Services registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowToGetHelp -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fAllowToGetHelp;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Plugged-In Connected-Standby Network Settings\nDESCRIPTION: Verifies that 'Allow network connectivity during connected-standby (plugged in)' is disabled by checking for ACSettingIndex=0 in the registry. This prevents network access during low-power states when plugged in.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> ACSettingIndex -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\f15576e8-98b7-4186-b944-eafa664402d9 -> !ACSettingIndex;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for DIF and Sylk Files\nDESCRIPTION: Checks registry values to ensure that DIF and Sylk files are properly blocked in Microsoft Excel 2016 with the appropriate file block behavior. These file types could potentially contain malicious content.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock ->\tdifandsylkfiles -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !difandsylkfiles;\n```\n\n----------------------------------------\n\nTITLE: Including cJSON Library in C Projects\nDESCRIPTION: Shows how to include the cJSON library in C code after installing it via CMake or Makefile. This is the standard way to access cJSON functionality in your projects.\n\nLANGUAGE: C\nCODE:\n```\n#include <cjson/cJSON.h>\n```\n\n----------------------------------------\n\nTITLE: RSH Server Check in OSSEC\nDESCRIPTION: OSSEC rule to verify rsh/rlogin/rcp services are disabled on RHEL5 systems. Checks multiple configuration files to ensure these insecure services are properly disabled, satisfying CIS requirement 2.1.3 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 2.1.3 - rsh/rlogin/rcp enabled on xinetd {CIS: 2.1.3 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/etc/xinetd.d/rlogin -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/rsh -> !r:^# && r:disable && r:no;\nf:/etc/xinetd.d/shell -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled Kudzu Hardware Detection Service in OSSEC\nDESCRIPTION: OSSEC rule to check if Kudzu hardware detection service is enabled in the boot sequence, which could potentially introduce security risks if not required.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - X.X.X - Disable standard boot services - Kudzu hardware detection Enabled] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dkudzu$;\n```\n\n----------------------------------------\n\nTITLE: Checking UAC Virtualization Setting\nDESCRIPTION: Verifies that 'User Account Control: Virtualize file and registry write failures to per-user locations' is enabled by checking the EnableVirtualization registry value.\n\nLANGUAGE: OSSEC rules\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> EnableVirtualization -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge InPrivate Browsing Settings in Registry\nDESCRIPTION: Verifies that 'Allow InPrivate Browsing' is set to 'Disabled' by confirming AllowInPrivate is set to 0 in the registry.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> AllowInPrivate -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !AllowInPrivate;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Selection UI Display Settings\nDESCRIPTION: OSSEC rule to verify that the network selection UI is not displayed. The rule checks if the DontDisplayNetworkSelectionUI registry value is not set to 1 or is missing entirely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> DontDisplayNetworkSelectionUI -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\System -> !DontDisplayNetworkSelectionUI;\n```\n\n----------------------------------------\n\nTITLE: Checking Inactive User Account Locking\nDESCRIPTION: Verifies if automatic locking of inactive user accounts is configured. This setting enhances security by disabling accounts that haven't been used for a specified period, reducing the attack surface.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/default/useradd -> !r:^INACTIVE=\\d\\d*;\n```\n\n----------------------------------------\n\nTITLE: Detecting discard on xinetd in SLES11\nDESCRIPTION: Checks if discard service is enabled in xinetd configuration. The pattern detects if the 'disable' parameter is set to 'no' in a non-commented line.\n\nLANGUAGE: regex\nCODE:\n```\nf:/etc/xinetd.d/discard -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Building with Borland C and TASM\nDESCRIPTION: Command to build zlib with ASM optimizations using Borland C compiler and TASM assembler. Includes assembly object files for improved performance.\n\nLANGUAGE: Makefile\nCODE:\n```\nmake -f win32/Makefile.bor LOCAL_ZLIB=\"-DASMV -DASMINF\" OBJA=\"match686.obj inffas32.obj\" OBJPA=\"+match686c.obj+match686.obj+inffas32.obj\"\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Autoplay registry setting in OSSEC\nDESCRIPTION: Verifies that 'Turn off Autoplay' is set to 'Enabled: All drives' by checking if the NoDriveTypeAutoRun registry value equals ff and that the key exists in the Explorer policies registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> NoDriveTypeAutoRun -> !ff;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer-> !NoDriveTypeAutoRun;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check daemon umask settings\nDESCRIPTION: Verifies that the default umask for daemons is set appropriately (umask 027) in the system functions file.\n\nLANGUAGE: configuration\nCODE:\n```\nf:/etc/init.d/functions -> !r:^# && r:^umask && <:umask 027;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Excel Extension Hardening\nDESCRIPTION: OSSEC audit rules to verify that Extension Hardening functionality is enabled in Microsoft Excel. This security feature helps protect against malicious file extensions that could exploit Excel.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security -> extensionhardening -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security -> !extensionhardening;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Temporary Folders Per Session Setting\nDESCRIPTION: Validates that Terminal Services uses temporary folders per session by ensuring the PerSessionTempDir registry value is set to 1 per CIS benchmark 18.9.52.3.11.2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> PerSessionTempDir -> !1;\n```\n\n----------------------------------------\n\nTITLE: Variable Declaration for MySQL Configuration Files in OSSEC\nDESCRIPTION: Defines path variables for home directories, environment files, and MySQL configuration files to be used in the audit checks. These variables help OSSEC locate the relevant files across different system configurations.\n\nLANGUAGE: bash\nCODE:\n```\n$home_dirs=/usr2/home/*,/home/*,/home,/*/home/*,/*/home,/;\n$enviroment_files=/*/home/*/\\.bashrc,/*/home/*/\\.profile,/*/home/*/\\.bash_profile,/home/*/\\.bashrc,/home/*/\\.profile,/home/*/\\.bash_profile;\n$mysql-cnfs=/etc/mysql/my.cnf,/etc/mysql/mariadb.cnf,/etc/mysql/conf.d/*.cnf,/etc/mysql/mariadb.conf.d/*.cnf,~/.my.cnf;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check for Squid proxy server enabled\nDESCRIPTION: Checks if Squid proxy server is enabled in startup scripts by looking for S followed by numbers and squid.\n\nLANGUAGE: configuration\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsquid$;\n```\n\n----------------------------------------\n\nTITLE: ExecShield Configuration Check in OSSEC\nDESCRIPTION: OSSEC rule to verify ExecShield is enabled on RHEL5 systems. Checks /proc/sys/kernel/exec-shield to ensure it's not set to 0, satisfying CIS requirement 1.6.2 and PCI DSS 2.2.4.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 1.6.2 - ExecShield not enabled  {CIS: 1.6.2 RHEL5} {PCI_DSS: 2.2.4}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nf:/proc/sys/kernel/exec-shield -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Encryption Level in Registry\nDESCRIPTION: Registry check to ensure that 'Set client connection encryption level' is set to 'Enabled: High Level' as required by CIS benchmark 18.9.52.3.9.3. This enforces strong encryption for Remote Desktop connections.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.52.3.9.3 Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'\n[CIS - Microsoft Windows Server 2016 - 18.9.52.3.9.3: Ensure 'Set client connection encryption level' is set to 'Enabled: High Level'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MinEncryptionLevel -> !3;\n```\n\n----------------------------------------\n\nTITLE: Checking PerfTrack Settings\nDESCRIPTION: Verifies that 'Enable/Disable PerfTrack' is disabled by checking if ScenarioExecutionEnabled registry value is set to 0 in the WDI policies.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> !ScenarioExecutionEnabled;\n```\n\n----------------------------------------\n\nTITLE: Verifying Remote Log Hosting Configuration\nDESCRIPTION: Rules for confirming that rsyslog is configured to send logs to a remote host according to CIS benchmark 8.2.5. Checks for proper forwarding configuration.\n\nLANGUAGE: ossec\nCODE:\n```\n#8.2.5 Configure rsyslog to Send Logs to a Remote Log Host\n[CIS - Debian Linux 7/8 - 8.2.5 Configure rsyslog to Send Logs to a Remote Log Host] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:/etc/rsyslog.conf -> !r:^*.* @@\\w+.\\w+.\\w+;\n```\n\n----------------------------------------\n\nTITLE: Detecting Avahi daemon in SLES11\nDESCRIPTION: Checks if the Avahi daemon (zero-configuration networking service) is running, which could be a security risk if not needed.\n\nLANGUAGE: regex\nCODE:\n```\np:avahi-daemon;\n```\n\n----------------------------------------\n\nTITLE: Building Example Applications\nDESCRIPTION: Creates example and minigzip applications that demonstrate zlib functionality, with additional 64-bit variants when large file support is available.\n\nLANGUAGE: CMake\nCODE:\n```\n#============================================================================\n# Example binaries\n#============================================================================\n\nadd_executable(example test/example.c)\ntarget_link_libraries(example zlib)\nadd_test(example example)\n\nadd_executable(minigzip test/minigzip.c)\ntarget_link_libraries(minigzip zlib)\n\nif(HAVE_OFF64_T)\n    add_executable(example64 test/example.c)\n    target_link_libraries(example64 zlib)\n    set_target_properties(example64 PROPERTIES COMPILE_FLAGS \"-D_FILE_OFFSET_BITS=64\")\n    add_test(example64 example64)\n\n    add_executable(minigzip64 test/minigzip.c)\n    target_link_libraries(minigzip64 zlib)\n    set_target_properties(minigzip64 PROPERTIES COMPILE_FLAGS \"-D_FILE_OFFSET_BITS=64\")\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Toggle user control over Insider builds registry setting in OSSEC\nDESCRIPTION: Verifies that 'Toggle user control over Insider builds' is set to 'Disabled' by checking if the AllowBuildPreview registry value doesn't equal 1 and that the key exists in the PreviewBuilds registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> AllowBuildPreview -> 1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> !AllowBuildPreview;\n```\n\n----------------------------------------\n\nTITLE: Validating PerfTrack Disable Configuration in Windows Registry\nDESCRIPTION: Checks that 'Enable/Disable PerfTrack' is set to 'Disabled' by confirming the ScenarioExecutionEnabled registry value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> !ScenarioExecutionEnabled;\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for ActiveX Controls Disablement\nDESCRIPTION: OSSEC audit rules to verify that all ActiveX controls are disabled in Office applications. This security setting prevents potentially vulnerable ActiveX controls from running in Office documents.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\common\\security -> disableallactivex -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\common\\security -> !disableallactivex;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC PF Firewall Integration Messages in Portuguese\nDESCRIPTION: Portuguese translations for configuring PF firewall integration with OSSEC HIDS active responses.\n\nLANGUAGE: Bash\nCODE:\n```\n# Pf support\npfenable=\"Deseja utilizar o firewall PF nas respostas automaticas?\"\nnopf=\"Respostas automaticas com o PF desabilitadas.\"\npftablename=\"Qual o nome da tabela no PF que deseja utilizar?\"\npfmessage=\"Adicione as seguintes linhas na configuracao do seu firewall\"\n```\n\n----------------------------------------\n\nTITLE: Disable Mounting of hfs Filesystems Rule for OSSEC\nDESCRIPTION: CIS rule 2.21 that checks for the existence of /etc/modprobe.d/CIS.conf and verifies it contains a directive to disable mounting of hfs filesystems for security hardening.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 2.21 Disable Mounting of hfs Filesystems] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install hfs /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled Kudzu Hardware Detection Service in OSSEC\nDESCRIPTION: OSSEC rule that checks if the Kudzu hardware detection service is enabled in the system's startup scripts, which may pose unnecessary security risks.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL6 - X.X.X - Disable standard boot services - Kudzu hardware detection Enabled] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_6_Benchmark_v1.3.0.pdf]\nd:$rc_dirs -> ^S\\d\\dkudzu$;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Local Connection Security Rules\nDESCRIPTION: Registry checks to ensure the Windows Firewall Private Profile allows local connection security rules to be applied. Verifies this setting in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Internet Connection Minimization Settings\nDESCRIPTION: Registry check to ensure that simultaneous connections to the Internet or a Windows Domain are minimized for improved security.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.4.21.1 Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.21.1 Ensure 'Minimize the number of simultaneous connections to the Internet or a Windows Domain' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WcmSvc\\GroupPolicy -> fMinimizeConnections -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Setup Event Log Behavior Registry Settings\nDESCRIPTION: Verifies registry settings to ensure 'Setup: Control Event Log behavior when the log file reaches its maximum size' is set to 'Disabled' as per CIS benchmark 18.9.26.3.1. Checks if Retention value is not set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking TIPC Protocol Disabling\nDESCRIPTION: Rules for verifying that the TIPC protocol is properly disabled according to CIS benchmark 7.5.4. Checks for configuration in the CIS.conf file.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.5.4 Disable TIPC\n[CIS - Debian Linux 7/8 - 7.5.4 Disable TIPC] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install tipc /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Detecting Samba services in SLES11\nDESCRIPTION: Checks if Samba services are enabled in the runlevel directories, which should be disabled if not needed for file sharing.\n\nLANGUAGE: regex\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsamba$;\nd:$rc_dirs -> ^S\\d\\dsmb$;\n```\n\n----------------------------------------\n\nTITLE: Configuring Zlib Package Files and Headers\nDESCRIPTION: Generates zlib.pc and zconf.h files from templates and sets up include directories for the build.\n\nLANGUAGE: CMake\nCODE:\n```\nset(ZLIB_PC ${CMAKE_CURRENT_BINARY_DIR}/zlib.pc)\nconfigure_file( ${CMAKE_CURRENT_SOURCE_DIR}/zlib.pc.cmakein\n\t\t${ZLIB_PC} @ONLY)\nconfigure_file(\t${CMAKE_CURRENT_SOURCE_DIR}/zconf.h.cmakein\n\t\t${CMAKE_CURRENT_BINARY_DIR}/zconf.h @ONLY)\ninclude_directories(${CMAKE_CURRENT_BINARY_DIR} ${CMAKE_SOURCE_DIR})\n```\n\n----------------------------------------\n\nTITLE: Checking Application Event Log Retention Behavior in Windows Registry\nDESCRIPTION: Registry check to ensure that automatic EventLog maintenance is disabled when the Application log reaches its maximum size. This implements CIS benchmark 18.9.26.1.1 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Application -> Retention -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Anonymous Access Restriction to Named Pipes and Shares in Windows 10\nDESCRIPTION: Verifies that 'Network access: Restrict anonymous access to Named Pipes and Shares' is set to 'Enabled' by checking that the RestrictNullSessAccess registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RestrictNullSessAccess -> !1;\n```\n\n----------------------------------------\n\nTITLE: Distance Code Table for DEFLATE Compression\nDESCRIPTION: Table showing how distance values (1-32768) are encoded in the DEFLATE format. For each code (0-29), the table shows the extra bits required and the actual distance values represented.\n\nLANGUAGE: plain text\nCODE:\n```\n          Extra           Extra               Extra\n     Code Bits Dist  Code Bits   Dist     Code Bits Distance\n     ---- ---- ----  ---- ----  ------    ---- ---- --------\n       0   0    1     10   4     33-48    20    9   1025-1536\n       1   0    2     11   4     49-64    21    9   1537-2048\n       2   0    3     12   5     65-96    22   10   2049-3072\n       3   0    4     13   5     97-128   23   10   3073-4096\n       4   1   5,6    14   6    129-192   24   11   4097-6144\n       5   1   7,8    15   6    193-256   25   11   6145-8192\n       6   2   9-12   16   7    257-384   26   12  8193-12288\n       7   2  13-16   17   7    385-512   27   12 12289-16384\n       8   3  17-24   18   8    513-768   28   13 16385-24576\n       9   3  25-32   19   8   769-1024   29   13 24577-32768\n```\n\n----------------------------------------\n\nTITLE: Network Access Security Policy Check in Windows Server 2016\nDESCRIPTION: Implements an OSSEC check to verify that 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled' according to CIS benchmark 2.3.10.4.\n\nLANGUAGE: text\nCODE:\n```\n#2.3.10.4 Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 2.3.10.4 Ensure 'Network access: Do not allow storage of passwords and credentials for network authentication' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> DisableDomainCreds -> !1;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa -> !DisableDomainCreds;\n```\n\n----------------------------------------\n\nTITLE: Checking Default Group for Root Account\nDESCRIPTION: Ensures that the root account has the proper default group ID of 0. Having the correct group assignment for the root account is important for maintaining proper system security.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/passwd -> !r:^root:\\w+:\\w+:0:;\n```\n\n----------------------------------------\n\nTITLE: Detecting Chargen-stream Service in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if chargen-stream service is enabled through xinetd. This implements CIS benchmark 2.1.13 by checking the relevant xinetd configuration file for service enablement.\n\nLANGUAGE: ossec\nCODE:\n```\nf:/etc/xinetd.d/chargen-stream -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous access restrictions to Named Pipes and Shares\nDESCRIPTION: Verifies that 'Network access: Restrict anonymous access to Named Pipes and Shares' is enabled by checking the RestrictNullSessAccess registry value.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> RestrictNullSessAccess -> !1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Last Username Display\nDESCRIPTION: Verifies the 'Interactive logon: Do not display last user name' policy is enabled in Windows Server 2016. Checks if the DontDisplayLastUserName registry value is correctly configured to enhance logon security.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.7.1 Ensure 'Interactive logon: Do not display last user name' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> 0;\nr:HKEY_LOCAL_MACHINE\\Software\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> !DontDisplayLastUserName;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Automatic Updates\nDESCRIPTION: Verifies that 'Turn off Automatic Download and Install of updates' is set to 'Disabled' (value not equal to 4) in the Windows Store registry path.\n\nLANGUAGE: plain\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> AutoDownload -> !4;\n```\n\n----------------------------------------\n\nTITLE: Checking SCTP Protocol Disabling\nDESCRIPTION: Rules for verifying that the SCTP protocol is properly disabled according to CIS benchmark 7.5.2. Checks for configuration in the CIS.conf file.\n\nLANGUAGE: ossec\nCODE:\n```\n#7.5.2 Disable SCTP\n[CIS - Debian Linux 7/8 - 7.5.2 Disable SCTP] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install sctp /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Checking IP Send Redirects in SLES11\nDESCRIPTION: Verifies that IP send redirects are disabled in the network configuration to prevent potential routing-based attacks.\n\nLANGUAGE: regex\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/send_redirects -> 0;\nf:/proc/sys/net/ipv4/conf/default/send_redirects -> 0;\n```\n\n----------------------------------------\n\nTITLE: Basic JSON Printing with cJSON in C\nDESCRIPTION: Demonstrates how to print a cJSON object to a string. The function allocates memory that must be freed by the caller, typically with free() unless a custom allocator has been set with cJSON_InitHooks.\n\nLANGUAGE: c\nCODE:\n```\nchar *string = cJSON_Print(json);\n```\n\n----------------------------------------\n\nTITLE: Checking Heap Termination on Corruption Settings in Registry\nDESCRIPTION: Registry check to ensure heap termination on corruption is not disabled. Implements CIS benchmark 18.9.30.4 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoHeapTerminationOnCorruption -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile Log Size\nDESCRIPTION: Verifies that the Windows Firewall Private Profile log file size is set to at least 16384 KB as required by CIS benchmark 9.2.8. The rule checks various registry paths and values to ensure compliance.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w; \nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Finalizing Adler-32 Checksum Calculation in C\nDESCRIPTION: The final part of the update_adler32 function that combines two 16-bit sums (s1 and s2) into a single 32-bit Adler-32 checksum value using bitwise operations.\n\nLANGUAGE: C\nCODE:\n```\n  s1 = (s1 + buf[n]) % BASE;\n  s2 = (s2 + s1)     % BASE;\n}\nreturn (s2 << 16) + s1;\n```\n\n----------------------------------------\n\nTITLE: NIS Client Check in OSSEC\nDESCRIPTION: OSSEC rule to verify NIS client (ypbind) is disabled on RHEL5 systems. Checks for start scripts in runlevel directories, satisfying CIS requirement 2.1.5 and PCI DSS 2.2.3.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - 2.1.5 - Disable standard boot services - NIS (client) Enabled {CIS: 2.1.5 RHEL5} {PCI_DSS: 2.2.3}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dypbind$;\n```\n\n----------------------------------------\n\nTITLE: Configuring Assembly Optimizations for MSVC\nDESCRIPTION: Sets up assembly optimizations for i686 and AMD64 platforms when using Microsoft Visual C++, enabling MASM language support and adding appropriate source files.\n\nLANGUAGE: CMake\nCODE:\n```\nif(MSVC)\n    if(ASM686)\n\t\tENABLE_LANGUAGE(ASM_MASM)\n        set(ZLIB_ASMS\n\t\t\tcontrib/masmx86/inffas32.asm\n\t\t\tcontrib/masmx86/match686.asm\n\t\t)\n    elseif (AMD64)\n\t\tENABLE_LANGUAGE(ASM_MASM)\n        set(ZLIB_ASMS\n\t\t\tcontrib/masmx64/gvmat64.asm\n\t\t\tcontrib/masmx64/inffasx64.asm\n\t\t)\n    endif()\n\n\tif(ZLIB_ASMS)\n\t\tadd_definitions(-DASMV -DASMINF)\n\tendif()\nendif()\n```\n\n----------------------------------------\n\nTITLE: Detecting HTTP Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if Apache HTTP server is enabled in boot services. This implements CIS benchmark 3.11 by checking for httpd service in the system's runtime configuration directories.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dhttpd$;\n```\n\n----------------------------------------\n\nTITLE: Checking Excel Security File Block Settings for Excel 2 Macrosheets\nDESCRIPTION: Verifies registry values to ensure Excel 2 macrosheets and add-in files are blocked in Microsoft Excel 2016. These files can contain macros that pose security risks if not properly restricted.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> xl2macros -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\excel\\security\\fileblock -> !xl2macros;\n```\n\n----------------------------------------\n\nTITLE: Validating Plug and Play Device Redirection Settings in Terminal Services\nDESCRIPTION: Checks if Plug and Play device redirection is disabled in Windows Terminal Services. This is required by CIS benchmark item 18.9.52.3.3.4, which prevents Plug and Play devices from being redirected, reducing potential attack vectors.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fDisablePNPRedir -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fDisablePNPRedir;\n```\n\n----------------------------------------\n\nTITLE: Checking PerfTrack Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Enable/Disable PerfTrack' is set to 'Disabled' by verifying the ScenarioExecutionEnabled registry value is set to 0 under the WDI policy path.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.44.11.1 Ensure 'Enable/Disable PerfTrack' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> ScenarioExecutionEnabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WDI\\{9c5a40da-b965-4fc3-8781-88dd50a6299d} -> !ScenarioExecutionEnabled;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Browser Frame Options\nDESCRIPTION: Audit rule that checks if browser frame options are properly restricted. The X-Frame-Options header should be set to SAMEORIGIN or DENY to prevent clickjacking attacks.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.14: Restrict Browser Frame Options] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:$main-conf -> !r:header\\salways\\sappend\\sx-frame-options && !r:sameorigin|deny;\n```\n\n----------------------------------------\n\nTITLE: Checking Source Routed Packet Acceptance in SLES11\nDESCRIPTION: Verifies that source routed packet acceptance is disabled to prevent potential routing-based attacks and IP spoofing.\n\nLANGUAGE: regex\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_source_route -> 1;\n```\n\n----------------------------------------\n\nTITLE: Compiling cJSON with Make\nDESCRIPTION: Command to compile cJSON after generating the Makefile with CMake. This builds the library according to the configuration specified in the CMake step.\n\nLANGUAGE: bash\nCODE:\n```\nmake\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge Cookie Configuration in Registry\nDESCRIPTION: Registry check to ensure Edge browser cookies are configured to block 3rd-party cookies or higher. Implements CIS benchmark 18.9.41.3 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> Cookies -> 2;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !Cookies;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Logging Path Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile has the correct logging path configuration. Uses regex to validate registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.7.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogFilePath -> r:\\psystemroot\\p\\\\system32\\logfiles\\firewall\\\\w+\\plog;\n```\n\n----------------------------------------\n\nTITLE: Building cJSON with Make Command\nDESCRIPTION: Command to build cJSON directly using the provided Makefile without CMake. Compiles both static and shared libraries along with a test program.\n\nLANGUAGE: bash\nCODE:\n```\nmake all\n```\n\n----------------------------------------\n\nTITLE: Checking Web Management Service Status in Windows Registry\nDESCRIPTION: Verifies that the Web Management Service (WMSvc) is set to 'Disabled' or 'Not Installed' per CIS benchmark 5.32. The check confirms the Start value is set to 4.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\WMSvc -> Start -> !4;\n```\n\n----------------------------------------\n\nTITLE: Configuring Windows DLL Resources\nDESCRIPTION: Sets up Windows-specific DLL resource files when not using MinGW.\n\nLANGUAGE: CMake\nCODE:\n```\nif(NOT MINGW)\n    set(ZLIB_DLL_SRCS\n        win32/zlib1.rc # If present will override custom build rule below.\n    )\nendif()\n```\n\n----------------------------------------\n\nTITLE: Detecting SNMP Server in OSSEC for RHEL7\nDESCRIPTION: OSSEC rule to detect if SNMP server is enabled. This implements CIS benchmark 3.15 by checking for snmpd service in the boot configuration directories.\n\nLANGUAGE: ossec\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Checking RPC Endpoint Mapper Authentication in Windows 10\nDESCRIPTION: Verifies that 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled' by checking registry values related to EnableAuthEpResolution.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.36.1 Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> EnableAuthEpResolution -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> !EnableAuthEpResolution;\n```\n\n----------------------------------------\n\nTITLE: Checking Advertising ID Settings in Windows Registry with OSSEC\nDESCRIPTION: Verifies that 'Turn off the advertising ID' is enabled by checking if DisabledByGroupPolicy is set to 1 in the Windows registry. This helps protect user privacy by preventing apps from using the advertising ID.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> DisabledByGroupPolicy -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo -> !DisabledByGroupPolicy;\n```\n\n----------------------------------------\n\nTITLE: HTTP Print Driver Download Security Setting Check\nDESCRIPTION: Verifies that 'Turn off downloading of print drivers over HTTP' is set to 'Enabled' per CIS benchmark 18.8.20.1.2 to prevent potential security vulnerabilities.\n\nLANGUAGE: text\nCODE:\n```\n#18.8.20.1.2 Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.20.1.2 Ensure 'Turn off downloading of print drivers over HTTP' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> DisableWebPnPDownload -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Printers -> !DisableWebPnPDownload;\n```\n\n----------------------------------------\n\nTITLE: CIS Check for User Directories Modules in Apache\nDESCRIPTION: Audit rule that checks if User Directories modules are enabled in Apache configurations, which allow users to host content in their home directories and may present security risks. Examines configurations for uncommented LoadModule directives.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 2.7: User Directories Modules are enabled] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:loadmodule\\suserdir;\nd:$conf-dirs -> load -> !r:^# && r:loadmodule\\suserdir;\nf:/etc/httpd/conf.d -> !r:^# && r:loadmodule\\suserdir;\nd:$mods-en -> userdir.load;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled NetFS Service in OSSEC\nDESCRIPTION: OSSEC rule to check if NetFS service is enabled at system startup, which allows network file systems mounting and should be disabled unless required, per PCI DSS 2.2.2 requirements.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - RHEL5 - X.X.X - Disable standard boot services - NetFS Enabled {PCI_DSS: 2.2.2}] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_Red_Hat_Enterprise_Linux_5_Benchmark_v2.1.0.pdf]\nd:$rc_dirs -> ^S\\d\\dnetfs$;\n```\n\n----------------------------------------\n\nTITLE: Defining Spanish Language Variables for OSSEC Installation Script\nDESCRIPTION: This code snippet defines Spanish language string variables used throughout the OSSEC HIDS installation process. It includes translations for installation options, configuration prompts, and system messages presented to Spanish-speaking users.\n\nLANGUAGE: Bash\nCODE:\n```\n# Configuration\nyes=\"s\"\nno=\"n\"\nyesmatch=\"s\"\nnomatch=\"n\"\nagent=\"agente\"\nlocal=\"local\"\nserver=\"servidor\"\nhelp=\"ayuda\"\n\n# Global\nmoreinfo=\"Ms informacin en: \"\nstarting=\"Comenzando OSSEC HIDS\"\nsystemis=\"El sistema es\"\nmodifiedinit=\"Init script modificado para empezar OSSEC HIDS durante el arranque.\"\nnoboot=\"Sistema desconocido. El guin init no fu agregado\"\n\n# Part 1\ninstallscript=\"Guin de instalacin\"\nsystem=\"Sistema\"\nuser=\"Usuario\"\nhost=\"servidor\"\nhitanyorabort=\"Presione ENTER para continuar  Ctrl-C para abortar.\"\nwhattoinstall=\"Que tipo de instalacin desea (servidor, agente, local  ayuda)?\"\nserverchose=\"Usted eligi instalacin de Servidor\"\nclientchose=\"Usted eligi instalacin de Agente(cliente)\"\nlocalchose=\"Usted eligi instalacin Local\"\n\n# Part 2\nsettingupenv=\"Configurando las variables de entorno de la instalacin\"\nwheretoinstall=\"Eliga donde instalar OSSEC HIDS\"\ninstallat=\"La instalacin se realizar en \"\ndeletedir=\"El directorio de instalacin ya existe. Desea borrarlo?\"\n\n# Part 3\nconfiguring=\"Configurando el sistema\"\nmailnotify=\"Desea recibir notificacin por correo electrnico?\"\nnomail=\"Notificacin por correo electrnico deshabilitado\"\nwhatsemail=\"Cul es su direccin de correo electrnico?\"\nyoursmtp=\"Hemos encontrado su servidor de correo (SMTP)\"\nusesmtp=\"Desea usarlo?\"\nusingsmtp=\"Usando el servidor SMTP: \"\nwhatsmtp=\"Cul es la direccion  nombre de su servidor de correo SMTP?\"\n\n# Part 3.1/agent\nserverip=\"Cul es la direccion del servidor OSSEC HIDS?\"\nserveraddr=\"Cul es la direccion  nombre de vuestro del servidor OSSEC HIDS?\"\naddingip=\"Agregando el IP del servidor\"\naddingname=\"Agregando el nombre del servidor\"\n\n# Part 3.2\nrunsyscheck=\"Desea Usted agregar el servidor de integridad del sistema?\"\nnosyscheck=\"No se ejecutar syscheck (servidor de integridad del sistema)\"\nyessyscheck=\"Ejecutando syscheck (servidor de integridad del sistema)\"\n\n# Part 3.3\nrunrootcheck=\"Desea Usted agregar el sistema de deteccin de rootkit?\"\nnorootcheck=\"No se ejecutar rootcheck (sistema de deteccin de rootkit)\"\nyesrootcheck=\"Ejecutando rootcheck (sistema de deteccin de rootkit)\"\n\n# Part 3.4/server/local\nenable_ar=\"Desea habilitar respuesta activa?\"\nnoactive=\"Respuesta activa deshabilitada\"\nnohosts=\"host-deny deshabilitado\"\nyeshosts=\"host-deny habilitado (local) para niveles >= 6\"\nfirewallar=\"Desea habilitar la respuesta desechar en el Firewall?\"\nnofirewall=\"Respuesta desechar en el Firewall deshabilitada.\"\nyesfirewall=\"Respuesta desechar en el Firewall habilitada (local)  para niveles >= 6\"\ndefaultwhitelist=\"Lista blanca para respuesta activa por omisin:\"\naddwhite=\"Desea Usted agregar ms IPs a la lista blanca?\"\nipswhite=\"IPs (lista separada por blancos): \"\n\n# Part 3.5/server/local\nsyslog=\"Desea Usted habilitar syslog remoto (puerto 514 udp)?\"\nnosyslog=\"Syslog remoto deshabilitado\"\nyessyslog=\"Syslog remoto habilitado\"\n\n# Part 3.4/3.5\nreadlogs=\"Estableciendo la configuracin para analizar los siguientes registros:\"\n\n# Part 5\ninstalling=\"Instalando el sistema\"\nrunningmake=\"Ejecutando el Makefile\"\n\n# Final\nconfigurationdone=\"Configuracin finalizada correctamente\"\ntostart=\"Para comenzar OSSEC HIDS\"\ntostop=\"Para detener OSSEC HIDS\"\nconfigat=\"La configuracin puede ser leda  mofificada en\"\naddserveragent=\"Para connectar el agente con el servidor, debe agregar cada uno de los agentes en el servidor.\"\nrunma=\"Ejecute el programa 'manage_agents' para agregarlos  eliminarlos \"\npresskey=\"Press ENTER to continue\"\n\n# Update\nwanttoupdate=\"Usted ya ha instalado OSSEC previamente. Desea actualizarlo?\"\nunabletoupdate=\"Ha sido imposible actualizar el sistema. Se requiere una nueva y completa instalacin.\"\nupdatecompleted=\"Actualizacin completa.\"\nupdatefailed=\"La actualizacin ha fallado.\"\nupdaterules=\"Desea actualizar las reglas?\"\nupdatingrules=\"Actualizando las reglas.\"\nnotupdatingrules=\"No se actualizan las reglas.\"\n\n# Pf support\npfenable=\"Desea Usted usar el PF firewall en la respuesta activa?\"\nnopf=\"respuesta PF deshabilitada.\"\npftablename=\"Nombre de la tabla de PF table a usar?\"\npfmessage=\"Agregar las siguientes lineas al principio de las reglas del PF\"\n```\n\n----------------------------------------\n\nTITLE: Checking 'Require secure RPC communication' Registry Setting\nDESCRIPTION: Registry check to ensure 'Require secure RPC communication' is enabled per CIS benchmark 18.9.52.3.9.2. Verifies the fEncryptRPCTraffic value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fEncryptRPCTraffic -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fEncryptRPCTraffic;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Defender ASR Rules Configuration\nDESCRIPTION: OSSEC rule to check if Windows Defender Attack Surface Reduction rules are properly configured according to CIS benchmark 18.9.76.13.1.2. The rule verifies multiple registry keys are set to the value '1'.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.9.76.13.1.2 Ensure 'Configure Attack Surface Reduction rules: Set the state for each ASR rule' is 'configured'\n[CIS - Microsoft Windows 10 - 18.9.76.13.1.2 Ensure 'Configure Attack Surface Reduction rules: Set the state for each ASR rule' is 'configured'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550 -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !BE9BA2D9-53EA-4CDC-84E5-9B1EEEE46550;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> D4F940AB-401B-4EFC-AADC-AD5F3C50688A -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !D4F940AB-401B-4EFC-AADC-AD5F3C50688A;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 3B576869-A4EC-4529-8536-B80A7769E899 -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !3B576869-A4EC-4529-8536-B80A7769E899;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84 -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !75668C1F-73B5-4CF0-BB93-3ECF5CB7CC84;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> D3E037E1-3EB8-44C8-A917-57927947596D -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !D3E037E1-3EB8-44C8-A917-57927947596D;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 5BEB7EFE-FD9A-4556-801D-275E5FFC04CC -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !5BEB7EFE-FD9A-4556-801D-275E5FFC04CC;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> 92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR\\Rules -> !92E97FA1-2EDF-4476-BDD6-9DD0B4DDDC7B;\n```\n\n----------------------------------------\n\nTITLE: Installing and Configuring OSSEC Agent SELinux Module\nDESCRIPTION: Commands for installing the SELinux module for OSSEC agent, setting proper context, and verifying the installation. This includes loading the module, restoring security contexts, restarting the agent, and checking process contexts.\n\nLANGUAGE: bash\nCODE:\n```\nsemodule -i ossec_agent.pp.bz2\n```\n\nLANGUAGE: bash\nCODE:\n```\nrestorecon -R /var/ossec\n```\n\nLANGUAGE: bash\nCODE:\n```\nps -AZ\n```\n\n----------------------------------------\n\nTITLE: Starting OSSEC Service\nDESCRIPTION: Command to start the OSSEC service after rule configuration changes have been completed.\n\nLANGUAGE: bash\nCODE:\n```\n/etc/init.d/ossec start\n```\n\n----------------------------------------\n\nTITLE: Setting MSVC-Specific Compiler Options\nDESCRIPTION: Configures Microsoft Visual C++ specific settings including debug postfix, security definitions, and include directories.\n\nLANGUAGE: CMake\nCODE:\n```\nif(MSVC)\n    set(CMAKE_DEBUG_POSTFIX \"d\")\n    add_definitions(-D_CRT_SECURE_NO_DEPRECATE)\n    add_definitions(-D_CRT_NONSTDC_NO_DEPRECATE)\n    include_directories(${CMAKE_CURRENT_SOURCE_DIR})\nendif()\n```\n\n----------------------------------------\n\nTITLE: Checking Source Route Validation in Network Configuration\nDESCRIPTION: Verifies if RFC-recommended source route validation is enabled in the network configuration. The test checks if rp_filter is set to 0 (disabled) in both all and default IPv4 configurations.\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/rp_filter -> 0;\nf:/proc/sys/net/ipv4/conf/default/rp_filter -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft MAPS Membership Disablement Setting\nDESCRIPTION: Registry checks to ensure joining Microsoft MAPS is disabled, enforcing CIS Windows Server 2016 benchmark rule 18.9.69.3.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Spynet -> SpynetReporting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Registry Settings\nDESCRIPTION: Verifies that 'Turn off Windows Error Reporting' is enabled by checking if the Disabled registry value is set to 0 in Windows Error Reporting and DoReport is set to 1 in ErrorReporting.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> DoReport -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> !DoReport;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Ink Workspace Suggested Apps Setting\nDESCRIPTION: Registry checks to ensure suggested apps in Windows Ink Workspace are disabled, enforcing CIS Windows Server 2016 benchmark rule 18.9.73.1.\n\nLANGUAGE: config\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> AllowSuggestedAppsInWindowsInkWorkspace -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsInkWorkspace -> !AllowSuggestedAppsInWindowsInkWorkspace;\n```\n\n----------------------------------------\n\nTITLE: OSSEC Rule: Security Notification Disabling Detection\nDESCRIPTION: Checks if Windows security notifications for firewall or antivirus have been disabled, which could indicate malware presence or misconfiguration. References PCI-DSS section 10.6.1.\n\nLANGUAGE: ossec\nCODE:\n```\n[Firewall/Anti Virus notification disabled {PCI_DSS: 10.6.1}] [any] []\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> FirewallDisableNotify -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> antivirusoverride -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> firewalldisablenotify -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Security Center -> firewalldisableoverride -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Packet Redirects Configuration in OSSEC\nDESCRIPTION: OSSEC rules to verify Packet Redirects are disabled as per CIS Benchmark 7.1.2, checking both for explicit enabling and lack of explicit disabling.\n\nLANGUAGE: OSSEC rule syntax\nCODE:\n```\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.all.send_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.all.send_redirects=0;\nf:/etc/sysctl.conf -> !r:^# && r:net.ipv4.conf.default.send_redirects=1;\nf:/etc/sysctl.conf -> !r:^net.ipv4.conf.default.send_redirects=0;\n```\n\n----------------------------------------\n\nTITLE: Defining Log Analysis Configuration Message in Bash\nDESCRIPTION: Sets a variable for the message displayed when configuring log analysis in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3.4/3.5\nreadlogs=\"Setting the configuration to analyze the following logs:\"\n```\n\n----------------------------------------\n\nTITLE: TCP Keep-Alive Time Security Check for Windows Server 2016\nDESCRIPTION: Verifies that 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes' as specified in CIS benchmark 18.3.5.\n\nLANGUAGE: text\nCODE:\n```\n#18.3.5 Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'\n[CIS - Microsoft Windows Server 2016 - 18.3.5 Ensure 'MSS: (KeepAliveTime) How often keep-alive packets are sent in milliseconds' is set to 'Enabled: 300,000 or 5 minutes (recommended)'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> KeepAliveTime -> !493e0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !KeepAliveTime;\n```\n\n----------------------------------------\n\nTITLE: Checking Logoff When Logon Hours Expire in Windows 10\nDESCRIPTION: Verifies that 'Network security: Force logoff when logon hours expire' is set to 'Enabled' by checking that the EnableForcedLogOff registry value is set to 1.\n\nLANGUAGE: reg\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1;\n```\n\n----------------------------------------\n\nTITLE: Building ZLib.Ada with GNAT\nDESCRIPTION: Command to build ZLib.Ada using GNAT build system. This requires the ZLib library to be already built on the system.\n\nLANGUAGE: shell\nCODE:\n```\ngnatmake test -largs -L<directory where libz.a is> -lz\n```\n\n----------------------------------------\n\nTITLE: Checking SSH MaxAuthTries Configuration\nDESCRIPTION: Verifies if SSH MaxAuthTries is set to 4 or less to limit authentication attempts. The test checks for proper configuration or absence of this setting, which helps prevent brute force attacks.\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:MaxAuthTries && !r:3\\s*$;\nf:/etc/ssh/sshd_config -> r:^#\\s*MaxAuthTries;\nf:/etc/ssh/sshd_config -> !r:MaxAuthTries;\n```\n\n----------------------------------------\n\nTITLE: Checking Data Execution Prevention for Explorer in Registry\nDESCRIPTION: Registry check to ensure Data Execution Prevention (DEP) for Explorer is not disabled. Implements CIS benchmark 18.9.30.3 requirement.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Service Basic Authentication Setting\nDESCRIPTION: Verifies that Basic authentication for WinRM Service is disabled by checking the AllowBasic registry value is not set to anything other than 0.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowBasic -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Set client connection encryption level' Registry Setting\nDESCRIPTION: Registry check to ensure 'Set client connection encryption level' is set to 'Enabled: High Level' per CIS benchmark 18.9.52.3.9.3. Verifies the MinEncryptionLevel value is set to 3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> MinEncryptionLevel -> !3;\n```\n\n----------------------------------------\n\nTITLE: Building Zlib Libraries\nDESCRIPTION: Creates both shared (zlib) and static (zlibstatic) libraries from source files, setting appropriate properties for DLL symbols and versioning.\n\nLANGUAGE: CMake\nCODE:\n```\nadd_library(zlib SHARED ${ZLIB_SRCS} ${ZLIB_ASMS} ${ZLIB_DLL_SRCS} ${ZLIB_PUBLIC_HDRS} ${ZLIB_PRIVATE_HDRS})\nadd_library(zlibstatic STATIC ${ZLIB_SRCS} ${ZLIB_ASMS} ${ZLIB_PUBLIC_HDRS} ${ZLIB_PRIVATE_HDRS})\nset_target_properties(zlib PROPERTIES DEFINE_SYMBOL ZLIB_DLL)\nset_target_properties(zlib PROPERTIES SOVERSION 1)\n```\n\n----------------------------------------\n\nTITLE: Checking cron Daemon Enablement\nDESCRIPTION: Rules for verifying that the cron daemon is enabled at appropriate runlevels according to CIS benchmark 9.1.1. Checks for either anacron or cron being enabled at runlevels 2-5.\n\nLANGUAGE: ossec\nCODE:\n```\n#9.1.1 Enable cron Daemon (RunLevel 2, 3, 4, 5; Priority 15)\n[CIS - Debian Linux 7/8 - 9.1.1 Enable cron Daemon (RunLevel 2, 3, 4, 5; Priority 15)] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/rc2.d/S15anacron;\nf:!/etc/rc2.d/S15cron;\nf:!/etc/rc3.d/S15anacron;\nf:!/etc/rc3.d/S15cron;\nf:!/etc/rc4.d/S15anacron;\nf:!/etc/rc4.d/S15cron;\nf:!/etc/rc5.d/S15anacron;\nf:!/etc/rc5.d/S15cron;\n```\n\n----------------------------------------\n\nTITLE: Defining Integrity Check Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring the integrity check daemon (syscheck) in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3.2\nrunsyscheck=\"Do you want to run the integrity check daemon?\"\nnosyscheck=\"Not running syscheck (integrity check daemon)\"\nyessyscheck=\"Running syscheck (integrity check daemon)\"\n```\n\n----------------------------------------\n\nTITLE: Windows Connect Now Wireless Configuration Security Check\nDESCRIPTION: Ensures that 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled' according to CIS benchmark 18.4.20.1 to prevent unauthorized wireless configuration.\n\nLANGUAGE: text\nCODE:\n```\n#18.4.20.1 Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.20.1 Ensure 'Configuration of wireless settings using Windows Connect Now' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> EnableRegistrars -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !EnableRegistrars;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableUPnPRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableUPnPRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableInBand802DOT11Registrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableInBand802DOT11Registrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableFlashConfigRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableFlashConfigRegistrar;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> DisableWPDRegistrar -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\Registrars -> !DisableWPDRegistrar;\n```\n\n----------------------------------------\n\nTITLE: Checking Data Execution Prevention for Explorer Configuration\nDESCRIPTION: Validates that Data Execution Prevention (DEP) for Explorer is enabled by ensuring the NoDataExecutionPrevention registry value is set to 0 per CIS benchmark 18.9.30.3.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer -> NoDataExecutionPrevention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Executing host-deny.sh Script Shell Commands\nDESCRIPTION: Shell commands mentioned in the changelog for host-deny.sh that improve duplicate entry handling, with consistent indentation and removing unnecessary echo messages.\n\nLANGUAGE: bash\nCODE:\n```\nhost-deny.sh: Move duplicate entry check into the add action\nhost-deny.sh: Use consistent indentation\nhost-deny.sh: Remove unnecessary echo for duplicated entry\n```\n\n----------------------------------------\n\nTITLE: Defining Agent Server Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring agent-server connectivity in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3.1/agent\nserveraddr=\"What's the IP Address or hostname of the OSSEC HIDS server?\"\naddingip=\"Adding Server IP\"\naddingname=\"Adding Hostname\"\nconfigprofile=\"Enter the agent's config profile name (default: blank)\"\naddingcfg=\"Setting agent's config profile name\"\n```\n\n----------------------------------------\n\nTITLE: Checking SSH HostbasedAuthentication Configuration\nDESCRIPTION: Verifies if SSH host-based authentication is disabled. This test checks if HostbasedAuthentication is set to 'yes', which is less secure than other authentication methods.\n\nLANGUAGE: conf\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:HostbasedAuthentication\\.+yes;\n```\n\n----------------------------------------\n\nTITLE: Disable Mounting of freevxfs Filesystems Rule for OSSEC\nDESCRIPTION: CIS rule 2.19 that checks for the existence of /etc/modprobe.d/CIS.conf and verifies it contains a directive to disable mounting of freevxfs filesystems for security hardening.\n\nLANGUAGE: OSSEC configuration\nCODE:\n```\n[CIS - Debian Linux 7/8 - 2.19 Disable Mounting of freevxfs Filesystems] [any] [https://workbench.cisecurity.org/benchmarks/80, https://workbench.cisecurity.org/benchmarks/81]\nf:!/etc/modprobe.d/CIS.conf;\nf:/etc/modprobe.d/CIS.conf -> !r:^install freevxfs /bin/true;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Allow search and Cortana to use location' Registry Setting\nDESCRIPTION: Registry check to ensure 'Allow search and Cortana to use location' is disabled per CIS benchmark 18.9.54.5. Verifies the AllowSearchToUseLocation value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowSearchToUseLocation -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !AllowSearchToUseLocation;\n```\n\n----------------------------------------\n\nTITLE: Building Assembly Files with Microsoft Macro Assembler\nDESCRIPTION: Command to build the 64-bit assembly files using the ml64.exe assembler from Microsoft. This batch file compiles the assembly source files for integration with zlib.\n\nLANGUAGE: batch\nCODE:\n```\nbld_64.bat\n```\n\n----------------------------------------\n\nTITLE: Defining Email Notification Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring email notifications in the OSSEC HIDS installer, including SMTP server settings.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3\nconfiguring=\"Configuring the\"\nmailnotify=\"Do you want e-mail notification?\"\nnomail=\"Email notification disabled\"\nwhatsemail=\"What's your e-mail address?\"\nyoursmtp=\"We found your SMTP server as\"\nusesmtp=\"Do you want to use it?\"\nusingsmtp=\"Using SMTP server: \"\nwhatsmtp=\"What's your SMTP server ip/host?\"\n```\n\n----------------------------------------\n\nTITLE: CIS Check for Info Module in Apache\nDESCRIPTION: Audit rule that checks if the Info module is enabled in Apache configurations, which exposes server information that could be useful for attackers. The check searches for uncommented LoadModule directives for the info module.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 2.8: Info Module is enabled] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nd:$conf-dirs -> conf -> !r:^# && r:loadmodule\\sinfo;\nd:$conf-dirs -> load -> !r:^# && r:loadmodule\\sinfo;\nd:$conf-dirs -> conf -> !r:^# && r:loadmodule\\sinfo;\nd:$mods-en -> info.load;\n```\n\n----------------------------------------\n\nTITLE: Checking Registration URL Microsoft.com Referral Settings\nDESCRIPTION: Verifies that 'Turn off Registration if URL connection is referring to Microsoft.com' is enabled by checking if the NoRegistration registry value is set to 1 in the Registration Wizard Control key.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> NoRegistration -> !1;\nr:HKEY_LOCAL_MACHINE\\Policies\\Microsoft\\Windows\\Registration Wizard Control -> !NoRegistration;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Connection Security Rules\nDESCRIPTION: Registry checks to ensure 'Windows Firewall: Public: Settings: Apply local connection security rules' is set to 'No' as required by CIS benchmark 9.3.6 for Windows Server 2012 R2.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalIPsecPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Cloud Search Settings in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'AllowCloudSearch' registry setting. This rule checks for compliance with CIS recommendation 18.9.60.2, ensuring that Cloud Search is disabled for security purposes.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowCloudSearch -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !AllowCloudSearch;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Remote Syslog Configuration Messages in Portuguese\nDESCRIPTION: Portuguese translations for enabling or disabling remote syslog functionality in OSSEC HIDS.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3.5/servidor/local\nsyslog=\"Deseja habilitar o syslog remoto (514 udp)?\"\nnosyslog=\"Syslog desabilitado\"\nyessyslog=\"Syslog habilitado\"\n```\n\n----------------------------------------\n\nTITLE: Detecting chargen-udp Service in xinetd\nDESCRIPTION: Checks for enabled chargen-udp service in xinetd configuration. Part of CIS SLES12 benchmark section 5.2.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/chargen-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking System Objects Case Insensitivity Setting in Windows Registry\nDESCRIPTION: Checks that 'System objects: Require case insensitivity for non-Windows subsystems' is set to 'Enabled' by verifying ObCaseInsensitive registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Session Manager\\Kernel -> ObCaseInsensitive -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Allow Cortana above lock screen' Registry Setting\nDESCRIPTION: Registry check to ensure 'Allow Cortana above lock screen' is disabled per CIS benchmark 18.9.54.3. Verifies the AllowCortanaAboveLock value is set to 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> AllowCortanaAboveLock -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search -> !AllowCortanaAboveLock;\n```\n\n----------------------------------------\n\nTITLE: Link-Layer Topology Discovery Mapper I/O Driver Security Check\nDESCRIPTION: Verifies that 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled' according to CIS benchmark 18.4.9.1 to reduce network discovery risk.\n\nLANGUAGE: text\nCODE:\n```\n#18.4.9.1 Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.9.1 Ensure 'Turn on Mapper I/O (LLTDIO) driver' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowLLTDIOOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableLLTDIO -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitLLTDIOOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Installation Completion Messages in Portuguese\nDESCRIPTION: Portuguese translations for messages displayed upon successful completion of the OSSEC HIDS installation.\n\nLANGUAGE: Bash\nCODE:\n```\n# Final\nconfigurationdone=\"Configurao finalizada corretamente\"\ntostart=\"Para iniciar o OSSEC HIDS\"\ntostop=\"Para parar o OSSEC HIDS\"\nconfigat=\"A configurao pode ser vista ou modificada em\"\naddserveragent=\"Voc precisa adicionar cada um dos clientes antes que estejam autorizados a acessar o servidor.\"\nrunma=\"Execute o 'manage_agents' para adicion-los ou remov-los\"\npresskey=\"Pressione ENTER para continuar.\"\n```\n\n----------------------------------------\n\nTITLE: CIS Check for HTTP Protocol Version Restrictions\nDESCRIPTION: Audit rule that checks if HTTP protocol versions are properly restricted. Configurations should limit allowed HTTP protocol versions to reduce vulnerability to attacks targeting older protocol versions.\n\nLANGUAGE: apache-config\nCODE:\n```\n[CIS - Apache Configuration - 5.9: Restrict HTTP Protocol Versions] [any] [https://workbench.cisecurity.org/benchmarks/307, https://workbench.cisecurity.org/benchmarks/308]\nf:/etc/httpd/conf/httpd.conf -> !r:loadmodule\\srewrite;\nd:$mods-en -> !f:rewrite.load;\nf:$main-conf -> !r:rewriteengine\\son;\nf:$main-conf -> !r:rewritecond && !r:%{THE_REQUEST} && !r:!HTTP/1\\\\.1\\$; \nf:$main-conf -> !r:rewriterule && !r:.* - [F];\n```\n\n----------------------------------------\n\nTITLE: Checking Windows CEIP Registry Settings\nDESCRIPTION: Verifies that 'Turn off Windows Customer Experience Improvement Program' is enabled by checking if the CEIPEnable registry value is set to 0 in the SQMClient\\Windows policies.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> CEIPEnable -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\SQMClient\\Windows -> !CEIPEnable;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Private Profile Logging of Successful Connections in Registry\nDESCRIPTION: Validates that the Windows Firewall for Private Profile is set to log successful connections. The rule checks for a value of 0 in the LogSuccessfulConnections key, indicating non-compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile\\Logging -> LogSuccessfulConnections -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile\\Logging -> LogSuccessfulConnections -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Disable pre-release features or settings registry setting in OSSEC\nDESCRIPTION: Verifies that 'Disable pre-release features or settings' is set to 'Disabled' by checking if the EnableConfigFlighting registry value equals 0 and that the key exists in the PreviewBuilds registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> EnableConfigFlighting -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\PreviewBuilds -> !EnableConfigFlighting;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Agent Server Connection Messages in Portuguese\nDESCRIPTION: Portuguese translations for prompts related to configuring agent-server connections in OSSEC HIDS.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3.1/agente\nserverip=\"Qual  o endereo de IP do servidor OSSEC HIDS?\"\nserveraddr=\"Qual  o endereo de IP/hostname do servidor OSSEC HIDS?\"\naddingip=\"Adicionando IP do servidor\"\naddingname=\"Adicionando hostname do servidor\"\n```\n\n----------------------------------------\n\nTITLE: Detecting daytime-udp Service in xinetd\nDESCRIPTION: Checks for enabled daytime-udp service in xinetd configuration. Part of CIS SLES12 benchmark section 5.4.\n\nLANGUAGE: shell\nCODE:\n```\nf:/etc/xinetd.d/daytime-udp -> !r:^# && r:disable && r:no;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Application Settings in Registry\nDESCRIPTION: This rule verifies that the Windows Store application is disabled by checking if the RemoveWindowsStore registry key is set to 1. The rule triggers if the key is missing or not set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> RemoveWindowsStore -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !RemoveWindowsStore;\n```\n\n----------------------------------------\n\nTITLE: Checking 'Always prompt for password upon connection' Registry Setting\nDESCRIPTION: Registry check to ensure 'Always prompt for password upon connection' is enabled per CIS benchmark 18.9.52.3.9.1. Verifies the fPromptForPassword value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fPromptForPassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fPromptForPassword;\n```\n\n----------------------------------------\n\nTITLE: Checking RPC Endpoint Mapper Client Authentication Settings\nDESCRIPTION: Registry check to ensure RPC Endpoint Mapper Client Authentication is enabled for improved RPC security.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.8.32.1 Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.32.1 Ensure 'Enable RPC Endpoint Mapper Client Authentication' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> EnableAuthEpResolution -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> !EnableAuthEpResolution;\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Installation Type Selection Messages in Portuguese\nDESCRIPTION: Portuguese translations for the installation script section that handles the selection of installation type (server, client, or local).\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 1\ninstallscript=\"Script de instalao\"\nsystem=\"Sistema\"\nuser=\"Usurio\"\nhost=\"Host\"\nhitanyorabort=\"Aperte ENTER para continuar ou Ctrl+C para abortar.\"\nwhattoinstall=\"Que tipo de instalao voc deseja (servidor, cliente, local ou ajuda)?\"\nserverchose=\"Escolhida instalao servidor\"\nclientchose=\"Escolhida instalao cliente\"\nlocalchose=\"Escolhida instalao local\"\n```\n\n----------------------------------------\n\nTITLE: Registry Checks for Microsoft Office 2016 Attack Surface Reduction Settings\nDESCRIPTION: OSSEC audit rules to verify Attack Surface Reduction settings are properly enabled in Windows Defender. These checks ensure that critical security features that prevent Office applications from creating malicious content are enabled.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR -> ExploitGuard_ASR_Rules -> !1;\nr:HKEY_LOCAL_MACHINE\\Software\\Policies\\Microsoft\\Windows Defender\\Windows Defender Exploit Guard\\ASR -> !ExploitGuard_ASR_Rules;\n```\n\n----------------------------------------\n\nTITLE: Checking User Input Methods Registry Settings\nDESCRIPTION: Verifies that 'Disallow copying of user input methods to the system account for sign-in' is enabled by checking if BlockUserInputMethodsForSignIn registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> BlockUserInputMethodsForSignIn -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Control Panel\\International -> !BlockUserInputMethodsForSignIn;\n```\n\n----------------------------------------\n\nTITLE: Handwriting Personalization Data Sharing Security Check\nDESCRIPTION: Ensures that 'Turn off handwriting personalization data sharing' is set to 'Enabled' as specified in CIS benchmark 18.8.20.1.3 to protect user privacy and prevent data leakage.\n\nLANGUAGE: text\nCODE:\n```\n#18.8.20.1.3 Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.8.20.1.3 Ensure 'Turn off handwriting personalization data sharing' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> PreventHandwritingDataSharing -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC -> !PreventHandwritingDataSharing;\n```\n\n----------------------------------------\n\nTITLE: Checking WinRM Remote Server Management Setting\nDESCRIPTION: This rule ensures that 'Allow remote server management through WinRM' is set to 'Disabled' by verifying the AllowAutoConfig registry key is not set to 0, in compliance with CIS benchmark 18.9.86.2.2.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service -> AllowAutoConfig -> !0;\n```\n\n----------------------------------------\n\nTITLE: Modified Rules Configuration in ossec.conf\nDESCRIPTION: XML configuration that modifies the rules tag to include only the compiled rules_ossec.xml file instead of individual rule files.\n\nLANGUAGE: xml\nCODE:\n```\n<rules>\n  <include>rules_ossec.xml</include>\n</rules>\n```\n\n----------------------------------------\n\nTITLE: Checking ICMP Redirect Acceptance Configuration\nDESCRIPTION: Rule to check if ICMP redirect acceptance is enabled. According to CIS SLES12 benchmark 7.2.2, these settings should be disabled (set to 0) for security.\n\nLANGUAGE: config\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/accept_redirects -> 1;\nf:/proc/sys/net/ipv4/conf/default/accept_redirects -> 1;\n```\n\n----------------------------------------\n\nTITLE: Checking Xbox Live Auth Manager Service Status in Windows Registry\nDESCRIPTION: Verifies that the Xbox Live Auth Manager service (XblAuthManager) is set to 'Disabled' per CIS benchmark 5.44. The check confirms the Start value is set to 4 or that the Start value doesn't exist.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XblAuthManager -> Start -> !4;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\XblAuthManager -> !Start;\n```\n\n----------------------------------------\n\nTITLE: Checking Turn off Microsoft consumer experiences registry setting in OSSEC\nDESCRIPTION: Verifies that 'Turn off Microsoft consumer experiences' is set to 'Enabled' by checking if the DisableWindowsConsumerFeatures registry value equals 1 and that the key exists in the CloudContent registry path.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent -> DisableWindowsConsumerFeatures -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent -> !DisableWindowsConsumerFeatures;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Error Reporting Settings in Registry\nDESCRIPTION: OSSEC rule that checks if 'Turn off Windows Error Reporting' is set to 'Enabled' by verifying multiple registry values related to error reporting in the Windows and PCHealth policies.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.22.1.14 Ensure 'Turn off Windows Error Reporting' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> Disabled -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Error Reporting -> !Disabled;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> DoReport -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\PCHealth\\ErrorReporting -> !DoReport;\n```\n\n----------------------------------------\n\nTITLE: Checking Error Reporting for Failed File Validation in Office\nDESCRIPTION: Registry check to verify that error reporting is disabled for files that fail validation in Microsoft Office. This prevents potentially sensitive information from being sent to Microsoft when files fail validation checks.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\security\\filevalidation -> disablereporting -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\common\\security\\filevalidation -> !disablereporting;\n```\n\n----------------------------------------\n\nTITLE: Validating Windows Store Application Disablement\nDESCRIPTION: Checks if the Windows Store application is disabled. This is required by CIS benchmark item 18.9.61.4, which ensures that the Store application itself is disabled to prevent unauthorized software installations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> RemoveWindowsStore -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !RemoveWindowsStore;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Domain Profile Logging Size Limit\nDESCRIPTION: Registry checks to ensure the Windows Firewall Domain Profile logging size is 16,384 KB or greater. This uses regex patterns to match various size configurations in both policy and current configuration registry paths.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:1\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:2\\w\\w\\w;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\DomainProfile\\Logging -> LogFileSize -> r:3\\w\\w\\w;\n```\n\n----------------------------------------\n\nTITLE: Verifying Standard Login Warning Banners\nDESCRIPTION: Rule to check for proper warning banners for standard login services, as specified in CIS Solaris 11 benchmark section 8.1. These banners provide legal notifications to users.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/issue -> r:SunOS;\nf:/etc/issue -> r:Oracle;\nf:/etc/issue -> r:solaris;\nf:/etc/issue -> !r:Authorized users only. All activity may be monitored and reported;\nf:/etc/motd -> r:SunOS;\nf:/etc/motd -> r:Oracle;\nf:/etc/motd -> r:solaris;\nf:/etc/motd -> !r:Authorized users only. All activity may be monitored and reported;\n```\n\n----------------------------------------\n\nTITLE: Moving Rule Files to Repository Directory\nDESCRIPTION: Command to move all rule files to the repository directory for centralized storage.\n\nLANGUAGE: bash\nCODE:\n```\nmv rules/* repository/\n```\n\n----------------------------------------\n\nTITLE: Checking SSH Root Login Configuration\nDESCRIPTION: Rule to check if SSH root login is allowed. According to CIS SLES12 benchmark 9.2.8, PermitRootLogin should be set to no to prevent direct root login for better security.\n\nLANGUAGE: config\nCODE:\n```\nf:/etc/ssh/sshd_config -> !r:^# && r:PermitRootLogin\\.+yes;\nf:/etc/ssh/sshd_config -> r:^#\\s*PermitRootLogin;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Assistance Offer Configuration in Windows 10\nDESCRIPTION: Verifies that 'Configure Offer Remote Assistance' is set to 'Disabled' by checking the fAllowUnsolicited registry value is set to 0.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows 10 - 18.8.35.1 Ensure 'Configure Offer Remote Assistance' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/766]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fAllowUnsolicited -> !0;\n```\n\n----------------------------------------\n\nTITLE: Verifying 'Network Security: Allow PKU2U authentication requests' setting\nDESCRIPTION: Registry check to ensure PKU2U authentication requests using online identities are disabled, preventing potential authentication vulnerabilities.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Lsa\\pku2u -> AllowOnlineID -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Local Rules Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile does not apply local firewall rules. Validates registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.5.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> AllowLocalPolicyMerge -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> AllowLocalPolicyMerge -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking for fseeko and unistd.h Functionality\nDESCRIPTION: Tests for the fseeko function and unistd.h header, adding appropriate definitions when they're not available.\n\nLANGUAGE: CMake\nCODE:\n```\n#\n# Check for fseeko\n#\ncheck_function_exists(fseeko HAVE_FSEEKO)\nif(NOT HAVE_FSEEKO)\n    add_definitions(-DNO_FSEEKO)\nendif()\n\n#\n# Check for unistd.h\n#\ncheck_include_file(unistd.h Z_HAVE_UNISTD_H)\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Machine Account Password Changes\nDESCRIPTION: Verifies the 'Domain member: Disable machine account password changes' policy is disabled in Windows Server 2016. Checks if the DisablePasswordChange registry value is correctly configured to allow password changes.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.6.4 Ensure 'Domain member: Disable machine account password changes' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\Netlogon\\Parameters -> DisablePasswordChange -> 1;\n```\n\n----------------------------------------\n\nTITLE: Windows RSPNDR Driver Check in OSSEC\nDESCRIPTION: Verifies the Link-Layer Topology Discovery Responder driver is disabled by checking multiple registry values that control its functionality on different network types.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2012 R2 - 18.4.9.2: Ensure 'Turn on Responder (RSPNDR) driver' is set to 'Disabled'] [any] [https://workbench.cisecurity.org/benchmarks/288]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnDomain -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> AllowRspndrOnPublicNet -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> EnableRspndr -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LLTD -> ProhibitRspndrOnPrivateNet -> !0;\n```\n\n----------------------------------------\n\nTITLE: Validating Internet Explorer Security Prompt for Windows Installer Scripts\nDESCRIPTION: Checks if the Internet Explorer security prompt for Windows Installer scripts is enabled. This is required by CIS benchmark item 18.9.74.3, which ensures that script-based installers trigger appropriate security prompts to prevent silent malicious installations.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Installer -> SafeForScripting -> !0;\n```\n\n----------------------------------------\n\nTITLE: Copying OSSEC Contrib Directory\nDESCRIPTION: Command to copy the contrib directory from the source package to the OSSEC installation directory.\n\nLANGUAGE: bash\nCODE:\n```\ncp -a /tmp/ossec/contrib .\n```\n\n----------------------------------------\n\nTITLE: Checking FTP Warning Banner\nDESCRIPTION: Rule to verify a warning banner is enabled for the FTP service, as specified in CIS Solaris 11 benchmark section 8.4. This ensures legal notifications are presented to FTP users.\n\nLANGUAGE: plaintext\nCODE:\n```\nf:/etc/proftpd.conf -> !r:^DisplayConnect\\s+/etc/issue;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Peer-to-Peer Networking Services Settings\nDESCRIPTION: Verifies that 'Turn off Microsoft Peer-to-Peer Networking Services' is enabled. This rule checks that the Disabled registry value is set to 1 to prevent peer-to-peer networking services from running.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> Disabled -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Peernet -> !Disabled;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Server Logon Hours Enforcement Setting\nDESCRIPTION: Validates that Microsoft network server is set to disconnect clients when logon hours expire as specified in CIS benchmark 2.3.9.4. The rule checks for incorrect registry values.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - Microsoft Windows Server 2016 - 2.3.9.4 Ensure 'Microsoft network server: Disconnect clients when logon hours expire' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> EnableForcedLogOff -> !1;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall: Public Profile Inbound Connections in Registry\nDESCRIPTION: Validates that the Windows Firewall for Public Profile is set to block inbound connections by default. The rule checks for a value of 0 in the DefaultInboundAction key, indicating non-compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile -> DefaultInboundAction -> 0;\n```\n\n----------------------------------------\n\nTITLE: Parsing JSON in C with cJSON_Parse\nDESCRIPTION: Simple example of parsing a JSON string using cJSON_Parse. This function allocates a tree of cJSON items representing the parsed JSON, which must be deallocated with cJSON_Delete after use.\n\nLANGUAGE: c\nCODE:\n```\ncJSON *json = cJSON_Parse(string);\n```\n\n----------------------------------------\n\nTITLE: Checking Server Session Idle Time Settings in Windows Server 2016\nDESCRIPTION: Ensures that 'Microsoft network server: Amount of idle time required before suspending session' is set to between 1 and 15 minutes. This validates the AutoDisconnect registry value to manage inactive network sessions.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> 0;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:1\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:2\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:3\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:4\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:5\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:6\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:7\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:8\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:9\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\D\\w;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> AutoDisconnect -> r:\\w\\w\\w+;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !AutoDisconnect;\n```\n\n----------------------------------------\n\nTITLE: Checking OneDrive File Storage Usage Prevention Setting\nDESCRIPTION: Validates that OneDrive for file storage is disabled by ensuring the DisableFileSyncNGSC registry value is set to 1 or exists per CIS benchmark 18.9.47.1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> DisableFileSyncNGSC -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\OneDrive -> !DisableFileSyncNGSC;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Shell Access Setting\nDESCRIPTION: These rules verify that 'Allow Remote Shell Access' is set to 'Disabled' either by confirming AllowRemoteShellAccess is not set to 0 or by checking the key doesn't exist at all, in compliance with CIS benchmark 18.9.87.1.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> AllowRemoteShellAccess -> !0;\n```\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> !AllowRemoteShellAccess;\n```\n\n----------------------------------------\n\nTITLE: Checking for Insecure SSH Protocol Version in OSSEC Rootcheck\nDESCRIPTION: Checks if the SSH daemon is configured to use Protocol 1, which has known weaknesses and should be avoided in favor of Protocol 2.\n\nLANGUAGE: rootcheck\nCODE:\n```\n[SSH Hardening - 2: Protocol 1 {PCI_DSS: 2.2.4}] [any] [2]\nf:$sshd_file -> !r:^# && r:Protocol\\.+1;\n```\n\n----------------------------------------\n\nTITLE: JSON Output Configuration in OSSEC\nDESCRIPTION: XML configuration tag to enable JSON format for all logs, which writes archives to archives.json instead of archives.log.\n\nLANGUAGE: xml\nCODE:\n```\n<logall_json>yes</logall_json>\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Last Username Display\nDESCRIPTION: Registry check to verify that the last user name is not displayed at logon according to CIS benchmark 2.3.7.1, examining the DontDisplayLastUserName registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System -> DontDisplayLastUserName -> !1;\n```\n\n----------------------------------------\n\nTITLE: Defining Dutch Language Variables for OSSEC Installation Script\nDESCRIPTION: This snippet defines variables with Dutch text strings used throughout the OSSEC installation process. The variables include configuration options, system messages, installation prompts, and various configuration questions for setting up email notifications, integrity checking, rootkit detection, active response, and syslog.\n\nLANGUAGE: Bash/Shell\nCODE:\n```\n# Configuration\nyes=\"j\"\nno=\"n\"\nyesmatch=\"j\"\nnomatch=\"n\"\nagent=\"agent\"\nlocal=\"local\"\nserver=\"server\"\nhelp=\"help\"\n\n# Global\nmoreinfo=\"Meer informatie op: \"\nstarting=\"Bezig met starten van OSSEC HIDS\"\nsystemis=\"Systeem is\"\nmodifiedinit=\"Init script aangepast om OSSEC HIDS te laden tijdens opstarten.\"\nnoboot=\"Onbekend systeem. Geen init script toegevoegd.\"\n\n# Part 1\ninstallscript=\"Installatie Script\"\nsystem=\"Systeem\"\nuser=\"Gebruiker\"\nhost=\"Host\"\nhitanyorabort=\"Druk op ENTER om door te gaan of Ctrl-C om af te breken.\"\nwhattoinstall=\"Wat voor soort installatie wilt u doen (server, agent, local of help)?\"\nserverchose=\"Gekozen voor server installatie\"\nclientchose=\"Gekozen voor agent(client) installatie\"\nlocalchose=\"Gekozen voor lokale installatie\"\n\n# Part 2\nsettingupenv=\"Opzetten van installatie omgeving\"\nwheretoinstall=\"Waar wilt u OSSEC HIDS installaren\"\ninstallat=\"Installatie word geplaatst in \"\ndeletedir=\"De installatie map bestaat reeds. Zal ik deze verwijderen?\"\n\n# Part 3\nconfiguring=\"Configureren van\"\nmailnotify=\"Wilt u email notificatie inschakelen?\"\nnomail=\"Email notificatie uitgeschakeld\"\nwhatsemail=\"Wat is uw emailadres?\"\nyoursmtp=\"We hebben uw SMTP server gevonden als: \"\nusesmtp=\"Wilt u deze gebruiken ?\"\nusingsmtp=\"Gebruik maken van SMTP server: \"\nwhatsmtp=\"Wat is uw SMTP server ip/host?\"\n\n# Part 3.1/agent\nserverip=\"Wat is het IP adres van uw OSSEC HIDS host?\"\nserveraddr=\"Wat is het IP adres/host van uw OSSEC HIDS host?\"\naddingip=\"Toevoegen van server IP\"\naddingname=\"Toevoegen van server host\"\n\n\n# Part 3.2\nrunsyscheck=\"Wilt u de integriteits controle proces?\"\nnosyscheck=\"Geen syscheck (integriteits controle proces)\"\nyessyscheck=\"Starten van syscheck (integriteits controle proces)\"\n\n# Part 3.3\nrunrootcheck=\"Wilt u de rootkit detectie engine?\"\nnorootcheck=\"Geen rootcheck (rootkit detectie)\"\nyesrootcheck=\"Starten van rootcheck (rootkit detectie)\"\n\n# Part 3.4/server/local\nenable_ar=\"Wilt u actief handelen?\"\nnoactive=\"Actief handelen uitgeschakeld\"\nnohosts=\"host-deny uitgeschakeld\"\nyeshosts=\"host-deny ingeschakeld (lokaal) voor niveaus >= 6\"\nfirewallar=\"Wilt u de firewall-drop handeling inschakelen?\"\nnofirewall=\"firewall-drop uitgeschakeld.\"\nyesfirewall=\"firewall-drop ingeschakeld (lokaal) voor niveaus >= 6\"\ndefaultwhitelist=\"Standaard witte lijst voor actief handelen:\"\naddwhite=\"Wilt u meer IPs toevoegen aan de witte lijst?\"\nipswhite=\"IPs (spatie gescheiden): \"\n\n# Part 3.5/server/local\nsyslog=\"Wilt u externe systeem logging (syslog) inschakelen (poort 514 udp)?\"\nnosyslog=\"Externe systeem logging uitgeschakeld\"\nyessyslog=\"Externe systeem logging ingeschakeld\"\n\n# Part 3.4/3.5\nreadlogs=\"Systeem instellen om de volgende logbestanden te controleren:\"\n\n# Part 5\ninstalling=\"Bezig met installeren van het systeem\"\nrunningmake=\"Uitvoeren van Makefile\"\n\n# Final\nconfigurationdone=\"Configuratie is succesvol afgesloten\"\ntostart=\"Om OSSEC HIDS te starten\"\ntostop=\"Om OSSEC HIDS te stoppen\"\nconfigat=\"De configuratie kan worden bekeken en gewijzigd in\"\naddserveragent=\"Om verbinding te maken tussen agent en server, moet je alle agenten aan de server toevoegen.\"\nrunma=\"Voer 'manage_agents' uit om ze toe te voegen of te verwijderen\"\npresskey=\"Druk op ENTER om door te gaan\"\n\n# Update\nwanttoupdate=\"U heeft OSSEC reeds geinstalleerd. Wilt u actualiseren?\"\nunabletoupdate=\"Kan geen actualisatie uitvoeren. Een volledig nieuwe installatie is vereist.\"\nupdatecompleted=\"Actualisatie succesvol uitgevoerd.\"\nupdatefailed=\"Actualisatie is gefaald.\"\nupdaterules=\"Wilt u de regels actualiseren?\"\nupdatingrules=\"Actualiseren van regels.\"\nnotupdatingrules=\"Regels worden niet geactualiseerd.\"\n\n# Pf support\npfenable=\"Wilt u de PF firewall gebruiken bij actief handelen?\"\nnopf=\"PF respons is uitgeschakeld.\"\npftablename=\"Naam van de PF tabel om te gebruiken?\"\npfmessage=\"Voeg de volgende regels toe aan het begin van uw PF regels\"\n```\n\n----------------------------------------\n\nTITLE: Checking Remotely Accessible Registry Paths Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network access: Remotely accessible registry paths' configuration according to CIS benchmark 2.3.10.7.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\SecurePipeServers\\Winreg\\AllowedExactPaths -> Machine -> !r:System\\\\CurrentControlSet\\\\Control\\\\ProductOptions|System\\\\CurrentControlSet\\\\Control\\\\Server Applications|Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion;\n```\n\n----------------------------------------\n\nTITLE: Windows Connect Now Wizards Access Restriction Check\nDESCRIPTION: Verifies that 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled' as specified in CIS benchmark 18.4.20.2 to prevent unauthorized network configuration.\n\nLANGUAGE: text\nCODE:\n```\n#18.4.20.2 Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'\n[CIS - Microsoft Windows Server 2016 - 18.4.20.2 Ensure 'Prohibit access of the Windows Connect Now wizards' is set to 'Enabled'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> DisableWcnUi -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WCN\\UI -> !DisableWcnUi;\n```\n\n----------------------------------------\n\nTITLE: Checking NetBIOS Node Type Registry Settings\nDESCRIPTION: Validates that NetBIOS node type is set to P-node by checking the NodeType registry value is set to 2 (0x2).\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NetBT\\Parameters -> NodeType -> !2;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\NetBT\\Parameters -> !NodeType;\n```\n\n----------------------------------------\n\nTITLE: Syscheck No Recurse Option\nDESCRIPTION: XML configuration option to prevent OSSEC's file integrity monitoring (FIM) from recursively monitoring subdirectories.\n\nLANGUAGE: xml\nCODE:\n```\n<no_recurse>\n```\n\n----------------------------------------\n\nTITLE: Implementing Adler-32 Checksum Algorithm in C for ZLIB Compliance\nDESCRIPTION: This C function updates a running Adler-32 checksum with new bytes from a buffer and returns the updated checksum value. The algorithm maintains two sums (s1 and s2) and processes each byte in the input buffer to compute the checksum according to the ZLIB specification.\n\nLANGUAGE: C\nCODE:\n```\n#define BASE 65521 /* largest prime smaller than 65536 */\n\n/*\n   Update a running Adler-32 checksum with the bytes buf[0..len-1]\n and return the updated checksum. The Adler-32 checksum should be\n initialized to 1.\n\n Usage example:\n\n   unsigned long adler = 1L;\n\n   while (read_buffer(buffer, length) != EOF) {\n     adler = update_adler32(adler, buffer, length);\n   }\n   if (adler != original_adler) error();\n*/\nunsigned long update_adler32(unsigned long adler,\n   unsigned char *buf, int len)\n{\n  unsigned long s1 = adler & 0xffff;\n  unsigned long s2 = (adler >> 16) & 0xffff;\n  int n;\n\n  for (n = 0; n < len; n++) {\n\n```\n\n----------------------------------------\n\nTITLE: OSSEC Registry Check for Printer Driver Installation Restriction\nDESCRIPTION: Registry check to ensure that users are prevented from installing printer drivers according to CIS benchmark 2.3.4.2, checking the AddPrinterDrivers registry value.\n\nLANGUAGE: plaintext\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Control\\Print\\Providers\\LanMan Print Services\\Servers -> AddPrinterDrivers -> !1;\n```\n\n----------------------------------------\n\nTITLE: Automating OSSEC Reports with Crontab\nDESCRIPTION: Example crontab entry for scheduling the OSSEC report tool to run daily summary reports at 11:58 PM.\n\nLANGUAGE: bash\nCODE:\n```\n58 23 * * * (cat ossec-alerts-05.log | ossec_report_contrib.pl -s)\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Private Profile State and Connection Settings in Registry\nDESCRIPTION: Registry checks for Windows Firewall Private profile state and connection settings. Verifies EnableFirewall, DefaultInboundAction, DefaultOutboundAction, and notification settings comply with security best practices.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> EnableFirewall -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> EnableFirewall -> 0;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultInboundAction -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultInboundAction -> 0;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DefaultOutboundAction -> 1;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DefaultOutboundAction -> 1;\n\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PrivateProfile -> DisableNotifications -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\StandardProfile -> DisableNotifications -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Screen Saver Grace Period Settings in Windows Server 2016\nDESCRIPTION: OSSEC rule to check if 'MSS: (ScreenSaverGracePeriod) The time in seconds before the screen saver grace period expires' is set to '5 or fewer seconds'. This setting limits the time window where an unattended workstation can be accessed after screen saver activation.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 6;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 7;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 8;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> 9;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon -> ScreenSaverGracePeriod -> r:\\w\\w+;\n```\n\n----------------------------------------\n\nTITLE: Sample JSON Structure\nDESCRIPTION: An example JSON structure representing a monitor with supported resolutions. This shows the format that will be used in the examples for both building and parsing JSON.\n\nLANGUAGE: json\nCODE:\n```\n{\n    \"name\": \"Awesome 4K\",\n    \"resolutions\": [\n        {\n            \"width\": 1280,\n            \"height\": 720\n        },\n        {\n            \"width\": 1920,\n            \"height\": 1080\n        },\n        {\n            \"width\": 3840,\n            \"height\": 2160\n        }\n    ]\n}\n```\n\n----------------------------------------\n\nTITLE: Pipe-Based Usage Examples of OSSEC Report Tool\nDESCRIPTION: Examples showing how to use the OSSEC report tool in pipe-based workflows, including sending reports via email and filtering output with other command line tools.\n\nLANGUAGE: bash\nCODE:\n```\ncat ossec-alerts-05.log | ossec_report_contrib.pl -r | mail root -s 'OSSEC detailed report'\ncat ossec-alerts-05.log | ossec_report_contrib.pl -s | mail root -s 'OSSEC summary report'\ncat <log file> | ossec_report_contrib.pl -t <key> | head -n 15 (for top 15)\ncat <log file> | ossec_report_contrib.pl -s (for summary)\n```\n\n----------------------------------------\n\nTITLE: Defining OSSEC Rootkit Detection Configuration Messages in Portuguese\nDESCRIPTION: Portuguese translations for enabling or disabling the rootkit detection system in OSSEC HIDS.\n\nLANGUAGE: Bash\nCODE:\n```\n# Parte 3.3\nrunrootcheck=\"Deseja habilitar o sistema de deteco de rootkis?\"\nnorootcheck=\"Rootcheck (Sistema de deteco de rootkits) desabilitado\"\nyesrootcheck=\"Rootcheck (Sistema de deteco de rootkits) habilitado\"\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Store Apps Disabling in Windows Registry\nDESCRIPTION: OSSEC rule that verifies the 'DisableStoreApps' registry setting for Windows Store. This rule checks for compliance with CIS recommendation 18.9.68.1, ensuring the setting is properly configured.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> DisableStoreApps -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsStore -> !DisableStoreApps;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Internet Connection Wizard Settings\nDESCRIPTION: Verifies that 'Turn off Internet Connection Wizard if URL connection is referring to Microsoft.com' is enabled by checking for ExitOnMSICW=1 in the registry. This prevents the system from automatically connecting to Microsoft sites.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> ExitOnMSICW -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\Internet Connection Wizard -> !ExitOnMSICW;\n```\n\n----------------------------------------\n\nTITLE: Checking Network Access Named Pipes Anonymous Access Configuration (Registry)\nDESCRIPTION: Checks registry keys to verify 'Network access: Named Pipes that can be accessed anonymously' configuration according to CIS benchmark 2.3.10.6.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionPipes -> r:\\S*;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !NullSessionPipes;\n```\n\n----------------------------------------\n\nTITLE: Setting PCRE2 System Environment Variable in Bash\nDESCRIPTION: Command to set the PCRE2_SYSTEM environment variable to 'yes' to build OSSEC with the native distribution PCRE2 packages instead of bundled libraries.\n\nLANGUAGE: bash\nCODE:\n```\nexport PCRE2_SYSTEM=yes\n```\n\n----------------------------------------\n\nTITLE: Running OSSEC Installation Script with Proper Path in Bash\nDESCRIPTION: Instructions for correctly executing the OSSEC installation script. The script must be run from its containing directory using the relative path notation './install.sh'.\n\nLANGUAGE: bash\nCODE:\n```\n./install.sh\n```\n\n----------------------------------------\n\nTITLE: Creating Directory Structure for Rules Organization\nDESCRIPTION: Command to create the directories needed for organizing OSSEC rules.\n\nLANGUAGE: bash\nCODE:\n```\nmkdir signatures user_signatures repository\n```\n\n----------------------------------------\n\nTITLE: Checking IPv4 TCP Data Retransmission Configuration\nDESCRIPTION: Verifies that IPv4 unacknowledged data retransmission limit is set to 3 by checking the TcpMaxDataRetransmissions registry value. Implements CIS benchmark 18.4.12.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> TcpMaxDataRetransmissions -> !3;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters -> !TcpMaxDataRetransmissions;\n```\n\n----------------------------------------\n\nTITLE: Checking Registry for Battery Wake Password Settings\nDESCRIPTION: Verifies that 'Require a password when a computer wakes (on battery)' is enabled by checking for DCSettingIndex=1 in the registry. This ensures password protection when resuming from sleep on battery power.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Power\\PowerSettings\\0e796bdb-100d-47d6-a2d5-f7d2daa51f51 -> DCSettingIndex -> !1;\n```\n\n----------------------------------------\n\nTITLE: OSSEC rule to check for SNMP server enabled\nDESCRIPTION: Checks if SNMP daemon is enabled in startup scripts by looking for S followed by numbers and snmpd.\n\nLANGUAGE: configuration\nCODE:\n```\nd:$rc_dirs -> ^S\\d\\dsnmpd$;\n```\n\n----------------------------------------\n\nTITLE: Checking Boot-Start Driver Initialization Policy\nDESCRIPTION: Registry check to ensure that Boot-Start Driver Initialization Policy is set to allow good, unknown, and critical bad drivers.\n\nLANGUAGE: ossec\nCODE:\n```\n#18.8.12.1 Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'\n[CIS - Microsoft Windows Server 2016 - 18.8.12.1 Ensure 'Boot-Start Driver Initialization Policy' is set to 'Enabled: Good, unknown and bad but critical'] [any] [https://workbench.cisecurity.org/benchmarks/515]\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Policies\\EarlyLaunch -> DriverLoadPolicy -> !3;\n```\n\n----------------------------------------\n\nTITLE: Defining Installation Environment Setup Messages in Bash\nDESCRIPTION: Defines variables for messages related to setting up the installation environment, including installation location and directory management.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 2\nsettingupenv=\"Setting up the installation environment\"\nwheretoinstall=\"Choose where to install the OSSEC HIDS\"\ninstallat=\"Installation will be made at \"\ndeletedir=\"The installation directory already exists. Should I delete it?\"\n```\n\n----------------------------------------\n\nTITLE: Verifying Suspicious Packet Logging in Network Configuration\nDESCRIPTION: Checks if logging of martian packets is enabled in the network configuration. The rule verifies if log_martians is set to 0 (disabled), which prevents the system from logging suspicious packets.\n\nLANGUAGE: conf\nCODE:\n```\nf:/proc/sys/net/ipv4/conf/all/log_martians -> 0;\n```\n\n----------------------------------------\n\nTITLE: Checking Terminal Services Password Prompt Configuration in Registry\nDESCRIPTION: Verifies that Terminal Services is configured to always prompt for password upon connection by checking if the fPromptForPassword registry value is not set to 1 or if the key doesn't exist.\n\nLANGUAGE: regex\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> fPromptForPassword -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Terminal Services -> !fPromptForPassword;\n```\n\n----------------------------------------\n\nTITLE: Verifying RPC Client Authentication Settings in Windows Registry\nDESCRIPTION: Checks that the 'Restrict Unauthenticated RPC clients' setting is configured to 'Enabled: Authenticated' by validating the RestrictRemoteClients registry value is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> RestrictRemoteClients -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows NT\\Rpc -> !RestrictRemoteClients;\n```\n\n----------------------------------------\n\nTITLE: Checking Windows Firewall Public Profile Dropped Packets Logging Settings\nDESCRIPTION: Registry checks to ensure Windows Firewall Public Profile logs dropped packets. Validates registry keys in both policy and current configuration locations as required by CIS benchmark 9.3.9.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\WindowsFirewall\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\nr:HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SharedAccess\\Parameters\\FirewallPolicy\\PublicProfile\\Logging -> LogDroppedPackets -> 0;\n```\n\n----------------------------------------\n\nTITLE: Defining Remote Syslog Configuration Messages in Bash\nDESCRIPTION: Sets variables for messages related to configuring remote syslog functionality in the OSSEC HIDS installer.\n\nLANGUAGE: bash\nCODE:\n```\n# Part 3.5/server/local\nsyslog=\"Do you want to enable remote syslog (port 514 udp)?\"\nnosyslog=\"Remote syslog disabled\"\nyessyslog=\"Remote syslog enabled\"\n```\n\n----------------------------------------\n\nTITLE: Compiling Assembly Code for 32-bit Zlib using Batch Commands\nDESCRIPTION: Batch command to compile assembly code for 32-bit systems. This needs to be run in the Visual Studio Command Prompt from the contrib\\masmx86 directory before building the solution.\n\nLANGUAGE: batch\nCODE:\n```\nbld_ml32.bat\n```\n\n----------------------------------------\n\nTITLE: Checking anonymous access to Named Pipes configuration\nDESCRIPTION: Verifies Named Pipes configuration to ensure proper protection from anonymous access by checking the NullSessionPipes registry value.\n\nLANGUAGE: text\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> NullSessionPipes -> r:\\S*;\nr:HKEY_LOCAL_MACHINE\\System\\CurrentControlSet\\Services\\LanManServer\\Parameters -> !NullSessionPipes;\n```\n\n----------------------------------------\n\nTITLE: Checking Setup Event Log Behavior\nDESCRIPTION: Ensures that the Setup Event Log is configured to not automatically clear events when the log file reaches its maximum size by verifying the Retention value is not 0.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\EventLog\\Setup -> Retention -> !0;\n```\n\n----------------------------------------\n\nTITLE: Checking Microsoft Edge about:flags Access Control in Registry\nDESCRIPTION: Verifies that 'Prevent access to the about:flags page in Microsoft Edge' is set to 'Enabled' by confirming PreventAccessToAboutFlagsInMicrosoftEdge is set to 1.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> PreventAccessToAboutFlagsInMicrosoftEdge -> !1;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\MicrosoftEdge\\Main -> !PreventAccessToAboutFlagsInMicrosoftEdge;\n```\n\n----------------------------------------\n\nTITLE: Detecting Enabled Kudzu Hardware Detection Service in OSSEC\nDESCRIPTION: OSSEC rule to identify if the Kudzu hardware detection service is enabled at boot time, which could introduce security vulnerabilities if not required for system operation.\n\nLANGUAGE: ossec\nCODE:\n```\n[CIS - SLES12 - X.X.X - Disable standard boot services - Kudzu hardware detection Enabled] [any] [https://benchmarks.cisecurity.org/tools2/linux/CIS_SUSE_Linux_Enterprise_Server_12_Benchmark_v1.0.0.pdf]\nd:$rc_dirs -> ^S\\d\\dkudzu$;\n```\n\n----------------------------------------\n\nTITLE: Checking Insecure Guest Logons Registry Settings\nDESCRIPTION: Validates that insecure guest logons are disabled by checking the AllowInsecureGuestAuth registry value is set to 0.\n\nLANGUAGE: regexp\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation -> AllowInsecureGuestAuth -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\LanmanWorkstation -> !AllowInsecureGuestAuth;\n```\n\n----------------------------------------\n\nTITLE: Checking Remote Shell Access Configuration in OSSEC\nDESCRIPTION: OSSEC rules that verify the 'Allow Remote Shell Access' setting is disabled by checking if the AllowRemoteShellAccess registry value is not set to 0 or is missing completely.\n\nLANGUAGE: ossec\nCODE:\n```\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> AllowRemoteShellAccess -> !0;\nr:HKEY_LOCAL_MACHINE\\SOFTWARE\\Policies\\Microsoft\\Windows\\WinRM\\Service\\WinRS -> !AllowRemoteShellAccess;\n```\n\n----------------------------------------\n\nTITLE: Checking Word Trusted Documents Settings in Registry\nDESCRIPTION: Registry checks to verify that trusted documents are disabled in Microsoft Word 16.0. These rules ensure the disabletrusteddocuments and disablenetworktrusteddocuments registry values are set correctly for security compliance.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\trusted documents -> disabletrusteddocuments -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\trusted documents -> !disabletrusteddocuments;\n```\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\trusted documents -> disablenetworktrusteddocuments -> !1;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\trusted documents -> !disablenetworktrusteddocuments;\n```\n\n----------------------------------------\n\nTITLE: Checking Word Security File Block Settings for Word 6.0 Documents\nDESCRIPTION: Validates registry values to ensure Word 6.0 binary documents and templates are blocked in Microsoft Word 2016. These older document formats can contain vulnerabilities that present security risks.\n\nLANGUAGE: registry\nCODE:\n```\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> word60files -> !2;\nr:HKEY_CURRENT_USER\\software\\policies\\microsoft\\office\\16.0\\word\\security\\fileblock -> !word60files;\n```"
  }
]