[
  {
    "owner": "angel-one",
    "repo": "smartapi-python",
    "content": "TITLE: SmartAPI Trading Implementation\nDESCRIPTION: Complete implementation showing authentication, session management, order placement, GTT rules, and historical data retrieval using SmartAPI.\nSOURCE: https://github.com/angel-one/smartapi-python/blob/main/README.md#2025-04-22_snippet_3\n\nLANGUAGE: python\nCODE:\n```\n# package import statement\nfrom SmartApi import SmartConnect\nimport pyotp\nfrom logzero import logger\n\napi_key = 'Your Api Key'\nusername = 'Your client code'\npwd = 'Your pin'\nsmartApi = SmartConnect(api_key)\ntry:\n    token = \"Your QR value\"\n    totp = pyotp.TOTP(token).now()\nexcept Exception as e:\n    logger.error(\"Invalid Token: The provided token is not valid.\")\n    raise e\n\ncorrelation_id = \"abcde\"\ndata = smartApi.generateSession(username, pwd, totp)\n\nif data['status'] == False:\n    logger.error(data)\n    \nelse:\n    authToken = data['data']['jwtToken']\n    refreshToken = data['data']['refreshToken']\n    feedToken = smartApi.getfeedToken()\n    res = smartApi.getProfile(refreshToken)\n    smartApi.generateToken(refreshToken)\n    res=res['data']['exchanges']\n\n    try:\n        orderparams = {\n            \"variety\": \"NORMAL\",\n            \"tradingsymbol\": \"SBIN-EQ\",\n            \"symboltoken\": \"3045\",\n            \"transactiontype\": \"BUY\",\n            \"exchange\": \"NSE\",\n            \"ordertype\": \"LIMIT\",\n            \"producttype\": \"INTRADAY\",\n            \"duration\": \"DAY\",\n            \"price\": \"19500\",\n            \"squareoff\": \"0\",\n            \"stoploss\": \"0\",\n            \"quantity\": \"1\"\n            }\n        orderid = smartApi.placeOrder(orderparams)\n        response = smartApi.placeOrderFullResponse(orderparams)\n    except Exception as e:\n        logger.exception(f\"Order placement failed: {e}\")\n\n    try:\n        gttCreateParams={\n                \"tradingsymbol\" : \"SBIN-EQ\",\n                \"symboltoken\" : \"3045\",\n                \"exchange\" : \"NSE\", \n                \"producttype\" : \"MARGIN\",\n                \"transactiontype\" : \"BUY\",\n                \"price\" : 100000,\n                \"qty\" : 10,\n                \"disclosedqty\": 10,\n                \"triggerprice\" : 200000,\n                \"timeperiod\" : 365\n            }\n        rule_id=smartApi.gttCreateRule(gttCreateParams)\n    except Exception as e:\n        logger.exception(f\"GTT Rule creation failed: {e}\")\n        \n    try:\n        status=[\"FORALL\"]\n        page=1\n        count=10\n        lists=smartApi.gttLists(status,page,count)\n    except Exception as e:\n        logger.exception(f\"GTT Rule List failed: {e}\")\n\n    try:\n        historicParam={\n        \"exchange\": \"NSE\",\n        \"symboltoken\": \"3045\",\n        \"interval\": \"ONE_MINUTE\",\n        \"fromdate\": \"2021-02-08 09:00\", \n        \"todate\": \"2021-02-08 09:16\"\n        }\n        smartApi.getCandleData(historicParam)\n    except Exception as e:\n        logger.exception(f\"Historic Api failed: {e}\")\n\n    try:\n        logout=smartApi.terminateSession('Your Client Id')\n        logger.info(\"Logout Successfull\")\n    except Exception as e:\n        logger.exception(f\"Logout failed: {e}\")\n```\n\n----------------------------------------\n\nTITLE: SmartAPI WebSocket V2 Implementation\nDESCRIPTION: Implementation of WebSocket V2 client for real-time market data streaming with event handlers for connection management.\nSOURCE: https://github.com/angel-one/smartapi-python/blob/main/README.md#2025-04-22_snippet_4\n\nLANGUAGE: python\nCODE:\n```\nfrom SmartApi.smartWebSocketV2 import SmartWebSocketV2\nfrom logzero import logger\n\nAUTH_TOKEN = \"authToken\"\nAPI_KEY = \"api_key\"\nCLIENT_CODE = \"client code\"\nFEED_TOKEN = \"feedToken\"\ncorrelation_id = \"abc123\"\naction = 1\nmode = 1\n\ntoken_list = [\n    {\n        \"exchangeType\": 1,\n        \"tokens\": [\"26009\"]\n    }\n]\ntoken_list1 = [\n    {\n        \"action\": 0,\n        \"exchangeType\": 1,\n        \"tokens\": [\"26009\"]\n    }\n]\n\nsws = SmartWebSocketV2(AUTH_TOKEN, API_KEY, CLIENT_CODE, FEED_TOKEN)\n\ndef on_data(wsapp, message):\n    logger.info(\"Ticks: {}\".format(message))\n\ndef on_open(wsapp):\n    logger.info(\"on open\")\n    sws.subscribe(correlation_id, mode, token_list)\n\ndef on_error(wsapp, error):\n    logger.error(error)\n\ndef on_close(wsapp):\n    logger.info(\"Close\")\n\ndef close_connection():\n    sws.close_connection()\n\nsws.on_open = on_open\nsws.on_data = on_data\nsws.on_error = on_error\nsws.on_close = on_close\n\nsws.connect()\n```\n\n----------------------------------------\n\nTITLE: SmartAPI Order Update WebSocket Implementation\nDESCRIPTION: Implementation of WebSocket client specifically for order updates streaming.\nSOURCE: https://github.com/angel-one/smartapi-python/blob/main/README.md#2025-04-22_snippet_5\n\nLANGUAGE: python\nCODE:\n```\nfrom SmartApi.smartWebSocketOrderUpdate import SmartWebSocketOrderUpdate\nclient = SmartWebSocketOrderUpdate(AUTH_TOKEN, API_KEY, CLIENT_CODE, FEED_TOKEN)\nclient.connect()\n```\n\n----------------------------------------\n\nTITLE: Installing Required Packages with pip\nDESCRIPTION: Installation commands for required Python packages including the main requirements and additional dependencies.\nSOURCE: https://github.com/angel-one/smartapi-python/blob/main/README.md#2025-04-22_snippet_0\n\nLANGUAGE: bash\nCODE:\n```\npip install -r requirements_dev.txt\n```\n\n----------------------------------------\n\nTITLE: Installing Additional Dependencies\nDESCRIPTION: Commands for installing specific required packages pyotp, logzero, and websocket-client.\nSOURCE: https://github.com/angel-one/smartapi-python/blob/main/README.md#2025-04-22_snippet_1\n\nLANGUAGE: bash\nCODE:\n```\npip install pyotp\npip install logzero\npip install websocket-client\n```\n\n----------------------------------------\n\nTITLE: Installing Cryptography Package\nDESCRIPTION: Commands for replacing pycrypto with pycryptodome package.\nSOURCE: https://github.com/angel-one/smartapi-python/blob/main/README.md#2025-04-22_snippet_2\n\nLANGUAGE: bash\nCODE:\n```\npip uninstall pycrypto\npip install pycryptodome\n```"
  }
]